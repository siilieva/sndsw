<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SND Software: genfit::RKTrackRep Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SND Software
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classgenfit_1_1RKTrackRep.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classgenfit_1_1RKTrackRep-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">genfit::RKTrackRep Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classgenfit_1_1AbsTrackRep.html" title="Abstract base class for a track representation.">AbsTrackRep</a> with 5D track parameterization in plane coordinates: (q/p, u', v', u, v)  
 <a href="classgenfit_1_1RKTrackRep.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for genfit::RKTrackRep:</div>
<div class="dyncontent">
<div class="center"><img src="classgenfit_1_1RKTrackRep__inherit__graph.png" border="0" usemap="#genfit_1_1RKTrackRep_inherit__map" alt="Inheritance graph"/></div>
<map name="genfit_1_1RKTrackRep_inherit__map" id="genfit_1_1RKTrackRep_inherit__map">
<area shape="rect" title="AbsTrackRep with 5D track parameterization in plane coordinates: (q/p, u&#39;, v&#39;, u, v)" alt="" coords="9,155,152,181"/>
<area shape="rect" href="classgenfit_1_1AbsTrackRep.html" title="Abstract base class for a track representation." alt="" coords="5,80,156,107"/>
<area shape="rect" title=" " alt="" coords="45,5,117,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for genfit::RKTrackRep:</div>
<div class="dyncontent">
<div class="center"><img src="classgenfit_1_1RKTrackRep__coll__graph.png" border="0" usemap="#genfit_1_1RKTrackRep_coll__map" alt="Collaboration graph"/></div>
<map name="genfit_1_1RKTrackRep_coll__map" id="genfit_1_1RKTrackRep_coll__map">
<area shape="rect" title="AbsTrackRep with 5D track parameterization in plane coordinates: (q/p, u&#39;, v&#39;, u, v)" alt="" coords="123,275,265,301"/>
<area shape="rect" href="classgenfit_1_1AbsTrackRep.html" title="Abstract base class for a track representation." alt="" coords="5,81,156,108"/>
<area shape="rect" href="classgenfit_1_1StateOnPlane.html" title="A state with arbitrary dimension defined in a DetPlane." alt="" coords="117,171,271,197"/>
<area shape="rect" title=" " alt="" coords="101,5,173,32"/>
<area shape="rect" href="classgenfit_1_1StepLimits.html" title="Helper to store different limits on the stepsize for the RKTRackRep." alt="" coords="295,171,431,197"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aca0b07380cd50f63eef644ebda8252ce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#aca0b07380cd50f63eef644ebda8252ce">RKTrackRep</a> ()</td></tr>
<tr class="separator:aca0b07380cd50f63eef644ebda8252ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab266d184647ad23a4b9f1e8f408b6513"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ab266d184647ad23a4b9f1e8f408b6513">RKTrackRep</a> (int pdgCode, char propDir=0)</td></tr>
<tr class="separator:ab266d184647ad23a4b9f1e8f408b6513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa59782fc97eb9bf3ab2f1e1ab88a2a19"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#aa59782fc97eb9bf3ab2f1e1ab88a2a19">~RKTrackRep</a> ()</td></tr>
<tr class="separator:aa59782fc97eb9bf3ab2f1e1ab88a2a19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb842973c3accd7dce8c10e967fabd14"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#acb842973c3accd7dce8c10e967fabd14">clone</a> () const</td></tr>
<tr class="memdesc:acb842973c3accd7dce8c10e967fabd14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone the trackRep.  <a href="classgenfit_1_1RKTrackRep.html#acb842973c3accd7dce8c10e967fabd14">More...</a><br /></td></tr>
<tr class="separator:acb842973c3accd7dce8c10e967fabd14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade2e4cf73880a2df757e9dd372bf7b00"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ade2e4cf73880a2df757e9dd372bf7b00">extrapolateToPlane</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const <a class="el" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> &amp;plane, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:ade2e4cf73880a2df757e9dd372bf7b00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to plane, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#ade2e4cf73880a2df757e9dd372bf7b00">More...</a><br /></td></tr>
<tr class="separator:ade2e4cf73880a2df757e9dd372bf7b00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af556c558f049d00b43b079bd363564d9"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#af556c558f049d00b43b079bd363564d9">extrapolateToLine</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;linePoint, const TVector3 &amp;lineDirection, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:af556c558f049d00b43b079bd363564d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to the POCA to a line, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#af556c558f049d00b43b079bd363564d9">More...</a><br /></td></tr>
<tr class="separator:af556c558f049d00b43b079bd363564d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb99d5a9c3b53087dfbd30cb1d393eaa"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#afb99d5a9c3b53087dfbd30cb1d393eaa">extrapolateToPoint</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;point, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:afb99d5a9c3b53087dfbd30cb1d393eaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to the POCA to a point, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#afb99d5a9c3b53087dfbd30cb1d393eaa">More...</a><br /></td></tr>
<tr class="separator:afb99d5a9c3b53087dfbd30cb1d393eaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add04b97a56a22832fed2a96bfa45a597"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#add04b97a56a22832fed2a96bfa45a597">extrapolateToPoint</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;point, const TMatrixDSym &amp;G, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:add04b97a56a22832fed2a96bfa45a597"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to the POCA to a point in the metric of G, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#add04b97a56a22832fed2a96bfa45a597">More...</a><br /></td></tr>
<tr class="separator:add04b97a56a22832fed2a96bfa45a597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cfb69ae23f997f00073c2178771e233"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a7cfb69ae23f997f00073c2178771e233">extrapolateToCylinder</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, double radius, const TVector3 &amp;linePoint=TVector3(0., 0., 0.), const TVector3 &amp;lineDirection=TVector3(0., 0., 1.), bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:a7cfb69ae23f997f00073c2178771e233"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to the cylinder surface, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#a7cfb69ae23f997f00073c2178771e233">More...</a><br /></td></tr>
<tr class="separator:a7cfb69ae23f997f00073c2178771e233"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a593518bed9f4385feab1623a66d734a5"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a593518bed9f4385feab1623a66d734a5">extrapolateToSphere</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, double radius, const TVector3 &amp;point=TVector3(0., 0., 0.), bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:a593518bed9f4385feab1623a66d734a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to the sphere surface, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#a593518bed9f4385feab1623a66d734a5">More...</a><br /></td></tr>
<tr class="separator:a593518bed9f4385feab1623a66d734a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e8225094b2cba938c3dcef7261ccfb0"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a6e8225094b2cba938c3dcef7261ccfb0">extrapolateBy</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, double step, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:a6e8225094b2cba938c3dcef7261ccfb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state by step (cm) and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#a6e8225094b2cba938c3dcef7261ccfb0">More...</a><br /></td></tr>
<tr class="separator:a6e8225094b2cba938c3dcef7261ccfb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb36a12c29b84f73fe2243f65ae09b7"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a9fb36a12c29b84f73fe2243f65ae09b7">getDim</a> () const</td></tr>
<tr class="memdesc:a9fb36a12c29b84f73fe2243f65ae09b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the dimension of the state vector used by the track representation.  <a href="classgenfit_1_1RKTrackRep.html#a9fb36a12c29b84f73fe2243f65ae09b7">More...</a><br /></td></tr>
<tr class="separator:a9fb36a12c29b84f73fe2243f65ae09b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf4865558fe7b54ffe94c3e145344505"><td class="memItemLeft" align="right" valign="top">virtual TVector3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#adf4865558fe7b54ffe94c3e145344505">getPos</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:adf4865558fe7b54ffe94c3e145344505"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the cartesian position of a state.  <a href="classgenfit_1_1RKTrackRep.html#adf4865558fe7b54ffe94c3e145344505">More...</a><br /></td></tr>
<tr class="separator:adf4865558fe7b54ffe94c3e145344505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01ccd6e74c4750e434e89992e853ae30"><td class="memItemLeft" align="right" valign="top">virtual TVector3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a01ccd6e74c4750e434e89992e853ae30">getMom</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:a01ccd6e74c4750e434e89992e853ae30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the cartesian momentum vector of a state.  <a href="classgenfit_1_1RKTrackRep.html#a01ccd6e74c4750e434e89992e853ae30">More...</a><br /></td></tr>
<tr class="separator:a01ccd6e74c4750e434e89992e853ae30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35723de16e1bae56aeb8a7ca098b2b9e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a35723de16e1bae56aeb8a7ca098b2b9e">getPosMom</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, TVector3 &amp;pos, TVector3 &amp;mom) const</td></tr>
<tr class="memdesc:a35723de16e1bae56aeb8a7ca098b2b9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get cartesian position and momentum vector of a state.  <a href="classgenfit_1_1RKTrackRep.html#a35723de16e1bae56aeb8a7ca098b2b9e">More...</a><br /></td></tr>
<tr class="separator:a35723de16e1bae56aeb8a7ca098b2b9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f24c1004c5693d405225be56ec007c"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ab7f24c1004c5693d405225be56ec007c">getMomMag</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:ab7f24c1004c5693d405225be56ec007c"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the magnitude of the momentum in GeV.  <a href="classgenfit_1_1RKTrackRep.html#ab7f24c1004c5693d405225be56ec007c">More...</a><br /></td></tr>
<tr class="separator:ab7f24c1004c5693d405225be56ec007c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0993fd7e2150032f83508291c9aa713"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ab0993fd7e2150032f83508291c9aa713">getMomVar</a> (const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:ab0993fd7e2150032f83508291c9aa713"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the variance of the absolute value of the momentum .  <a href="classgenfit_1_1RKTrackRep.html#ab0993fd7e2150032f83508291c9aa713">More...</a><br /></td></tr>
<tr class="separator:ab0993fd7e2150032f83508291c9aa713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e880395d30a6520d8a9aece5f0e36b3"><td class="memItemLeft" align="right" valign="top">virtual TMatrixDSym&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a5e880395d30a6520d8a9aece5f0e36b3">get6DCov</a> (const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:a5e880395d30a6520d8a9aece5f0e36b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the 6D covariance.  <a href="classgenfit_1_1RKTrackRep.html#a5e880395d30a6520d8a9aece5f0e36b3">More...</a><br /></td></tr>
<tr class="separator:a5e880395d30a6520d8a9aece5f0e36b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad94153c3713eeff5ee143ab21902de62"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ad94153c3713eeff5ee143ab21902de62">getPosMomCov</a> (const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, TVector3 &amp;pos, TVector3 &amp;mom, TMatrixDSym &amp;cov) const</td></tr>
<tr class="memdesc:ad94153c3713eeff5ee143ab21902de62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translates <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html" title="StateOnPlane with additional covariance matrix.">MeasuredStateOnPlane</a> into 3D position, momentum and 6x6 covariance.  <a href="classgenfit_1_1RKTrackRep.html#ad94153c3713eeff5ee143ab21902de62">More...</a><br /></td></tr>
<tr class="separator:ad94153c3713eeff5ee143ab21902de62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33b8c25c6a34f361839aa7ac65769193"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:a33b8c25c6a34f361839aa7ac65769193"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the (fitted) charge of a state. This is not always equal the pdg charge (e.g. if the charge sign was flipped during the fit).  <a href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">More...</a><br /></td></tr>
<tr class="separator:a33b8c25c6a34f361839aa7ac65769193"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a57b696edac7ed33608d10053f255d6"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a2a57b696edac7ed33608d10053f255d6">getQop</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:a2a57b696edac7ed33608d10053f255d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get charge over momentum.  <a href="classgenfit_1_1RKTrackRep.html#a2a57b696edac7ed33608d10053f255d6">More...</a><br /></td></tr>
<tr class="separator:a2a57b696edac7ed33608d10053f255d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a177f273f4dc3d7d1eaa646fe5a70aaf3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a177f273f4dc3d7d1eaa646fe5a70aaf3">getSpu</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="separator:a177f273f4dc3d7d1eaa646fe5a70aaf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa96520234a875b14591c79214627c50c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#aa96520234a875b14591c79214627c50c">getForwardJacobianAndNoise</a> (TMatrixD &amp;jacobian, TMatrixDSym &amp;noise, TVectorD &amp;deltaState) const</td></tr>
<tr class="memdesc:aa96520234a875b14591c79214627c50c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the jacobian and noise matrix of the last extrapolation.  <a href="classgenfit_1_1RKTrackRep.html#aa96520234a875b14591c79214627c50c">More...</a><br /></td></tr>
<tr class="separator:aa96520234a875b14591c79214627c50c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b4f84851dbb33f617a52f9bbd3ccd8a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a1b4f84851dbb33f617a52f9bbd3ccd8a">getBackwardJacobianAndNoise</a> (TMatrixD &amp;jacobian, TMatrixDSym &amp;noise, TVectorD &amp;deltaState) const</td></tr>
<tr class="memdesc:a1b4f84851dbb33f617a52f9bbd3ccd8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the jacobian and noise matrix of the last extrapolation if it would have been done in opposite direction.  <a href="classgenfit_1_1RKTrackRep.html#a1b4f84851dbb33f617a52f9bbd3ccd8a">More...</a><br /></td></tr>
<tr class="separator:a1b4f84851dbb33f617a52f9bbd3ccd8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71750034f38aa93a3941ae3ae3d3533e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structgenfit_1_1MatStep.html">genfit::MatStep</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a71750034f38aa93a3941ae3ae3d3533e">getSteps</a> () const</td></tr>
<tr class="memdesc:a71750034f38aa93a3941ae3ae3d3533e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get stepsizes and material properties of crossed materials of the last extrapolation.  <a href="classgenfit_1_1RKTrackRep.html#a71750034f38aa93a3941ae3ae3d3533e">More...</a><br /></td></tr>
<tr class="separator:a71750034f38aa93a3941ae3ae3d3533e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaaf31bac6cfa342cfb5560ec2f1f3d0"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#aaaaf31bac6cfa342cfb5560ec2f1f3d0">getRadiationLenght</a> () const</td></tr>
<tr class="memdesc:aaaaf31bac6cfa342cfb5560ec2f1f3d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the accumulated X/X0 (path / radiation length) of the material crossed in the last extrapolation.  <a href="classgenfit_1_1RKTrackRep.html#aaaaf31bac6cfa342cfb5560ec2f1f3d0">More...</a><br /></td></tr>
<tr class="separator:aaaaf31bac6cfa342cfb5560ec2f1f3d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78bd680b2fee363204b524fe76f988b9"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a78bd680b2fee363204b524fe76f988b9">getTOF</a> () const</td></tr>
<tr class="memdesc:a78bd680b2fee363204b524fe76f988b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the time of flight [ns] of the last extrapolation.  <a href="classgenfit_1_1RKTrackRep.html#a78bd680b2fee363204b524fe76f988b9">More...</a><br /></td></tr>
<tr class="separator:a78bd680b2fee363204b524fe76f988b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a743ae73c90b306147fff6092ae2a0c99"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a743ae73c90b306147fff6092ae2a0c99">setPosMom</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;pos, const TVector3 &amp;mom) const</td></tr>
<tr class="memdesc:a743ae73c90b306147fff6092ae2a0c99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set position and momentum of state.  <a href="classgenfit_1_1RKTrackRep.html#a743ae73c90b306147fff6092ae2a0c99">More...</a><br /></td></tr>
<tr class="separator:a743ae73c90b306147fff6092ae2a0c99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a4f43ee1ff3f76f0f6cdf1b02cfacde"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a5a4f43ee1ff3f76f0f6cdf1b02cfacde">setPosMom</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVectorD &amp;state6) const</td></tr>
<tr class="memdesc:a5a4f43ee1ff3f76f0f6cdf1b02cfacde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set position and momentum of state.  <a href="classgenfit_1_1RKTrackRep.html#a5a4f43ee1ff3f76f0f6cdf1b02cfacde">More...</a><br /></td></tr>
<tr class="separator:a5a4f43ee1ff3f76f0f6cdf1b02cfacde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e3336e902f6edb35dce5205724cfb1b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a0e3336e902f6edb35dce5205724cfb1b">setPosMomErr</a> (<a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, const TVector3 &amp;pos, const TVector3 &amp;mom, const TVector3 &amp;posErr, const TVector3 &amp;momErr) const</td></tr>
<tr class="memdesc:a0e3336e902f6edb35dce5205724cfb1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set position and momentum and error of state.  <a href="classgenfit_1_1RKTrackRep.html#a0e3336e902f6edb35dce5205724cfb1b">More...</a><br /></td></tr>
<tr class="separator:a0e3336e902f6edb35dce5205724cfb1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0c5a51469f0400049001c287ddd516"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a9a0c5a51469f0400049001c287ddd516">setPosMomCov</a> (<a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, const TVector3 &amp;pos, const TVector3 &amp;mom, const TMatrixDSym &amp;cov6x6) const</td></tr>
<tr class="memdesc:a9a0c5a51469f0400049001c287ddd516"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set position, momentum and covariance of state.  <a href="classgenfit_1_1RKTrackRep.html#a9a0c5a51469f0400049001c287ddd516">More...</a><br /></td></tr>
<tr class="separator:a9a0c5a51469f0400049001c287ddd516"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adda4fd1cb09adcd30afff0594e24519d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#adda4fd1cb09adcd30afff0594e24519d">setPosMomCov</a> (<a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, const TVectorD &amp;state6, const TMatrixDSym &amp;cov6x6) const</td></tr>
<tr class="memdesc:adda4fd1cb09adcd30afff0594e24519d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set position, momentum and covariance of state.  <a href="classgenfit_1_1RKTrackRep.html#adda4fd1cb09adcd30afff0594e24519d">More...</a><br /></td></tr>
<tr class="separator:adda4fd1cb09adcd30afff0594e24519d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23f160ca573dbf0ed2526b2c21b1fdc2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a23f160ca573dbf0ed2526b2c21b1fdc2">setChargeSign</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, double charge) const</td></tr>
<tr class="memdesc:a23f160ca573dbf0ed2526b2c21b1fdc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the sign of the charge according to charge.  <a href="classgenfit_1_1RKTrackRep.html#a23f160ca573dbf0ed2526b2c21b1fdc2">More...</a><br /></td></tr>
<tr class="separator:a23f160ca573dbf0ed2526b2c21b1fdc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eb48cd7c3e1c5d954563cea4d37576d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a1eb48cd7c3e1c5d954563cea4d37576d">setQop</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, double qop) const</td></tr>
<tr class="memdesc:a1eb48cd7c3e1c5d954563cea4d37576d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set charge/momentum.  <a href="classgenfit_1_1RKTrackRep.html#a1eb48cd7c3e1c5d954563cea4d37576d">More...</a><br /></td></tr>
<tr class="separator:a1eb48cd7c3e1c5d954563cea4d37576d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a324ba092d634f324285f445b4bba12b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a324ba092d634f324285f445b4bba12b6">setSpu</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, double spu) const</td></tr>
<tr class="separator:a324ba092d634f324285f445b4bba12b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affa6945eaba3b0f2b143d039967b834e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#affa6945eaba3b0f2b143d039967b834e">RKPropagate</a> (<a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7, <a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> *jacobian, <a class="el" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> &amp;SA, double S, bool varField=true, bool calcOnlyLastRowOfJ=false) const</td></tr>
<tr class="memdesc:affa6945eaba3b0f2b143d039967b834e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The actual Runge Kutta propagation.  <a href="classgenfit_1_1RKTrackRep.html#affa6945eaba3b0f2b143d039967b834e">More...</a><br /></td></tr>
<tr class="separator:affa6945eaba3b0f2b143d039967b834e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8e39563fac26c69d88f3408ba6de39e"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ae8e39563fac26c69d88f3408ba6de39e">isSameType</a> (const <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> *other)</td></tr>
<tr class="memdesc:ae8e39563fac26c69d88f3408ba6de39e"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if other is of same type (e.g. <a class="el" href="classgenfit_1_1RKTrackRep.html" title="AbsTrackRep with 5D track parameterization in plane coordinates: (q/p, u&#39;, v&#39;, u, v)">RKTrackRep</a>).  <a href="classgenfit_1_1RKTrackRep.html#ae8e39563fac26c69d88f3408ba6de39e">More...</a><br /></td></tr>
<tr class="separator:ae8e39563fac26c69d88f3408ba6de39e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ca7fc3eb20ddf0e8712b6a1f720356"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#aa8ca7fc3eb20ddf0e8712b6a1f720356">isSame</a> (const <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> *other)</td></tr>
<tr class="memdesc:aa8ca7fc3eb20ddf0e8712b6a1f720356"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if other is of same type (e.g. <a class="el" href="classgenfit_1_1RKTrackRep.html" title="AbsTrackRep with 5D track parameterization in plane coordinates: (q/p, u&#39;, v&#39;, u, v)">RKTrackRep</a>) and has same pdg code.  <a href="classgenfit_1_1RKTrackRep.html#aa8ca7fc3eb20ddf0e8712b6a1f720356">More...</a><br /></td></tr>
<tr class="separator:aa8ca7fc3eb20ddf0e8712b6a1f720356"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0b07380cd50f63eef644ebda8252ce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#aca0b07380cd50f63eef644ebda8252ce">RKTrackRep</a> ()</td></tr>
<tr class="separator:aca0b07380cd50f63eef644ebda8252ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab266d184647ad23a4b9f1e8f408b6513"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ab266d184647ad23a4b9f1e8f408b6513">RKTrackRep</a> (int pdgCode, char propDir=0)</td></tr>
<tr class="separator:ab266d184647ad23a4b9f1e8f408b6513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1f68e1338fe07ec2df8a9f9cb03aabd"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ac1f68e1338fe07ec2df8a9f9cb03aabd">~RKTrackRep</a> ()</td></tr>
<tr class="separator:ac1f68e1338fe07ec2df8a9f9cb03aabd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb842973c3accd7dce8c10e967fabd14"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#acb842973c3accd7dce8c10e967fabd14">clone</a> () const</td></tr>
<tr class="memdesc:acb842973c3accd7dce8c10e967fabd14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone the trackRep.  <a href="classgenfit_1_1RKTrackRep.html#acb842973c3accd7dce8c10e967fabd14">More...</a><br /></td></tr>
<tr class="separator:acb842973c3accd7dce8c10e967fabd14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa88e29e08c9e0991f85c10d69c5f673"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#aaa88e29e08c9e0991f85c10d69c5f673">makePlane</a> (const TVector3 &amp;o, const TVector3 &amp;u, const TVector3 &amp;v)</td></tr>
<tr class="separator:aaa88e29e08c9e0991f85c10d69c5f673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43755174182fc4f0e42cae45b690baae"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a43755174182fc4f0e42cae45b690baae">extrapolateToPlane</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const <a class="el" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> &amp;plane, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:a43755174182fc4f0e42cae45b690baae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to plane, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#a43755174182fc4f0e42cae45b690baae">More...</a><br /></td></tr>
<tr class="separator:a43755174182fc4f0e42cae45b690baae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add17267d625d78c2df112bbf501f5753"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#add17267d625d78c2df112bbf501f5753">extrapolateToPlane</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;point, const TVector3 &amp;dir, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="separator:add17267d625d78c2df112bbf501f5753"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeebe12bb8b5385b4ed46258271e7f13"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#afeebe12bb8b5385b4ed46258271e7f13">extrapolateToLine</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;linePoint, const TVector3 &amp;lineDirection, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:afeebe12bb8b5385b4ed46258271e7f13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to the POCA to a line, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#afeebe12bb8b5385b4ed46258271e7f13">More...</a><br /></td></tr>
<tr class="separator:afeebe12bb8b5385b4ed46258271e7f13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb99d5a9c3b53087dfbd30cb1d393eaa"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#afb99d5a9c3b53087dfbd30cb1d393eaa">extrapolateToPoint</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;point, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:afb99d5a9c3b53087dfbd30cb1d393eaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to the POCA to a point, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#afb99d5a9c3b53087dfbd30cb1d393eaa">More...</a><br /></td></tr>
<tr class="separator:afb99d5a9c3b53087dfbd30cb1d393eaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add04b97a56a22832fed2a96bfa45a597"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#add04b97a56a22832fed2a96bfa45a597">extrapolateToPoint</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;point, const TMatrixDSym &amp;G, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:add04b97a56a22832fed2a96bfa45a597"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to the POCA to a point in the metric of G, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#add04b97a56a22832fed2a96bfa45a597">More...</a><br /></td></tr>
<tr class="separator:add04b97a56a22832fed2a96bfa45a597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa91d6caaf330881eead525c66dff955f"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#aa91d6caaf330881eead525c66dff955f">extrapolateToCylinder</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, double radius, const TVector3 &amp;linePoint=TVector3(0., 0., 0.), const TVector3 &amp;lineDirection=TVector3(0., 0., 1.), bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:aa91d6caaf330881eead525c66dff955f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to the cylinder surface, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#aa91d6caaf330881eead525c66dff955f">More...</a><br /></td></tr>
<tr class="separator:aa91d6caaf330881eead525c66dff955f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72111e10145836e1357cf6fa1aa59b63"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a72111e10145836e1357cf6fa1aa59b63">extrapolateToSphere</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, double radius, const TVector3 &amp;point=TVector3(0., 0., 0.), bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:a72111e10145836e1357cf6fa1aa59b63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to the sphere surface, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#a72111e10145836e1357cf6fa1aa59b63">More...</a><br /></td></tr>
<tr class="separator:a72111e10145836e1357cf6fa1aa59b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f4323fd5ad69bce79d82d0af287417e"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a4f4323fd5ad69bce79d82d0af287417e">extrapolateBy</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, double step, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:a4f4323fd5ad69bce79d82d0af287417e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state by step (cm) and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#a4f4323fd5ad69bce79d82d0af287417e">More...</a><br /></td></tr>
<tr class="separator:a4f4323fd5ad69bce79d82d0af287417e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb36a12c29b84f73fe2243f65ae09b7"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a9fb36a12c29b84f73fe2243f65ae09b7">getDim</a> () const</td></tr>
<tr class="memdesc:a9fb36a12c29b84f73fe2243f65ae09b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the dimension of the state vector used by the track representation.  <a href="classgenfit_1_1RKTrackRep.html#a9fb36a12c29b84f73fe2243f65ae09b7">More...</a><br /></td></tr>
<tr class="separator:a9fb36a12c29b84f73fe2243f65ae09b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8043122392aed738fa1596b74cfa957"><td class="memItemLeft" align="right" valign="top">virtual TVector3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#af8043122392aed738fa1596b74cfa957">getPos</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:af8043122392aed738fa1596b74cfa957"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the cartesian position of a state.  <a href="classgenfit_1_1RKTrackRep.html#af8043122392aed738fa1596b74cfa957">More...</a><br /></td></tr>
<tr class="separator:af8043122392aed738fa1596b74cfa957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac729ee4957d43f4531f7621599286bbf"><td class="memItemLeft" align="right" valign="top">virtual TVector3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ac729ee4957d43f4531f7621599286bbf">getMom</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:ac729ee4957d43f4531f7621599286bbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the cartesian momentum vector of a state.  <a href="classgenfit_1_1RKTrackRep.html#ac729ee4957d43f4531f7621599286bbf">More...</a><br /></td></tr>
<tr class="separator:ac729ee4957d43f4531f7621599286bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aece5f6f41109186ac8116a1311c2c702"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#aece5f6f41109186ac8116a1311c2c702">getPosMom</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, TVector3 &amp;pos, TVector3 &amp;mom) const</td></tr>
<tr class="memdesc:aece5f6f41109186ac8116a1311c2c702"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get cartesian position and momentum vector of a state.  <a href="classgenfit_1_1RKTrackRep.html#aece5f6f41109186ac8116a1311c2c702">More...</a><br /></td></tr>
<tr class="separator:aece5f6f41109186ac8116a1311c2c702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2dc54584a27cddd473186cea5e23206"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#af2dc54584a27cddd473186cea5e23206">getMomMag</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:af2dc54584a27cddd473186cea5e23206"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the magnitude of the momentum in GeV.  <a href="classgenfit_1_1RKTrackRep.html#af2dc54584a27cddd473186cea5e23206">More...</a><br /></td></tr>
<tr class="separator:af2dc54584a27cddd473186cea5e23206"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82d4e2aca5f1636f0d8a21ac099f69b0"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a82d4e2aca5f1636f0d8a21ac099f69b0">getMomVar</a> (const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:a82d4e2aca5f1636f0d8a21ac099f69b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the variance of the absolute value of the momentum .  <a href="classgenfit_1_1RKTrackRep.html#a82d4e2aca5f1636f0d8a21ac099f69b0">More...</a><br /></td></tr>
<tr class="separator:a82d4e2aca5f1636f0d8a21ac099f69b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd3b926fefc365621ce79d2e13b7be7c"><td class="memItemLeft" align="right" valign="top">virtual TMatrixDSym&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#afd3b926fefc365621ce79d2e13b7be7c">get6DCov</a> (const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:afd3b926fefc365621ce79d2e13b7be7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the 6D covariance.  <a href="classgenfit_1_1RKTrackRep.html#afd3b926fefc365621ce79d2e13b7be7c">More...</a><br /></td></tr>
<tr class="separator:afd3b926fefc365621ce79d2e13b7be7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a365af2b96444bab71d5acb3cd75318c3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a365af2b96444bab71d5acb3cd75318c3">getPosMomCov</a> (const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, TVector3 &amp;pos, TVector3 &amp;mom, TMatrixDSym &amp;cov) const</td></tr>
<tr class="memdesc:a365af2b96444bab71d5acb3cd75318c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translates <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html" title="StateOnPlane with additional covariance matrix.">MeasuredStateOnPlane</a> into 3D position, momentum and 6x6 covariance.  <a href="classgenfit_1_1RKTrackRep.html#a365af2b96444bab71d5acb3cd75318c3">More...</a><br /></td></tr>
<tr class="separator:a365af2b96444bab71d5acb3cd75318c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8213288fbf4d7b25e02b6a49440702a9"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a8213288fbf4d7b25e02b6a49440702a9">getCharge</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:a8213288fbf4d7b25e02b6a49440702a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the (fitted) charge of a state. This is not always equal the pdg charge (e.g. if the charge sign was flipped during the fit).  <a href="classgenfit_1_1RKTrackRep.html#a8213288fbf4d7b25e02b6a49440702a9">More...</a><br /></td></tr>
<tr class="separator:a8213288fbf4d7b25e02b6a49440702a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a57b696edac7ed33608d10053f255d6"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a2a57b696edac7ed33608d10053f255d6">getQop</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:a2a57b696edac7ed33608d10053f255d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get charge over momentum.  <a href="classgenfit_1_1RKTrackRep.html#a2a57b696edac7ed33608d10053f255d6">More...</a><br /></td></tr>
<tr class="separator:a2a57b696edac7ed33608d10053f255d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a177f273f4dc3d7d1eaa646fe5a70aaf3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a177f273f4dc3d7d1eaa646fe5a70aaf3">getSpu</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="separator:a177f273f4dc3d7d1eaa646fe5a70aaf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a100bb8b3cd47c4f13fb3fc8e044a1980"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a100bb8b3cd47c4f13fb3fc8e044a1980">getForwardJacobianAndNoise</a> (TMatrixD &amp;jacobian, TMatrixDSym &amp;noise, TVectorD &amp;deltaState) const</td></tr>
<tr class="memdesc:a100bb8b3cd47c4f13fb3fc8e044a1980"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the jacobian and noise matrix of the last extrapolation.  <a href="classgenfit_1_1RKTrackRep.html#a100bb8b3cd47c4f13fb3fc8e044a1980">More...</a><br /></td></tr>
<tr class="separator:a100bb8b3cd47c4f13fb3fc8e044a1980"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab686cd76fe00a4b67cecd42d8c9183b9"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ab686cd76fe00a4b67cecd42d8c9183b9">getBackwardJacobianAndNoise</a> (TMatrixD &amp;jacobian, TMatrixDSym &amp;noise, TVectorD &amp;deltaState) const</td></tr>
<tr class="memdesc:ab686cd76fe00a4b67cecd42d8c9183b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the jacobian and noise matrix of the last extrapolation if it would have been done in opposite direction.  <a href="classgenfit_1_1RKTrackRep.html#ab686cd76fe00a4b67cecd42d8c9183b9">More...</a><br /></td></tr>
<tr class="separator:ab686cd76fe00a4b67cecd42d8c9183b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff5d9a16cfa0c3f02698467f2ef1e27e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structgenfit_1_1MatStep.html">genfit::MatStep</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#aff5d9a16cfa0c3f02698467f2ef1e27e">getSteps</a> () const</td></tr>
<tr class="memdesc:aff5d9a16cfa0c3f02698467f2ef1e27e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get stepsizes and material properties of crossed materials of the last extrapolation.  <a href="classgenfit_1_1RKTrackRep.html#aff5d9a16cfa0c3f02698467f2ef1e27e">More...</a><br /></td></tr>
<tr class="separator:aff5d9a16cfa0c3f02698467f2ef1e27e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74fb80a21741cc6d9290b21addba6c75"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a74fb80a21741cc6d9290b21addba6c75">getRadiationLenght</a> () const</td></tr>
<tr class="memdesc:a74fb80a21741cc6d9290b21addba6c75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the accumulated X/X0 (path / radiation length) of the material crossed in the last extrapolation.  <a href="classgenfit_1_1RKTrackRep.html#a74fb80a21741cc6d9290b21addba6c75">More...</a><br /></td></tr>
<tr class="separator:a74fb80a21741cc6d9290b21addba6c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae71e36989f017cc990fdd47e87bc4447"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ae71e36989f017cc990fdd47e87bc4447">getTOF</a> () const</td></tr>
<tr class="memdesc:ae71e36989f017cc990fdd47e87bc4447"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the time of flight [ns] of the last extrapolation.  <a href="classgenfit_1_1RKTrackRep.html#ae71e36989f017cc990fdd47e87bc4447">More...</a><br /></td></tr>
<tr class="separator:ae71e36989f017cc990fdd47e87bc4447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cf9535c2cfef5f12915de536941986e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a8cf9535c2cfef5f12915de536941986e">setPosMom</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;pos, const TVector3 &amp;mom) const</td></tr>
<tr class="memdesc:a8cf9535c2cfef5f12915de536941986e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set position and momentum of state.  <a href="classgenfit_1_1RKTrackRep.html#a8cf9535c2cfef5f12915de536941986e">More...</a><br /></td></tr>
<tr class="separator:a8cf9535c2cfef5f12915de536941986e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a747be9a6b854b5c47e2e7eaf806c185f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a747be9a6b854b5c47e2e7eaf806c185f">setPosMom</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVectorD &amp;state6) const</td></tr>
<tr class="memdesc:a747be9a6b854b5c47e2e7eaf806c185f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set position and momentum of state.  <a href="classgenfit_1_1RKTrackRep.html#a747be9a6b854b5c47e2e7eaf806c185f">More...</a><br /></td></tr>
<tr class="separator:a747be9a6b854b5c47e2e7eaf806c185f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99e37f2ab61f0473a26725979c94998d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a99e37f2ab61f0473a26725979c94998d">setPosMomErr</a> (<a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, const TVector3 &amp;pos, const TVector3 &amp;mom, const TVector3 &amp;posErr, const TVector3 &amp;momErr) const</td></tr>
<tr class="memdesc:a99e37f2ab61f0473a26725979c94998d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set position and momentum and error of state.  <a href="classgenfit_1_1RKTrackRep.html#a99e37f2ab61f0473a26725979c94998d">More...</a><br /></td></tr>
<tr class="separator:a99e37f2ab61f0473a26725979c94998d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b5455a69aae5687a9743c9f2f5d946c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a8b5455a69aae5687a9743c9f2f5d946c">setPosMomCov</a> (<a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, const TVector3 &amp;pos, const TVector3 &amp;mom, const TMatrixDSym &amp;cov6x6) const</td></tr>
<tr class="memdesc:a8b5455a69aae5687a9743c9f2f5d946c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set position, momentum and covariance of state.  <a href="classgenfit_1_1RKTrackRep.html#a8b5455a69aae5687a9743c9f2f5d946c">More...</a><br /></td></tr>
<tr class="separator:a8b5455a69aae5687a9743c9f2f5d946c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a248147a042b603431d22bd285ee14adc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a248147a042b603431d22bd285ee14adc">setPosMomCov</a> (<a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, const TVectorD &amp;state6, const TMatrixDSym &amp;cov6x6) const</td></tr>
<tr class="memdesc:a248147a042b603431d22bd285ee14adc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set position, momentum and covariance of state.  <a href="classgenfit_1_1RKTrackRep.html#a248147a042b603431d22bd285ee14adc">More...</a><br /></td></tr>
<tr class="separator:a248147a042b603431d22bd285ee14adc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9adae2d78ae5e04ca2a2039ce981bc8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ac9adae2d78ae5e04ca2a2039ce981bc8">setChargeSign</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, double charge) const</td></tr>
<tr class="memdesc:ac9adae2d78ae5e04ca2a2039ce981bc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the sign of the charge according to charge.  <a href="classgenfit_1_1RKTrackRep.html#ac9adae2d78ae5e04ca2a2039ce981bc8">More...</a><br /></td></tr>
<tr class="separator:ac9adae2d78ae5e04ca2a2039ce981bc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eb48cd7c3e1c5d954563cea4d37576d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a1eb48cd7c3e1c5d954563cea4d37576d">setQop</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, double qop) const</td></tr>
<tr class="memdesc:a1eb48cd7c3e1c5d954563cea4d37576d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set charge/momentum.  <a href="classgenfit_1_1RKTrackRep.html#a1eb48cd7c3e1c5d954563cea4d37576d">More...</a><br /></td></tr>
<tr class="separator:a1eb48cd7c3e1c5d954563cea4d37576d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a324ba092d634f324285f445b4bba12b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a324ba092d634f324285f445b4bba12b6">setSpu</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, double spu) const</td></tr>
<tr class="separator:a324ba092d634f324285f445b4bba12b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affa6945eaba3b0f2b143d039967b834e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#affa6945eaba3b0f2b143d039967b834e">RKPropagate</a> (<a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7, <a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> *jacobian, <a class="el" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> &amp;SA, double S, bool varField=true, bool calcOnlyLastRowOfJ=false) const</td></tr>
<tr class="memdesc:affa6945eaba3b0f2b143d039967b834e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The actual Runge Kutta propagation.  <a href="classgenfit_1_1RKTrackRep.html#affa6945eaba3b0f2b143d039967b834e">More...</a><br /></td></tr>
<tr class="separator:affa6945eaba3b0f2b143d039967b834e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48d03ccf2fe92bda3fc13ef7878e58a1"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a48d03ccf2fe92bda3fc13ef7878e58a1">isSameType</a> (const <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> *other)</td></tr>
<tr class="memdesc:a48d03ccf2fe92bda3fc13ef7878e58a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if other is of same type (e.g. <a class="el" href="classgenfit_1_1RKTrackRep.html" title="AbsTrackRep with 5D track parameterization in plane coordinates: (q/p, u&#39;, v&#39;, u, v)">RKTrackRep</a>).  <a href="classgenfit_1_1RKTrackRep.html#a48d03ccf2fe92bda3fc13ef7878e58a1">More...</a><br /></td></tr>
<tr class="separator:a48d03ccf2fe92bda3fc13ef7878e58a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc17228d76c6656b308bbcf4e4ee8a7d"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#acc17228d76c6656b308bbcf4e4ee8a7d">isSame</a> (const <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> *other)</td></tr>
<tr class="memdesc:acc17228d76c6656b308bbcf4e4ee8a7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if other is of same type (e.g. <a class="el" href="classgenfit_1_1RKTrackRep.html" title="AbsTrackRep with 5D track parameterization in plane coordinates: (q/p, u&#39;, v&#39;, u, v)">RKTrackRep</a>) and has same pdg code.  <a href="classgenfit_1_1RKTrackRep.html#acc17228d76c6656b308bbcf4e4ee8a7d">More...</a><br /></td></tr>
<tr class="separator:acc17228d76c6656b308bbcf4e4ee8a7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6808fa51fe2bd047e0d8742ea921b851"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a6808fa51fe2bd047e0d8742ea921b851">extrapolateToLine</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;linePoint, const TVector3 &amp;lineDirection, bool stopAtBoundary=false, bool calcJacobianNoise=false) const=0</td></tr>
<tr class="memdesc:a6808fa51fe2bd047e0d8742ea921b851"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to the POCA to a line, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#a6808fa51fe2bd047e0d8742ea921b851">More...</a><br /></td></tr>
<tr class="separator:a6808fa51fe2bd047e0d8742ea921b851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abccad41ccef10c491ed0bcacd2dcb022"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#abccad41ccef10c491ed0bcacd2dcb022">extrapolateToLine</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;point1, const TVector3 &amp;point2, TVector3 &amp;poca, TVector3 &amp;dirInPoca, TVector3 &amp;poca_onwire, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:abccad41ccef10c491ed0bcacd2dcb022"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resembles the interface of GFAbsTrackRep in old versions of genfit.  <a href="classgenfit_1_1RKTrackRep.html#abccad41ccef10c491ed0bcacd2dcb022">More...</a><br /></td></tr>
<tr class="separator:abccad41ccef10c491ed0bcacd2dcb022"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6808fa51fe2bd047e0d8742ea921b851"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a6808fa51fe2bd047e0d8742ea921b851">extrapolateToLine</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;linePoint, const TVector3 &amp;lineDirection, bool stopAtBoundary=false, bool calcJacobianNoise=false) const=0</td></tr>
<tr class="memdesc:a6808fa51fe2bd047e0d8742ea921b851"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrapolates the state to the POCA to a line, and returns the extrapolation length and, via reference, the extrapolated state.  <a href="classgenfit_1_1RKTrackRep.html#a6808fa51fe2bd047e0d8742ea921b851">More...</a><br /></td></tr>
<tr class="separator:a6808fa51fe2bd047e0d8742ea921b851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abccad41ccef10c491ed0bcacd2dcb022"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#abccad41ccef10c491ed0bcacd2dcb022">extrapolateToLine</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;point1, const TVector3 &amp;point2, TVector3 &amp;poca, TVector3 &amp;dirInPoca, TVector3 &amp;poca_onwire, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:abccad41ccef10c491ed0bcacd2dcb022"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resembles the interface of GFAbsTrackRep in old versions of genfit.  <a href="classgenfit_1_1RKTrackRep.html#abccad41ccef10c491ed0bcacd2dcb022">More...</a><br /></td></tr>
<tr class="separator:abccad41ccef10c491ed0bcacd2dcb022"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classgenfit_1_1AbsTrackRep"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classgenfit_1_1AbsTrackRep')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classgenfit_1_1AbsTrackRep.html">genfit::AbsTrackRep</a></td></tr>
<tr class="memitem:af96ccfed2ddd3cc344503e1b1bd4d17f inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#af96ccfed2ddd3cc344503e1b1bd4d17f">AbsTrackRep</a> ()</td></tr>
<tr class="separator:af96ccfed2ddd3cc344503e1b1bd4d17f inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b04f7361b67d3684947852cc908e9d7 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a7b04f7361b67d3684947852cc908e9d7">AbsTrackRep</a> (int pdgCode, char propDir=0)</td></tr>
<tr class="separator:a7b04f7361b67d3684947852cc908e9d7 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7016ea7bd596eb271cf7adb18ba0ac43 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a7016ea7bd596eb271cf7adb18ba0ac43">~AbsTrackRep</a> ()</td></tr>
<tr class="separator:a7016ea7bd596eb271cf7adb18ba0ac43 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abccad41ccef10c491ed0bcacd2dcb022 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#abccad41ccef10c491ed0bcacd2dcb022">extrapolateToLine</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;point1, const TVector3 &amp;point2, TVector3 &amp;poca, TVector3 &amp;dirInPoca, TVector3 &amp;poca_onwire, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:abccad41ccef10c491ed0bcacd2dcb022 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resembles the interface of GFAbsTrackRep in old versions of genfit.  <a href="classgenfit_1_1AbsTrackRep.html#abccad41ccef10c491ed0bcacd2dcb022">More...</a><br /></td></tr>
<tr class="separator:abccad41ccef10c491ed0bcacd2dcb022 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22347e986819863a90edca9a843f2929 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a22347e986819863a90edca9a843f2929">extrapolateToMeasurement</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const <a class="el" href="classgenfit_1_1AbsMeasurement.html">AbsMeasurement</a> *measurement, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="memdesc:a22347e986819863a90edca9a843f2929 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">extrapolate to an <a class="el" href="classgenfit_1_1AbsMeasurement.html" title="Contains the measurement and covariance in raw detector coordinates.">AbsMeasurement</a>  <a href="classgenfit_1_1AbsTrackRep.html#a22347e986819863a90edca9a843f2929">More...</a><br /></td></tr>
<tr class="separator:a22347e986819863a90edca9a843f2929 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3338706c6ecb501c79b874f0a69bb6c5 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">TVector3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a3338706c6ecb501c79b874f0a69bb6c5">getDir</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:a3338706c6ecb501c79b874f0a69bb6c5 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the direction vector of a state.  <a href="classgenfit_1_1AbsTrackRep.html#a3338706c6ecb501c79b874f0a69bb6c5">More...</a><br /></td></tr>
<tr class="separator:a3338706c6ecb501c79b874f0a69bb6c5 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35be75979af239d64a580034c51ae39d inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a35be75979af239d64a580034c51ae39d">getPosDir</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, TVector3 &amp;pos, TVector3 &amp;dir) const</td></tr>
<tr class="memdesc:a35be75979af239d64a580034c51ae39d inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get cartesian position and direction vector of a state.  <a href="classgenfit_1_1AbsTrackRep.html#a35be75979af239d64a580034c51ae39d">More...</a><br /></td></tr>
<tr class="separator:a35be75979af239d64a580034c51ae39d inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab46a119bcae7e465ad1ef10f4740952e inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">virtual TVectorD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#ab46a119bcae7e465ad1ef10f4740952e">get6DState</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:ab46a119bcae7e465ad1ef10f4740952e inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the 6D state vector (x, y, z, p_x, p_y, p_z).  <a href="classgenfit_1_1AbsTrackRep.html#ab46a119bcae7e465ad1ef10f4740952e">More...</a><br /></td></tr>
<tr class="separator:ab46a119bcae7e465ad1ef10f4740952e inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfb2ebef9afa7e7ca65a3af7381ba156 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#abfb2ebef9afa7e7ca65a3af7381ba156">get6DStateCov</a> (const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, TVectorD &amp;stateVec, TMatrixDSym &amp;cov) const</td></tr>
<tr class="memdesc:abfb2ebef9afa7e7ca65a3af7381ba156 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translates <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html" title="StateOnPlane with additional covariance matrix.">MeasuredStateOnPlane</a> into 6D state vector (x, y, z, p_x, p_y, p_z) and 6x6 covariance.  <a href="classgenfit_1_1AbsTrackRep.html#abfb2ebef9afa7e7ca65a3af7381ba156">More...</a><br /></td></tr>
<tr class="separator:abfb2ebef9afa7e7ca65a3af7381ba156 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a718e040ec8f22ef738af7c9005355443 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a718e040ec8f22ef738af7c9005355443">getPDG</a> () const</td></tr>
<tr class="memdesc:a718e040ec8f22ef738af7c9005355443 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the pdg code.  <a href="classgenfit_1_1AbsTrackRep.html#a718e040ec8f22ef738af7c9005355443">More...</a><br /></td></tr>
<tr class="separator:a718e040ec8f22ef738af7c9005355443 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf70894cebf437f09c284953d7e60734 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#aaf70894cebf437f09c284953d7e60734">getPDGCharge</a> () const</td></tr>
<tr class="memdesc:aaf70894cebf437f09c284953d7e60734 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the charge of the particle of the pdg code.  <a href="classgenfit_1_1AbsTrackRep.html#aaf70894cebf437f09c284953d7e60734">More...</a><br /></td></tr>
<tr class="separator:aaf70894cebf437f09c284953d7e60734 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f0073f2446a780e27886ab512e7787f inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a7f0073f2446a780e27886ab512e7787f">getMass</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state) const</td></tr>
<tr class="memdesc:a7f0073f2446a780e27886ab512e7787f inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get tha particle mass in GeV/c^2.  <a href="classgenfit_1_1AbsTrackRep.html#a7f0073f2446a780e27886ab512e7787f">More...</a><br /></td></tr>
<tr class="separator:a7f0073f2446a780e27886ab512e7787f inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a620617c8eecd6cf2aaa3ae40231a8979 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a620617c8eecd6cf2aaa3ae40231a8979">getPropDir</a> () const</td></tr>
<tr class="memdesc:a620617c8eecd6cf2aaa3ae40231a8979 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get propagation direction. (-1, 0, 1) -&gt; (backward, auto, forward).  <a href="classgenfit_1_1AbsTrackRep.html#a620617c8eecd6cf2aaa3ae40231a8979">More...</a><br /></td></tr>
<tr class="separator:a620617c8eecd6cf2aaa3ae40231a8979 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50abfd7a67b5b1347780a216cbee5423 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a50abfd7a67b5b1347780a216cbee5423">calcJacobianNumerically</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">genfit::StateOnPlane</a> &amp;origState, const <a class="el" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">genfit::SharedPlanePtr</a> destPlane, TMatrixD &amp;jacobian) const</td></tr>
<tr class="memdesc:a50abfd7a67b5b1347780a216cbee5423 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Jacobian of transportation numerically. Slow but accurate. Can be used to validate (semi)analytic calculations.  <a href="classgenfit_1_1AbsTrackRep.html#a50abfd7a67b5b1347780a216cbee5423">More...</a><br /></td></tr>
<tr class="separator:a50abfd7a67b5b1347780a216cbee5423 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a754b00fa09fe85760439462bc22bca84 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a754b00fa09fe85760439462bc22bca84">switchPDGSign</a> ()</td></tr>
<tr class="memdesc:a754b00fa09fe85760439462bc22bca84 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">try to multiply pdg code with -1. (Switch from particle to anti-particle and vice versa).  <a href="classgenfit_1_1AbsTrackRep.html#a754b00fa09fe85760439462bc22bca84">More...</a><br /></td></tr>
<tr class="separator:a754b00fa09fe85760439462bc22bca84 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ab24657168d34266cf73301cfd66794 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a6ab24657168d34266cf73301cfd66794">setPropDir</a> (int dir)</td></tr>
<tr class="memdesc:a6ab24657168d34266cf73301cfd66794 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set propagation direction. (-1, 0, 1) -&gt; (backward, auto, forward).  <a href="classgenfit_1_1AbsTrackRep.html#a6ab24657168d34266cf73301cfd66794">More...</a><br /></td></tr>
<tr class="separator:a6ab24657168d34266cf73301cfd66794 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd12dbf3680a5cfe682121b78480e8a0 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#abd12dbf3680a5cfe682121b78480e8a0">switchPropDir</a> ()</td></tr>
<tr class="memdesc:abd12dbf3680a5cfe682121b78480e8a0 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch propagation direction. Has no effect if propDir_ is set to 0.  <a href="classgenfit_1_1AbsTrackRep.html#abd12dbf3680a5cfe682121b78480e8a0">More...</a><br /></td></tr>
<tr class="separator:abd12dbf3680a5cfe682121b78480e8a0 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33124135a41a0b240742e5490220e40c inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a33124135a41a0b240742e5490220e40c">setDebugLvl</a> (unsigned int lvl=1)</td></tr>
<tr class="separator:a33124135a41a0b240742e5490220e40c inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa402977b82ac150f66e831e60cd48b86 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#aa402977b82ac150f66e831e60cd48b86">Print</a> (const Option_t *=&quot;&quot;) const</td></tr>
<tr class="separator:aa402977b82ac150f66e831e60cd48b86 inherit pub_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a03a4f035cc4162ea33556eb6da224150"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a03a4f035cc4162ea33556eb6da224150">initArrays</a> () const</td></tr>
<tr class="separator:a03a4f035cc4162ea33556eb6da224150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71dffb5437351d65394a778a5cc0b5df"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a71dffb5437351d65394a778a5cc0b5df">extrapToPoint</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;point, const TMatrixDSym *G=NULL, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="separator:a71dffb5437351d65394a778a5cc0b5df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64a99eb10c8052a950ad68376257e7dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7) const</td></tr>
<tr class="separator:a64a99eb10c8052a950ad68376257e7dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaa7f24fb07657e16fc24eb4340e79ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7) const</td></tr>
<tr class="separator:abaa7f24fb07657e16fc24eb4340e79ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59bd63aa9aa5caabd044129afe399e56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a59bd63aa9aa5caabd044129afe399e56">transformPM7</a> (const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, <a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> &amp;out7x7) const</td></tr>
<tr class="separator:a59bd63aa9aa5caabd044129afe399e56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab58d20f1b58e78d1952245a23e695553"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ab58d20f1b58e78d1952245a23e695553">calcJ_pM_5x7</a> (<a class="el" href="namespacegenfit.html#a13cb802e03b7ad640485ba2bf9fe12f7">M5x7</a> &amp;J_pM, const TVector3 &amp;U, const TVector3 &amp;V, const <a class="el" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> &amp;pTilde, double spu) const</td></tr>
<tr class="separator:ab58d20f1b58e78d1952245a23e695553"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f08fa06a70fdb7d6c5fe8b63bbe7c81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a8f08fa06a70fdb7d6c5fe8b63bbe7c81">transformPM6</a> (const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, <a class="el" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a> &amp;out6x6) const</td></tr>
<tr class="separator:a8f08fa06a70fdb7d6c5fe8b63bbe7c81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c3fa23cdc88dcc7708ddb4d64850d87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a6c3fa23cdc88dcc7708ddb4d64850d87">transformM7P</a> (const <a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> &amp;in7x7, const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7, <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state) const</td></tr>
<tr class="separator:a6c3fa23cdc88dcc7708ddb4d64850d87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14b3e8a65ae607330fcd65315ace0cba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a14b3e8a65ae607330fcd65315ace0cba">calcJ_Mp_7x5</a> (<a class="el" href="namespacegenfit.html#a3a66aa71e3109808ef8783809552139d">M7x5</a> &amp;J_Mp, const TVector3 &amp;U, const TVector3 &amp;V, const TVector3 &amp;W, const <a class="el" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> &amp;A) const</td></tr>
<tr class="separator:a14b3e8a65ae607330fcd65315ace0cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a421ac85c5f1c7b5ef3216943dbf7fc15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a421ac85c5f1c7b5ef3216943dbf7fc15">calcForwardJacobianAndNoise</a> (const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;startState7, const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;startPlane, const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;destState7, const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;destPlane) const</td></tr>
<tr class="separator:a421ac85c5f1c7b5ef3216943dbf7fc15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5b17345256ef11df15d571f9237f431"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ae5b17345256ef11df15d571f9237f431">transformM6P</a> (const <a class="el" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a> &amp;in6x6, const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7, <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state) const</td></tr>
<tr class="separator:ae5b17345256ef11df15d571f9237f431"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5235db4672bcedc6c78d69470b1cb289"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a5235db4672bcedc6c78d69470b1cb289">RKutta</a> (const <a class="el" href="namespacegenfit.html#a2f0d1d795f44c877a78277c7107a4eea">M1x4</a> &amp;SU, const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;plane, double charge, <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7, <a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> *jacobianT, double &amp;coveredDistance, bool &amp;checkJacProj, <a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> &amp;noiseProjection, <a class="el" href="classgenfit_1_1StepLimits.html">StepLimits</a> &amp;limits, bool onlyOneStep=false, bool calcOnlyLastRowOfJ=false) const</td></tr>
<tr class="memdesc:a5235db4672bcedc6c78d69470b1cb289"><td class="mdescLeft">&#160;</td><td class="mdescRight">Propagates the particle through the magnetic field.  <a href="classgenfit_1_1RKTrackRep.html#a5235db4672bcedc6c78d69470b1cb289">More...</a><br /></td></tr>
<tr class="separator:a5235db4672bcedc6c78d69470b1cb289"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a281fc9087c22ee0ed63e22330fecad9d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a281fc9087c22ee0ed63e22330fecad9d">estimateStep</a> (const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7, const <a class="el" href="namespacegenfit.html#a2f0d1d795f44c877a78277c7107a4eea">M1x4</a> &amp;SU, const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;plane, const double &amp;charge, double &amp;relMomLoss, <a class="el" href="classgenfit_1_1StepLimits.html">StepLimits</a> &amp;limits) const</td></tr>
<tr class="separator:a281fc9087c22ee0ed63e22330fecad9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd6b3f8bd742ea90f3d890ff01452c3"><td class="memItemLeft" align="right" valign="top">TVector3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#adcd6b3f8bd742ea90f3d890ff01452c3">pocaOnLine</a> (const TVector3 &amp;linePoint, const TVector3 &amp;lineDirection, const TVector3 &amp;point) const</td></tr>
<tr class="separator:adcd6b3f8bd742ea90f3d890ff01452c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fa173bb3b0080274c05f9fcf399768d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d">Extrap</a> (const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;startPlane, const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;destPlane, double charge, bool &amp;isAtBoundary, <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7, bool fillExtrapSteps, TMatrixDSym *cov=nullptr, bool onlyOneStep=false, bool stopAtBoundary=false, double maxStep=1.E99) const</td></tr>
<tr class="memdesc:a4fa173bb3b0080274c05f9fcf399768d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles propagation and material effects.  <a href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d">More...</a><br /></td></tr>
<tr class="separator:a4fa173bb3b0080274c05f9fcf399768d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93996a7134dfba3449c78bf882de8720"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a93996a7134dfba3449c78bf882de8720">checkCache</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const <a class="el" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> *plane) const</td></tr>
<tr class="separator:a93996a7134dfba3449c78bf882de8720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56e2cafc817e0e489e7a183c9bc8d549"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a56e2cafc817e0e489e7a183c9bc8d549">momMag</a> (const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7) const</td></tr>
<tr class="separator:a56e2cafc817e0e489e7a183c9bc8d549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03a4f035cc4162ea33556eb6da224150"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a03a4f035cc4162ea33556eb6da224150">initArrays</a> () const</td></tr>
<tr class="separator:a03a4f035cc4162ea33556eb6da224150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9a2cee136be1b13d26531ff2b1dbc23"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#af9a2cee136be1b13d26531ff2b1dbc23">extrapToPoint</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const TVector3 &amp;point, const TMatrixDSym *G=NULL, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</td></tr>
<tr class="separator:af9a2cee136be1b13d26531ff2b1dbc23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64a99eb10c8052a950ad68376257e7dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7) const</td></tr>
<tr class="separator:a64a99eb10c8052a950ad68376257e7dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaa7f24fb07657e16fc24eb4340e79ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a> (<a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7) const</td></tr>
<tr class="separator:abaa7f24fb07657e16fc24eb4340e79ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59bd63aa9aa5caabd044129afe399e56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a59bd63aa9aa5caabd044129afe399e56">transformPM7</a> (const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, <a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> &amp;out7x7) const</td></tr>
<tr class="separator:a59bd63aa9aa5caabd044129afe399e56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab58d20f1b58e78d1952245a23e695553"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ab58d20f1b58e78d1952245a23e695553">calcJ_pM_5x7</a> (<a class="el" href="namespacegenfit.html#a13cb802e03b7ad640485ba2bf9fe12f7">M5x7</a> &amp;J_pM, const TVector3 &amp;U, const TVector3 &amp;V, const <a class="el" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> &amp;pTilde, double spu) const</td></tr>
<tr class="separator:ab58d20f1b58e78d1952245a23e695553"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f08fa06a70fdb7d6c5fe8b63bbe7c81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a8f08fa06a70fdb7d6c5fe8b63bbe7c81">transformPM6</a> (const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state, <a class="el" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a> &amp;out6x6) const</td></tr>
<tr class="separator:a8f08fa06a70fdb7d6c5fe8b63bbe7c81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c3fa23cdc88dcc7708ddb4d64850d87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a6c3fa23cdc88dcc7708ddb4d64850d87">transformM7P</a> (const <a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> &amp;in7x7, const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7, <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state) const</td></tr>
<tr class="separator:a6c3fa23cdc88dcc7708ddb4d64850d87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14b3e8a65ae607330fcd65315ace0cba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a14b3e8a65ae607330fcd65315ace0cba">calcJ_Mp_7x5</a> (<a class="el" href="namespacegenfit.html#a3a66aa71e3109808ef8783809552139d">M7x5</a> &amp;J_Mp, const TVector3 &amp;U, const TVector3 &amp;V, const TVector3 &amp;W, const <a class="el" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> &amp;A) const</td></tr>
<tr class="separator:a14b3e8a65ae607330fcd65315ace0cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a421ac85c5f1c7b5ef3216943dbf7fc15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a421ac85c5f1c7b5ef3216943dbf7fc15">calcForwardJacobianAndNoise</a> (const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;startState7, const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;startPlane, const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;destState7, const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;destPlane) const</td></tr>
<tr class="separator:a421ac85c5f1c7b5ef3216943dbf7fc15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5b17345256ef11df15d571f9237f431"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ae5b17345256ef11df15d571f9237f431">transformM6P</a> (const <a class="el" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a> &amp;in6x6, const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7, <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;state) const</td></tr>
<tr class="separator:ae5b17345256ef11df15d571f9237f431"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5235db4672bcedc6c78d69470b1cb289"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a5235db4672bcedc6c78d69470b1cb289">RKutta</a> (const <a class="el" href="namespacegenfit.html#a2f0d1d795f44c877a78277c7107a4eea">M1x4</a> &amp;SU, const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;plane, double charge, <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7, <a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> *jacobianT, double &amp;coveredDistance, bool &amp;checkJacProj, <a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> &amp;noiseProjection, <a class="el" href="classgenfit_1_1StepLimits.html">StepLimits</a> &amp;limits, bool onlyOneStep=false, bool calcOnlyLastRowOfJ=false) const</td></tr>
<tr class="memdesc:a5235db4672bcedc6c78d69470b1cb289"><td class="mdescLeft">&#160;</td><td class="mdescRight">Propagates the particle through the magnetic field.  <a href="classgenfit_1_1RKTrackRep.html#a5235db4672bcedc6c78d69470b1cb289">More...</a><br /></td></tr>
<tr class="separator:a5235db4672bcedc6c78d69470b1cb289"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a281fc9087c22ee0ed63e22330fecad9d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a281fc9087c22ee0ed63e22330fecad9d">estimateStep</a> (const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7, const <a class="el" href="namespacegenfit.html#a2f0d1d795f44c877a78277c7107a4eea">M1x4</a> &amp;SU, const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;plane, const double &amp;charge, double &amp;relMomLoss, <a class="el" href="classgenfit_1_1StepLimits.html">StepLimits</a> &amp;limits) const</td></tr>
<tr class="separator:a281fc9087c22ee0ed63e22330fecad9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd6b3f8bd742ea90f3d890ff01452c3"><td class="memItemLeft" align="right" valign="top">TVector3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#adcd6b3f8bd742ea90f3d890ff01452c3">pocaOnLine</a> (const TVector3 &amp;linePoint, const TVector3 &amp;lineDirection, const TVector3 &amp;point) const</td></tr>
<tr class="separator:adcd6b3f8bd742ea90f3d890ff01452c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fa173bb3b0080274c05f9fcf399768d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d">Extrap</a> (const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;startPlane, const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;destPlane, double charge, bool &amp;isAtBoundary, <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7, bool fillExtrapSteps, TMatrixDSym *cov=nullptr, bool onlyOneStep=false, bool stopAtBoundary=false, double maxStep=1.E99) const</td></tr>
<tr class="memdesc:a4fa173bb3b0080274c05f9fcf399768d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles propagation and material effects.  <a href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d">More...</a><br /></td></tr>
<tr class="separator:a4fa173bb3b0080274c05f9fcf399768d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93996a7134dfba3449c78bf882de8720"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a93996a7134dfba3449c78bf882de8720">checkCache</a> (const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;state, const <a class="el" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> *plane) const</td></tr>
<tr class="separator:a93996a7134dfba3449c78bf882de8720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56e2cafc817e0e489e7a183c9bc8d549"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a56e2cafc817e0e489e7a183c9bc8d549">momMag</a> (const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;state7) const</td></tr>
<tr class="separator:a56e2cafc817e0e489e7a183c9bc8d549"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a9e71e74a9542d888e804a02998d25bce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a></td></tr>
<tr class="separator:a9e71e74a9542d888e804a02998d25bce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae76d29daa0524d65ed201eccf69c04f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a></td></tr>
<tr class="memdesc:ae76d29daa0524d65ed201eccf69c04f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">state where the last extrapolation has started  <a href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">More...</a><br /></td></tr>
<tr class="separator:ae76d29daa0524d65ed201eccf69c04f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0825cd5635ffb49e5879ada5b9f86149"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structgenfit_1_1RKStep.html">RKStep</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a></td></tr>
<tr class="memdesc:a0825cd5635ffb49e5879ada5b9f86149"><td class="mdescLeft">&#160;</td><td class="mdescRight">state where the last extrapolation has ended  <a href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">More...</a><br /></td></tr>
<tr class="separator:a0825cd5635ffb49e5879ada5b9f86149"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27fe628afd6be77f1f9de8a5a10d3b0a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a27fe628afd6be77f1f9de8a5a10d3b0a">RKStepsFXStart_</a></td></tr>
<tr class="memdesc:a27fe628afd6be77f1f9de8a5a10d3b0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">RungeKutta steps made in the last extrapolation.  <a href="classgenfit_1_1RKTrackRep.html#a27fe628afd6be77f1f9de8a5a10d3b0a">More...</a><br /></td></tr>
<tr class="separator:a27fe628afd6be77f1f9de8a5a10d3b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac04989ccf60fdba61d369aa462cdf40b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ac04989ccf60fdba61d369aa462cdf40b">RKStepsFXStop_</a></td></tr>
<tr class="separator:ac04989ccf60fdba61d369aa462cdf40b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a155aa1470ea4d57da938fe4cb484b9ce"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structgenfit_1_1ExtrapStep.html">ExtrapStep</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a></td></tr>
<tr class="separator:a155aa1470ea4d57da938fe4cb484b9ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafac71f71cc93a82aa42281d600b4776"><td class="memItemLeft" align="right" valign="top">TMatrixD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#aafac71f71cc93a82aa42281d600b4776">fJacobian_</a></td></tr>
<tr class="memdesc:aafac71f71cc93a82aa42281d600b4776"><td class="mdescLeft">&#160;</td><td class="mdescRight">steps made in Extrap during last extrapolation  <a href="classgenfit_1_1RKTrackRep.html#aafac71f71cc93a82aa42281d600b4776">More...</a><br /></td></tr>
<tr class="separator:aafac71f71cc93a82aa42281d600b4776"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae498a8cb248b5aa8dffb2555b6ca1925"><td class="memItemLeft" align="right" valign="top">TMatrixDSym&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ae498a8cb248b5aa8dffb2555b6ca1925">fNoise_</a></td></tr>
<tr class="separator:ae498a8cb248b5aa8dffb2555b6ca1925"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad299432e86e08c7f4413dccb2cd18794"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ad299432e86e08c7f4413dccb2cd18794">useCache_</a></td></tr>
<tr class="separator:ad299432e86e08c7f4413dccb2cd18794"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab145870eeeffa63af990fea3b93cf791"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">cachePos_</a></td></tr>
<tr class="memdesc:ab145870eeeffa63af990fea3b93cf791"><td class="mdescLeft">&#160;</td><td class="mdescRight">use cached RKSteps_ for extrapolation  <a href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">More...</a><br /></td></tr>
<tr class="separator:ab145870eeeffa63af990fea3b93cf791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d72d0cf8fed127c8599c11283374288"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classgenfit_1_1StepLimits.html">StepLimits</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a0d72d0cf8fed127c8599c11283374288">limits_</a></td></tr>
<tr class="separator:a0d72d0cf8fed127c8599c11283374288"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a889ad368e5c5c6ac870402c9420b2bb8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a889ad368e5c5c6ac870402c9420b2bb8">noiseArray_</a></td></tr>
<tr class="separator:a889ad368e5c5c6ac870402c9420b2bb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a210279ccff463e20ea47b345a288f1d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a210279ccff463e20ea47b345a288f1d0">noiseProjection_</a></td></tr>
<tr class="memdesc:a210279ccff463e20ea47b345a288f1d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">noise matrix of the last extrapolation  <a href="classgenfit_1_1RKTrackRep.html#a210279ccff463e20ea47b345a288f1d0">More...</a><br /></td></tr>
<tr class="separator:a210279ccff463e20ea47b345a288f1d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41dcd53004ff44e12a924084b37cad8c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1RKTrackRep.html#a41dcd53004ff44e12a924084b37cad8c">J_MMT_</a></td></tr>
<tr class="separator:a41dcd53004ff44e12a924084b37cad8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classgenfit_1_1AbsTrackRep"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classgenfit_1_1AbsTrackRep')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classgenfit_1_1AbsTrackRep.html">genfit::AbsTrackRep</a></td></tr>
<tr class="memitem:a67e8c7fe5ba51f1a563676b51a192c94 inherit pro_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a67e8c7fe5ba51f1a563676b51a192c94">AbsTrackRep</a> (const <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> &amp;)</td></tr>
<tr class="memdesc:a67e8c7fe5ba51f1a563676b51a192c94 inherit pro_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">protect from calling copy c'tor from outside the class. Use <a class="el" href="classgenfit_1_1AbsTrackRep.html#a167993908a742633c6216cf811ea3ea2" title="Clone the trackRep.">clone()</a> if you want a copy!  <a href="classgenfit_1_1AbsTrackRep.html#a67e8c7fe5ba51f1a563676b51a192c94">More...</a><br /></td></tr>
<tr class="separator:a67e8c7fe5ba51f1a563676b51a192c94 inherit pro_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a061a0373454c317844762ce9d16184c4 inherit pro_methods_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a061a0373454c317844762ce9d16184c4">operator=</a> (const <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> &amp;)</td></tr>
<tr class="memdesc:a061a0373454c317844762ce9d16184c4 inherit pro_methods_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">protect from calling assignment operator from outside the class. Use <a class="el" href="classgenfit_1_1AbsTrackRep.html#a167993908a742633c6216cf811ea3ea2" title="Clone the trackRep.">clone()</a> instead!  <a href="classgenfit_1_1AbsTrackRep.html#a061a0373454c317844762ce9d16184c4">More...</a><br /></td></tr>
<tr class="separator:a061a0373454c317844762ce9d16184c4 inherit pro_methods_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classgenfit_1_1AbsTrackRep"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classgenfit_1_1AbsTrackRep')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classgenfit_1_1AbsTrackRep.html">genfit::AbsTrackRep</a></td></tr>
<tr class="memitem:a29cc69d36b01cab1d0c6fc8a9529fac4 inherit pro_attribs_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#a29cc69d36b01cab1d0c6fc8a9529fac4">pdgCode_</a></td></tr>
<tr class="memdesc:a29cc69d36b01cab1d0c6fc8a9529fac4 inherit pro_attribs_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">Particle code.  <a href="classgenfit_1_1AbsTrackRep.html#a29cc69d36b01cab1d0c6fc8a9529fac4">More...</a><br /></td></tr>
<tr class="separator:a29cc69d36b01cab1d0c6fc8a9529fac4 inherit pro_attribs_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b046499b9651e30c0d4e06243c58b4 inherit pro_attribs_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#af8b046499b9651e30c0d4e06243c58b4">propDir_</a></td></tr>
<tr class="memdesc:af8b046499b9651e30c0d4e06243c58b4 inherit pro_attribs_classgenfit_1_1AbsTrackRep"><td class="mdescLeft">&#160;</td><td class="mdescRight">propagation direction (-1, 0, 1) -&gt; (backward, auto, forward)  <a href="classgenfit_1_1AbsTrackRep.html#af8b046499b9651e30c0d4e06243c58b4">More...</a><br /></td></tr>
<tr class="separator:af8b046499b9651e30c0d4e06243c58b4 inherit pro_attribs_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af69df07f28005ab0da75a81b59b0af7f inherit pro_attribs_classgenfit_1_1AbsTrackRep"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a></td></tr>
<tr class="separator:af69df07f28005ab0da75a81b59b0af7f inherit pro_attribs_classgenfit_1_1AbsTrackRep"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classgenfit_1_1AbsTrackRep.html" title="Abstract base class for a track representation.">AbsTrackRep</a> with 5D track parameterization in plane coordinates: (q/p, u', v', u, v) </p>
<p>q/p is charge over momentum. u' and v' are direction tangents. u and v are positions on a <a class="el" href="classgenfit_1_1DetPlane.html" title="Detector plane.">DetPlane</a>. </p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00070">70</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aca0b07380cd50f63eef644ebda8252ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca0b07380cd50f63eef644ebda8252ce">&#9670;&nbsp;</a></span>RKTrackRep() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">genfit::RKTrackRep::RKTrackRep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00045">45</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                       :</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="classgenfit_1_1AbsTrackRep.html#af96ccfed2ddd3cc344503e1b1bd4d17f">AbsTrackRep</a>(),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>(<span class="keyword">this</span>),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>(<span class="keyword">this</span>),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a27fe628afd6be77f1f9de8a5a10d3b0a">RKStepsFXStart_</a>(0),</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ac04989ccf60fdba61d369aa462cdf40b">RKStepsFXStop_</a>(0),</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#aafac71f71cc93a82aa42281d600b4776">fJacobian_</a>(5,5),</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae498a8cb248b5aa8dffb2555b6ca1925">fNoise_</a>(5),</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ad299432e86e08c7f4413dccb2cd18794">useCache_</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">cachePos_</a>(0)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a03a4f035cc4162ea33556eb6da224150">initArrays</a>();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab266d184647ad23a4b9f1e8f408b6513"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab266d184647ad23a4b9f1e8f408b6513">&#9670;&nbsp;</a></span>RKTrackRep() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">genfit::RKTrackRep::RKTrackRep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdgCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>propDir</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00060">60</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                                :</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="classgenfit_1_1AbsTrackRep.html#af96ccfed2ddd3cc344503e1b1bd4d17f">AbsTrackRep</a>(pdgCode, propDir),</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>(<span class="keyword">this</span>),</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>(<span class="keyword">this</span>),</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a27fe628afd6be77f1f9de8a5a10d3b0a">RKStepsFXStart_</a>(0),</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ac04989ccf60fdba61d369aa462cdf40b">RKStepsFXStop_</a>(0),</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#aafac71f71cc93a82aa42281d600b4776">fJacobian_</a>(5,5),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae498a8cb248b5aa8dffb2555b6ca1925">fNoise_</a>(5),</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ad299432e86e08c7f4413dccb2cd18794">useCache_</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">cachePos_</a>(0)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a03a4f035cc4162ea33556eb6da224150">initArrays</a>();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa59782fc97eb9bf3ab2f1e1ab88a2a19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa59782fc97eb9bf3ab2f1e1ab88a2a19">&#9670;&nbsp;</a></span>~RKTrackRep() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">genfit::RKTrackRep::~RKTrackRep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00075">75</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                        {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  ;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aca0b07380cd50f63eef644ebda8252ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca0b07380cd50f63eef644ebda8252ce">&#9670;&nbsp;</a></span>RKTrackRep() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">genfit::RKTrackRep::RKTrackRep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab266d184647ad23a4b9f1e8f408b6513"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab266d184647ad23a4b9f1e8f408b6513">&#9670;&nbsp;</a></span>RKTrackRep() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">genfit::RKTrackRep::RKTrackRep </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdgCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>propDir</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac1f68e1338fe07ec2df8a9f9cb03aabd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1f68e1338fe07ec2df8a9f9cb03aabd">&#9670;&nbsp;</a></span>~RKTrackRep() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual genfit::RKTrackRep::~RKTrackRep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a421ac85c5f1c7b5ef3216943dbf7fc15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a421ac85c5f1c7b5ef3216943dbf7fc15">&#9670;&nbsp;</a></span>calcForwardJacobianAndNoise() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::calcForwardJacobianAndNoise </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>startState7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>startPlane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>destState7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>destPlane</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00774">774</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                                                                  {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::calcForwardJacobianAndNoise &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>.size() == 0) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::calcForwardJacobianAndNoise ==&gt; cache is empty. Extrapolation must run with a MeasuredStateOnPlane.&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="comment">// The Jacobians returned from RKutta are transposed.</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  TMatrixD jac(TMatrixD::kTransposed, TMatrixD(7, 7, <a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>.back().jac7_));</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  TMatrixDSym noise(7, <a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>.back().noise7_);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> = <a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>.size() - 2; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> &gt;= 0; --<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>) {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    noise += TMatrixDSym(7, <a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>].noise7_).Similarity(jac);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    jac *= TMatrixD(TMatrixD::kTransposed, TMatrixD(7, 7, <a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>].jac7_));</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="comment">// Project into 5x5 space.</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> pTilde = {startState7[3], startState7[4], startState7[5]};</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keyword">const</span> TVector3&amp; normal = startPlane.getNormal();</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordtype">double</span> pTildeW = pTilde[0] * normal.X() + pTilde[1] * normal.Y() + pTilde[2] * normal.Z();</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordtype">double</span> spu = pTildeW &gt; 0 ? 1 : -1;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>=0; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>&lt;3; ++<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    pTilde[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>] *= spu/pTildeW; <span class="comment">// | pTilde * W | has to be 1 (definition of pTilde)</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <a class="code" href="namespacegenfit.html#a13cb802e03b7ad640485ba2bf9fe12f7">M5x7</a> J_pM;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ab58d20f1b58e78d1952245a23e695553">calcJ_pM_5x7</a>(J_pM, startPlane.getU(), startPlane.getV(), pTilde, spu);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <a class="code" href="namespacegenfit.html#a3a66aa71e3109808ef8783809552139d">M7x5</a> J_Mp;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a14b3e8a65ae607330fcd65315ace0cba">calcJ_Mp_7x5</a>(J_Mp, destPlane.getU(), destPlane.getV(), destPlane.getNormal(), *((<a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>*) &amp;destState7[3]));</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  jac.Transpose(jac); <span class="comment">// Because the helper function wants transposed input.</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <a class="code" href="namespacegenfit_1_1RKTools.html#a65fa58888e266d50b8857b6d098377a7">RKTools::J_pMTTxJ_MMTTxJ_MpTT</a>(J_Mp, *(<a class="code" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> *)jac.GetMatrixArray(),</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                J_pM, *(<a class="code" href="namespacegenfit.html#aa59cd0f20b9c72817c90fe0df1472ece">M5x5</a> *)<a class="code" href="classgenfit_1_1RKTrackRep.html#aafac71f71cc93a82aa42281d600b4776">fJacobian_</a>.GetMatrixArray());</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <a class="code" href="namespacegenfit_1_1RKTools.html#ad2530899a8df922d173c17f55ac590b9">RKTools::J_MpTxcov7xJ_Mp</a>(J_Mp, *(<a class="code" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> *)noise.GetMatrixArray(),</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;               *(<a class="code" href="namespacegenfit.html#aa59cd0f20b9c72817c90fe0df1472ece">M5x5</a> *)<a class="code" href="classgenfit_1_1RKTrackRep.html#ae498a8cb248b5aa8dffb2555b6ca1925">fNoise_</a>.GetMatrixArray());</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;total jacobian : &quot;</span>; <a class="code" href="classgenfit_1_1RKTrackRep.html#aafac71f71cc93a82aa42281d600b4776">fJacobian_</a>.Print();</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;total noise : &quot;</span>; <a class="code" href="classgenfit_1_1RKTrackRep.html#ae498a8cb248b5aa8dffb2555b6ca1925">fNoise_</a>.Print();</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a421ac85c5f1c7b5ef3216943dbf7fc15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a421ac85c5f1c7b5ef3216943dbf7fc15">&#9670;&nbsp;</a></span>calcForwardJacobianAndNoise() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::calcForwardJacobianAndNoise </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>startState7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>startPlane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>destState7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>destPlane</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a14b3e8a65ae607330fcd65315ace0cba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14b3e8a65ae607330fcd65315ace0cba">&#9670;&nbsp;</a></span>calcJ_Mp_7x5() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::calcJ_Mp_7x5 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a3a66aa71e3109808ef8783809552139d">M7x5</a> &amp;&#160;</td>
          <td class="paramname"><em>J_Mp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01582">1582</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                                                                                                                      {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <span class="comment">/*if (debugLvl_ &gt; 1) {</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;RKTrackRep::calcJ_Mp_7x5 \n&quot;;</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;  U = &quot;; U.Print();</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;  V = &quot;; V.Print();</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;  W = &quot;; W.Print();</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;  A = &quot;; RKTools::printDim(A, 3,1);</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment">  }*/</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  memset(J_Mp, 0, <span class="keyword">sizeof</span>(<a class="code" href="namespacegenfit.html#a3a66aa71e3109808ef8783809552139d">M7x5</a>));</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; </div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> AtU = <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]*U.X() + <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]*U.Y() + <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]*U.Z();</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> AtV = <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X() + <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y() + <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z();</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> AtW = <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]*W.X() + <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]*W.Y() + <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]*W.Z();</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="comment">// J_Mp matrix is d(q/p,u&#39;,v&#39;,u,v) / d(x,y,z,ax,ay,az,q/p)   (in is 7x7)</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160; </div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <span class="comment">// d(u&#39;)/d(ax,ay,az)</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <span class="keywordtype">double</span> fact = 1./(AtW*AtW);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  J_Mp[16] = fact * (U.X()*AtW - W.X()*AtU); <span class="comment">// [3][1]</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  J_Mp[21] = fact * (U.Y()*AtW - W.Y()*AtU); <span class="comment">// [4][1]</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  J_Mp[26] = fact * (U.Z()*AtW - W.Z()*AtU); <span class="comment">// [5][1]</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <span class="comment">// d(v&#39;)/d(ax,ay,az)</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  J_Mp[17] = fact * (<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X()*AtW - W.X()*AtV); <span class="comment">// [3][2]</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  J_Mp[22] = fact * (<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y()*AtW - W.Y()*AtV); <span class="comment">// [4][2]</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  J_Mp[27] = fact * (<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z()*AtW - W.Z()*AtV); <span class="comment">// [5][2]</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <span class="comment">// d(q/p)/d(q/p)</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  J_Mp[30] = 1.; <span class="comment">// [6][0]  - not needed for array matrix multiplication</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="comment">//d(u)/d(x,y,z)</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  J_Mp[3]  = U.X(); <span class="comment">// [0][3]</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  J_Mp[8]  = U.Y(); <span class="comment">// [1][3]</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  J_Mp[13] = U.Z(); <span class="comment">// [2][3]</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  <span class="comment">//d(v)/d(x,y,z)</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  J_Mp[4]  = <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X(); <span class="comment">// [0][4]</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  J_Mp[9]  = <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y(); <span class="comment">// [1][4]</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  J_Mp[14] = <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z(); <span class="comment">// [2][4]</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160; </div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="comment">/*if (debugLvl_ &gt; 1) {</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;  J_Mp_7x5_ = &quot;; RKTools::printDim(J_Mp, 7,5);</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment">  }*/</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160; </div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a14b3e8a65ae607330fcd65315ace0cba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14b3e8a65ae607330fcd65315ace0cba">&#9670;&nbsp;</a></span>calcJ_Mp_7x5() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::calcJ_Mp_7x5 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a3a66aa71e3109808ef8783809552139d">M7x5</a> &amp;&#160;</td>
          <td class="paramname"><em>J_Mp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab58d20f1b58e78d1952245a23e695553"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab58d20f1b58e78d1952245a23e695553">&#9670;&nbsp;</a></span>calcJ_pM_5x7() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::calcJ_pM_5x7 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a13cb802e03b7ad640485ba2bf9fe12f7">M5x7</a> &amp;&#160;</td>
          <td class="paramname"><em>J_pM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> &amp;&#160;</td>
          <td class="paramname"><em>pTilde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>spu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01452">1452</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                                                                                                                    {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="comment">/*if (debugLvl_ &gt; 1) {</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;RKTrackRep::calcJ_pM_5x7 \n&quot;;</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;  U = &quot;; U.Print();</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;  V = &quot;; V.Print();</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;  pTilde = &quot;; RKTools::printDim(pTilde, 3,1);</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;  spu = &quot; &lt;&lt; spu &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment">  }*/</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  memset(J_pM, 0, <span class="keyword">sizeof</span>(<a class="code" href="namespacegenfit.html#a13cb802e03b7ad640485ba2bf9fe12f7">M5x7</a>));</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160; </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> pTildeMag = sqrt(pTilde[0]*pTilde[0] + pTilde[1]*pTilde[1] + pTilde[2]*pTilde[2]);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> pTildeMag2 = pTildeMag*pTildeMag;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> utpTildeOverpTildeMag2 = (U.X()*pTilde[0] + U.Y()*pTilde[1] + U.Z()*pTilde[2]) / pTildeMag2;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> vtpTildeOverpTildeMag2 = (<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X()*pTilde[0] + <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y()*pTilde[1] + <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z()*pTilde[2]) / pTildeMag2;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="comment">//J_pM matrix is d(x,y,z,ax,ay,az,q/p) / d(q/p,u&#39;,v&#39;,u,v)   (out is 7x7)</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160; </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;   <span class="comment">// d(x,y,z)/d(u)</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  J_pM[21] = U.X(); <span class="comment">// [3][0]</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  J_pM[22] = U.Y(); <span class="comment">// [3][1]</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  J_pM[23] = U.Z(); <span class="comment">// [3][2]</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="comment">// d(x,y,z)/d(v)</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  J_pM[28] = <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X(); <span class="comment">// [4][0]</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  J_pM[29] = <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y(); <span class="comment">// [4][1]</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  J_pM[30] = <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z(); <span class="comment">// [4][2]</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <span class="comment">// d(q/p)/d(q/p)</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  J_pM[6] = 1.; <span class="comment">// not needed for array matrix multiplication</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="comment">// d(ax,ay,az)/d(u&#39;)</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="keywordtype">double</span> fact = spu / pTildeMag;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  J_pM[10] = fact * ( U.X() - pTilde[0]*utpTildeOverpTildeMag2 ); <span class="comment">// [1][3]</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  J_pM[11] = fact * ( U.Y() - pTilde[1]*utpTildeOverpTildeMag2 ); <span class="comment">// [1][4]</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  J_pM[12] = fact * ( U.Z() - pTilde[2]*utpTildeOverpTildeMag2 ); <span class="comment">// [1][5]</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="comment">// d(ax,ay,az)/d(v&#39;)</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  J_pM[17] = fact * ( <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X() - pTilde[0]*vtpTildeOverpTildeMag2 ); <span class="comment">// [2][3]</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  J_pM[18] = fact * ( <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y() - pTilde[1]*vtpTildeOverpTildeMag2 ); <span class="comment">// [2][4]</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  J_pM[19] = fact * ( <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z() - pTilde[2]*vtpTildeOverpTildeMag2 ); <span class="comment">// [2][5]</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <span class="comment">/*if (debugLvl_ &gt; 1) {</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">    std::cout &lt;&lt; &quot;  J_pM_5x7_ = &quot;; RKTools::printDim(J_pM_5x7_, 5,7);</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">  }*/</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab58d20f1b58e78d1952245a23e695553"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab58d20f1b58e78d1952245a23e695553">&#9670;&nbsp;</a></span>calcJ_pM_5x7() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::calcJ_pM_5x7 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a13cb802e03b7ad640485ba2bf9fe12f7">M5x7</a> &amp;&#160;</td>
          <td class="paramname"><em>J_pM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> &amp;&#160;</td>
          <td class="paramname"><em>pTilde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>spu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a93996a7134dfba3449c78bf882de8720"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93996a7134dfba3449c78bf882de8720">&#9670;&nbsp;</a></span>checkCache() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::checkCache </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> *&#160;</td>
          <td class="paramname"><em>plane</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l02412">2412</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                                                                                        {</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160; </div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  <span class="keywordflow">if</span> (state.getRep() != <span class="keyword">this</span>){</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::checkCache ==&gt; state is defined wrt. another TrackRep&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    exc.setFatal();</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  }</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; </div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>MeasurementOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::checkCache - cannot extrapolate MeasurementOnPlane&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    exc.setFatal();</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;  }</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160; </div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">cachePos_</a> = 0;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a27fe628afd6be77f1f9de8a5a10d3b0a">RKStepsFXStart_</a> = 0;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ac04989ccf60fdba61d369aa462cdf40b">RKStepsFXStop_</a> = 0;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>.clear();</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a03a4f035cc4162ea33556eb6da224150">initArrays</a>();</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160; </div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160; </div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;  <span class="keywordflow">if</span> (plane != NULL &amp;&amp;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      <a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a07e3deab7abff59e61fd91786fa335b6">getPlane</a>().get() != NULL &amp;&amp;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a07e3deab7abff59e61fd91786fa335b6">getPlane</a>().get() != NULL &amp;&amp;</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;      state.getPlane() == <a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a07e3deab7abff59e61fd91786fa335b6">getPlane</a>() &amp;&amp;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      state.getState() == <a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a3c89a0efae9b00bd44ee240aa9e6c843">getState</a>() &amp;&amp;</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      (*plane)-&gt;distance(<a class="code" href="classgenfit_1_1RKTrackRep.html#adf4865558fe7b54ffe94c3e145344505">getPos</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>)) &lt;= <a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>) {</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#ad299432e86e08c7f4413dccb2cd18794">useCache_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160; </div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="comment">// clean up cache. Only use steps with same sign.</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    <span class="keywordtype">double</span> firstStep(0);</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>=0; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>&lt;<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.size(); ++<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>) {</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> == 0) {</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;        firstStep = <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(0).matStep_.stepSize_;</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      }</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>).matStep_.stepSize_ * firstStep &lt; 0) {</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>-1).matStep_.materialProperties_ == <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>).matStep_.materialProperties_) {</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;          <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>-1).matStep_.stepSize_ += <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>).matStep_.stepSize_;</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        }</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;        <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.erase(<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.begin()+<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>, <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.end());</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;      }</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    }</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160; </div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::checkCache: use cached material and step values.\n&quot;</span>;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    }</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;  }</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160; </div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::checkCache: can NOT use cached material and step values.\n&quot;</span>;</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160; </div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      <span class="keywordflow">if</span> (plane != NULL) {</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        <span class="keywordflow">if</span> (state.getPlane() != <a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a07e3deab7abff59e61fd91786fa335b6">getPlane</a>()) {</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;state.getPlane() != lastStartState_.getPlane()\n&quot;</span>;</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        }</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;          <span class="keywordflow">if</span> (! (state.getState() == <a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a3c89a0efae9b00bd44ee240aa9e6c843">getState</a>())) {</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;state.getState() != lastStartState_.getState()\n&quot;</span>;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;          }</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a07e3deab7abff59e61fd91786fa335b6">getPlane</a>().get() != NULL) {</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;distance &quot;</span> &lt;&lt; (*plane)-&gt;distance(<a class="code" href="classgenfit_1_1RKTrackRep.html#adf4865558fe7b54ffe94c3e145344505">getPos</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>)) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;          }</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        }</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      }</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    }</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160; </div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#ad299432e86e08c7f4413dccb2cd18794">useCache_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.clear();</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160; </div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#ae99cc4cd2f81ae8c848b4cb76f63389e">setStatePlane</a>(state.getState(), state.getPlane());</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;  }</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a93996a7134dfba3449c78bf882de8720"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93996a7134dfba3449c78bf882de8720">&#9670;&nbsp;</a></span>checkCache() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::checkCache </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> *&#160;</td>
          <td class="paramname"><em>plane</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="acb842973c3accd7dce8c10e967fabd14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb842973c3accd7dce8c10e967fabd14">&#9670;&nbsp;</a></span>clone() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a>* genfit::RKTrackRep::clone </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clone the trackRep. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a167993908a742633c6216cf811ea3ea2">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00080">80</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{<span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classgenfit_1_1RKTrackRep.html#aca0b07380cd50f63eef644ebda8252ce">RKTrackRep</a>(*<span class="keyword">this</span>);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acb842973c3accd7dce8c10e967fabd14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb842973c3accd7dce8c10e967fabd14">&#9670;&nbsp;</a></span>clone() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a>* genfit::RKTrackRep::clone </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clone the trackRep. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a167993908a742633c6216cf811ea3ea2">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="trackReps_2include_2RKTrackRep_8h_source.html#l00080">80</a> of file <a class="el" href="trackReps_2include_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{<span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classgenfit_1_1RKTrackRep.html#aca0b07380cd50f63eef644ebda8252ce">RKTrackRep</a>(*<span class="keyword">this</span>);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a281fc9087c22ee0ed63e22330fecad9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a281fc9087c22ee0ed63e22330fecad9d">&#9670;&nbsp;</a></span>estimateStep() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::estimateStep </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a2f0d1d795f44c877a78277c7107a4eea">M1x4</a> &amp;&#160;</td>
          <td class="paramname"><em>SU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>plane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>relMomLoss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StepLimits.html">StepLimits</a> &amp;&#160;</td>
          <td class="paramname"><em>limits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>invalid: RKSteps_.back().state7_ = { state7[0], state7[1], state7[2], state7[3], state7[4], state7[5], state7[6] };</p>
<p>fNoMaterial</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01963">1963</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                                                          {</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160; </div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1RKTrackRep.html#ad299432e86e08c7f4413dccb2cd18794">useCache_</a>) {</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">cachePos_</a> &gt;= <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.size()) {</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      <a class="code" href="classgenfit_1_1RKTrackRep.html#ad299432e86e08c7f4413dccb2cd18794">useCache_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    }</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">cachePos_</a>).limits_.getLowestLimit().first == <a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf">stp_plane</a>) {</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        <span class="comment">// we need to step exactly to the plane, so don&#39;t use the cache!</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        <a class="code" href="classgenfit_1_1RKTrackRep.html#ad299432e86e08c7f4413dccb2cd18794">useCache_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.erase(<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.begin() + <a class="code" href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">cachePos_</a>, <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.end());</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      }</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot; RKTrackRep::estimateStep: use stepSize &quot;</span> &lt;&lt; <a class="code" href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">cachePos_</a> &lt;&lt; <span class="stringliteral">&quot; from cache: &quot;</span> &lt;&lt; <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">cachePos_</a>).matStep_.stepSize_ &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        <span class="comment">//for(int n = 0; n &lt; 1*7; ++n) RKSteps_[cachePos_].state7_[n] = state7[n];</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        ++<a class="code" href="classgenfit_1_1RKTrackRep.html#ac04989ccf60fdba61d369aa462cdf40b">RKStepsFXStop_</a>;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        limits = <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">cachePos_</a>).limits_;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">cachePos_</a>++).matStep_.stepSize_;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      }</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    }</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  }</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160; </div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  limits.setLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da61f5269fcba7511a27c72e1583641040">stp_sMax</a>, 25.); <span class="comment">// max. step allowed [cm]</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160; </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot; RKTrackRep::estimateStep \n&quot;</span>;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;  position:  &quot;</span>; TVector3(state7[0], state7[1], state7[2]).Print();</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;  direction: &quot;</span>; TVector3(state7[3], state7[4], state7[5]).Print();</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  }</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  <span class="comment">// calculate SL distance to surface</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  <span class="keywordtype">double</span> Dist = SU[3] - (state7[0]*SU[0] +</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                         state7[1]*SU[1] +</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                         state7[2]*SU[2]);  <span class="comment">// Distance between start coordinates and surface</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <span class="keywordtype">double</span> An = state7[3]*SU[0] +</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;              state7[4]*SU[1] +</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;              state7[5]*SU[2];              <span class="comment">// An = dir * N;  component of dir normal to surface</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <span class="keywordtype">double</span> SLDist; <span class="comment">// signed</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  <span class="keywordflow">if</span> (fabs(An) &gt; 1.E-10)</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    SLDist = Dist/An;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    SLDist = Dist*1.E10;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="keywordflow">if</span> (An&lt;0) SLDist *= -1.;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  }</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  limits.setLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf">stp_plane</a>, SLDist);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  limits.setStepSign(SLDist);</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160; </div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;  Distance to plane: &quot;</span> &lt;&lt; Dist &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;  SL distance to plane: &quot;</span> &lt;&lt; SLDist &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordflow">if</span> (limits.getStepSign()&gt;0)</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;  Direction is  pointing towards surface.\n&quot;</span>;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;  Direction is pointing away from surface.\n&quot;</span>;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  }</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <span class="comment">// DONE calculate SL distance to surface</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160; </div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  <span class="comment">// Limit according to curvature and magnetic field inhomogenities</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="comment">// and improve stepsize estimation to reach plane</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  <span class="keywordtype">double</span> fieldCurvLimit(limits.getLowestLimitSignedVal()); <span class="comment">// signed</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  std::pair&lt;double, double&gt; distVsStep (9.E99, 9.E99); <span class="comment">// first: smallest straight line distances to plane; second: RK steps</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160; </div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxNumIt = 10;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a>(0);</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160; </div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  <span class="keywordflow">while</span> (fabs(fieldCurvLimit) &gt; <a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>) {</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keywordflow">if</span>(++<a class="code" href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a> &gt; maxNumIt){</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      <span class="comment">// if max iterations are reached, take a safe value</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      <span class="comment">// (in previous iteration, fieldCurvLimit has been not more than doubled)</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <span class="comment">// and break.</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      fieldCurvLimit *= 0.5;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    }</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160; </div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7_temp = { state7[0], state7[1], state7[2], state7[3], state7[4], state7[5], state7[6] }; <span class="comment">// invalid: M1x7 state7_temp(state7);</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> SA;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; </div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="keywordtype">double</span> q = <a class="code" href="classgenfit_1_1RKTrackRep.html#affa6945eaba3b0f2b143d039967b834e">RKPropagate</a>(state7_temp, NULL, SA, fieldCurvLimit, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;  maxStepArg = &quot;</span> &lt;&lt; fieldCurvLimit &lt;&lt; <span class="stringliteral">&quot;; q = &quot;</span> &lt;&lt; q  &lt;&lt; <span class="stringliteral">&quot; \n&quot;</span>;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    }</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160; </div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="comment">// remember steps and resulting SL distances to plane for stepsize improvement</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="comment">// calculate distance to surface</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    Dist = SU[3] - (state7_temp[0] * SU[0] +</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                    state7_temp[1] * SU[1] +</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                    state7_temp[2] * SU[2]); <span class="comment">// Distance between position and surface</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160; </div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    An = state7_temp[3] * SU[0] +</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;         state7_temp[4] * SU[1] +</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;         state7_temp[5] * SU[2];    <span class="comment">// An = dir * N;  component of dir normal to surface</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keywordflow">if</span> (fabs(Dist/An) &lt; fabs(distVsStep.first)) {</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      distVsStep.first = Dist/An;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      distVsStep.second = fieldCurvLimit;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    }</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <span class="comment">// resize limit according to q never grow step size more than</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="comment">// two-fold to avoid infinite grow-shrink loops with strongly</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <span class="comment">// inhomogeneous fields.</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <span class="keywordflow">if</span> (q&gt;2) {</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;      fieldCurvLimit *= 2;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    }</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    fieldCurvLimit *= q * 0.95;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160; </div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="keywordflow">if</span> (fabs(q-1) &lt; 0.25 || <span class="comment">// good enough!</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        fabs(fieldCurvLimit) &gt; limits.getLowestLimitVal()) <span class="comment">// other limits are lower!</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  }</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <span class="keywordflow">if</span> (fabs(fieldCurvLimit) &lt; <a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>)</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    limits.setLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da4da62c4f01005fa9d9b41383d919fb42">stp_fieldCurv</a>, <a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    limits.setLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da4da62c4f01005fa9d9b41383d919fb42">stp_fieldCurv</a>, fieldCurvLimit);</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160; </div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  <span class="keywordtype">double</span> stepToPlane(limits.getLimitSigned(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf">stp_plane</a>));</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="keywordflow">if</span> (fabs(distVsStep.first) &lt; 8.E99) {</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    stepToPlane = distVsStep.first + distVsStep.second;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  }</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  limits.setLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf">stp_plane</a>, stepToPlane);</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160; </div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  <span class="comment">// Select direction</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  <span class="comment">// auto select</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af8b046499b9651e30c0d4e06243c58b4">propDir_</a> == 0 || !plane.isFinite()){</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;  auto select direction&quot;</span>;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;      <span class="keywordflow">if</span> (!plane.isFinite()) std::cout &lt;&lt; <span class="stringliteral">&quot;, plane is not finite&quot;</span>;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    }</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  }</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  <span class="comment">// see if straight line approximation is ok</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( limits.getLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf">stp_plane</a>) &lt; 0.2*limits.getLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da4da62c4f01005fa9d9b41383d919fb42">stp_fieldCurv</a>) ){</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;  straight line approximation is fine.\n&quot;</span>;</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    }</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160; </div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <span class="comment">// if direction is pointing to active part of surface</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="keywordflow">if</span>( plane.isInActive(state7[0], state7[1], state7[2],  state7[3], state7[4], state7[5]) ) {</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  direction is pointing to active part of surface. \n&quot;</span>;</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      }</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    }</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="comment">// if we are near the plane, but not pointing to the active area, make a big step!</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;      limits.removeLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf">stp_plane</a>);</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;      limits.setStepSign(<a class="code" href="classgenfit_1_1AbsTrackRep.html#af8b046499b9651e30c0d4e06243c58b4">propDir_</a>);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  we are near the plane, but not pointing to the active area. make a big step! \n&quot;</span>;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;      }</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    }</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  }</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  <span class="comment">// propDir_ is set and we are not pointing to an active part of a plane -&gt; propDir_ decides!</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="keywordflow">if</span> (limits.getStepSign() * <a class="code" href="classgenfit_1_1AbsTrackRep.html#af8b046499b9651e30c0d4e06243c58b4">propDir_</a> &lt; 0){</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      limits.removeLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf">stp_plane</a>);</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;      limits.setStepSign(<a class="code" href="classgenfit_1_1AbsTrackRep.html#af8b046499b9651e30c0d4e06243c58b4">propDir_</a>);</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  invert Step according to propDir_ and make a big step. \n&quot;</span>;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;      }</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    }</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  }</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160; </div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <span class="comment">// call stepper and reduce stepsize if step not too small</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> RKStep defaultRKStep;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.push_back( defaultRKStep );</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  std::vector&lt;RKStep&gt;::iterator lastStep = <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.end() - 1;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a0300c9226cb21058a0167e6076c29b1d">n</a> = 0; <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a0300c9226cb21058a0167e6076c29b1d">n</a> &lt; 1*7; ++<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a0300c9226cb21058a0167e6076c29b1d">n</a>) lastStep-&gt;state7_[<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a0300c9226cb21058a0167e6076c29b1d">n</a>] = state7[<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a0300c9226cb21058a0167e6076c29b1d">n</a>];</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  ++<a class="code" href="classgenfit_1_1RKTrackRep.html#ac04989ccf60fdba61d369aa462cdf40b">RKStepsFXStop_</a>;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  if ( <span class="keyword">true</span>){</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160; </div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="keywordflow">if</span>(limits.getLowestLimitVal() &gt; <a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>){ <span class="comment">// only call stepper if step estimation big enough</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7_temp = {  state7[0], state7[1], state7[2], state7[3], state7[4], state7[5], state7[6] }; <span class="comment">// invalid: ... = (state7);</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160; </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;      <a class="code" href="classgenfit_1_1MaterialEffects.html#a15a93d367165ade368e6caec713d0934">MaterialEffects::getInstance</a>()-&gt;<a class="code" href="classgenfit_1_1MaterialEffects.html#a8bd536070da14d0a868a77ffa9cdaf43">stepper</a>(<span class="keyword">this</span>,</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                                              state7_temp,</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                                              charge/state7[6], <span class="comment">// |p|</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                                              relMomLoss,</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                                              <a class="code" href="classgenfit_1_1AbsTrackRep.html#a29cc69d36b01cab1d0c6fc8a9529fac4">pdgCode_</a>,</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                                              lastStep-&gt;matStep_.materialProperties_,</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                                              limits,</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                                              <span class="keyword">true</span>);</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    }</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <span class="keywordflow">else</span> { <span class="comment">//assume material has not changed</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      <span class="keywordflow">if</span>  (<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.size()&gt;1) {</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        lastStep-&gt;matStep_.materialProperties_ = (lastStep - 1)-&gt;matStep_.materialProperties_;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      }</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    }</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  }</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160; </div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;   final limits:\n&quot;</span>;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    limits.Print();</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  }</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160; </div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  <span class="keywordtype">double</span> finalStep = limits.getLowestLimitSignedVal();</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160; </div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  lastStep-&gt;matStep_.stepSize_ = finalStep;</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  lastStep-&gt;limits_ = limits;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; </div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;  --&gt; Step to be used: &quot;</span> &lt;&lt; finalStep &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;  }</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160; </div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  <span class="keywordflow">return</span> finalStep;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160; </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a281fc9087c22ee0ed63e22330fecad9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a281fc9087c22ee0ed63e22330fecad9d">&#9670;&nbsp;</a></span>estimateStep() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::estimateStep </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a2f0d1d795f44c877a78277c7107a4eea">M1x4</a> &amp;&#160;</td>
          <td class="paramname"><em>SU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>plane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>relMomLoss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StepLimits.html">StepLimits</a> &amp;&#160;</td>
          <td class="paramname"><em>limits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4fa173bb3b0080274c05f9fcf399768d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fa173bb3b0080274c05f9fcf399768d">&#9670;&nbsp;</a></span>Extrap() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::Extrap </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>startPlane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>destPlane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>isAtBoundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fillExtrapSteps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixDSym *&#160;</td>
          <td class="paramname"><em>cov</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>onlyOneStep</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxStep</em> = <code>1.E99</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles propagation and material effects. </p>
<p><a class="el" href="classgenfit_1_1RKTrackRep.html#ade2e4cf73880a2df757e9dd372bf7b00" title="Extrapolates the state to plane, and returns the extrapolation length and, via reference,...">extrapolateToPlane()</a>, <a class="el" href="classgenfit_1_1RKTrackRep.html#afb99d5a9c3b53087dfbd30cb1d393eaa" title="Extrapolates the state to the POCA to a point, and returns the extrapolation length and,...">extrapolateToPoint()</a> and <a class="el" href="classgenfit_1_1RKTrackRep.html#af556c558f049d00b43b079bd363564d9" title="Extrapolates the state to the POCA to a line, and returns the extrapolation length and,...">extrapolateToLine()</a> etc. call this function. <a class="el" href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d" title="Handles propagation and material effects.">Extrap()</a> needs a plane as an argument, hence <a class="el" href="classgenfit_1_1RKTrackRep.html#afb99d5a9c3b53087dfbd30cb1d393eaa" title="Extrapolates the state to the POCA to a point, and returns the extrapolation length and,...">extrapolateToPoint()</a> and <a class="el" href="classgenfit_1_1RKTrackRep.html#af556c558f049d00b43b079bd363564d9" title="Extrapolates the state to the POCA to a line, and returns the extrapolation length and,...">extrapolateToLine()</a> create virtual detector planes. In this function, <a class="el" href="classgenfit_1_1RKTrackRep.html#a5235db4672bcedc6c78d69470b1cb289" title="Propagates the particle through the magnetic field.">RKutta()</a> is called and the resulting points and point paths are filtered so that the direction doesn't change and tiny steps are filtered out. After the propagation the material effects are called via the <a class="el" href="classgenfit_1_1MaterialEffects.html" title="Stepper and energy loss/noise matrix calculation.">MaterialEffects</a> singleton. <a class="el" href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d" title="Handles propagation and material effects.">Extrap()</a> will loop until the plane is reached, unless the propagation fails or the maximum number of iterations is exceeded. </p>
<p>fNoMaterial &amp;&amp;</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l02201">2201</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                                                {</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160; </div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxNumIt(500);</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numIt(0);</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  <span class="keywordtype">double</span> coveredDistance(0.);</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  <span class="keywordtype">double</span> dqop(0.);</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;  <span class="keyword">const</span> TVector3 W(destPlane.getNormal());</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;  <a class="code" href="namespacegenfit.html#a2f0d1d795f44c877a78277c7107a4eea">M1x4</a> SU = {W.X(), W.Y(), W.Z(), destPlane.distance(0., 0., 0.)};</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160; </div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;  <span class="comment">// make SU vector point away from origin</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  <span class="keywordflow">if</span> (W*destPlane.getO() &lt; 0) {</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    SU[0] *= -1;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    SU[1] *= -1;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    SU[2] *= -1;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;  }</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160; </div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160; </div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> startState7;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  memcpy(startState7, state7, <span class="keyword">sizeof</span>(<a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a>));</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160; </div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;  <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160; </div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;\n============ RKTrackRep::Extrap loop nr. &quot;</span> &lt;&lt; numIt &lt;&lt; <span class="stringliteral">&quot; ============\n&quot;</span>;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Start plane: &quot;</span>; startPlane.Print();</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;fillExtrapSteps &quot;</span> &lt;&lt; fillExtrapSteps &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    }</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160; </div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <span class="keywordflow">if</span>(++numIt &gt; maxNumIt){</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      Exception exc(<span class="stringliteral">&quot;RKTrackRep::Extrap ==&gt; maximum number of iterations exceeded&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    }</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160; </div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <span class="comment">// initialize jacobianT with unit matrix</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> = 0; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> &lt; 7*7; ++<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>) <a class="code" href="classgenfit_1_1RKTrackRep.html#a41dcd53004ff44e12a924084b37cad8c">J_MMT_</a>[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>] = 0; <span class="comment">// invalid: J_MMT_.fill(0);</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>=0; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>&lt;7; ++<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>) <a class="code" href="classgenfit_1_1RKTrackRep.html#a41dcd53004ff44e12a924084b37cad8c">J_MMT_</a>[8*<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>] = 1.;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <a class="code" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a>* noise = NULL;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    isAtBoundary = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160; </div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="comment">// Remember previous state</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> oldState7;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    memcpy(oldState7, state7, <span class="keyword">sizeof</span>(<a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a>));</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160; </div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <span class="comment">// propagation</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="keywordtype">bool</span> checkJacProj = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#a0d72d0cf8fed127c8599c11283374288">limits_</a>.<a class="code" href="classgenfit_1_1StepLimits.html#ada8640542f6d6fc3f9467bf08d8ad777">reset</a>();</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#a0d72d0cf8fed127c8599c11283374288">limits_</a>.<a class="code" href="classgenfit_1_1StepLimits.html#a24a223a3dc45f881ff1dd9897cedd56b">setLimit</a>(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da9a3e90c9756979f3bdd4de5e3cd9da15">stp_sMaxArg</a>, maxStep-fabs(coveredDistance));</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <span class="keywordflow">if</span>( ! <a class="code" href="classgenfit_1_1RKTrackRep.html#a5235db4672bcedc6c78d69470b1cb289">RKutta</a>(SU, destPlane, charge, state7, &amp;<a class="code" href="classgenfit_1_1RKTrackRep.html#a41dcd53004ff44e12a924084b37cad8c">J_MMT_</a>,</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        coveredDistance, checkJacProj, <a class="code" href="classgenfit_1_1RKTrackRep.html#a210279ccff463e20ea47b345a288f1d0">noiseProjection_</a>,</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        <a class="code" href="classgenfit_1_1RKTrackRep.html#a0d72d0cf8fed127c8599c11283374288">limits_</a>, onlyOneStep, !fillExtrapSteps) ) {</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      Exception exc(<span class="stringliteral">&quot;RKTrackRep::Extrap ==&gt; Runge Kutta propagation failed&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    }</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160; </div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="keywordtype">bool</span> atPlane(<a class="code" href="classgenfit_1_1RKTrackRep.html#a0d72d0cf8fed127c8599c11283374288">limits_</a>.<a class="code" href="classgenfit_1_1StepLimits.html#a53d606cfca63873ad0b00993e8045d65">getLowestLimit</a>().first == <a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf">stp_plane</a>);</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1RKTrackRep.html#a0d72d0cf8fed127c8599c11283374288">limits_</a>.<a class="code" href="classgenfit_1_1StepLimits.html#a53d606cfca63873ad0b00993e8045d65">getLowestLimit</a>().first == <a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da605e0085946c284dd888271e7f7c5252">stp_boundary</a>)</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      isAtBoundary = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160; </div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160; </div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      std::cout&lt;&lt;<span class="stringliteral">&quot;RKSteps \n&quot;</span>;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      <span class="keywordflow">for</span> (std::vector&lt;RKStep&gt;::iterator it = <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.begin(); it != <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.end(); ++it){</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;stepSize = &quot;</span> &lt;&lt; it-&gt;matStep_.stepSize_ &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;        it-&gt;matStep_.materialProperties_.Print();</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      }</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;      std::cout&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    }</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160; </div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160; </div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160; </div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="comment">// call MatFX</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    <span class="keywordflow">if</span>(fillExtrapSteps) {</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      noise = &amp;<a class="code" href="classgenfit_1_1RKTrackRep.html#a889ad368e5c5c6ac870402c9420b2bb8">noiseArray_</a>;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> = 0; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> &lt; 7*7; ++<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>) <a class="code" href="classgenfit_1_1RKTrackRep.html#a889ad368e5c5c6ac870402c9420b2bb8">noiseArray_</a>[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>] = 0; <span class="comment">// set noiseArray_ to 0</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    }</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacescifiSimAna.html#a3d2b280b16570f1b32f4c8e56f666015">nPoints</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#ac04989ccf60fdba61d369aa462cdf40b">RKStepsFXStop_</a> - <a class="code" href="classgenfit_1_1RKTrackRep.html#a27fe628afd6be77f1f9de8a5a10d3b0a">RKStepsFXStart_</a>);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespacescifiSimAna.html#a3d2b280b16570f1b32f4c8e56f666015">nPoints</a>&gt;0){</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      <span class="comment">// momLoss has a sign - negative loss means momentum gain</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      <span class="keywordtype">double</span> momLoss = <a class="code" href="classgenfit_1_1MaterialEffects.html#a15a93d367165ade368e6caec713d0934">MaterialEffects::getInstance</a>()-&gt;<a class="code" href="classgenfit_1_1MaterialEffects.html#a2b4a0a0718f2c097d73b7b8c9514557f">effects</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>,</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                                                               <a class="code" href="classgenfit_1_1RKTrackRep.html#a27fe628afd6be77f1f9de8a5a10d3b0a">RKStepsFXStart_</a>,</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                                                               <a class="code" href="classgenfit_1_1RKTrackRep.html#ac04989ccf60fdba61d369aa462cdf40b">RKStepsFXStop_</a>,</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                                                               fabs(charge/state7[6]), <span class="comment">// momentum</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                                                               <a class="code" href="classgenfit_1_1AbsTrackRep.html#a29cc69d36b01cab1d0c6fc8a9529fac4">pdgCode_</a>,</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                                                               noise);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; </div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;      <a class="code" href="classgenfit_1_1RKTrackRep.html#a27fe628afd6be77f1f9de8a5a10d3b0a">RKStepsFXStart_</a> = <a class="code" href="classgenfit_1_1RKTrackRep.html#ac04989ccf60fdba61d369aa462cdf40b">RKStepsFXStop_</a>;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160; </div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;momLoss: &quot;</span> &lt;&lt; momLoss &lt;&lt; <span class="stringliteral">&quot; GeV; relative: &quot;</span> &lt;&lt; momLoss/fabs(charge/state7[6]) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 1 &amp;&amp; noise != NULL) {</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;7D noise: \n&quot;</span>;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;          <a class="code" href="namespacegenfit_1_1RKTools.html#a7842d42c75a8456ef78ccc4ddf08373f">RKTools::printDim</a>(*noise, 7, 7);</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        }</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      }</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160; </div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      <span class="comment">// do momLoss only for defined 1/momentum .ne.0</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      <span class="keywordflow">if</span>(fabs(state7[6])&gt;1.<a class="code" href="namespacemakeMuonDIS.html#ad916c51f2653b60d746cf521ef14f685">E</a>-10) {</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;        <span class="keywordtype">double</span> qop = charge/(fabs(charge/state7[6])-momLoss);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        dqop = qop - state7[6];</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        state7[6] = qop;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160; </div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        <span class="comment">// correct state7 with dx/dqop, dy/dqop ... Greatly improves extrapolation accuracy!</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;correct state7 with dx/dqop, dy/dqop ...\n&quot;</span>;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        }</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>=0; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>&lt;6; ++<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>) {</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;          state7[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>] += 0.5 * dqop * <a class="code" href="classgenfit_1_1RKTrackRep.html#a41dcd53004ff44e12a924084b37cad8c">J_MMT_</a>[6*7 + <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>];</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;        }</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      }</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    } <span class="comment">// finished MatFX</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160; </div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <span class="comment">// fill ExtrapSteps_</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <span class="keywordflow">if</span> (fillExtrapSteps) {</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;      <span class="keyword">static</span> <span class="keyword">const</span> ExtrapStep defaultExtrapStep;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;      <a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>.push_back(defaultExtrapStep);</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      std::vector&lt;ExtrapStep&gt;::iterator lastStep = <a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>.end() - 1;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160; </div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;      <span class="comment">// Store Jacobian of this step for final calculation.</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;      memcpy(lastStep-&gt;jac7_, <a class="code" href="classgenfit_1_1RKTrackRep.html#a41dcd53004ff44e12a924084b37cad8c">J_MMT_</a>, <span class="keyword">sizeof</span>(<a class="code" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a>));</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160; </div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      <span class="keywordflow">if</span>( checkJacProj == <span class="keyword">true</span> ){</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        <span class="comment">//project the noise onto the destPlane</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        <a class="code" href="namespacegenfit_1_1RKTools.html#a5ad8693b4b34e9d016b4bedc7a574800">RKTools::Np_N_NpT</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#a210279ccff463e20ea47b345a288f1d0">noiseProjection_</a>, <a class="code" href="classgenfit_1_1RKTrackRep.html#a889ad368e5c5c6ac870402c9420b2bb8">noiseArray_</a>);</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160; </div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 1) {</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;7D noise projected onto plane: \n&quot;</span>;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;          <a class="code" href="namespacegenfit_1_1RKTools.html#a7842d42c75a8456ef78ccc4ddf08373f">RKTools::printDim</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#a889ad368e5c5c6ac870402c9420b2bb8">noiseArray_</a>, 7, 7);</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        }</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      }</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160; </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      <span class="comment">// Store this step&#39;s noise for final calculation.</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      memcpy(lastStep-&gt;noise7_, <a class="code" href="classgenfit_1_1RKTrackRep.html#a889ad368e5c5c6ac870402c9420b2bb8">noiseArray_</a>, <span class="keyword">sizeof</span>(<a class="code" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a>));</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 2) {</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        std::cout&lt;&lt;<span class="stringliteral">&quot;ExtrapSteps \n&quot;</span>;</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        <span class="keywordflow">for</span> (std::vector&lt;ExtrapStep&gt;::iterator it = <a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>.begin(); it != <a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>.end(); ++it){</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;7D Jacobian: &quot;</span>; <a class="code" href="namespacegenfit_1_1RKTools.html#a7842d42c75a8456ef78ccc4ddf08373f">RKTools::printDim</a>((it-&gt;jac7_), 5,5);</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;7D noise:    &quot;</span>; <a class="code" href="namespacegenfit_1_1RKTools.html#a7842d42c75a8456ef78ccc4ddf08373f">RKTools::printDim</a>((it-&gt;noise7_), 5,5);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        }</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        std::cout&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;      }</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    }</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160; </div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160; </div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160; </div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    <span class="comment">// check if at boundary</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    <span class="keywordflow">if</span> (stopAtBoundary) {</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;stopAtBoundary -&gt; break; \n &quot;</span>;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      }</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    }</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160; </div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    <span class="keywordflow">if</span> (onlyOneStep) {</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;onlyOneStep -&gt; break; \n &quot;</span>;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      }</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    }</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160; </div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    <span class="comment">//break if we arrived at destPlane</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <span class="keywordflow">if</span>(atPlane) {</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;arrived at destPlane with a distance of  &quot;</span> &lt;&lt; destPlane.distance(state7[0], state7[1], state7[2]) &lt;&lt; <span class="stringliteral">&quot; cm left. &quot;</span>;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        <span class="keywordflow">if</span> (destPlane.isInActive(state7[0], state7[1], state7[2],  state7[3], state7[4], state7[5]))</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;In active area of destPlane. \n&quot;</span>;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot;NOT in active area of plane. \n&quot;</span>;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      }</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    }</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160; </div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  }</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160; </div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;  <span class="keywordflow">if</span> (fillExtrapSteps) {</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    <span class="comment">// propagate cov and add noise</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#a421ac85c5f1c7b5ef3216943dbf7fc15">calcForwardJacobianAndNoise</a>(startState7, startPlane, state7, destPlane);</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160; </div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <span class="keywordflow">if</span> (cov != NULL) {</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;      cov-&gt;Similarity(<a class="code" href="classgenfit_1_1RKTrackRep.html#aafac71f71cc93a82aa42281d600b4776">fJacobian_</a>);</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;      *cov += <a class="code" href="classgenfit_1_1RKTrackRep.html#ae498a8cb248b5aa8dffb2555b6ca1925">fNoise_</a>;</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    }</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160; </div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      <span class="keywordflow">if</span> (cov != NULL) {</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;final covariance matrix after Extrap: &quot;</span>; cov-&gt;Print();</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;      }</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    }</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;  }</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160; </div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;  <span class="keywordflow">return</span> coveredDistance;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4fa173bb3b0080274c05f9fcf399768d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fa173bb3b0080274c05f9fcf399768d">&#9670;&nbsp;</a></span>Extrap() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::Extrap </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>startPlane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>destPlane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>isAtBoundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fillExtrapSteps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixDSym *&#160;</td>
          <td class="paramname"><em>cov</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>onlyOneStep</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxStep</em> = <code>1.E99</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles propagation and material effects. </p>
<p><a class="el" href="classgenfit_1_1RKTrackRep.html#ade2e4cf73880a2df757e9dd372bf7b00" title="Extrapolates the state to plane, and returns the extrapolation length and, via reference,...">extrapolateToPlane()</a>, <a class="el" href="classgenfit_1_1RKTrackRep.html#afb99d5a9c3b53087dfbd30cb1d393eaa" title="Extrapolates the state to the POCA to a point, and returns the extrapolation length and,...">extrapolateToPoint()</a> and <a class="el" href="classgenfit_1_1RKTrackRep.html#af556c558f049d00b43b079bd363564d9" title="Extrapolates the state to the POCA to a line, and returns the extrapolation length and,...">extrapolateToLine()</a> etc. call this function. <a class="el" href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d" title="Handles propagation and material effects.">Extrap()</a> needs a plane as an argument, hence <a class="el" href="classgenfit_1_1RKTrackRep.html#afb99d5a9c3b53087dfbd30cb1d393eaa" title="Extrapolates the state to the POCA to a point, and returns the extrapolation length and,...">extrapolateToPoint()</a> and <a class="el" href="classgenfit_1_1RKTrackRep.html#af556c558f049d00b43b079bd363564d9" title="Extrapolates the state to the POCA to a line, and returns the extrapolation length and,...">extrapolateToLine()</a> create virtual detector planes. In this function, <a class="el" href="classgenfit_1_1RKTrackRep.html#a5235db4672bcedc6c78d69470b1cb289" title="Propagates the particle through the magnetic field.">RKutta()</a> is called and the resulting points and point paths are filtered so that the direction doesn't change and tiny steps are filtered out. After the propagation the material effects are called via the <a class="el" href="classgenfit_1_1MaterialEffects.html" title="Stepper and energy loss/noise matrix calculation.">MaterialEffects</a> singleton. <a class="el" href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d" title="Handles propagation and material effects.">Extrap()</a> will loop until the plane is reached, unless the propagation fails or the maximum number of iterations is exceeded. </p>

</div>
</div>
<a id="a6e8225094b2cba938c3dcef7261ccfb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e8225094b2cba938c3dcef7261ccfb0">&#9670;&nbsp;</a></span>extrapolateBy() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::extrapolateBy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state by step (cm) and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#aff2dc02475fbef55f521373a8659d020">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00579">579</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                  {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::extrapolateBy()\n&quot;</span>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a93996a7134dfba3449c78bf882de8720">checkCache</a>(state, NULL);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxIt(1000);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">// to 7D</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a>(state, state7);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordtype">bool</span> fillExtrapSteps(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>MeasuredStateOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    fillExtrapSteps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (calcJacobianNoise)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    fillExtrapSteps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordtype">double</span> tracklength(0.);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  TVector3 <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a4761262924c3ec5c89e319afab5084a9">dest</a>, <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>, dir;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordtype">bool</span> isAtBoundary(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  DetPlane startPlane(*(state.getPlane()));</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <a class="code" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> plane(<span class="keyword">new</span> DetPlane());</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iterations(0);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">if</span>(++iterations == maxIt) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      Exception exc(<span class="stringliteral">&quot;RKTrackRep::extrapolateBy ==&gt; maximum number of iterations reached&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>.SetXYZ(state7[0], state7[1], state7[2]);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    dir.SetXYZ(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a4761262924c3ec5c89e319afab5084a9">dest</a> = <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a> + 1.5*(<a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a>-tracklength) * dir;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    plane-&gt;setON(<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a4761262924c3ec5c89e319afab5084a9">dest</a>, dir);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    tracklength += this-&gt;<a class="code" href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d">Extrap</a>(startPlane, *plane, <a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state), isAtBoundary, state7, <span class="keyword">false</span>, NULL, <span class="keyword">true</span>, stopAtBoundary, (<a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a>-tracklength));</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">// check break conditions</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">if</span> (stopAtBoundary &amp;&amp; isAtBoundary) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>.SetXYZ(state7[0], state7[1], state7[2]);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      dir.SetXYZ(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      plane-&gt;setON(<a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>, dir);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">if</span> (fabs(tracklength-<a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a>) &lt; <a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>) {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::extrapolateBy(): reached after &quot;</span> &lt;&lt; iterations &lt;&lt; <span class="stringliteral">&quot; iterations. \n&quot;</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>.SetXYZ(state7[0], state7[1], state7[2]);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      dir.SetXYZ(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      plane-&gt;setON(<a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>, dir);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    startPlane = *plane;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">if</span> (fillExtrapSteps) { <span class="comment">// now do the full extrapolation with covariance matrix</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// make use of the cache</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a0123543a15df51f8beaa98660cfa89b7">setPlane</a>(plane);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>, state7);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    tracklength = <a class="code" href="classgenfit_1_1RKTrackRep.html#ade2e4cf73880a2df757e9dd372bf7b00">extrapolateToPlane</a>(state, plane, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    state.setPlane(plane);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a>(state, state7);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a> = state;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordflow">return</span> tracklength;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f4323fd5ad69bce79d82d0af287417e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f4323fd5ad69bce79d82d0af287417e">&#9670;&nbsp;</a></span>extrapolateBy() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::extrapolateBy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state by step (cm) and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#aff2dc02475fbef55f521373a8659d020">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a7cfb69ae23f997f00073c2178771e233"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cfb69ae23f997f00073c2178771e233">&#9670;&nbsp;</a></span>extrapolateToCylinder() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::extrapolateToCylinder </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>linePoint</em> = <code>TVector3(0.,&#160;0.,&#160;0.)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>lineDirection</em> = <code>TVector3(0.,&#160;0.,&#160;1.)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state to the cylinder surface, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a3159647541c1414d7bfd2c97eec716ac">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00353">353</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                  {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::extrapolateToCylinder()\n&quot;</span>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a93996a7134dfba3449c78bf882de8720">checkCache</a>(state, NULL);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxIt(1000);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">// to 7D</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a>(state, state7);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordtype">bool</span> fillExtrapSteps(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>MeasuredStateOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    fillExtrapSteps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (calcJacobianNoise)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    fillExtrapSteps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordtype">double</span> tracklength(0.), maxStep(1.E99);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  TVector3 <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a4761262924c3ec5c89e319afab5084a9">dest</a>, <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>, dir;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordtype">bool</span> isAtBoundary(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  DetPlane startPlane(*(state.getPlane()));</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <a class="code" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> plane(<span class="keyword">new</span> DetPlane());</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iterations(0);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span>(++iterations == maxIt) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      Exception exc(<span class="stringliteral">&quot;RKTrackRep::extrapolateToCylinder ==&gt; maximum number of iterations reached&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>.SetXYZ(state7[0], state7[1], state7[2]);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    dir.SetXYZ(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">// solve quadratic equation</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    TVector3 AO = (<a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a> - linePoint);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    TVector3 AOxAB = (AO.Cross(lineDirection));</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    TVector3 VxAB  = (dir.Cross(lineDirection));</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">float</span> ab2    = (lineDirection * lineDirection);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a5e37896fee417eb26379057dc702c406">a</a>      = (VxAB * VxAB);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="namespaceScifiCTR.html#a87a9336a17ef0557a1090c56e6990797">b</a>      = 2 * (VxAB * AOxAB);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="namespacehnl.html#adb7ba50b8941bf3badea16f97cb665d5">c</a>      = (AOxAB * AOxAB) - (radius*radius * ab2);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordtype">double</span> arg = <a class="code" href="namespaceScifiCTR.html#a87a9336a17ef0557a1090c56e6990797">b</a>*<a class="code" href="namespaceScifiCTR.html#a87a9336a17ef0557a1090c56e6990797">b</a> - 4.*<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a5e37896fee417eb26379057dc702c406">a</a>*<a class="code" href="namespacehnl.html#adb7ba50b8941bf3badea16f97cb665d5">c</a>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span>(arg &lt; 0) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      Exception exc(<span class="stringliteral">&quot;RKTrackRep::extrapolateToCylinder ==&gt; cannot solve&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordtype">double</span> term = sqrt(arg);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordtype">double</span> k1, k2;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceScifiCTR.html#a87a9336a17ef0557a1090c56e6990797">b</a>&lt;0) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      k1 = (-<a class="code" href="namespaceScifiCTR.html#a87a9336a17ef0557a1090c56e6990797">b</a> + term)/(2.*<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a5e37896fee417eb26379057dc702c406">a</a>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      k2 = 2.*<a class="code" href="namespacehnl.html#adb7ba50b8941bf3badea16f97cb665d5">c</a>/(-<a class="code" href="namespaceScifiCTR.html#a87a9336a17ef0557a1090c56e6990797">b</a> + term);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      k1 = 2.*<a class="code" href="namespacehnl.html#adb7ba50b8941bf3badea16f97cb665d5">c</a>/(-<a class="code" href="namespaceScifiCTR.html#a87a9336a17ef0557a1090c56e6990797">b</a> - term);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      k2 = (-<a class="code" href="namespaceScifiCTR.html#a87a9336a17ef0557a1090c56e6990797">b</a> - term)/(2.*<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a5e37896fee417eb26379057dc702c406">a</a>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// select smallest absolute solution -&gt; closest cylinder surface</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">k</a> = k1;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (fabs(k2)&lt;fabs(<a class="code" href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">k</a>))</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">k</a> = k2;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::extrapolateToCylinder(); k = &quot;</span> &lt;&lt; <a class="code" href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">k</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a4761262924c3ec5c89e319afab5084a9">dest</a> = <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a> + <a class="code" href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">k</a> * dir;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    plane-&gt;setO(<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a4761262924c3ec5c89e319afab5084a9">dest</a>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    plane-&gt;setUV((<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a4761262924c3ec5c89e319afab5084a9">dest</a>-linePoint).Cross(lineDirection), lineDirection);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    tracklength += this-&gt;<a class="code" href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d">Extrap</a>(startPlane, *plane, <a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state), isAtBoundary, state7, <span class="keyword">false</span>, NULL, <span class="keyword">true</span>, stopAtBoundary, maxStep);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// check break conditions</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (stopAtBoundary &amp;&amp; isAtBoundary) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>.SetXYZ(state7[0], state7[1], state7[2]);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      dir.SetXYZ(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      plane-&gt;setO(<a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      plane-&gt;setUV((<a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>-linePoint).Cross(lineDirection), lineDirection);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">if</span>(fabs(<a class="code" href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">k</a>)&lt;<a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    startPlane = *plane;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordflow">if</span> (fillExtrapSteps) { <span class="comment">// now do the full extrapolation with covariance matrix</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// make use of the cache</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a0123543a15df51f8beaa98660cfa89b7">setPlane</a>(plane);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>, state7);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    tracklength = <a class="code" href="classgenfit_1_1RKTrackRep.html#ade2e4cf73880a2df757e9dd372bf7b00">extrapolateToPlane</a>(state, plane, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    state.setPlane(plane);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a>(state, state7);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a> = state;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keywordflow">return</span> tracklength;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa91d6caaf330881eead525c66dff955f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa91d6caaf330881eead525c66dff955f">&#9670;&nbsp;</a></span>extrapolateToCylinder() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::extrapolateToCylinder </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>linePoint</em> = <code>TVector3(0.,&#160;0.,&#160;0.)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>lineDirection</em> = <code>TVector3(0.,&#160;0.,&#160;1.)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state to the cylinder surface, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a3159647541c1414d7bfd2c97eec716ac">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="af556c558f049d00b43b079bd363564d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af556c558f049d00b43b079bd363564d9">&#9670;&nbsp;</a></span>extrapolateToLine() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::extrapolateToLine </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>linePoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>lineDirection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state to the POCA to a line, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a4442c7a510c9bc05a51130350f2268a1">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00150">150</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                  {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::extrapolateToLine()\n&quot;</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a93996a7134dfba3449c78bf882de8720">checkCache</a>(state, NULL);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxIt(1000);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">// to 7D</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a>(state, state7);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordtype">bool</span> fillExtrapSteps(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>MeasuredStateOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    fillExtrapSteps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (calcJacobianNoise)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    fillExtrapSteps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a>(0.), lastStep(0.), maxStep(1.E99), <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#ab2f042ac8d5c79bab81997961ad3ee23">angle</a>(0), distToPoca(0), tracklength(0);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">double</span> charge = <a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  TVector3 dir(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  TVector3 lastDir(0,0,0);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  TVector3 poca, poca_onwire;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">bool</span> isAtBoundary(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  DetPlane startPlane(*(state.getPlane()));</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> plane(<span class="keyword">new</span> DetPlane(linePoint, dir.Cross(lineDirection), lineDirection));</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iterations(0);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span>(++iterations == maxIt) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      Exception exc(<span class="stringliteral">&quot;RKTrackRep::extrapolateToLine ==&gt; extrapolation to line failed, maximum number of iterations reached&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    lastStep = <a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    lastDir = dir;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a> = this-&gt;<a class="code" href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d">Extrap</a>(startPlane, *plane, charge, isAtBoundary, state7, <span class="keyword">false</span>, NULL, <span class="keyword">true</span>, stopAtBoundary, maxStep);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    tracklength += <a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    dir.SetXYZ(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    poca.SetXYZ(state7[0], state7[1], state7[2]);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    poca_onwire = <a class="code" href="classgenfit_1_1RKTrackRep.html#adcd6b3f8bd742ea90f3d890ff01452c3">pocaOnLine</a>(linePoint, lineDirection, poca);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// check break conditions</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span> (stopAtBoundary &amp;&amp; isAtBoundary) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      plane-&gt;setON(dir, poca);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#ab2f042ac8d5c79bab81997961ad3ee23">angle</a> = fabs(dir.Angle((poca_onwire-poca))-TMath::PiOver2()); <span class="comment">// angle between direction and connection to point - 90 deg</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    distToPoca = (poca_onwire-poca).Mag();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#ab2f042ac8d5c79bab81997961ad3ee23">angle</a>*distToPoca &lt; 0.1*<a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// if lastStep and step have opposite sign, the real normal vector lies somewhere between the last two normal vectors (i.e. the directions)</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// -&gt; try mean value of the two (normalization not needed)</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (lastStep*<a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a> &lt; 0){</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      dir += lastDir;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      maxStep = 0.5*fabs(lastStep); <span class="comment">// make it converge!</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    startPlane = *plane;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    plane-&gt;setU(dir.Cross(lineDirection));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">if</span> (fillExtrapSteps) { <span class="comment">// now do the full extrapolation with covariance matrix</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">// make use of the cache</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a0123543a15df51f8beaa98660cfa89b7">setPlane</a>(plane);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>, state7);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    tracklength = <a class="code" href="classgenfit_1_1RKTrackRep.html#ade2e4cf73880a2df757e9dd372bf7b00">extrapolateToPlane</a>(state, plane, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    state.setPlane(plane);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a>(state, state7);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::extrapolateToLine(): Reached POCA after &quot;</span> &lt;&lt; iterations+1 &lt;&lt; <span class="stringliteral">&quot; iterations. Distance: &quot;</span> &lt;&lt; (poca_onwire-poca).Mag() &lt;&lt; <span class="stringliteral">&quot; cm. Angle deviation: &quot;</span> &lt;&lt; dir.Angle((poca_onwire-poca))-TMath::PiOver2() &lt;&lt; <span class="stringliteral">&quot; rad \n&quot;</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a> = state;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">return</span> tracklength;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afeebe12bb8b5385b4ed46258271e7f13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeebe12bb8b5385b4ed46258271e7f13">&#9670;&nbsp;</a></span>extrapolateToLine() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::extrapolateToLine </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>linePoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>lineDirection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state to the POCA to a line, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a4442c7a510c9bc05a51130350f2268a1">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a6808fa51fe2bd047e0d8742ea921b851"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6808fa51fe2bd047e0d8742ea921b851">&#9670;&nbsp;</a></span>extrapolateToLine() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::AbsTrackRep::extrapolateToLine</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extrapolates the state to the POCA to a line, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

</div>
</div>
<a id="a6808fa51fe2bd047e0d8742ea921b851"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6808fa51fe2bd047e0d8742ea921b851">&#9670;&nbsp;</a></span>extrapolateToLine() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::AbsTrackRep::extrapolateToLine</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extrapolates the state to the POCA to a line, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

</div>
</div>
<a id="abccad41ccef10c491ed0bcacd2dcb022"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abccad41ccef10c491ed0bcacd2dcb022">&#9670;&nbsp;</a></span>extrapolateToLine() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::AbsTrackRep::extrapolateToLine</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resembles the interface of GFAbsTrackRep in old versions of genfit. </p>
<p>This interface to extrapolateToLine is intended to resemble the interface of GFAbsTrackRep in old versions of genfit and is implemented by default via the preceding function.</p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p class="definition">Definition at line <a class="el" href="AbsTrackRep_8h_source.html#l00120">120</a> of file <a class="el" href="AbsTrackRep_8h_source.html">AbsTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                            {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    TVector3 wireDir(point2 - point1);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    wireDir.Unit();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">double</span> retval = this-&gt;<a class="code" href="classgenfit_1_1RKTrackRep.html#af556c558f049d00b43b079bd363564d9">extrapolateToLine</a>(state, point1, wireDir, stopAtBoundary, calcJacobianNoise);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    poca = this-&gt;<a class="code" href="classgenfit_1_1RKTrackRep.html#adf4865558fe7b54ffe94c3e145344505">getPos</a>(state);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    dirInPoca = this-&gt;<a class="code" href="classgenfit_1_1RKTrackRep.html#a01ccd6e74c4750e434e89992e853ae30">getMom</a>(state);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    dirInPoca.Unit();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    poca_onwire = point1 + wireDir*((poca - point1)*wireDir);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="abccad41ccef10c491ed0bcacd2dcb022"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abccad41ccef10c491ed0bcacd2dcb022">&#9670;&nbsp;</a></span>extrapolateToLine() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::AbsTrackRep::extrapolateToLine</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resembles the interface of GFAbsTrackRep in old versions of genfit. </p>
<p>This interface to extrapolateToLine is intended to resemble the interface of GFAbsTrackRep in old versions of genfit and is implemented by default via the preceding function.</p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p class="definition">Definition at line <a class="el" href="AbsTrackRep_8h_source.html#l00120">120</a> of file <a class="el" href="AbsTrackRep_8h_source.html">AbsTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                            {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    TVector3 wireDir(point2 - point1);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    wireDir.Unit();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">double</span> retval = this-&gt;<a class="code" href="classgenfit_1_1RKTrackRep.html#af556c558f049d00b43b079bd363564d9">extrapolateToLine</a>(state, point1, wireDir, stopAtBoundary, calcJacobianNoise);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    poca = this-&gt;<a class="code" href="classgenfit_1_1RKTrackRep.html#adf4865558fe7b54ffe94c3e145344505">getPos</a>(state);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    dirInPoca = this-&gt;<a class="code" href="classgenfit_1_1RKTrackRep.html#a01ccd6e74c4750e434e89992e853ae30">getMom</a>(state);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    dirInPoca.Unit();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    poca_onwire = point1 + wireDir*((poca - point1)*wireDir);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ade2e4cf73880a2df757e9dd372bf7b00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade2e4cf73880a2df757e9dd372bf7b00">&#9670;&nbsp;</a></span>extrapolateToPlane() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::extrapolateToPlane </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> &amp;&#160;</td>
          <td class="paramname"><em>plane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state to plane, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a2f8c69950056c0c679d66bfb2eae2431">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00097">97</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                  {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::extrapolateToPlane()\n&quot;</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">if</span> (state.getPlane() == plane) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;state is already defined at plane. Do nothing! \n&quot;</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a93996a7134dfba3449c78bf882de8720">checkCache</a>(state, &amp;plane);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">// to 7D</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a>(state, state7);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  TMatrixDSym* covPtr(NULL);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">bool</span> fillExtrapSteps(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>MeasuredStateOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    covPtr = &amp;(<span class="keyword">static_cast&lt;</span>MeasuredStateOnPlane*<span class="keyword">&gt;</span>(&amp;state)-&gt;getCov());</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    fillExtrapSteps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (calcJacobianNoise)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    fillExtrapSteps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// actual extrapolation</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordtype">bool</span> isAtBoundary(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordtype">double</span> coveredDistance = <a class="code" href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d">Extrap</a>(*(state.getPlane()), *plane, <a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state), isAtBoundary, state7, fillExtrapSteps, covPtr, <span class="keyword">false</span>, stopAtBoundary);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">if</span> (stopAtBoundary &amp;&amp; isAtBoundary) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    state.setPlane(<a class="code" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a>(<span class="keyword">new</span> DetPlane(TVector3(state7[0], state7[1], state7[2]),</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                                TVector3(state7[3], state7[4], state7[5]))));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    state.setPlane(plane);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// back to 5D</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a>(state, state7);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a> = state;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">return</span> coveredDistance;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a43755174182fc4f0e42cae45b690baae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43755174182fc4f0e42cae45b690baae">&#9670;&nbsp;</a></span>extrapolateToPlane() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::extrapolateToPlane </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> &amp;&#160;</td>
          <td class="paramname"><em>plane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state to plane, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a2f8c69950056c0c679d66bfb2eae2431">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="add17267d625d78c2df112bbf501f5753"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add17267d625d78c2df112bbf501f5753">&#9670;&nbsp;</a></span>extrapolateToPlane() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::extrapolateToPlane </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00084">84</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                  {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;test &quot;&lt;&lt;point.X()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> shared = <a class="code" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a>(<span class="keyword">new</span> DetPlane(point, dir));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classgenfit_1_1RKTrackRep.html#ade2e4cf73880a2df757e9dd372bf7b00">extrapolateToPlane</a>(state,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    shared,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    stopAtBoundary,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    calcJacobianNoise);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afb99d5a9c3b53087dfbd30cb1d393eaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb99d5a9c3b53087dfbd30cb1d393eaa">&#9670;&nbsp;</a></span>extrapolateToPoint() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::extrapolateToPoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state to the POCA to a point, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#adf11f826cc9b4d61fed7d7141e833e94">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00095">95</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                            {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classgenfit_1_1RKTrackRep.html#a71dffb5437351d65394a778a5cc0b5df">extrapToPoint</a>(state, point, NULL, stopAtBoundary, calcJacobianNoise);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afb99d5a9c3b53087dfbd30cb1d393eaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb99d5a9c3b53087dfbd30cb1d393eaa">&#9670;&nbsp;</a></span>extrapolateToPoint() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::extrapolateToPoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state to the POCA to a point, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#adf11f826cc9b4d61fed7d7141e833e94">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="trackReps_2include_2RKTrackRep_8h_source.html#l00100">100</a> of file <a class="el" href="trackReps_2include_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                            {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classgenfit_1_1RKTrackRep.html#a71dffb5437351d65394a778a5cc0b5df">extrapToPoint</a>(state, point, NULL, stopAtBoundary, calcJacobianNoise);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="add04b97a56a22832fed2a96bfa45a597"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add04b97a56a22832fed2a96bfa45a597">&#9670;&nbsp;</a></span>extrapolateToPoint() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::extrapolateToPoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TMatrixDSym &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state to the POCA to a point in the metric of G, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a8b5b1181ba3ee5b1310ca8d09359797d">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00102">102</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                            {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classgenfit_1_1RKTrackRep.html#a71dffb5437351d65394a778a5cc0b5df">extrapToPoint</a>(state, point, &amp;<a class="code" href="namespacerunPythia8.html#a92b74818d4845c92d20cf34c4802c79d">G</a>, stopAtBoundary, calcJacobianNoise);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="add04b97a56a22832fed2a96bfa45a597"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add04b97a56a22832fed2a96bfa45a597">&#9670;&nbsp;</a></span>extrapolateToPoint() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::extrapolateToPoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TMatrixDSym &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state to the POCA to a point in the metric of G, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a8b5b1181ba3ee5b1310ca8d09359797d">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="trackReps_2include_2RKTrackRep_8h_source.html#l00107">107</a> of file <a class="el" href="trackReps_2include_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                            {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classgenfit_1_1RKTrackRep.html#a71dffb5437351d65394a778a5cc0b5df">extrapToPoint</a>(state, point, &amp;<a class="code" href="namespacerunPythia8.html#a92b74818d4845c92d20cf34c4802c79d">G</a>, stopAtBoundary, calcJacobianNoise);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a593518bed9f4385feab1623a66d734a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a593518bed9f4385feab1623a66d734a5">&#9670;&nbsp;</a></span>extrapolateToSphere() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::extrapolateToSphere </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>point</em> = <code>TVector3(0.,&#160;0.,&#160;0.)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state to the sphere surface, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a7e6519f084e4ac5c58b3f3f8836cfbf0">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00473">473</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                  {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::extrapolateToSphere()\n&quot;</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a93996a7134dfba3449c78bf882de8720">checkCache</a>(state, NULL);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxIt(1000);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">// to 7D</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a>(state, state7);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordtype">bool</span> fillExtrapSteps(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>MeasuredStateOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    fillExtrapSteps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (calcJacobianNoise)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    fillExtrapSteps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordtype">double</span> tracklength(0.), maxStep(1.E99);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  TVector3 <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a4761262924c3ec5c89e319afab5084a9">dest</a>, <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>, dir;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordtype">bool</span> isAtBoundary(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  DetPlane startPlane(*(state.getPlane()));</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <a class="code" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> plane(<span class="keyword">new</span> DetPlane());</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iterations(0);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">if</span>(++iterations == maxIt) {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      Exception exc(<span class="stringliteral">&quot;RKTrackRep::extrapolateToSphere ==&gt; maximum number of iterations reached&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>.SetXYZ(state7[0], state7[1], state7[2]);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    dir.SetXYZ(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">// solve quadratic equation</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    TVector3 AO = (<a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a> - point);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordtype">double</span> dirAO = dir * AO;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordtype">double</span> arg = dirAO*dirAO - AO*AO + radius*radius;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span>(arg &lt; 0) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      Exception exc(<span class="stringliteral">&quot;RKTrackRep::extrapolateToSphere ==&gt; cannot solve&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordtype">double</span> term = sqrt(arg);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordtype">double</span> k1, k2;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    k1 = -dirAO + term;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    k2 = -dirAO - term;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">// select smallest absolute solution -&gt; closest cylinder surface</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">k</a> = k1;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">if</span> (fabs(k2)&lt;fabs(<a class="code" href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">k</a>))</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">k</a> = k2;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::extrapolateToSphere(); k = &quot;</span> &lt;&lt; <a class="code" href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">k</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a4761262924c3ec5c89e319afab5084a9">dest</a> = <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a> + <a class="code" href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">k</a> * dir;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    plane-&gt;setON(<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a4761262924c3ec5c89e319afab5084a9">dest</a>, <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a4761262924c3ec5c89e319afab5084a9">dest</a>-point);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    tracklength += this-&gt;<a class="code" href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d">Extrap</a>(startPlane, *plane, <a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state), isAtBoundary, state7, <span class="keyword">false</span>, NULL, <span class="keyword">true</span>, stopAtBoundary, maxStep);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// check break conditions</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (stopAtBoundary &amp;&amp; isAtBoundary) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>.SetXYZ(state7[0], state7[1], state7[2]);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      dir.SetXYZ(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      plane-&gt;setON(<a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>, <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>-point);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span>(fabs(<a class="code" href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">k</a>)&lt;<a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    startPlane = *plane;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordflow">if</span> (fillExtrapSteps) { <span class="comment">// now do the full extrapolation with covariance matrix</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// make use of the cache</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a0123543a15df51f8beaa98660cfa89b7">setPlane</a>(plane);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>, state7);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    tracklength = <a class="code" href="classgenfit_1_1RKTrackRep.html#ade2e4cf73880a2df757e9dd372bf7b00">extrapolateToPlane</a>(state, plane, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    state.setPlane(plane);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a>(state, state7);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a> = state;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">return</span> tracklength;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a72111e10145836e1357cf6fa1aa59b63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72111e10145836e1357cf6fa1aa59b63">&#9670;&nbsp;</a></span>extrapolateToSphere() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::extrapolateToSphere </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>point</em> = <code>TVector3(0.,&#160;0.,&#160;0.)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extrapolates the state to the sphere surface, and returns the extrapolation length and, via reference, the extrapolated state. </p>
<p>If stopAtBoundary is true, the extrapolation stops as soon as a material boundary is encountered.</p>
<p>If state has a covariance, jacobian and noise matrices will be calculated and the covariance will be propagated. If state has no covariance, jacobian and noise will only be calculated if calcJacobianNoise == true. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a7e6519f084e4ac5c58b3f3f8836cfbf0">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a71dffb5437351d65394a778a5cc0b5df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71dffb5437351d65394a778a5cc0b5df">&#9670;&nbsp;</a></span>extrapToPoint() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::extrapToPoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TMatrixDSym *&#160;</td>
          <td class="paramname"><em>G</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00246">246</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                  {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::extrapolateToPoint()\n&quot;</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a93996a7134dfba3449c78bf882de8720">checkCache</a>(state, NULL);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxIt(1000);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="comment">// to 7D</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a>(state, state7);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordtype">bool</span> fillExtrapSteps(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>MeasuredStateOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    fillExtrapSteps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (calcJacobianNoise)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    fillExtrapSteps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a>(0.), lastStep(0.), maxStep(1.E99), <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#ab2f042ac8d5c79bab81997961ad3ee23">angle</a>(0), distToPoca(0), tracklength(0);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  TVector3 dir(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacerunPythia8.html#a92b74818d4845c92d20cf34c4802c79d">G</a> != NULL) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacerunPythia8.html#a92b74818d4845c92d20cf34c4802c79d">G</a>-&gt;GetNrows() != 3) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      Exception exc(<span class="stringliteral">&quot;RKTrackRep::extrapolateToLine ==&gt; G is not 3x3&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    dir = TMatrix(*<a class="code" href="namespacerunPythia8.html#a92b74818d4845c92d20cf34c4802c79d">G</a>) * dir;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  TVector3 lastDir(0,0,0);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  TVector3 poca;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordtype">bool</span> isAtBoundary(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  DetPlane startPlane(*(state.getPlane()));</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> plane(<span class="keyword">new</span> DetPlane(point, dir));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iterations(0);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span>(++iterations == maxIt) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      Exception exc(<span class="stringliteral">&quot;RKTrackRep::extrapolateToPoint ==&gt; extrapolation to point failed, maximum number of iterations reached&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    lastStep = <a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    lastDir = dir;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a> = this-&gt;<a class="code" href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d">Extrap</a>(startPlane, *plane, <a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state), isAtBoundary, state7, <span class="keyword">false</span>, NULL, <span class="keyword">true</span>, stopAtBoundary, maxStep);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    tracklength += <a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    dir.SetXYZ(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacerunPythia8.html#a92b74818d4845c92d20cf34c4802c79d">G</a> != NULL) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      dir = TMatrix(*<a class="code" href="namespacerunPythia8.html#a92b74818d4845c92d20cf34c4802c79d">G</a>) * dir;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    poca.SetXYZ(state7[0], state7[1], state7[2]);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// check break conditions</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">if</span> (stopAtBoundary &amp;&amp; isAtBoundary) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      plane-&gt;setON(dir, poca);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#ab2f042ac8d5c79bab81997961ad3ee23">angle</a> = fabs(dir.Angle((point-poca))-TMath::PiOver2()); <span class="comment">// angle between direction and connection to point - 90 deg</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    distToPoca = (point-poca).Mag();</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#ab2f042ac8d5c79bab81997961ad3ee23">angle</a>*distToPoca &lt; 0.1*<a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// if lastStep and step have opposite sign, the real normal vector lies somewhere between the last two normal vectors (i.e. the directions)</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// -&gt; try mean value of the two (normalization not needed)</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (lastStep*<a class="code" href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">step</a> &lt; 0){</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      dir += lastDir;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      maxStep = 0.5*fabs(lastStep); <span class="comment">// make it converge!</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    startPlane = *plane;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    plane-&gt;setNormal(dir);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">if</span> (fillExtrapSteps) { <span class="comment">// now do the full extrapolation with covariance matrix</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// make use of the cache</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a0123543a15df51f8beaa98660cfa89b7">setPlane</a>(plane);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>, state7);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    tracklength = <a class="code" href="classgenfit_1_1RKTrackRep.html#ade2e4cf73880a2df757e9dd372bf7b00">extrapolateToPlane</a>(state, plane, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    state.setPlane(plane);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a>(state, state7);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::extrapolateToPoint(): Reached POCA after &quot;</span> &lt;&lt; iterations+1 &lt;&lt; <span class="stringliteral">&quot; iterations. Distance: &quot;</span> &lt;&lt; (point-poca).Mag() &lt;&lt; <span class="stringliteral">&quot; cm. Angle deviation: &quot;</span> &lt;&lt; dir.Angle((point-poca))-TMath::PiOver2() &lt;&lt; <span class="stringliteral">&quot; rad \n&quot;</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a> = state;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">return</span> tracklength;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af9a2cee136be1b13d26531ff2b1dbc23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9a2cee136be1b13d26531ff2b1dbc23">&#9670;&nbsp;</a></span>extrapToPoint() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::extrapToPoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TMatrixDSym *&#160;</td>
          <td class="paramname"><em>G</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopAtBoundary</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcJacobianNoise</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5e880395d30a6520d8a9aece5f0e36b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e880395d30a6520d8a9aece5f0e36b3">&#9670;&nbsp;</a></span>get6DCov() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixDSym genfit::RKTrackRep::get6DCov </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the 6D covariance. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#ad7b167d43973371da9284279ca352b0c">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00704">704</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                                                                        {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  TMatrixDSym cov(6);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a8f08fa06a70fdb7d6c5fe8b63bbe7c81">transformPM6</a>(state, *((<a class="code" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a>*) cov.GetMatrixArray()));</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">return</span> cov;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afd3b926fefc365621ce79d2e13b7be7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd3b926fefc365621ce79d2e13b7be7c">&#9670;&nbsp;</a></span>get6DCov() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TMatrixDSym genfit::RKTrackRep::get6DCov </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the 6D covariance. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#ad7b167d43973371da9284279ca352b0c">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a1b4f84851dbb33f617a52f9bbd3ccd8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b4f84851dbb33f617a52f9bbd3ccd8a">&#9670;&nbsp;</a></span>getBackwardJacobianAndNoise() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::getBackwardJacobianAndNoise </td>
          <td>(</td>
          <td class="paramtype">TMatrixD &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixDSym &amp;&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD &amp;&#160;</td>
          <td class="paramname"><em>deltaState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the jacobian and noise matrix of the last extrapolation if it would have been done in opposite direction. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#ab3a5dc2444864896ac2c4b9f0023a7f8">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00844">844</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                                                                                               {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::getBackwardJacobianAndNoise &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>.size() == 0) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::getBackwardJacobianAndNoise ==&gt; cache is empty. Extrapolation must run with a MeasuredStateOnPlane.&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  jacobian.ResizeTo(5,5);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  jacobian = <a class="code" href="classgenfit_1_1RKTrackRep.html#aafac71f71cc93a82aa42281d600b4776">fJacobian_</a>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="keywordflow">if</span> (!useInvertFast) {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    TDecompLU invertAlgo(jacobian);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="namespaceconvertRawData__muTestbeam.html#acc0e8c0a4e13c384547a75bbba32164c">status</a> = invertAlgo.Invert(jacobian);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespaceconvertRawData__muTestbeam.html#acc0e8c0a4e13c384547a75bbba32164c">status</a> == 0){</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      Exception e(<span class="stringliteral">&quot;cannot invert matrix, status = 0&quot;</span>, __LINE__,__FILE__);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      e.setFatal();</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordflow">throw</span> e;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordtype">double</span> det;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    jacobian.InvertFast(&amp;det);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">if</span>(det &lt; 1e-80){</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      Exception e(<span class="stringliteral">&quot;cannot invert matrix, status = 0&quot;</span>, __LINE__,__FILE__);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      e.setFatal();</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">throw</span> e;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  noise.ResizeTo(5,5);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  noise = <a class="code" href="classgenfit_1_1RKTrackRep.html#ae498a8cb248b5aa8dffb2555b6ca1925">fNoise_</a>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  noise.Similarity(jacobian);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="comment">// lastStartState_ = jacobian * lastEndState_  + deltaState</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  deltaState.ResizeTo(5);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  deltaState = <a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a3c89a0efae9b00bd44ee240aa9e6c843">getState</a>() - jacobian * <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a3c89a0efae9b00bd44ee240aa9e6c843">getState</a>();</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab686cd76fe00a4b67cecd42d8c9183b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab686cd76fe00a4b67cecd42d8c9183b9">&#9670;&nbsp;</a></span>getBackwardJacobianAndNoise() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void genfit::RKTrackRep::getBackwardJacobianAndNoise </td>
          <td>(</td>
          <td class="paramtype">TMatrixD &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixDSym &amp;&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD &amp;&#160;</td>
          <td class="paramname"><em>deltaState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the jacobian and noise matrix of the last extrapolation if it would have been done in opposite direction. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#ab3a5dc2444864896ac2c4b9f0023a7f8">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a33b8c25c6a34f361839aa7ac65769193"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33b8c25c6a34f361839aa7ac65769193">&#9670;&nbsp;</a></span>getCharge() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::getCharge </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the (fitted) charge of a state. This is not always equal the pdg charge (e.g. if the charge sign was flipped during the fit). </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a7afa73676edafab028f1f777dd40b770">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00712">712</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                                            {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>MeasurementOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::getCharge - cannot get charge from MeasurementOnPlane&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    exc.setFatal();</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordtype">double</span> pdgCharge = <a class="code" href="classgenfit_1_1AbsTrackRep.html#aaf70894cebf437f09c284953d7e60734">getPDGCharge</a>();</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="comment">// return pdgCharge with sign of q/p</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">if</span> (state.getState()(0) * pdgCharge &lt; 0)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">return</span> -pdgCharge;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">return</span> pdgCharge;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8213288fbf4d7b25e02b6a49440702a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8213288fbf4d7b25e02b6a49440702a9">&#9670;&nbsp;</a></span>getCharge() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::getCharge </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the (fitted) charge of a state. This is not always equal the pdg charge (e.g. if the charge sign was flipped during the fit). </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a7afa73676edafab028f1f777dd40b770">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a9fb36a12c29b84f73fe2243f65ae09b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fb36a12c29b84f73fe2243f65ae09b7">&#9670;&nbsp;</a></span>getDim() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int genfit::RKTrackRep::getDim </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the dimension of the state vector used by the track representation. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#ab73b2438fc8bc96ea96449b799c8f583">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00129">129</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;{<span class="keywordflow">return</span> 5;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9fb36a12c29b84f73fe2243f65ae09b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fb36a12c29b84f73fe2243f65ae09b7">&#9670;&nbsp;</a></span>getDim() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int genfit::RKTrackRep::getDim </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the dimension of the state vector used by the track representation. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#ab73b2438fc8bc96ea96449b799c8f583">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="trackReps_2include_2RKTrackRep_8h_source.html#l00134">134</a> of file <a class="el" href="trackReps_2include_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;{<span class="keywordflow">return</span> 5;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa96520234a875b14591c79214627c50c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa96520234a875b14591c79214627c50c">&#9670;&nbsp;</a></span>getForwardJacobianAndNoise() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::getForwardJacobianAndNoise </td>
          <td>(</td>
          <td class="paramtype">TMatrixD &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixDSym &amp;&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD &amp;&#160;</td>
          <td class="paramname"><em>deltaState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the jacobian and noise matrix of the last extrapolation. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#aaabf5d464819db19f5542ac201708772">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00820">820</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                                                                                                              {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  jacobian.ResizeTo(5,5);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  jacobian = <a class="code" href="classgenfit_1_1RKTrackRep.html#aafac71f71cc93a82aa42281d600b4776">fJacobian_</a>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  noise.ResizeTo(5,5);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  noise = <a class="code" href="classgenfit_1_1RKTrackRep.html#ae498a8cb248b5aa8dffb2555b6ca1925">fNoise_</a>;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="comment">// lastEndState_ = jacobian * lastStartState_  + deltaState</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  deltaState.ResizeTo(5);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">// Calculate this without temporaries:</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="comment">//deltaState = lastEndState_.getState() - jacobian * lastStartState_.getState()</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  deltaState = <a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a3c89a0efae9b00bd44ee240aa9e6c843">getState</a>();</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  deltaState *= jacobian;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  deltaState -= <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#a3c89a0efae9b00bd44ee240aa9e6c843">getState</a>();</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  deltaState *= -1;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;delta state : &quot;</span>; deltaState.Print();</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a100bb8b3cd47c4f13fb3fc8e044a1980"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a100bb8b3cd47c4f13fb3fc8e044a1980">&#9670;&nbsp;</a></span>getForwardJacobianAndNoise() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void genfit::RKTrackRep::getForwardJacobianAndNoise </td>
          <td>(</td>
          <td class="paramtype">TMatrixD &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixDSym &amp;&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD &amp;&#160;</td>
          <td class="paramname"><em>deltaState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the jacobian and noise matrix of the last extrapolation. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#aaabf5d464819db19f5542ac201708772">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a01ccd6e74c4750e434e89992e853ae30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01ccd6e74c4750e434e89992e853ae30">&#9670;&nbsp;</a></span>getMom() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVector3 genfit::RKTrackRep::getMom </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the cartesian momentum vector of a state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a5c793a4e2a75511b77a53ec977e2501b">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00677">677</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                                           {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a>(state, state7);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  TVector3 <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.SetMag(<a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state)/state7[6]);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac729ee4957d43f4531f7621599286bbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac729ee4957d43f4531f7621599286bbf">&#9670;&nbsp;</a></span>getMom() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TVector3 genfit::RKTrackRep::getMom </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the cartesian momentum vector of a state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a5c793a4e2a75511b77a53ec977e2501b">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="ab7f24c1004c5693d405225be56ec007c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7f24c1004c5693d405225be56ec007c">&#9670;&nbsp;</a></span>getMomMag() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::getMomMag </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get the magnitude of the momentum in GeV. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a8ee4e8ae6b8b57c401bbccb659647e21">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00730">730</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                                                            {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="comment">// p = q / qop</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a> = <a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state)/state.getState()(0);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  assert (<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a>&gt;=0);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af2dc54584a27cddd473186cea5e23206"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2dc54584a27cddd473186cea5e23206">&#9670;&nbsp;</a></span>getMomMag() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::getMomMag </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get the magnitude of the momentum in GeV. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a8ee4e8ae6b8b57c401bbccb659647e21">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="ab0993fd7e2150032f83508291c9aa713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0993fd7e2150032f83508291c9aa713">&#9670;&nbsp;</a></span>getMomVar() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::getMomVar </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get the variance of the absolute value of the momentum . </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a24ebac1b00dcdac1d80d786b93721a4d">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00738">738</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                                                    {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>MeasurementOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::getMomVar - cannot get momVar from MeasurementOnPlane&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    exc.setFatal();</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="comment">// p(qop) = q/qop</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="comment">// dp/d(qop) = - q / (qop^2)</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="comment">// (delta p) = (delta qop) * |dp/d(qop)| = delta qop * |q / (qop^2)|</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="comment">// (var p) = (var qop) * q^2 / (qop^4)</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="comment">// delta means sigma</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="comment">// cov(0,0) is sigma^2</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">return</span> state.getCov()(0,0) * pow(<a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state), 2)  / pow(state.getState()(0), 4);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a82d4e2aca5f1636f0d8a21ac099f69b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82d4e2aca5f1636f0d8a21ac099f69b0">&#9670;&nbsp;</a></span>getMomVar() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::getMomVar </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get the variance of the absolute value of the momentum . </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a24ebac1b00dcdac1d80d786b93721a4d">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="adf4865558fe7b54ffe94c3e145344505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf4865558fe7b54ffe94c3e145344505">&#9670;&nbsp;</a></span>getPos() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVector3 genfit::RKTrackRep::getPos </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the cartesian position of a state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a8a5f4ef901011b30ecfaa612ae993c80">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00669">669</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                                           {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a>(state, state7);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordflow">return</span> TVector3(state7[0], state7[1], state7[2]);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af8043122392aed738fa1596b74cfa957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8043122392aed738fa1596b74cfa957">&#9670;&nbsp;</a></span>getPos() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual TVector3 genfit::RKTrackRep::getPos </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the cartesian position of a state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a8a5f4ef901011b30ecfaa612ae993c80">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a35723de16e1bae56aeb8a7ca098b2b9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35723de16e1bae56aeb8a7ca098b2b9e">&#9670;&nbsp;</a></span>getPosMom() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::getPosMom </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVector3 &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVector3 &amp;&#160;</td>
          <td class="paramname"><em>mom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get cartesian position and momentum vector of a state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a0c07d65d1102e91c2856e02590d1d99b">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00687">687</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                                                                        {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a>(state, state7);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>.SetXYZ(state7[0], state7[1], state7[2]);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.SetXYZ(state7[3], state7[4], state7[5]);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.SetMag(<a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state)/state7[6]);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aece5f6f41109186ac8116a1311c2c702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aece5f6f41109186ac8116a1311c2c702">&#9670;&nbsp;</a></span>getPosMom() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void genfit::RKTrackRep::getPosMom </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVector3 &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVector3 &amp;&#160;</td>
          <td class="paramname"><em>mom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get cartesian position and momentum vector of a state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a0c07d65d1102e91c2856e02590d1d99b">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="ad94153c3713eeff5ee143ab21902de62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad94153c3713eeff5ee143ab21902de62">&#9670;&nbsp;</a></span>getPosMomCov() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::getPosMomCov </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVector3 &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVector3 &amp;&#160;</td>
          <td class="paramname"><em>mom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixDSym &amp;&#160;</td>
          <td class="paramname"><em>cov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Translates <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html" title="StateOnPlane with additional covariance matrix.">MeasuredStateOnPlane</a> into 3D position, momentum and 6x6 covariance. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#ae6f4c4eeb3e4fbadcc930f53e2ca4ad7">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00697">697</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                                                                                                                     {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a35723de16e1bae56aeb8a7ca098b2b9e">getPosMom</a>(state, <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>, <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  cov.ResizeTo(6,6);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a8f08fa06a70fdb7d6c5fe8b63bbe7c81">transformPM6</a>(state, *((<a class="code" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a>*) cov.GetMatrixArray()));</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a365af2b96444bab71d5acb3cd75318c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a365af2b96444bab71d5acb3cd75318c3">&#9670;&nbsp;</a></span>getPosMomCov() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void genfit::RKTrackRep::getPosMomCov </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVector3 &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVector3 &amp;&#160;</td>
          <td class="paramname"><em>mom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixDSym &amp;&#160;</td>
          <td class="paramname"><em>cov</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Translates <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html" title="StateOnPlane with additional covariance matrix.">MeasuredStateOnPlane</a> into 3D position, momentum and 6x6 covariance. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#ae6f4c4eeb3e4fbadcc930f53e2ca4ad7">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a2a57b696edac7ed33608d10053f255d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a57b696edac7ed33608d10053f255d6">&#9670;&nbsp;</a></span>getQop() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::getQop </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get charge over momentum. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a3d1a7d87cdd3c52fa414d4c7fbf8eddf">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00142">142</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;{<span class="keywordflow">return</span> state.getState()(0);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a57b696edac7ed33608d10053f255d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a57b696edac7ed33608d10053f255d6">&#9670;&nbsp;</a></span>getQop() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::getQop </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get charge over momentum. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a3d1a7d87cdd3c52fa414d4c7fbf8eddf">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="trackReps_2include_2RKTrackRep_8h_source.html#l00147">147</a> of file <a class="el" href="trackReps_2include_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{<span class="keywordflow">return</span> state.getState()(0);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaaaf31bac6cfa342cfb5560ec2f1f3d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaaf31bac6cfa342cfb5560ec2f1f3d0">&#9670;&nbsp;</a></span>getRadiationLenght() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::getRadiationLenght </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the accumulated X/X0 (path / radiation length) of the material crossed in the last extrapolation. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a54ff32818d4df01dfee9dcb8f9b0ed39">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00905">905</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                            {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="comment">// Todo: test</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.size() == 0) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::getRadiationLenght ==&gt; cache is empty.&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="keywordtype">double</span> radLen(0);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> = 0; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>&lt;<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.size(); ++<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>) {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    radLen += <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>).matStep_.stepSize_ / <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>).matStep_.materialProperties_.getRadLen();</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="keywordflow">return</span> radLen;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a74fb80a21741cc6d9290b21addba6c75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74fb80a21741cc6d9290b21addba6c75">&#9670;&nbsp;</a></span>getRadiationLenght() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::getRadiationLenght </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the accumulated X/X0 (path / radiation length) of the material crossed in the last extrapolation. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a54ff32818d4df01dfee9dcb8f9b0ed39">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a177f273f4dc3d7d1eaa646fe5a70aaf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a177f273f4dc3d7d1eaa646fe5a70aaf3">&#9670;&nbsp;</a></span>getSpu() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::getSpu </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00758">758</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                                                         {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>MeasurementOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::getSpu - cannot get spu from MeasurementOnPlane&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    exc.setFatal();</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keyword">const</span> TVectorD&amp; auxInfo = state.getAuxInfo();</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keywordflow">if</span> (auxInfo.GetNrows() == 1)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">return</span> state.getAuxInfo()(0);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">return</span> 1.;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a177f273f4dc3d7d1eaa646fe5a70aaf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a177f273f4dc3d7d1eaa646fe5a70aaf3">&#9670;&nbsp;</a></span>getSpu() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::getSpu </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abaa7f24fb07657e16fc24eb4340e79ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaa7f24fb07657e16fc24eb4340e79ed">&#9670;&nbsp;</a></span>getState5() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::getState5 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01385">1385</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                                                                        {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <span class="comment">// state5: (q/p, u&#39;, v&#39;. u, v)</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160; </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  <span class="keywordtype">double</span> spu(1.);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="keyword">const</span> TVector3&amp; O(state.getPlane()-&gt;getO());</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="keyword">const</span> TVector3&amp; U(state.getPlane()-&gt;getU());</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="keyword">const</span> TVector3&amp; <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>(state.getPlane()-&gt;getV());</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <span class="keyword">const</span> TVector3&amp; W(state.getPlane()-&gt;getNormal());</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160; </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  TVector3 posShift(state7[0], state7[1], state7[2]);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  posShift -= state.getPlane()-&gt;getO();</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160; </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  <span class="comment">// force A to be in normal direction and set spu accordingly</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <span class="keywordtype">double</span> AtW = state7[3]*W.X() + state7[4]*W.Y() + state7[5]*W.Z();</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="keywordflow">if</span> (AtW &lt; 0) {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="comment">//fDir *= -1.;</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="comment">//AtW *= -1.;</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    spu = -1.;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  }</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  TVectorD&amp; state5 = state.getState();</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; </div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  state5(0) = state7[6]; <span class="comment">// q/p</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  state5(1) = (state7[3]*U.X() + state7[4]*U.Y() + state7[5]*U.Z()) / AtW; <span class="comment">// u&#39; = (A * U) / (A * W)</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  state5(2) = (state7[3]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X() + state7[4]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y() + state7[5]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z()) / AtW; <span class="comment">// v&#39; = (A * V) / (A * W)</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  state5(3) = ((state7[0]-O.X())*U.X() +</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;               (state7[1]-O.Y())*U.Y() +</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;               (state7[2]-O.Z())*U.Z()); <span class="comment">// u = (pos - O) * U</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  state5(4) = ((state7[0]-O.X())*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X() +</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;               (state7[1]-O.Y())*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y() +</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;               (state7[2]-O.Z())*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z()); <span class="comment">// v = (pos - O) * V</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a324ba092d634f324285f445b4bba12b6">setSpu</a>(state, spu);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160; </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abaa7f24fb07657e16fc24eb4340e79ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaa7f24fb07657e16fc24eb4340e79ed">&#9670;&nbsp;</a></span>getState5() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::getState5 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a64a99eb10c8052a950ad68376257e7dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64a99eb10c8052a950ad68376257e7dd">&#9670;&nbsp;</a></span>getState7() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::getState7 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01351">1351</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                                                                        {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>MeasurementOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::getState7 - cannot get pos or mom from a MeasurementOnPlane&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    exc.setFatal();</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="keyword">const</span> TVector3&amp; U(state.getPlane()-&gt;getU());</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keyword">const</span> TVector3&amp; <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>(state.getPlane()-&gt;getV());</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keyword">const</span> TVector3&amp; O(state.getPlane()-&gt;getO());</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keyword">const</span> TVector3&amp; W(state.getPlane()-&gt;getNormal());</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  assert(state.getState().GetNrows() == 5);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span>* state5 = state.getState().GetMatrixArray();</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordtype">double</span> spu = <a class="code" href="classgenfit_1_1RKTrackRep.html#a177f273f4dc3d7d1eaa646fe5a70aaf3">getSpu</a>(state);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  state7[0] = O.X() + state5[3]*U.X() + state5[4]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X(); <span class="comment">// x</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  state7[1] = O.Y() + state5[3]*U.Y() + state5[4]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y(); <span class="comment">// y</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  state7[2] = O.Z() + state5[3]*U.Z() + state5[4]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z(); <span class="comment">// z</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; </div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  state7[3] = spu * (W.X() + state5[1]*U.X() + state5[2]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X()); <span class="comment">// a_x</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  state7[4] = spu * (W.Y() + state5[1]*U.Y() + state5[2]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y()); <span class="comment">// a_y</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  state7[5] = spu * (W.Z() + state5[1]*U.Z() + state5[2]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z()); <span class="comment">// a_z</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160; </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  <span class="comment">// normalize dir</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <span class="keywordtype">double</span> norm = 1. / sqrt(state7[3]*state7[3] + state7[4]*state7[4] + state7[5]*state7[5]);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>=3; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>&lt;6; ++<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>) state7[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>] *= norm;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  state7[6] = state5[0]; <span class="comment">// q/p</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a64a99eb10c8052a950ad68376257e7dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64a99eb10c8052a950ad68376257e7dd">&#9670;&nbsp;</a></span>getState7() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::getState7 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a71750034f38aa93a3941ae3ae3d3533e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71750034f38aa93a3941ae3ae3d3533e">&#9670;&nbsp;</a></span>getSteps() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structgenfit_1_1MatStep.html">genfit::MatStep</a> &gt; genfit::RKTrackRep::getSteps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get stepsizes and material properties of crossed materials of the last extrapolation. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a81c8842b2afc5f6036353760d82c8bd2">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00885">885</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                                                    {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="comment">// Todo: test</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.size() == 0) {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::getSteps ==&gt; cache is empty.&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  }</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  std::vector&lt;MatStep&gt; retVal;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  retVal.reserve(<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.size());</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> = 0; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>&lt;<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.size(); ++<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>) {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    retVal.push_back(<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>].matStep_);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="keywordflow">return</span> retVal;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aff5d9a16cfa0c3f02698467f2ef1e27e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff5d9a16cfa0c3f02698467f2ef1e27e">&#9670;&nbsp;</a></span>getSteps() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structgenfit_1_1MatStep.html">genfit::MatStep</a>&gt; genfit::RKTrackRep::getSteps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get stepsizes and material properties of crossed materials of the last extrapolation. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a81c8842b2afc5f6036353760d82c8bd2">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a78bd680b2fee363204b524fe76f988b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78bd680b2fee363204b524fe76f988b9">&#9670;&nbsp;</a></span>getTOF() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::getTOF </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the time of flight [ns] of the last extrapolation. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a2eab8d93e8b6f8df544f7813779ae523">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00924">924</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="comment">// Todo: test</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.size() == 0) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::getTOF ==&gt; cache is empty.&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="ShipBellField_8cxx.html#a42d42dd2c682d42f11de58e34c89f895">m</a> = <a class="code" href="classgenfit_1_1AbsTrackRep.html#a7f0073f2446a780e27886ab512e7787f">getMass</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>); <span class="comment">// GeV</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="namespacehepunit.html#a8b7a286d413f2209e2192b2bbdc4ce0a">m2</a> = <a class="code" href="ShipBellField_8cxx.html#a42d42dd2c682d42f11de58e34c89f895">m</a>*<a class="code" href="ShipBellField_8cxx.html#a42d42dd2c682d42f11de58e34c89f895">m</a>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespacehnl.html#adb7ba50b8941bf3badea16f97cb665d5">c</a> = TMath::Ccgs(); <span class="comment">// cm/s</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordtype">double</span> p1(0), p2(0), trackLen(0), <a class="code" href="namespacemakeCascade.html#a0ea591e7333fcfd50fb131ada5ef2ead">beta</a>(0);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keywordtype">double</span> tof(0);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  p1 = <a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#ae524fe7b14b36572372ee7553557d37c">getMomMag</a>();</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> = 0; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>&lt;<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.size(); ++<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    trackLen = <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>].matStep_.stepSize_; <span class="comment">// [cm]</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    p2 = <a class="code" href="classgenfit_1_1RKTrackRep.html#a56e2cafc817e0e489e7a183c9bc8d549">momMag</a>(<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>].state7_);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">if</span> (fabs(p1-p2) &lt; 1<a class="code" href="namespacemakeMuonDIS.html#ad916c51f2653b60d746cf521ef14f685">E</a>-6) {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a> = (p1+p2)/2.;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <a class="code" href="namespacemakeCascade.html#a0ea591e7333fcfd50fb131ada5ef2ead">beta</a> = <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a> / sqrt(<a class="code" href="namespacehepunit.html#a8b7a286d413f2209e2192b2bbdc4ce0a">m2</a> + <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a>*<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a>);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      tof += 1.E9 * trackLen / (<a class="code" href="namespacehnl.html#adb7ba50b8941bf3badea16f97cb665d5">c</a>*<a class="code" href="namespacemakeCascade.html#a0ea591e7333fcfd50fb131ada5ef2ead">beta</a>); <span class="comment">// [ns]</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    }</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="comment">// assume linear momentum loss</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      tof += 1.E9 / <a class="code" href="namespacehnl.html#adb7ba50b8941bf3badea16f97cb665d5">c</a> / (p1 - p2) * trackLen *</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;             (sqrt(<a class="code" href="namespacehepunit.html#a8b7a286d413f2209e2192b2bbdc4ce0a">m2</a> + p1*p1) - sqrt(<a class="code" href="namespacehepunit.html#a8b7a286d413f2209e2192b2bbdc4ce0a">m2</a> + p2*p2) +</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;              <a class="code" href="ShipBellField_8cxx.html#a42d42dd2c682d42f11de58e34c89f895">m</a> * <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a5922b10e23818a4485857b715589241e">log</a>( p1/p2 * (<a class="code" href="ShipBellField_8cxx.html#a42d42dd2c682d42f11de58e34c89f895">m</a> + sqrt(<a class="code" href="namespacehepunit.html#a8b7a286d413f2209e2192b2bbdc4ce0a">m2</a> + p2*p2)) / (<a class="code" href="ShipBellField_8cxx.html#a42d42dd2c682d42f11de58e34c89f895">m</a> + sqrt(<a class="code" href="namespacehepunit.html#a8b7a286d413f2209e2192b2bbdc4ce0a">m2</a> + p1*p1)) ) ); <span class="comment">// [ns]</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    p1 = p2;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">return</span> tof;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae71e36989f017cc990fdd47e87bc4447"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae71e36989f017cc990fdd47e87bc4447">&#9670;&nbsp;</a></span>getTOF() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double genfit::RKTrackRep::getTOF </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the time of flight [ns] of the last extrapolation. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a2eab8d93e8b6f8df544f7813779ae523">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a03a4f035cc4162ea33556eb6da224150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03a4f035cc4162ea33556eb6da224150">&#9670;&nbsp;</a></span>initArrays() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::initArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01332">1332</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                                  {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  memset(<a class="code" href="classgenfit_1_1RKTrackRep.html#a889ad368e5c5c6ac870402c9420b2bb8">noiseArray_</a>, 0x00, 7*7*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  memset(<a class="code" href="classgenfit_1_1RKTrackRep.html#a210279ccff463e20ea47b345a288f1d0">noiseProjection_</a>, 0x00, 7*7*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>=0; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>&lt;7; ++<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>) <span class="comment">// initialize as diagonal matrix</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#a210279ccff463e20ea47b345a288f1d0">noiseProjection_</a>[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>*8] = 1;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  memset(<a class="code" href="classgenfit_1_1RKTrackRep.html#a41dcd53004ff44e12a924084b37cad8c">J_MMT_</a>,      0x00, 7*7*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160; </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#aafac71f71cc93a82aa42281d600b4776">fJacobian_</a>.UnitMatrix();</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae498a8cb248b5aa8dffb2555b6ca1925">fNoise_</a>.Zero();</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a0d72d0cf8fed127c8599c11283374288">limits_</a>.<a class="code" href="classgenfit_1_1StepLimits.html#ada8640542f6d6fc3f9467bf08d8ad777">reset</a>();</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.reserve(100);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">ExtrapSteps_</a>.reserve(100);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160; </div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">lastStartState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#ad574c9e4ef45aed61bab1f7b99e221db">getAuxInfo</a>().ResizeTo(1);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">lastEndState_</a>.<a class="code" href="classgenfit_1_1StateOnPlane.html#ad574c9e4ef45aed61bab1f7b99e221db">getAuxInfo</a>().ResizeTo(1);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a03a4f035cc4162ea33556eb6da224150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03a4f035cc4162ea33556eb6da224150">&#9670;&nbsp;</a></span>initArrays() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::initArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa8ca7fc3eb20ddf0e8712b6a1f720356"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8ca7fc3eb20ddf0e8712b6a1f720356">&#9670;&nbsp;</a></span>isSame() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool genfit::RKTrackRep::isSame </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> *&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>check if other is of same type (e.g. <a class="el" href="classgenfit_1_1RKTrackRep.html" title="AbsTrackRep with 5D track parameterization in plane coordinates: (q/p, u&#39;, v&#39;, u, v)">RKTrackRep</a>) and has same pdg code. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#aa494bd47979b66da699f25456058cad8">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l02502">2502</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                                                {</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#a718e040ec8f22ef738af7c9005355443">getPDG</a>() != other-&gt;getPDG())</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160; </div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classgenfit_1_1RKTrackRep.html#ae8e39563fac26c69d88f3408ba6de39e">isSameType</a>(other);</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acc17228d76c6656b308bbcf4e4ee8a7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc17228d76c6656b308bbcf4e4ee8a7d">&#9670;&nbsp;</a></span>isSame() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool genfit::RKTrackRep::isSame </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> *&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>check if other is of same type (e.g. <a class="el" href="classgenfit_1_1RKTrackRep.html" title="AbsTrackRep with 5D track parameterization in plane coordinates: (q/p, u&#39;, v&#39;, u, v)">RKTrackRep</a>) and has same pdg code. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#aa494bd47979b66da699f25456058cad8">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="ae8e39563fac26c69d88f3408ba6de39e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8e39563fac26c69d88f3408ba6de39e">&#9670;&nbsp;</a></span>isSameType() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool genfit::RKTrackRep::isSameType </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> *&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>check if other is of same type (e.g. <a class="el" href="classgenfit_1_1RKTrackRep.html" title="AbsTrackRep with 5D track parameterization in plane coordinates: (q/p, u&#39;, v&#39;, u, v)">RKTrackRep</a>). </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a233a8d540b378ae604b2ce9e8d894360">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l02494">2494</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                                                    {</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classgenfit_1_1RKTrackRep.html#aca0b07380cd50f63eef644ebda8252ce">RKTrackRep</a>*<span class="keyword">&gt;</span>(other) == NULL)</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160; </div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a48d03ccf2fe92bda3fc13ef7878e58a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48d03ccf2fe92bda3fc13ef7878e58a1">&#9670;&nbsp;</a></span>isSameType() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool genfit::RKTrackRep::isSameType </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1AbsTrackRep.html">AbsTrackRep</a> *&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>check if other is of same type (e.g. <a class="el" href="classgenfit_1_1RKTrackRep.html" title="AbsTrackRep with 5D track parameterization in plane coordinates: (q/p, u&#39;, v&#39;, u, v)">RKTrackRep</a>). </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a233a8d540b378ae604b2ce9e8d894360">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="aaa88e29e08c9e0991f85c10d69c5f673"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa88e29e08c9e0991f85c10d69c5f673">&#9670;&nbsp;</a></span>makePlane()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> genfit::RKTrackRep::makePlane </td>
          <td>(</td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00079">79</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                                                                         {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> plane = <a class="code" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a>(<span class="keyword">new</span> DetPlane(o,u,<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a2309e9fc8c297156c5977adca2c8a4cb">v</a>));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">return</span> plane;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a56e2cafc817e0e489e7a183c9bc8d549"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56e2cafc817e0e489e7a183c9bc8d549">&#9670;&nbsp;</a></span>momMag() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::momMag </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l02488">2488</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                                                  {</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;  <span class="keywordtype">double</span> momMag2 = state7[3]*state7[3] + state7[4]*state7[4] + state7[5]*state7[5];</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;  <span class="keywordflow">return</span> sqrt(momMag2);</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a56e2cafc817e0e489e7a183c9bc8d549"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56e2cafc817e0e489e7a183c9bc8d549">&#9670;&nbsp;</a></span>momMag() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::momMag </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adcd6b3f8bd742ea90f3d890ff01452c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcd6b3f8bd742ea90f3d890ff01452c3">&#9670;&nbsp;</a></span>pocaOnLine() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVector3 genfit::RKTrackRep::pocaOnLine </td>
          <td>(</td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>linePoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>lineDirection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>point</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l02189">2189</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                                                                                                                     {</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  TVector3 retVal(lineDirection);</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160; </div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="namespacerun__simScript.html#a7438ba4e0f241567d8e58065969d5ab5">t</a> = 1./(retVal.Mag2()) * ((point*retVal) - (linePoint*retVal));</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  retVal *= <a class="code" href="namespacerun__simScript.html#a7438ba4e0f241567d8e58065969d5ab5">t</a>;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  retVal += linePoint;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <span class="keywordflow">return</span> retVal; <span class="comment">// = linePoint + t*lineDirection</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; </div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adcd6b3f8bd742ea90f3d890ff01452c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcd6b3f8bd742ea90f3d890ff01452c3">&#9670;&nbsp;</a></span>pocaOnLine() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVector3 genfit::RKTrackRep::pocaOnLine </td>
          <td>(</td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>linePoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>lineDirection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>point</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="affa6945eaba3b0f2b143d039967b834e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affa6945eaba3b0f2b143d039967b834e">&#9670;&nbsp;</a></span>RKPropagate() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::RKPropagate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> *&#160;</td>
          <td class="paramname"><em>jacobian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> &amp;&#160;</td>
          <td class="paramname"><em>SA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>varField</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcOnlyLastRowOfJ</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The actual Runge Kutta propagation. </p>
<p>propagate state7 with step S. Fills SA (Start directions derivatives dA/S). If jacobian is NULL, only the state is propagated, otherwise also the 7x7 jacobian is calculated. If varField is false, the magnetic field will only be evaluated at the starting position. The return value is an estimation on how good the extrapolation is, and it is usually fine if it is &gt; 1. It gives a suggestion how you must scale S so that the quality will be sufficient. </p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01143">1143</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                                       {</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="comment">// important fixed numbers</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> EC     = 0.000149896229;  <span class="comment">// c/(2*10^12) resp. c/2Tera</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> P3     = 1./3.;           <span class="comment">// 1/3</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> DLT    = .0002;           <span class="comment">// max. deviation for approximation-quality test</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespacemakeDecay.html#ad0cca2a83c59bb283ee59cc30dc2ea4b">par</a> = 1./3.081615;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="comment">// Aux parameters</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>&amp;   <a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>           = *((<a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>*) &amp;state7[0]);       <span class="comment">// Start coordinates  [cm]  (x,  y,  z)</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>&amp;   <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>           = *((<a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>*) &amp;state7[3]);       <span class="comment">// Start directions         (ax, ay, az);   ax^2+ay^2+az^2=1</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="keywordtype">double</span>  S3(0), S4(0), PS2(0);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>     H0 = {0.,0.,0.}, H1 = {0.,0.,0.}, H2 = {0.,0.,0.};</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>     <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a> = {0.,0.,0.};</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="comment">// Variables for Runge Kutta solver</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordtype">double</span>   A0(0), A1(0), A2(0), A3(0), A4(0), A5(0), A6(0);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keywordtype">double</span>   B0(0), B1(0), B2(0), B3(0), B4(0), B5(0), B6(0);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="keywordtype">double</span>   C0(0), C1(0), C2(0), C3(0), C4(0), C5(0), C6(0);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="comment">// Runge Kutta Extrapolation</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  S3 = P3*S;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  S4 = 0.25*S;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  PS2 = state7[6]*EC * S;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="comment">// First point</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[0] = <a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[0];           <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[1] = <a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[1];           <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[2]=<a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[2];</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <a class="code" href="classgenfit_1_1FieldManager.html#aaf0b56fea4f0deb428de8749febf792d">FieldManager::getInstance</a>()-&gt;<a class="code" href="classgenfit_1_1FieldManager.html#a7432ac0fd7ad0d3249ca4546a8ead6cb">getFieldVal</a>(<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[0], <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[1], <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[2], H0[0], H0[1], H0[2]);       <span class="comment">// magnetic field in 10^-1 T = kGauss</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  H0[0] *= PS2; H0[1] *= PS2; H0[2] *= PS2;     <span class="comment">// H0 is PS2*(Hx, Hy, Hz) @ R0</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  A0 = <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]*H0[2]-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]*H0[1]; B0 = <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]*H0[0]-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]*H0[2]; C0 = <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]*H0[1]-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]*H0[0]; <span class="comment">// (ax, ay, az) x H0</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  A2 = <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]+A0              ; B2 = <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]+B0              ; C2 = <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]+C0              ; <span class="comment">// (A0, B0, C0) + (ax, ay, az)</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  A1 = A2+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]              ; B1 = B2+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]              ; C1 = C2+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]              ; <span class="comment">// (A0, B0, C0) + 2*(ax, ay, az)</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="comment">// Second point</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keywordflow">if</span> (varField) {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[0] += A1*S4;         <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[1] += B1*S4;         <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[2] += C1*S4;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <a class="code" href="classgenfit_1_1FieldManager.html#aaf0b56fea4f0deb428de8749febf792d">FieldManager::getInstance</a>()-&gt;<a class="code" href="classgenfit_1_1FieldManager.html#a7432ac0fd7ad0d3249ca4546a8ead6cb">getFieldVal</a>(<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[0], <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[1], <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[2], H1[0], H1[1], H1[2]);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    H1[0] *= PS2; H1[1] *= PS2; H1[2] *= PS2; <span class="comment">// H1 is PS2*(Hx, Hy, Hz) @ (x, y, z) + 0.25*S * [(A0, B0, C0) + 2*(ax, ay, az)]</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  }</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="keywordflow">else</span> { H1[0] = H0[0]; H1[1] = H0[1]; H1[2] = H0[2];  }; <span class="comment">// invalid: H1 = H0; !!</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  A3 = B2*H1[2]-C2*H1[1]+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]; B3 = C2*H1[0]-A2*H1[2]+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]; C3 = A2*H1[1]-B2*H1[0]+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]; <span class="comment">// (A2, B2, C2) x H1 + (ax, ay, az)</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  A4 = B3*H1[2]-C3*H1[1]+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]; B4 = C3*H1[0]-A3*H1[2]+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]; C4 = A3*H1[1]-B3*H1[0]+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]; <span class="comment">// (A3, B3, C3) x H1 + (ax, ay, az)</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  A5 = A4-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]+A4            ; B5 = B4-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]+B4            ; C5 = C4-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]+C4            ; <span class="comment">//    2*(A4, B4, C4) - (ax, ay, az)</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="comment">// Last point</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="keywordflow">if</span> (varField) {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[0]=<a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[0]+S*A4;         <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[1]=<a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[1]+S*B4;         <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[2]=<a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[2]+S*C4;  <span class="comment">//setup.Field(r,H2);</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="classgenfit_1_1FieldManager.html#aaf0b56fea4f0deb428de8749febf792d">FieldManager::getInstance</a>()-&gt;<a class="code" href="classgenfit_1_1FieldManager.html#a7432ac0fd7ad0d3249ca4546a8ead6cb">getFieldVal</a>(<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[0], <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[1], <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">r</a>[2], H2[0], H2[1], H2[2]);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    H2[0] *= PS2; H2[1] *= PS2; H2[2] *= PS2; <span class="comment">// H2 is PS2*(Hx, Hy, Hz) @ (x, y, z) + 0.25*S * (A4, B4, C4)</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="keywordflow">else</span> { H2[0] = H0[0]; H2[1] = H0[1]; H2[2] = H0[2];  }; <span class="comment">// invalid: H2 = H0; !!</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  A6 = B5*H2[2]-C5*H2[1]; B6 = C5*H2[0]-A5*H2[2]; C6 = A5*H2[1]-B5*H2[0]; <span class="comment">// (A5, B5, C5) x H2</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="comment">// Derivatives of track parameters</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="keywordflow">if</span>(jacobianT != NULL){</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="comment">// jacobianT</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="comment">// 1 0 0 0 0 0 0</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="comment">// 0 1 0 0 0 0 0</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="comment">// 0 0 1 0 0 0 0</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="comment">// x x x x x x 0</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="comment">// x x x x x x 0</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="comment">// x x x x x x 0</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="comment">// x x x x x x 1</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordtype">double</span>   dA0(0), dA2(0), dA3(0), dA4(0), dA5(0), dA6(0);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordtype">double</span>   dB0(0), dB2(0), dB3(0), dB4(0), dB5(0), dB6(0);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordtype">double</span>   dC0(0), dC2(0), dC3(0), dC4(0), dC5(0), dC6(0);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#abaf58c8e5683cef7081a12d534f05739">start</a>(0);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">if</span> (!calcOnlyLastRowOfJ) {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="keywordflow">if</span> (!varField) {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="comment">// d(x, y, z)/d(x, y, z) submatrix is unit matrix</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        (*jacobianT)[0] = 1;  (*jacobianT)[8] = 1;  (*jacobianT)[16] = 1;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="comment">// d(ax, ay, az)/d(ax, ay, az) submatrix is 0</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <span class="comment">// start with d(x, y, z)/d(ax, ay, az)</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#abaf58c8e5683cef7081a12d534f05739">start</a> = 3;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>=<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#abaf58c8e5683cef7081a12d534f05739">start</a>*7; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>&lt;42; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+=7) {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="comment">//first point</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        dA0 = H0[2]*(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4]-H0[1]*(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5];    <span class="comment">// dA0/dp }</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        dB0 = H0[0]*(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5]-H0[2]*(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3];    <span class="comment">// dB0/dp  } = dA x H0</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        dC0 = H0[1]*(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3]-H0[0]*(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4];    <span class="comment">// dC0/dp }</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        dA2 = dA0+(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3];        <span class="comment">// }</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        dB2 = dB0+(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4];        <span class="comment">//  } = (dA0, dB0, dC0) + dA</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        dC2 = dC0+(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5];        <span class="comment">// }</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <span class="comment">//second point</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        dA3 = (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3]+dB2*H1[2]-dC2*H1[1];    <span class="comment">// dA3/dp }</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        dB3 = (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4]+dC2*H1[0]-dA2*H1[2];    <span class="comment">// dB3/dp  } = dA + (dA2, dB2, dC2) x H1</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        dC3 = (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5]+dA2*H1[1]-dB2*H1[0];    <span class="comment">// dC3/dp }</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160; </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        dA4 = (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3]+dB3*H1[2]-dC3*H1[1];    <span class="comment">// dA4/dp }</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        dB4 = (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4]+dC3*H1[0]-dA3*H1[2];    <span class="comment">// dB4/dp  } = dA + (dA3, dB3, dC3) x H1</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        dC4 = (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5]+dA3*H1[1]-dB3*H1[0];    <span class="comment">// dC4/dp }</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <span class="comment">//last point</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        dA5 = dA4+dA4-(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3];      <span class="comment">// }</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        dB5 = dB4+dB4-(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4];      <span class="comment">//  } =  2*(dA4, dB4, dC4) - dA</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        dC5 = dC4+dC4-(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5];      <span class="comment">// }</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160; </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        dA6 = dB5*H2[2]-dC5*H2[1];      <span class="comment">// dA6/dp }</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        dB6 = dC5*H2[0]-dA5*H2[2];      <span class="comment">// dB6/dp  } = (dA5, dB5, dC5) x H2</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        dC6 = dA5*H2[1]-dB5*H2[0];      <span class="comment">// dC6/dp }</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="comment">// this gives the same results as multiplying the old with the new Jacobian</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>]   += (dA2+dA3+dA4)*S3;  (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3] = ((dA0+2.*dA3)+(dA5+dA6))*P3; <span class="comment">// dR := dR + S3*[(dA2, dB2, dC2) +   (dA3, dB3, dC3) + (dA4, dB4, dC4)]</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+1] += (dB2+dB3+dB4)*S3;  (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4] = ((dB0+2.*dB3)+(dB5+dB6))*P3; <span class="comment">// dA :=     1/3*[(dA0, dB0, dC0) + 2*(dA3, dB3, dC3) + (dA5, dB5, dC5) + (dA6, dB6, dC6)]</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+2] += (dC2+dC3+dC4)*S3;  (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5] = ((dC0+2.*dC3)+(dC5+dC6))*P3;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    } <span class="comment">// end if (!calcOnlyLastRowOfJ)</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> = 42;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3] *= state7[6]; (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4] *= state7[6]; (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5] *= state7[6];</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="comment">//first point</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    dA0 = H0[2]*(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4]-H0[1]*(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5] + A0;    <span class="comment">// dA0/dp }</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    dB0 = H0[0]*(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5]-H0[2]*(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3] + B0;    <span class="comment">// dB0/dp  } = dA x H0 + (A0, B0, C0)</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    dC0 = H0[1]*(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3]-H0[0]*(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4] + C0;    <span class="comment">// dC0/dp }</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    dA2 = dA0+(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3];        <span class="comment">// }</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    dB2 = dB0+(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4];        <span class="comment">//  } = (dA0, dB0, dC0) + dA</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    dC2 = dC0+(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5];        <span class="comment">// }</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="comment">//second point</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    dA3 = (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3]+dB2*H1[2]-dC2*H1[1] + (A3-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]);    <span class="comment">// dA3/dp }</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    dB3 = (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4]+dC2*H1[0]-dA2*H1[2] + (B3-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]);    <span class="comment">// dB3/dp  } = dA + (dA2, dB2, dC2) x H1</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    dC3 = (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5]+dA2*H1[1]-dB2*H1[0] + (C3-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]);    <span class="comment">// dC3/dp }</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    dA4 = (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3]+dB3*H1[2]-dC3*H1[1] + (A4-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]);    <span class="comment">// dA4/dp }</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    dB4 = (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4]+dC3*H1[0]-dA3*H1[2] + (B4-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]);    <span class="comment">// dB4/dp  } = dA + (dA3, dB3, dC3) x H1</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    dC4 = (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5]+dA3*H1[1]-dB3*H1[0] + (C4-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]);    <span class="comment">// dC4/dp }</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160; </div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">//last point</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    dA5 = dA4+dA4-(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3];      <span class="comment">// }</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    dB5 = dB4+dB4-(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4];      <span class="comment">//  } =  2*(dA4, dB4, dC4) - dA</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    dC5 = dC4+dC4-(*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5];      <span class="comment">// }</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    dA6 = dB5*H2[2]-dC5*H2[1] + A6;      <span class="comment">// dA6/dp }</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    dB6 = dC5*H2[0]-dA5*H2[2] + B6;      <span class="comment">// dB6/dp  } = (dA5, dB5, dC5) x H2 + (A6, B6, C6)</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    dC6 = dA5*H2[1]-dB5*H2[0] + C6;      <span class="comment">// dC6/dp }</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="comment">// this gives the same results as multiplying the old with the new Jacobian</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>]   += (dA2+dA3+dA4)*S3/state7[6];  (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3] = ((dA0+2.*dA3)+(dA5+dA6))*P3/state7[6]; <span class="comment">// dR := dR + S3*[(dA2, dB2, dC2) +   (dA3, dB3, dC3) + (dA4, dB4, dC4)]</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+1] += (dB2+dB3+dB4)*S3/state7[6];  (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4] = ((dB0+2.*dB3)+(dB5+dB6))*P3/state7[6]; <span class="comment">// dA :=     1/3*[(dA0, dB0, dC0) + 2*(dA3, dB3, dC3) + (dA5, dB5, dC5) + (dA6, dB6, dC6)]</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+2] += (dC2+dC3+dC4)*S3/state7[6];  (*jacobianT)[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5] = ((dC0+2.*dC3)+(dC5+dC6))*P3/state7[6];</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  }</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160; </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <span class="comment">// Track parameters in last point</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[0] += (A2+A3+A4)*S3;   <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0] += (SA[0]=((A0+2.*A3)+(A5+A6))*P3-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]);  <span class="comment">// R  = R0 + S3*[(A2, B2, C2) +   (A3, B3, C3) + (A4, B4, C4)]</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[1] += (B2+B3+B4)*S3;   <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1] += (SA[1]=((B0+2.*B3)+(B5+B6))*P3-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]);  <span class="comment">// A  =     1/3*[(A0, B0, C0) + 2*(A3, B3, C3) + (A5, B5, C5) + (A6, B6, C6)]</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[2] += (C2+C3+C4)*S3;   <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2] += (SA[2]=((C0+2.*C3)+(C5+C6))*P3-<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]);  <span class="comment">// SA = A_new - A_old</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="comment">// normalize A</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordtype">double</span> CBA = 1./sqrt(<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]*<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]*<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]*<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]); <span class="comment">// 1/|A|</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0] *= CBA; <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1] *= CBA; <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2] *= CBA;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="comment">// Test approximation quality on given step</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="keywordtype">double</span> EST = fabs((A1+A6)-(A3+A4)) +</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;               fabs((B1+B6)-(B3+B4)) +</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;               fabs((C1+C6)-(C3+C4));  <span class="comment">// EST = ||(ABC1+ABC6)-(ABC3+ABC4)||_1  =  ||(axzy x H0 + ABC5 x H2) - (ABC2 x H1 + ABC3 x H1)||_1</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="keywordflow">if</span> (EST &lt; 1.<a class="code" href="namespacemakeMuonDIS.html#ad916c51f2653b60d746cf521ef14f685">E</a>-7) EST = 1.E-7; <span class="comment">// prevent q from getting too large</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;    RKTrackRep::RKPropagate. Step = &quot;</span>&lt;&lt; S &lt;&lt; <span class="stringliteral">&quot;; quality EST = &quot;</span> &lt;&lt; EST  &lt;&lt; <span class="stringliteral">&quot; \n&quot;</span>;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  }</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="keywordflow">return</span> pow(DLT/EST, <a class="code" href="namespacemakeDecay.html#ad0cca2a83c59bb283ee59cc30dc2ea4b">par</a>);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="affa6945eaba3b0f2b143d039967b834e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affa6945eaba3b0f2b143d039967b834e">&#9670;&nbsp;</a></span>RKPropagate() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double genfit::RKTrackRep::RKPropagate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> *&#160;</td>
          <td class="paramname"><em>jacobian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> &amp;&#160;</td>
          <td class="paramname"><em>SA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>varField</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcOnlyLastRowOfJ</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The actual Runge Kutta propagation. </p>
<p>propagate state7 with step S. Fills SA (Start directions derivatives dA/S). If jacobian is NULL, only the state is propagated, otherwise also the 7x7 jacobian is calculated. If varField is false, the magnetic field will only be evaluated at the starting position. The return value is an estimation on how good the extrapolation is, and it is usually fine if it is &gt; 1. It gives a suggestion how you must scale S so that the quality will be sufficient. </p>

</div>
</div>
<a id="a5235db4672bcedc6c78d69470b1cb289"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5235db4672bcedc6c78d69470b1cb289">&#9670;&nbsp;</a></span>RKutta() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool genfit::RKTrackRep::RKutta </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a2f0d1d795f44c877a78277c7107a4eea">M1x4</a> &amp;&#160;</td>
          <td class="paramname"><em>SU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>plane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> *&#160;</td>
          <td class="paramname"><em>jacobianT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coveredDistance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>checkJacProj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> &amp;&#160;</td>
          <td class="paramname"><em>noiseProjection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StepLimits.html">StepLimits</a> &amp;&#160;</td>
          <td class="paramname"><em>limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>onlyOneStep</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcOnlyLastRowOfJ</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Propagates the particle through the magnetic field. </p>
<p>If the propagation is successful and the plane is reached, the function returns true. Propagated state and the jacobian of the extrapolation are written to state7 and jacobianT. The jacobian is only calculated if jacobianT != NULL. In the main loop of the Runge Kutta algorithm, the <a class="el" href="classgenfit_1_1RKTrackRep.html#a281fc9087c22ee0ed63e22330fecad9d">estimateStep()</a> is called and may reduce the estimated stepsize so that a maximum momentum loss will not be exceeded, and stop at material boundaries. If this is the case, <a class="el" href="classgenfit_1_1RKTrackRep.html#a5235db4672bcedc6c78d69470b1cb289" title="Propagates the particle through the magnetic field.">RKutta()</a> will only propagate the reduced distance and then return. This is to ensure that material effects, which are calculated after the propagation, are taken into account properly. </p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01705">1705</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                                                       {</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160; </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  <span class="comment">// limits, check-values, etc. Can be tuned!</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> Wmax   = 6000.;           <span class="comment">// max. way allowed [cm]  TR 1/12/2014 3000-&gt;6000</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> AngleMax = 6.3;           <span class="comment">// max. total angle change of momentum. Prevents extrapolating a curler round and round if no active plane is found.</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> Pmin   = 4.E-3;           <span class="comment">// minimum momentum for propagation [GeV]</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxNumIt = 1000;    <span class="comment">// maximum number of iterations in main loop</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="comment">// Aux parameters</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>&amp;   <a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>           = *((<a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>*) &amp;state7[0]);  <span class="comment">// Start coordinates  [cm]  (x,  y,  z)</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>&amp;   <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>           = *((<a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>*) &amp;state7[3]);  <span class="comment">// Start directions         (ax, ay, az);   ax^2+ay^2+az^2=1</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>    SA          = {0.,0.,0.};             <span class="comment">// Start directions derivatives dA/S</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <span class="keywordtype">double</span>  Way         = 0.;                     <span class="comment">// Sum of absolute values of all extrapolation steps [cm]</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <span class="keywordtype">double</span>  <a class="code" href="namespacerun__simEcal.html#a43b5db65045aec3156fc3ae4167610f3">momentum</a>   = fabs(charge/state7[6]);<span class="comment">// momentum [GeV]</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <span class="keywordtype">double</span>  relMomLoss = 0;                      <span class="comment">// relative momentum loss in RKutta</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="keywordtype">double</span>  deltaAngle = 0.;                     <span class="comment">// total angle by which the momentum has changed during extrapolation</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="keywordtype">double</span>  An(0), S(0), Sl(0), CBA(0);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160; </div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160; </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::RKutta \n&quot;</span>;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;position: &quot;</span>; TVector3(<a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[0], <a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[1], <a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[2]).Print();</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;direction: &quot;</span>; TVector3(<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0], <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1], <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]).Print();</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;momentum: &quot;</span> &lt;&lt; <a class="code" href="namespacerun__simEcal.html#a43b5db65045aec3156fc3ae4167610f3">momentum</a> &lt;&lt; <span class="stringliteral">&quot; GeV\n&quot;</span>;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;destination: &quot;</span>; plane.Print();</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; </div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  checkJacProj = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; </div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="comment">// check momentum</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="namespacerun__simEcal.html#a43b5db65045aec3156fc3ae4167610f3">momentum</a> &lt; Pmin){</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    std::ostringstream sstream;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    sstream &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::RKutta ==&gt; momentum too low: &quot;</span> &lt;&lt; <a class="code" href="namespacerun__simEcal.html#a43b5db65045aec3156fc3ae4167610f3">momentum</a>*1000. &lt;&lt; <span class="stringliteral">&quot; MeV&quot;</span>;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    Exception exc(sstream.str(),__LINE__,__FILE__);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    exc.setFatal();</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  }</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160; </div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a>(0);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160; </div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="comment">// Step estimation (signed)</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  S = <a class="code" href="classgenfit_1_1RKTrackRep.html#a281fc9087c22ee0ed63e22330fecad9d">estimateStep</a>(state7, SU, plane, charge, relMomLoss, limits);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160; </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  <span class="comment">// Main loop of Runge-Kutta method</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <span class="keywordflow">while</span> (fabs(S) &gt;= <a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a> || <a class="code" href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a> == 0) {</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="keywordflow">if</span>(++<a class="code" href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a> &gt; maxNumIt){</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      Exception exc(<span class="stringliteral">&quot;RKTrackRep::RKutta ==&gt; maximum number of iterations exceeded&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    }</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;------ RKutta main loop nr. &quot;</span> &lt;&lt; <a class="code" href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a>-1 &lt;&lt; <span class="stringliteral">&quot; ------\n&quot;</span>;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    }</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> ABefore = { <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0], <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1], <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2] }; <span class="comment">// M1x3 ABefore(A);</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#affa6945eaba3b0f2b143d039967b834e">RKPropagate</a>(state7, jacobianT, SA, S, <span class="keyword">true</span>, calcOnlyLastRowOfJ); <span class="comment">// the actual Runge Kutta propagation</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="comment">// update paths</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    coveredDistance += S;       <span class="comment">// add stepsize to way (signed)</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    Way  += fabs(S);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160; </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="comment">// check way limit</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <span class="keywordflow">if</span>(Way &gt; Wmax){</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      std::ostringstream sstream;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      sstream &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::RKutta ==&gt; Total extrapolation length is longer than length limit : &quot;</span> &lt;&lt; Way &lt;&lt; <span class="stringliteral">&quot; cm !&quot;</span>;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      Exception exc(sstream.str(),__LINE__,__FILE__);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    }</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="keywordflow">if</span> (onlyOneStep) <span class="keywordflow">return</span>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; </div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="comment">// if stepsize has been limited by material, break the loop and return. No linear extrapolation!</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="keywordflow">if</span> (limits.getLowestLimit().first == <a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6daa23157bc4bd9610af3b3416324b47bff">stp_momLoss</a>) {</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        std::cout&lt;&lt;<span class="stringliteral">&quot; momLossExceeded -&gt; return(true); \n&quot;</span>;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      }</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      <span class="keywordflow">return</span>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    }</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="comment">// if stepsize has been limited by material boundary, break the loop and return. No linear extrapolation!</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="keywordflow">if</span> (limits.getLowestLimit().first == <a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da605e0085946c284dd888271e7f7c5252">stp_boundary</a>) {</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        std::cout&lt;&lt;<span class="stringliteral">&quot; at boundary -&gt; return(true); \n&quot;</span>;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      }</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      <span class="keywordflow">return</span>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160; </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="comment">// estimate Step for next loop or linear extrapolation</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    Sl = S; <span class="comment">// last S used</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    limits.removeLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da4da62c4f01005fa9d9b41383d919fb42">stp_fieldCurv</a>);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    limits.removeLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6daa23157bc4bd9610af3b3416324b47bff">stp_momLoss</a>);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    limits.removeLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da605e0085946c284dd888271e7f7c5252">stp_boundary</a>);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    limits.removeLimit(<a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf">stp_plane</a>);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    S = <a class="code" href="classgenfit_1_1RKTrackRep.html#a281fc9087c22ee0ed63e22330fecad9d">estimateStep</a>(state7, SU, plane, charge, relMomLoss, limits);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160; </div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="keywordflow">if</span> (limits.getLowestLimit().first == <a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf">stp_plane</a> &amp;&amp;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        fabs(S) &lt; <a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>) {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        std::cout&lt;&lt;<span class="stringliteral">&quot; (at Plane &amp;&amp; fabs(S) &lt; MINSTEP) -&gt; break and do linear extrapolation \n&quot;</span>;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      }</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    }</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <span class="keywordflow">if</span> (limits.getLowestLimit().first == <a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6daa23157bc4bd9610af3b3416324b47bff">stp_momLoss</a> &amp;&amp;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        fabs(S) &lt; <a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>) {</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        std::cout&lt;&lt;<span class="stringliteral">&quot; (momLossExceeded &amp;&amp; fabs(S) &lt; MINSTEP) -&gt; return(true), no linear extrapolation; \n&quot;</span>;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      }</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.erase(<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.end()-1);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      --<a class="code" href="classgenfit_1_1RKTrackRep.html#ac04989ccf60fdba61d369aa462cdf40b">RKStepsFXStop_</a>;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;      <span class="keywordflow">return</span>(<span class="keyword">true</span>); <span class="comment">// no linear extrapolation!</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    }</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160; </div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="comment">// check if total angle is bigger than AngleMax. Can happen if a curler should be fitted and it does not hit the active area of the next plane.</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    deltaAngle += acos(ABefore[0]*<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0] + ABefore[1]*<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1] + ABefore[2]*<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="keywordflow">if</span> (fabs(deltaAngle) &gt; AngleMax){</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      std::ostringstream sstream;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      sstream &lt;&lt; <span class="stringliteral">&quot;RKTrackRep::RKutta ==&gt; Do not get to an active plane! Already extrapolated &quot;</span> &lt;&lt; deltaAngle * 180 / TMath::Pi() &lt;&lt; <span class="stringliteral">&quot;°.&quot;</span>;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      Exception exc(sstream.str(),__LINE__,__FILE__);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      exc.setFatal();</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    }</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="comment">// check if we went back and forth multiple times -&gt; we don&#39;t come closer to the plane!</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a> &gt; 3){</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      <span class="keywordflow">if</span> (S                            *<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a>-1).matStep_.stepSize_ &lt; 0 &amp;&amp;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;          <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a>-1).matStep_.stepSize_*<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a>-2).matStep_.stepSize_ &lt; 0 &amp;&amp;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;          <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a>-2).matStep_.stepSize_*<a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.at(<a class="code" href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a>-3).matStep_.stepSize_ &lt; 0){</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        Exception exc(<span class="stringliteral">&quot;RKTrackRep::RKutta ==&gt; Do not get closer to plane!&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        exc.setFatal();</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    }</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160; </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  } <span class="comment">//end of main loop</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160; </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160; </div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <span class="comment">// linear extrapolation to plane</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="keywordflow">if</span> (limits.getLowestLimit().first == <a class="code" href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf">stp_plane</a>) {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="keywordflow">if</span> (fabs(Sl) &gt; 0.001*<a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>){</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot; RKutta - linear extrapolation to surface\n&quot;</span>;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      Sl = 1./Sl;        <span class="comment">// Sl = inverted last Stepsize Sl</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160; </div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      <span class="comment">// normalize SA</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      SA[0]*=Sl;  SA[1]*=Sl;  SA[2]*=Sl; <span class="comment">// SA/Sl = delta A / delta way; local derivative of A with respect to the length of the way</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="comment">// calculate A</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0] += SA[0]*S;    <span class="comment">// S  = distance to surface</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1] += SA[1]*S;    <span class="comment">// A = A + S * SA*Sl</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2] += SA[2]*S;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160; </div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      <span class="comment">// normalize A</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      CBA = 1./sqrt(<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]*<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]*<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]+<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]*<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]);  <span class="comment">// 1/|A|</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0] *= CBA; <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1] *= CBA; <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2] *= CBA;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      <a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[0] += S*(<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]-0.5*S*SA[0]);    <span class="comment">// R = R + S*(A - 0.5*S*SA); approximation for final point on surface</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      <a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[1] += S*(<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]-0.5*S*SA[1]);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      <a class="code" href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">R</a>[2] += S*(<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]-0.5*S*SA[2]);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160; </div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      coveredDistance += S;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      Way  += fabs(S);</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    }</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0)  {</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot; RKutta - last stepsize too small -&gt; can&#39;t do linear extrapolation! \n&quot;</span>;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    }</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <span class="comment">// Project Jacobian of extrapolation onto destination plane</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="keywordflow">if</span> (jacobianT != NULL) {</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160; </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="comment">// projected jacobianT</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="comment">// x x x x x x 0</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="comment">// x x x x x x 0</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="comment">// x x x x x x 0</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      <span class="comment">// x x x x x x 0</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <span class="comment">// x x x x x x 0</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <span class="comment">// x x x x x x 0</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <span class="comment">// x x x x x x 1</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160; </div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="keywordflow">if</span> (checkJacProj &amp;&amp; <a class="code" href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">RKSteps_</a>.size()&gt;0){</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        Exception exc(<span class="stringliteral">&quot;RKTrackRep::Extrap ==&gt; covariance is projected onto destination plane again&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      }</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160; </div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;  Jacobian^T of extrapolation before Projection:\n&quot;;</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <span class="comment">//RKTools::printDim(*jacobianT, 7,7);</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  Project Jacobian of extrapolation onto destination plane\n&quot;</span>;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      }</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      An = <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[0]*SU[0] + <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[1]*SU[1] + <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[2]*SU[2];</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;      An = (fabs(An) &gt; 1.E-7 ? 1./An : 0); <span class="comment">// 1/A_normal</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="keywordtype">double</span> norm;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>=0;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      <span class="keywordflow">if</span> (calcOnlyLastRowOfJ)</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a> = 42;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160; </div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      <span class="keywordflow">for</span>(; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>&lt;49; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+=7) {</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;          <span class="keywordtype">double</span>* jacPtr = *jacobianT;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        norm = (jacPtr[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>]*SU[0] + jacPtr[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+1]*SU[1] + jacPtr[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+2]*SU[2]) * An;  <span class="comment">// dR_normal / A_normal</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        jacPtr[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>]   -= norm*<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a> [0];   jacPtr[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+1] -= norm*<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a> [1];   jacPtr[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+2] -= norm*<a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a> [2];</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        jacPtr[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+3] -= norm*SA[0];   jacPtr[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+4] -= norm*SA[1];   jacPtr[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>+5] -= norm*SA[2];</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      }</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      checkJacProj = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160; </div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">debugLvl_</a> &gt; 0) {</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot;  Jacobian^T of extrapolation after Projection:\n&quot;;</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        <span class="comment">//RKTools::printDim(*jacobianT, 7,7);</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      }</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160; </div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="keywordflow">if</span> (!calcOnlyLastRowOfJ) {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iRow = 0; iRow &lt; 3; ++iRow) {</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iCol = 0; iCol &lt; 3; ++iCol) {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        noiseProjection[iRow*7 + iCol]       = (iRow == iCol) - An * SU[iCol] * <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>[iRow];</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        noiseProjection[(iRow + 3)*7 + iCol] =                - An * SU[iCol] * SA[iRow];</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160; </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;          }</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        }</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160; </div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        <span class="comment">// noiseProjection will look like this:</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        <span class="comment">// x x x 0 0 0 0</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="comment">// x x x 0 0 0 0</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        <span class="comment">// x x x 0 0 0 0</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        <span class="comment">// x x x 1 0 0 0</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <span class="comment">// x x x 0 1 0 0</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="comment">// x x x 0 0 1 0</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="comment">// 0 0 0 0 0 0 1</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      }</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    }</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  } <span class="comment">// end of linear extrapolation to surface</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160; </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <span class="keywordflow">return</span>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160; </div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5235db4672bcedc6c78d69470b1cb289"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5235db4672bcedc6c78d69470b1cb289">&#9670;&nbsp;</a></span>RKutta() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool genfit::RKTrackRep::RKutta </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a2f0d1d795f44c877a78277c7107a4eea">M1x4</a> &amp;&#160;</td>
          <td class="paramname"><em>SU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1DetPlane.html">DetPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>plane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>charge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> *&#160;</td>
          <td class="paramname"><em>jacobianT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>coveredDistance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>checkJacProj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> &amp;&#160;</td>
          <td class="paramname"><em>noiseProjection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StepLimits.html">StepLimits</a> &amp;&#160;</td>
          <td class="paramname"><em>limits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>onlyOneStep</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calcOnlyLastRowOfJ</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Propagates the particle through the magnetic field. </p>
<p>If the propagation is successful and the plane is reached, the function returns true. Propagated state and the jacobian of the extrapolation are written to state7 and jacobianT. The jacobian is only calculated if jacobianT != NULL. In the main loop of the Runge Kutta algorithm, the <a class="el" href="classgenfit_1_1RKTrackRep.html#a281fc9087c22ee0ed63e22330fecad9d">estimateStep()</a> is called and may reduce the estimated stepsize so that a maximum momentum loss will not be exceeded, and stop at material boundaries. If this is the case, <a class="el" href="classgenfit_1_1RKTrackRep.html#a5235db4672bcedc6c78d69470b1cb289" title="Propagates the particle through the magnetic field.">RKutta()</a> will only propagate the reduced distance and then return. This is to ensure that material effects, which are calculated after the propagation, are taken into account properly. </p>

</div>
</div>
<a id="a23f160ca573dbf0ed2526b2c21b1fdc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23f160ca573dbf0ed2526b2c21b1fdc2">&#9670;&nbsp;</a></span>setChargeSign() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::setChargeSign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>charge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the sign of the charge according to charge. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a88446a9993e7f447d7e2d24c5d550aff">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01122">1122</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                                                                       {</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>MeasurementOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::setChargeSign - cannot set charge of a MeasurementOnPlane&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    exc.setFatal();</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  }</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordflow">if</span> (state.getState()(0) * charge &lt; 0) {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    state.getState()(0) *= -1.;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9adae2d78ae5e04ca2a2039ce981bc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9adae2d78ae5e04ca2a2039ce981bc8">&#9670;&nbsp;</a></span>setChargeSign() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void genfit::RKTrackRep::setChargeSign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>charge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the sign of the charge according to charge. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a88446a9993e7f447d7e2d24c5d550aff">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a743ae73c90b306147fff6092ae2a0c99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a743ae73c90b306147fff6092ae2a0c99">&#9670;&nbsp;</a></span>setPosMom() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::setPosMom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>mom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set position and momentum of state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a6ef84bf5c2a3c96a90ea1d030ecff47b">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l00965">965</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                                                                                              {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordflow">if</span> (state.getRep() != <span class="keyword">this</span>){</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::setPosMom ==&gt; state is defined wrt. another TrackRep&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>MeasurementOnPlane*<span class="keyword">&gt;</span>(&amp;state) != NULL) {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::setPosMom - cannot set pos/mom of a MeasurementOnPlane&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    exc.setFatal();</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="comment">// init auxInfo if that has not yet happened</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  TVectorD&amp; auxInfo = state.getAuxInfo();</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="keywordflow">if</span> (auxInfo.GetNrows() != 1) {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    auxInfo.ResizeTo(1);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#a324ba092d634f324285f445b4bba12b6">setSpu</a>(state, 1.);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="keywordflow">if</span> (state.getPlane() != NULL &amp;&amp; state.getPlane()-&gt;distance(<a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>) &lt; <a class="code" href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a>) { <span class="comment">// pos is on plane -&gt; do not change plane!</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    state7[0] = <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>.X();</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    state7[1] = <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>.Y();</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    state7[2] = <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>.Z();</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    state7[3] = <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.X();</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    state7[4] = <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.Y();</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    state7[5] = <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.Z();</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="comment">// normalize dir</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordtype">double</span> norm = 1. / sqrt(state7[3]*state7[3] + state7[4]*state7[4] + state7[5]*state7[5]);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>=3; <a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>&lt;6; ++<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      state7[<a class="code" href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">i</a>] *= norm;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    state7[6] = <a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state) * norm;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">getState5</a>(state, state7);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="keywordflow">else</span> { <span class="comment">// pos is not on plane -&gt; create new plane!</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="comment">// TODO: Raise Warning that a new plane has been created!</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <a class="code" href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">SharedPlanePtr</a> plane(<span class="keyword">new</span> DetPlane(<a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>, <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>));</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    state.setPlane(plane);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    TVectorD&amp; state5(state.getState());</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    state5(0) = <a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state)/<a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.Mag(); <span class="comment">// q/p</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    state5(1) = 0.; <span class="comment">// u&#39;</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    state5(2) = 0.; <span class="comment">// v&#39;</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    state5(3) = 0.; <span class="comment">// u</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    state5(4) = 0.; <span class="comment">// v</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <a class="code" href="classgenfit_1_1RKTrackRep.html#a324ba092d634f324285f445b4bba12b6">setSpu</a>(state, 1.);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8cf9535c2cfef5f12915de536941986e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cf9535c2cfef5f12915de536941986e">&#9670;&nbsp;</a></span>setPosMom() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void genfit::RKTrackRep::setPosMom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>mom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set position and momentum of state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a6ef84bf5c2a3c96a90ea1d030ecff47b">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a5a4f43ee1ff3f76f0f6cdf1b02cfacde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a4f43ee1ff3f76f0f6cdf1b02cfacde">&#9670;&nbsp;</a></span>setPosMom() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::setPosMom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVectorD &amp;&#160;</td>
          <td class="paramname"><em>state6</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set position and momentum of state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a07b8b582fc86e5ba93e823b107eb0c3a">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01027">1027</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                                                                            {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keywordflow">if</span> (state6.GetNrows()!=6){</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::setPosMom ==&gt; state has to be 6d (x, y, z, px, py, pz)&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a743ae73c90b306147fff6092ae2a0c99">setPosMom</a>(state, TVector3(state6(0), state6(1), state6(2)), TVector3(state6(3), state6(4), state6(5)));</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a747be9a6b854b5c47e2e7eaf806c185f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a747be9a6b854b5c47e2e7eaf806c185f">&#9670;&nbsp;</a></span>setPosMom() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void genfit::RKTrackRep::setPosMom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVectorD &amp;&#160;</td>
          <td class="paramname"><em>state6</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set position and momentum of state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a07b8b582fc86e5ba93e823b107eb0c3a">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a9a0c5a51469f0400049001c287ddd516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a0c5a51469f0400049001c287ddd516">&#9670;&nbsp;</a></span>setPosMomCov() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::setPosMomCov </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>mom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TMatrixDSym &amp;&#160;</td>
          <td class="paramname"><em>cov6x6</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set position, momentum and covariance of state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#aa64680a087ba9a9a91b77f80977e19cc">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01078">1078</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                                                                                                                                    {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">if</span> (cov6x6.GetNcols()!=6 || cov6x6.GetNrows()!=6){</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::setPosMomCov ==&gt; cov has to be 6x6 (x, y, z, px, py, pz)&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a743ae73c90b306147fff6092ae2a0c99">setPosMom</a>(state, <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>, <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>); <span class="comment">// charge does not change!</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a>(state, state7);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a>&amp; cov6x6_( *((<a class="code" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a>*) cov6x6.GetMatrixArray()) );</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae5b17345256ef11df15d571f9237f431">transformM6P</a>(cov6x6_, state7, state);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b5455a69aae5687a9743c9f2f5d946c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b5455a69aae5687a9743c9f2f5d946c">&#9670;&nbsp;</a></span>setPosMomCov() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void genfit::RKTrackRep::setPosMomCov </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>mom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TMatrixDSym &amp;&#160;</td>
          <td class="paramname"><em>cov6x6</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set position, momentum and covariance of state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#aa64680a087ba9a9a91b77f80977e19cc">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="adda4fd1cb09adcd30afff0594e24519d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adda4fd1cb09adcd30afff0594e24519d">&#9670;&nbsp;</a></span>setPosMomCov() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::setPosMomCov </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVectorD &amp;&#160;</td>
          <td class="paramname"><em>state6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TMatrixDSym &amp;&#160;</td>
          <td class="paramname"><em>cov6x6</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set position, momentum and covariance of state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a3bc0c7ada3e1b5566539e627e2a2696c">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01096">1096</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                                                                                                                  {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordflow">if</span> (state6.GetNrows()!=6){</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::setPosMomCov ==&gt; state has to be 6d (x, y, z, px, py, pz)&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">if</span> (cov6x6.GetNcols()!=6 || cov6x6.GetNrows()!=6){</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    Exception exc(<span class="stringliteral">&quot;RKTrackRep::setPosMomCov ==&gt; cov has to be 6x6 (x, y, z, px, py, pz)&quot;</span>,__LINE__,__FILE__);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">throw</span> exc;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  TVector3 <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>(state6(0), state6(1), state6(2));</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  TVector3 <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>(state6(3), state6(4), state6(5));</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a743ae73c90b306147fff6092ae2a0c99">setPosMom</a>(state, <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>, <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>); <span class="comment">// charge does not change!</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <a class="code" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> state7;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">getState7</a>(state, state7);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a>&amp; cov6x6_( *((<a class="code" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a>*) cov6x6.GetMatrixArray()) );</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ae5b17345256ef11df15d571f9237f431">transformM6P</a>(cov6x6_, state7, state);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a248147a042b603431d22bd285ee14adc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a248147a042b603431d22bd285ee14adc">&#9670;&nbsp;</a></span>setPosMomCov() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void genfit::RKTrackRep::setPosMomCov </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVectorD &amp;&#160;</td>
          <td class="paramname"><em>state6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TMatrixDSym &amp;&#160;</td>
          <td class="paramname"><em>cov6x6</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set position, momentum and covariance of state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a3bc0c7ada3e1b5566539e627e2a2696c">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a0e3336e902f6edb35dce5205724cfb1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e3336e902f6edb35dce5205724cfb1b">&#9670;&nbsp;</a></span>setPosMomErr() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::setPosMomErr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>mom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>posErr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>momErr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set position and momentum and error of state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a475522e6703d149ef0b1407679bbe7f9">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01036">1036</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                                                                                                                                         {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="comment">// TODO: test!</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a743ae73c90b306147fff6092ae2a0c99">setPosMom</a>(state, <a class="code" href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">pos</a>, <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="keyword">const</span> TVector3&amp; U(state.getPlane()-&gt;getU());</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="keyword">const</span> TVector3&amp; <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>(state.getPlane()-&gt;getV());</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  TVector3 W(state.getPlane()-&gt;getNormal());</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keywordtype">double</span> pw = <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a> * W;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="keywordtype">double</span> pu = <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a> * U;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keywordtype">double</span> pv = <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a> * <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  TMatrixDSym&amp; cov(state.getCov());</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  cov(0,0) = pow(<a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state), 2) / pow(<a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.Mag(), 6) *</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;             (<a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.X()*<a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.X() * momErr.X()*momErr.X()+</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;              <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.Y()*<a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.Y() * momErr.Y()*momErr.Y()+</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;              <a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.Z()*<a class="code" href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">mom</a>.Z() * momErr.Z()*momErr.Z());</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  cov(1,1) = pow((U.X()/pw - W.X()*pu/(pw*pw)),2.) * momErr.X()*momErr.X() +</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;             pow((U.Y()/pw - W.Y()*pu/(pw*pw)),2.) * momErr.Y()*momErr.Y() +</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;             pow((U.Z()/pw - W.Z()*pu/(pw*pw)),2.) * momErr.Z()*momErr.Z();</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  cov(2,2) = pow((<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X()/pw - W.X()*pv/(pw*pw)),2.) * momErr.X()*momErr.X() +</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;             pow((<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y()/pw - W.Y()*pv/(pw*pw)),2.) * momErr.Y()*momErr.Y() +</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;             pow((<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z()/pw - W.Z()*pv/(pw*pw)),2.) * momErr.Z()*momErr.Z();</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  cov(3,3) = posErr.X()*posErr.X() * U.X()*U.X() +</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;             posErr.Y()*posErr.Y() * U.Y()*U.Y() +</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;             posErr.Z()*posErr.Z() * U.Z()*U.Z();</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  cov(4,4) = posErr.X()*posErr.X() * <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X()*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X() +</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;             posErr.Y()*posErr.Y() * <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y()*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y() +</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;             posErr.Z()*posErr.Z() * <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z()*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z();</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a99e37f2ab61f0473a26725979c94998d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99e37f2ab61f0473a26725979c94998d">&#9670;&nbsp;</a></span>setPosMomErr() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void genfit::RKTrackRep::setPosMomErr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>mom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>posErr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TVector3 &amp;&#160;</td>
          <td class="paramname"><em>momErr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set position and momentum and error of state. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#a475522e6703d149ef0b1407679bbe7f9">genfit::AbsTrackRep</a>.</p>

</div>
</div>
<a id="a1eb48cd7c3e1c5d954563cea4d37576d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1eb48cd7c3e1c5d954563cea4d37576d">&#9670;&nbsp;</a></span>setQop() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void genfit::RKTrackRep::setQop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>qop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set charge/momentum. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#aad99087e92c131e610a32f9e58023bb5">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00163">163</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;{state.getState()(0) = qop;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1eb48cd7c3e1c5d954563cea4d37576d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1eb48cd7c3e1c5d954563cea4d37576d">&#9670;&nbsp;</a></span>setQop() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void genfit::RKTrackRep::setQop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>qop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set charge/momentum. </p>

<p>Implements <a class="el" href="classgenfit_1_1AbsTrackRep.html#aad99087e92c131e610a32f9e58023bb5">genfit::AbsTrackRep</a>.</p>

<p class="definition">Definition at line <a class="el" href="trackReps_2include_2RKTrackRep_8h_source.html#l00168">168</a> of file <a class="el" href="trackReps_2include_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;{state.getState()(0) = qop;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a324ba092d634f324285f445b4bba12b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a324ba092d634f324285f445b4bba12b6">&#9670;&nbsp;</a></span>setSpu() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::setSpu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>spu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01136">1136</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                                             {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  state.getAuxInfo().ResizeTo(1);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  (state.getAuxInfo())(0) = spu;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a324ba092d634f324285f445b4bba12b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a324ba092d634f324285f445b4bba12b6">&#9670;&nbsp;</a></span>setSpu() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::setSpu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>spu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae5b17345256ef11df15d571f9237f431"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5b17345256ef11df15d571f9237f431">&#9670;&nbsp;</a></span>transformM6P() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::transformM6P </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a> &amp;&#160;</td>
          <td class="paramname"><em>in6x6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01627">1627</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                                                                 { <span class="comment">// plane and charge must already be set!</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="comment">// get vectors and aux variables</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="keyword">const</span> TVector3&amp; U(state.getPlane()-&gt;getU());</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="keyword">const</span> TVector3&amp; <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>(state.getPlane()-&gt;getV());</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <span class="keyword">const</span> TVector3&amp; W(state.getPlane()-&gt;getNormal());</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; </div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> AtU = state7[3]*U.X() + state7[4]*U.Y() + state7[5]*U.Z();</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> AtV = state7[3]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X() + state7[4]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y() + state7[5]*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z();</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> AtW = state7[3]*W.X() + state7[4]*W.Y() + state7[5]*W.Z();</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160; </div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  <span class="comment">// J_Mp matrix is d(q/p,u&#39;,v&#39;,u,v) / d(x,y,z,px,py,pz)       (in is 6x6)</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160; </div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> qop = state7[6];</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a> = <a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state)/qop; <span class="comment">// momentum</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160; </div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <a class="code" href="namespacegenfit.html#a9fe94bdc4b216fd56da5e7e447403d75">M6x5</a> J_Mp_6x5;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  memset(J_Mp_6x5, 0, <span class="keyword">sizeof</span>(<a class="code" href="namespacegenfit.html#a9fe94bdc4b216fd56da5e7e447403d75">M6x5</a>));</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160; </div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="comment">//d(u)/d(x,y,z)</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  J_Mp_6x5[3]  = U.X(); <span class="comment">// [0][3]</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  J_Mp_6x5[8]  = U.Y(); <span class="comment">// [1][3]</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  J_Mp_6x5[13] = U.Z(); <span class="comment">// [2][3]</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="comment">//d(v)/d(x,y,z)</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  J_Mp_6x5[4]  = <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X(); <span class="comment">// [0][4]</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  J_Mp_6x5[9]  = <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y(); <span class="comment">// [1][4]</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  J_Mp_6x5[14] = <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z(); <span class="comment">// [2][4]</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <span class="comment">// d(q/p)/d(px,py,pz)</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="keywordtype">double</span> fact = (-1.) * qop / <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a>;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  J_Mp_6x5[15] = fact * state7[3]; <span class="comment">// [3][0]</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  J_Mp_6x5[20] = fact * state7[4]; <span class="comment">// [4][0]</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  J_Mp_6x5[25] = fact * state7[5]; <span class="comment">// [5][0]</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="comment">// d(u&#39;)/d(px,py,pz)</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  fact = 1./(<a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a>*AtW*AtW);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  J_Mp_6x5[16] = fact * (U.X()*AtW - W.X()*AtU); <span class="comment">// [3][1]</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  J_Mp_6x5[21] = fact * (U.Y()*AtW - W.Y()*AtU); <span class="comment">// [4][1]</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  J_Mp_6x5[26] = fact * (U.Z()*AtW - W.Z()*AtU); <span class="comment">// [5][1]</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <span class="comment">// d(v&#39;)/d(px,py,pz)</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  J_Mp_6x5[17] = fact * (<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X()*AtW - W.X()*AtV); <span class="comment">// [3][2]</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  J_Mp_6x5[22] = fact * (<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y()*AtW - W.Y()*AtV); <span class="comment">// [4][2]</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  J_Mp_6x5[27] = fact * (<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z()*AtW - W.Z()*AtV); <span class="comment">// [5][2]</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="comment">// do the transformation</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="comment">// out5x5 = J_Mp^T * in * J_Mp</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  <a class="code" href="namespacegenfit.html#aa59cd0f20b9c72817c90fe0df1472ece">M5x5</a>&amp; out5x5_ = *((<a class="code" href="namespacegenfit.html#aa59cd0f20b9c72817c90fe0df1472ece">M5x5</a>*) state.getCov().GetMatrixArray());</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <a class="code" href="namespacegenfit_1_1RKTools.html#a399786be57d47fbbeb5539095b0138f8">RKTools::J_MpTxcov6xJ_Mp</a>(J_Mp_6x5, in6x6, out5x5_);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5b17345256ef11df15d571f9237f431"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5b17345256ef11df15d571f9237f431">&#9670;&nbsp;</a></span>transformM6P() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::transformM6P </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a> &amp;&#160;</td>
          <td class="paramname"><em>in6x6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6c3fa23cdc88dcc7708ddb4d64850d87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c3fa23cdc88dcc7708ddb4d64850d87">&#9670;&nbsp;</a></span>transformM7P() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::transformM7P </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> &amp;&#160;</td>
          <td class="paramname"><em>in7x7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01559">1559</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                                                                 { <span class="comment">// plane must already be set!</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="comment">// get vectors and aux variables</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="keyword">const</span> TVector3&amp; U(state.getPlane()-&gt;getU());</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="keyword">const</span> TVector3&amp; <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>(state.getPlane()-&gt;getV());</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="keyword">const</span> TVector3&amp; W(state.getPlane()-&gt;getNormal());</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160; </div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>&amp; <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a> = *((<a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a>*) &amp;state7[3]);</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <a class="code" href="namespacegenfit.html#a13cb802e03b7ad640485ba2bf9fe12f7">M5x7</a> J_Mp;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#a14b3e8a65ae607330fcd65315ace0cba">calcJ_Mp_7x5</a>(J_Mp, U, <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>, W, <a class="code" href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">A</a>);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="comment">// since the Jacobian contains a lot of zeros, and the resulting cov has to be symmetric,</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="comment">// the multiplication can be done much faster directly on array level</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="comment">// out5x5 = J_Mp^T * in * J_Mp</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <a class="code" href="namespacegenfit.html#aa59cd0f20b9c72817c90fe0df1472ece">M5x5</a>&amp; out5x5_ = *((<a class="code" href="namespacegenfit.html#aa59cd0f20b9c72817c90fe0df1472ece">M5x5</a>*) state.getCov().GetMatrixArray());</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <a class="code" href="namespacegenfit_1_1RKTools.html#ad2530899a8df922d173c17f55ac590b9">RKTools::J_MpTxcov7xJ_Mp</a>(J_Mp, in7x7, out5x5_);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c3fa23cdc88dcc7708ddb4d64850d87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c3fa23cdc88dcc7708ddb4d64850d87">&#9670;&nbsp;</a></span>transformM7P() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::transformM7P </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> &amp;&#160;</td>
          <td class="paramname"><em>in7x7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">M1x7</a> &amp;&#160;</td>
          <td class="paramname"><em>state7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8f08fa06a70fdb7d6c5fe8b63bbe7c81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f08fa06a70fdb7d6c5fe8b63bbe7c81">&#9670;&nbsp;</a></span>transformPM6() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::transformPM6 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a> &amp;&#160;</td>
          <td class="paramname"><em>out6x6</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01497">1497</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                                                  {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="comment">// get vectors and aux variables</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="keyword">const</span> TVector3&amp; U(state.getPlane()-&gt;getU());</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="keyword">const</span> TVector3&amp; <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>(state.getPlane()-&gt;getV());</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="keyword">const</span> TVector3&amp; W(state.getPlane()-&gt;getNormal());</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="keyword">const</span> TVectorD&amp; state5(state.getState());</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="keywordtype">double</span> spu(<a class="code" href="classgenfit_1_1RKTrackRep.html#a177f273f4dc3d7d1eaa646fe5a70aaf3">getSpu</a>(state));</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160; </div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> pTilde;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  pTilde[0] = spu * (W.X() + state5(1)*U.X() + state5(2)*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X()); <span class="comment">// a_x</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  pTilde[1] = spu * (W.Y() + state5(1)*U.Y() + state5(2)*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y()); <span class="comment">// a_y</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  pTilde[2] = spu * (W.Z() + state5(1)*U.Z() + state5(2)*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z()); <span class="comment">// a_z</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160; </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> pTildeMag = sqrt(pTilde[0]*pTilde[0] + pTilde[1]*pTilde[1] + pTilde[2]*pTilde[2]);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> pTildeMag2 = pTildeMag*pTildeMag;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160; </div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> utpTildeOverpTildeMag2 = (U.X()*pTilde[0] + U.Y()*pTilde[1] + U.Z()*pTilde[2]) / pTildeMag2;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> vtpTildeOverpTildeMag2 = (<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X()*pTilde[0] + <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y()*pTilde[1] + <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z()*pTilde[2]) / pTildeMag2;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="comment">//J_pM matrix is d(x,y,z,px,py,pz) / d(q/p,u&#39;,v&#39;,u,v)       (out is 6x6)</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160; </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> qop = state5(0);</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a> = <a class="code" href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">getCharge</a>(state)/qop; <span class="comment">// momentum</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <a class="code" href="namespacegenfit.html#a6154edc550af3e20a8b596b9c22e9a6e">M5x6</a> J_pM_5x6;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  memset(J_pM_5x6, 0, <span class="keyword">sizeof</span>(<a class="code" href="namespacegenfit.html#a6154edc550af3e20a8b596b9c22e9a6e">M5x6</a>));</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <span class="comment">// d(px,py,pz)/d(q/p)</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <span class="keywordtype">double</span> fact = -1. * <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a> / (pTildeMag * qop);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  J_pM_5x6[3] = fact * pTilde[0]; <span class="comment">// [0][3]</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  J_pM_5x6[4] = fact * pTilde[1]; <span class="comment">// [0][4]</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  J_pM_5x6[5] = fact * pTilde[2]; <span class="comment">// [0][5]</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="comment">// d(px,py,pz)/d(u&#39;)</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  fact = <a class="code" href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">p</a> * spu / pTildeMag;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  J_pM_5x6[9]  = fact * ( U.X() - pTilde[0]*utpTildeOverpTildeMag2 ); <span class="comment">// [1][3]</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  J_pM_5x6[10] = fact * ( U.Y() - pTilde[1]*utpTildeOverpTildeMag2 ); <span class="comment">// [1][4]</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  J_pM_5x6[11] = fact * ( U.Z() - pTilde[2]*utpTildeOverpTildeMag2 ); <span class="comment">// [1][5]</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="comment">// d(px,py,pz)/d(v&#39;)</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  J_pM_5x6[15] = fact * ( <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X() - pTilde[0]*vtpTildeOverpTildeMag2 ); <span class="comment">// [2][3]</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  J_pM_5x6[16] = fact * ( <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y() - pTilde[1]*vtpTildeOverpTildeMag2 ); <span class="comment">// [2][4]</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  J_pM_5x6[17] = fact * ( <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z() - pTilde[2]*vtpTildeOverpTildeMag2 ); <span class="comment">// [2][5]</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="comment">// d(x,y,z)/d(u)</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  J_pM_5x6[18] = U.X(); <span class="comment">// [3][0]</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  J_pM_5x6[19] = U.Y(); <span class="comment">// [3][1]</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  J_pM_5x6[20] = U.Z(); <span class="comment">// [3][2]</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="comment">// d(x,y,z)/d(v)</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  J_pM_5x6[24] = <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X(); <span class="comment">// [4][0]</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  J_pM_5x6[25] = <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y(); <span class="comment">// [4][1]</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  J_pM_5x6[26] = <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z(); <span class="comment">// [4][2]</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <span class="comment">// do the transformation</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="comment">// out = J_pM^T * in5x5 * J_pM</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacegenfit.html#aa59cd0f20b9c72817c90fe0df1472ece">M5x5</a>&amp; in5x5_ = *((<a class="code" href="namespacegenfit.html#aa59cd0f20b9c72817c90fe0df1472ece">M5x5</a>*) state.getCov().GetMatrixArray());</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <a class="code" href="namespacegenfit_1_1RKTools.html#a2f7105aa4bf8068626d3bdd03a2e1b99">RKTools::J_pMTxcov5xJ_pM</a>(J_pM_5x6, in5x5_, out6x6);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f08fa06a70fdb7d6c5fe8b63bbe7c81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f08fa06a70fdb7d6c5fe8b63bbe7c81">&#9670;&nbsp;</a></span>transformPM6() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::transformPM6 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">M6x6</a> &amp;&#160;</td>
          <td class="paramname"><em>out6x6</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a59bd63aa9aa5caabd044129afe399e56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59bd63aa9aa5caabd044129afe399e56">&#9670;&nbsp;</a></span>transformPM7() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::transformPM7 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> &amp;&#160;</td>
          <td class="paramname"><em>out7x7</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="RKTrackRep_8cc_source.html#l01425">1425</a> of file <a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                                                  {</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <span class="comment">// get vectors and aux variables</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <span class="keyword">const</span> TVector3&amp; U(state.getPlane()-&gt;getU());</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  <span class="keyword">const</span> TVector3&amp; <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>(state.getPlane()-&gt;getV());</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="keyword">const</span> TVector3&amp; W(state.getPlane()-&gt;getNormal());</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="keyword">const</span> TVectorD&amp; state5(state.getState());</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="keywordtype">double</span> spu(<a class="code" href="classgenfit_1_1RKTrackRep.html#a177f273f4dc3d7d1eaa646fe5a70aaf3">getSpu</a>(state));</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <a class="code" href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">M1x3</a> pTilde;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  pTilde[0] = spu * (W.X() + state5(1)*U.X() + state5(2)*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.X()); <span class="comment">// a_x</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  pTilde[1] = spu * (W.Y() + state5(1)*U.Y() + state5(2)*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Y()); <span class="comment">// a_y</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  pTilde[2] = spu * (W.Z() + state5(1)*U.Z() + state5(2)*<a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>.Z()); <span class="comment">// a_z</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <a class="code" href="namespacegenfit.html#a13cb802e03b7ad640485ba2bf9fe12f7">M5x7</a> J_pM;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <a class="code" href="classgenfit_1_1RKTrackRep.html#ab58d20f1b58e78d1952245a23e695553">calcJ_pM_5x7</a>(J_pM, U, <a class="code" href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">V</a>, pTilde, spu);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <span class="comment">// since the Jacobian contains a lot of zeros, and the resulting cov has to be symmetric,</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="comment">// the multiplication can be done much faster directly on array level</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <span class="comment">// out = J_pM^T * in5x5 * J_pM</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacegenfit.html#aa59cd0f20b9c72817c90fe0df1472ece">M5x5</a>&amp; in5x5_ = *((<a class="code" href="namespacegenfit.html#aa59cd0f20b9c72817c90fe0df1472ece">M5x5</a>*) state.getCov().GetMatrixArray());</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <a class="code" href="namespacegenfit_1_1RKTools.html#a2f7105aa4bf8068626d3bdd03a2e1b99">RKTools::J_pMTxcov5xJ_pM</a>(J_pM, in5x5_, out7x7);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a59bd63aa9aa5caabd044129afe399e56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59bd63aa9aa5caabd044129afe399e56">&#9670;&nbsp;</a></span>transformPM7() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void genfit::RKTrackRep::transformPM7 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgenfit_1_1MeasuredStateOnPlane.html">MeasuredStateOnPlane</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> &amp;&#160;</td>
          <td class="paramname"><em>out7x7</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ab145870eeeffa63af990fea3b93cf791"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab145870eeeffa63af990fea3b93cf791">&#9670;&nbsp;</a></span>cachePos_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int genfit::RKTrackRep::cachePos_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>use cached RKSteps_ for extrapolation </p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00288">288</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="a155aa1470ea4d57da938fe4cb484b9ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a155aa1470ea4d57da938fe4cb484b9ce">&#9670;&nbsp;</a></span>ExtrapSteps_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structgenfit_1_1ExtrapStep.html">ExtrapStep</a> &gt; genfit::RKTrackRep::ExtrapSteps_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00282">282</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="aafac71f71cc93a82aa42281d600b4776"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafac71f71cc93a82aa42281d600b4776">&#9670;&nbsp;</a></span>fJacobian_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixD genfit::RKTrackRep::fJacobian_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>steps made in Extrap during last extrapolation </p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00284">284</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="ae498a8cb248b5aa8dffb2555b6ca1925"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae498a8cb248b5aa8dffb2555b6ca1925">&#9670;&nbsp;</a></span>fNoise_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixDSym genfit::RKTrackRep::fNoise_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00285">285</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="a41dcd53004ff44e12a924084b37cad8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41dcd53004ff44e12a924084b37cad8c">&#9670;&nbsp;</a></span>J_MMT_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> genfit::RKTrackRep::J_MMT_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00295">295</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="ae76d29daa0524d65ed201eccf69c04f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae76d29daa0524d65ed201eccf69c04f8">&#9670;&nbsp;</a></span>lastEndState_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> genfit::RKTrackRep::lastEndState_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>state where the last extrapolation has started </p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00278">278</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="a9e71e74a9542d888e804a02998d25bce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e71e74a9542d888e804a02998d25bce">&#9670;&nbsp;</a></span>lastStartState_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classgenfit_1_1StateOnPlane.html">StateOnPlane</a> genfit::RKTrackRep::lastStartState_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00277">277</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="a0d72d0cf8fed127c8599c11283374288"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d72d0cf8fed127c8599c11283374288">&#9670;&nbsp;</a></span>limits_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classgenfit_1_1StepLimits.html">StepLimits</a> genfit::RKTrackRep::limits_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00292">292</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="a889ad368e5c5c6ac870402c9420b2bb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a889ad368e5c5c6ac870402c9420b2bb8">&#9670;&nbsp;</a></span>noiseArray_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> genfit::RKTrackRep::noiseArray_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00293">293</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="a210279ccff463e20ea47b345a288f1d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a210279ccff463e20ea47b345a288f1d0">&#9670;&nbsp;</a></span>noiseProjection_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">M7x7</a> genfit::RKTrackRep::noiseProjection_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>noise matrix of the last extrapolation </p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00294">294</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="a0825cd5635ffb49e5879ada5b9f86149"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0825cd5635ffb49e5879ada5b9f86149">&#9670;&nbsp;</a></span>RKSteps_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structgenfit_1_1RKStep.html">RKStep</a> &gt; genfit::RKTrackRep::RKSteps_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>state where the last extrapolation has ended </p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00279">279</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="a27fe628afd6be77f1f9de8a5a10d3b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27fe628afd6be77f1f9de8a5a10d3b0a">&#9670;&nbsp;</a></span>RKStepsFXStart_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int genfit::RKTrackRep::RKStepsFXStart_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>RungeKutta steps made in the last extrapolation. </p>

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00280">280</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="ac04989ccf60fdba61d369aa462cdf40b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac04989ccf60fdba61d369aa462cdf40b">&#9670;&nbsp;</a></span>RKStepsFXStop_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int genfit::RKTrackRep::RKStepsFXStop_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00281">281</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<a id="ad299432e86e08c7f4413dccb2cd18794"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad299432e86e08c7f4413dccb2cd18794">&#9670;&nbsp;</a></span>useCache_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool genfit::RKTrackRep::useCache_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html#l00287">287</a> of file <a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>genfit/include/genfit/<a class="el" href="include_2genfit_2RKTrackRep_8h_source.html">RKTrackRep.h</a></li>
<li>genfit/trackReps/src/<a class="el" href="RKTrackRep_8cc_source.html">RKTrackRep.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacegenfit_1_1RKTools_html_a2f7105aa4bf8068626d3bdd03a2e1b99"><div class="ttname"><a href="namespacegenfit_1_1RKTools.html#a2f7105aa4bf8068626d3bdd03a2e1b99">genfit::RKTools::J_pMTxcov5xJ_pM</a></div><div class="ttdeci">void J_pMTxcov5xJ_pM(const M5x7 &amp;J_pM, const M5x5 &amp;cov5, M7x7 &amp;out7)</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8cc_source.html#l00036">RKTools.cc:36</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a56e2cafc817e0e489e7a183c9bc8d549"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a56e2cafc817e0e489e7a183c9bc8d549">genfit::RKTrackRep::momMag</a></div><div class="ttdeci">double momMag(const M1x7 &amp;state7) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l02488">RKTrackRep.cc:2488</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a53bfc6c64a1fe1c3abea814a500dd60d"><div class="ttname"><a href="namespacegenfit.html#a53bfc6c64a1fe1c3abea814a500dd60d">genfit::SharedPlanePtr</a></div><div class="ttdeci">boost::shared_ptr&lt; genfit::DetPlane &gt; SharedPlanePtr</div><div class="ttdoc">Shared Pointer to a DetPlane.</div><div class="ttdef"><b>Definition:</b> <a href="SharedPlanePtr_8h_source.html#l00043">SharedPlanePtr.h:43</a></div></div>
<div class="ttc" id="aclassgenfit_1_1AbsTrackRep_html_af69df07f28005ab0da75a81b59b0af7f"><div class="ttname"><a href="classgenfit_1_1AbsTrackRep.html#af69df07f28005ab0da75a81b59b0af7f">genfit::AbsTrackRep::debugLvl_</a></div><div class="ttdeci">unsigned int debugLvl_</div><div class="ttdef"><b>Definition:</b> <a href="AbsTrackRep_8h_source.html#l00349">AbsTrackRep.h:349</a></div></div>
<div class="ttc" id="anamespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring_html_a2309e9fc8c297156c5977adca2c8a4cb"><div class="ttname"><a href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a2309e9fc8c297156c5977adca2c8a4cb">conditionsDatabase.demo.drifttubeMonitoring.v</a></div><div class="ttdeci">int v</div><div class="ttdef"><b>Definition:</b> <a href="drifttubeMonitoring_8py_source.html#l01000">drifttubeMonitoring.py:1000</a></div></div>
<div class="ttc" id="aclassgenfit_1_1MaterialEffects_html_a8bd536070da14d0a868a77ffa9cdaf43"><div class="ttname"><a href="classgenfit_1_1MaterialEffects.html#a8bd536070da14d0a868a77ffa9cdaf43">genfit::MaterialEffects::stepper</a></div><div class="ttdeci">void stepper(const RKTrackRep *rep, M1x7 &amp;state7, const double &amp;mom, double &amp;relMomLoss, const int &amp;pdg, MaterialProperties &amp;currentMaterial, StepLimits &amp;limits, bool varField=true)</div><div class="ttdoc">Returns maximum length so that a specified momentum loss will not be exceeded.</div><div class="ttdef"><b>Definition:</b> <a href="MaterialEffects_8cc_source.html#l00196">MaterialEffects.cc:196</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a41dcd53004ff44e12a924084b37cad8c"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a41dcd53004ff44e12a924084b37cad8c">genfit::RKTrackRep::J_MMT_</a></div><div class="ttdeci">M7x7 J_MMT_</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00295">RKTrackRep.h:295</a></div></div>
<div class="ttc" id="aPythia8Generator_8cxx_html_a0c71dd09868f911626085e61855e4d3a"><div class="ttname"><a href="Pythia8Generator_8cxx.html#a0c71dd09868f911626085e61855e4d3a">counter</a></div><div class="ttdeci">Int_t counter</div><div class="ttdef"><b>Definition:</b> <a href="Pythia8Generator_8cxx_source.html#l00014">Pythia8Generator.cxx:14</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_ae76d29daa0524d65ed201eccf69c04f8"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#ae76d29daa0524d65ed201eccf69c04f8">genfit::RKTrackRep::lastEndState_</a></div><div class="ttdeci">StateOnPlane lastEndState_</div><div class="ttdoc">state where the last extrapolation has started</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00278">RKTrackRep.h:278</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a31706efb8d31465e314243eca3594f6da4da62c4f01005fa9d9b41383d919fb42"><div class="ttname"><a href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da4da62c4f01005fa9d9b41383d919fb42">genfit::stp_fieldCurv</a></div><div class="ttdeci">@ stp_fieldCurv</div><div class="ttdef"><b>Definition:</b> <a href="StepLimits_8h_source.html#l00038">StepLimits.h:38</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_affa6945eaba3b0f2b143d039967b834e"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#affa6945eaba3b0f2b143d039967b834e">genfit::RKTrackRep::RKPropagate</a></div><div class="ttdeci">double RKPropagate(M1x7 &amp;state7, M7x7 *jacobian, M1x3 &amp;SA, double S, bool varField=true, bool calcOnlyLastRowOfJ=false) const</div><div class="ttdoc">The actual Runge Kutta propagation.</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l01143">RKTrackRep.cc:1143</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a01ccd6e74c4750e434e89992e853ae30"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a01ccd6e74c4750e434e89992e853ae30">genfit::RKTrackRep::getMom</a></div><div class="ttdeci">virtual TVector3 getMom(const StateOnPlane &amp;state) const</div><div class="ttdoc">Get the cartesian momentum vector of a state.</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l00677">RKTrackRep.cc:677</a></div></div>
<div class="ttc" id="anamespacehepunit_html_a8b7a286d413f2209e2192b2bbdc4ce0a"><div class="ttname"><a href="namespacehepunit.html#a8b7a286d413f2209e2192b2bbdc4ce0a">hepunit.m2</a></div><div class="ttdeci">int m2</div><div class="ttdef"><b>Definition:</b> <a href="hepunit_8py_source.html#l00057">hepunit.py:57</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_ae8e39563fac26c69d88f3408ba6de39e"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#ae8e39563fac26c69d88f3408ba6de39e">genfit::RKTrackRep::isSameType</a></div><div class="ttdeci">virtual bool isSameType(const AbsTrackRep *other)</div><div class="ttdoc">check if other is of same type (e.g. RKTrackRep).</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l02494">RKTrackRep.cc:2494</a></div></div>
<div class="ttc" id="aShipBellField_8cxx_html_a42d42dd2c682d42f11de58e34c89f895"><div class="ttname"><a href="ShipBellField_8cxx.html#a42d42dd2c682d42f11de58e34c89f895">m</a></div><div class="ttdeci">Double_t m</div><div class="ttdef"><b>Definition:</b> <a href="ShipBellField_8cxx_source.html#l00020">ShipBellField.cxx:20</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a281fc9087c22ee0ed63e22330fecad9d"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a281fc9087c22ee0ed63e22330fecad9d">genfit::RKTrackRep::estimateStep</a></div><div class="ttdeci">double estimateStep(const M1x7 &amp;state7, const M1x4 &amp;SU, const DetPlane &amp;plane, const double &amp;charge, double &amp;relMomLoss, StepLimits &amp;limits) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l01963">RKTrackRep.cc:1963</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a4fa173bb3b0080274c05f9fcf399768d"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a4fa173bb3b0080274c05f9fcf399768d">genfit::RKTrackRep::Extrap</a></div><div class="ttdeci">double Extrap(const DetPlane &amp;startPlane, const DetPlane &amp;destPlane, double charge, bool &amp;isAtBoundary, M1x7 &amp;state7, bool fillExtrapSteps, TMatrixDSym *cov=nullptr, bool onlyOneStep=false, bool stopAtBoundary=false, double maxStep=1.E99) const</div><div class="ttdoc">Handles propagation and material effects.</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l02201">RKTrackRep.cc:2201</a></div></div>
<div class="ttc" id="anamespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring_html_a5922b10e23818a4485857b715589241e"><div class="ttname"><a href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a5922b10e23818a4485857b715589241e">conditionsDatabase.demo.drifttubeMonitoring.log</a></div><div class="ttdeci">dictionary log</div><div class="ttdef"><b>Definition:</b> <a href="drifttubeMonitoring_8py_source.html#l00057">drifttubeMonitoring.py:57</a></div></div>
<div class="ttc" id="aclassgenfit_1_1StepLimits_html_a53d606cfca63873ad0b00993e8045d65"><div class="ttname"><a href="classgenfit_1_1StepLimits.html#a53d606cfca63873ad0b00993e8045d65">genfit::StepLimits::getLowestLimit</a></div><div class="ttdeci">std::pair&lt; StepLimitType, double &gt; getLowestLimit(double margin=1.E-3) const</div><div class="ttdoc">Get the lowest limit.</div><div class="ttdef"><b>Definition:</b> <a href="StepLimits_8cc_source.html#l00044">StepLimits.cc:44</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_ac04989ccf60fdba61d369aa462cdf40b"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#ac04989ccf60fdba61d369aa462cdf40b">genfit::RKTrackRep::RKStepsFXStop_</a></div><div class="ttdeci">int RKStepsFXStop_</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00281">RKTrackRep.h:281</a></div></div>
<div class="ttc" id="aclassgenfit_1_1StepLimits_html_a24a223a3dc45f881ff1dd9897cedd56b"><div class="ttname"><a href="classgenfit_1_1StepLimits.html#a24a223a3dc45f881ff1dd9897cedd56b">genfit::StepLimits::setLimit</a></div><div class="ttdeci">void setLimit(StepLimitType type, double value)</div><div class="ttdoc">absolute of value will be taken! If limit is already lower, it will be set to value anyway.</div><div class="ttdef"><b>Definition:</b> <a href="StepLimits_8h_source.html#l00089">StepLimits.h:89</a></div></div>
<div class="ttc" id="anamespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring_html_a5e37896fee417eb26379057dc702c406"><div class="ttname"><a href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a5e37896fee417eb26379057dc702c406">conditionsDatabase.demo.drifttubeMonitoring.a</a></div><div class="ttdeci">a</div><div class="ttdef"><b>Definition:</b> <a href="drifttubeMonitoring_8py_source.html#l00213">drifttubeMonitoring.py:213</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a71dffb5437351d65394a778a5cc0b5df"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a71dffb5437351d65394a778a5cc0b5df">genfit::RKTrackRep::extrapToPoint</a></div><div class="ttdeci">virtual double extrapToPoint(StateOnPlane &amp;state, const TVector3 &amp;point, const TMatrixDSym *G=NULL, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l00246">RKTrackRep.cc:246</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a743ae73c90b306147fff6092ae2a0c99"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a743ae73c90b306147fff6092ae2a0c99">genfit::RKTrackRep::setPosMom</a></div><div class="ttdeci">virtual void setPosMom(StateOnPlane &amp;state, const TVector3 &amp;pos, const TVector3 &amp;mom) const</div><div class="ttdoc">Set position and momentum of state.</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l00965">RKTrackRep.cc:965</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_af556c558f049d00b43b079bd363564d9"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#af556c558f049d00b43b079bd363564d9">genfit::RKTrackRep::extrapolateToLine</a></div><div class="ttdeci">virtual double extrapolateToLine(StateOnPlane &amp;state, const TVector3 &amp;linePoint, const TVector3 &amp;lineDirection, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</div><div class="ttdoc">Extrapolates the state to the POCA to a line, and returns the extrapolation length and,...</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l00150">RKTrackRep.cc:150</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a9e71e74a9542d888e804a02998d25bce"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a9e71e74a9542d888e804a02998d25bce">genfit::RKTrackRep::lastStartState_</a></div><div class="ttdeci">StateOnPlane lastStartState_</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00277">RKTrackRep.h:277</a></div></div>
<div class="ttc" id="aclassgenfit_1_1AbsTrackRep_html_aaf70894cebf437f09c284953d7e60734"><div class="ttname"><a href="classgenfit_1_1AbsTrackRep.html#aaf70894cebf437f09c284953d7e60734">genfit::AbsTrackRep::getPDGCharge</a></div><div class="ttdeci">double getPDGCharge() const</div><div class="ttdoc">Get the charge of the particle of the pdg code.</div><div class="ttdef"><b>Definition:</b> <a href="AbsTrackRep_8cc_source.html#l00093">AbsTrackRep.cc:93</a></div></div>
<div class="ttc" id="anamespaceadd__noise__to__field_html_a96cf5cc2cc008d7422009cb2ad93cb51"><div class="ttname"><a href="namespaceadd__noise__to__field.html#a96cf5cc2cc008d7422009cb2ad93cb51">add_noise_to_field.step</a></div><div class="ttdeci">step</div><div class="ttdef"><b>Definition:</b> <a href="add__noise__to__field_8py_source.html#l00069">add_noise_to_field.py:69</a></div></div>
<div class="ttc" id="aclassgenfit_1_1AbsTrackRep_html_a718e040ec8f22ef738af7c9005355443"><div class="ttname"><a href="classgenfit_1_1AbsTrackRep.html#a718e040ec8f22ef738af7c9005355443">genfit::AbsTrackRep::getPDG</a></div><div class="ttdeci">int getPDG() const</div><div class="ttdoc">Get the pdg code.</div><div class="ttdef"><b>Definition:</b> <a href="AbsTrackRep_8h_source.html#l00256">AbsTrackRep.h:256</a></div></div>
<div class="ttc" id="anamespacerun__simPgun_html_ac57e22275cd6a7bdb768a9d30320595e"><div class="ttname"><a href="namespacerun__simPgun.html#ac57e22275cd6a7bdb768a9d30320595e">run_simPgun.pos</a></div><div class="ttdeci">pos</div><div class="ttdef"><b>Definition:</b> <a href="run__simPgun_8py_source.html#l00085">run_simPgun.py:85</a></div></div>
<div class="ttc" id="anamespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring_html_a0300c9226cb21058a0167e6076c29b1d"><div class="ttname"><a href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a0300c9226cb21058a0167e6076c29b1d">conditionsDatabase.demo.drifttubeMonitoring.n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="drifttubeMonitoring_8py_source.html#l00253">drifttubeMonitoring.py:253</a></div></div>
<div class="ttc" id="aclassgenfit_1_1StateOnPlane_html_a0123543a15df51f8beaa98660cfa89b7"><div class="ttname"><a href="classgenfit_1_1StateOnPlane.html#a0123543a15df51f8beaa98660cfa89b7">genfit::StateOnPlane::setPlane</a></div><div class="ttdeci">void setPlane(const SharedPlanePtr &amp;plane)</div><div class="ttdef"><b>Definition:</b> <a href="StateOnPlane_8h_source.html#l00067">StateOnPlane.h:67</a></div></div>
<div class="ttc" id="aclassgenfit_1_1FieldManager_html_a7432ac0fd7ad0d3249ca4546a8ead6cb"><div class="ttname"><a href="classgenfit_1_1FieldManager.html#a7432ac0fd7ad0d3249ca4546a8ead6cb">genfit::FieldManager::getFieldVal</a></div><div class="ttdeci">TVector3 getFieldVal(const TVector3 &amp;position)</div><div class="ttdoc">This does NOT use the cache!</div><div class="ttdef"><b>Definition:</b> <a href="core_2include_2FieldManager_8h_source.html#l00063">FieldManager.h:63</a></div></div>
<div class="ttc" id="anamespacemakeCascade_html_a578d35e800b9f4a15a0c00d693a8de44"><div class="ttname"><a href="namespacemakeCascade.html#a578d35e800b9f4a15a0c00d693a8de44">makeCascade.R</a></div><div class="ttdeci">string R</div><div class="ttdef"><b>Definition:</b> <a href="makeCascade_8py_source.html#l00011">makeCascade.py:11</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_adcd6b3f8bd742ea90f3d890ff01452c3"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#adcd6b3f8bd742ea90f3d890ff01452c3">genfit::RKTrackRep::pocaOnLine</a></div><div class="ttdeci">TVector3 pocaOnLine(const TVector3 &amp;linePoint, const TVector3 &amp;lineDirection, const TVector3 &amp;point) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l02189">RKTrackRep.cc:2189</a></div></div>
<div class="ttc" id="anamespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring_html_ab2f042ac8d5c79bab81997961ad3ee23"><div class="ttname"><a href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#ab2f042ac8d5c79bab81997961ad3ee23">conditionsDatabase.demo.drifttubeMonitoring.angle</a></div><div class="ttdeci">tuple angle</div><div class="ttdef"><b>Definition:</b> <a href="drifttubeMonitoring_8py_source.html#l00286">drifttubeMonitoring.py:286</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a421ac85c5f1c7b5ef3216943dbf7fc15"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a421ac85c5f1c7b5ef3216943dbf7fc15">genfit::RKTrackRep::calcForwardJacobianAndNoise</a></div><div class="ttdeci">void calcForwardJacobianAndNoise(const M1x7 &amp;startState7, const DetPlane &amp;startPlane, const M1x7 &amp;destState7, const DetPlane &amp;destPlane) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l00774">RKTrackRep.cc:774</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_abaa7f24fb07657e16fc24eb4340e79ed"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#abaa7f24fb07657e16fc24eb4340e79ed">genfit::RKTrackRep::getState5</a></div><div class="ttdeci">void getState5(StateOnPlane &amp;state, const M1x7 &amp;state7) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l01385">RKTrackRep.cc:1385</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_ad299432e86e08c7f4413dccb2cd18794"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#ad299432e86e08c7f4413dccb2cd18794">genfit::RKTrackRep::useCache_</a></div><div class="ttdeci">bool useCache_</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00287">RKTrackRep.h:287</a></div></div>
<div class="ttc" id="anamespacerunPythia8_html_a4cd74a33c53eaeef70fcb6b448b9b285"><div class="ttname"><a href="namespacerunPythia8.html#a4cd74a33c53eaeef70fcb6b448b9b285">runPythia8.k</a></div><div class="ttdeci">int k</div><div class="ttdef"><b>Definition:</b> <a href="runPythia8_8py_source.html#l00129">runPythia8.py:129</a></div></div>
<div class="ttc" id="anamespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring_html_abaf58c8e5683cef7081a12d534f05739"><div class="ttname"><a href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#abaf58c8e5683cef7081a12d534f05739">conditionsDatabase.demo.drifttubeMonitoring.start</a></div><div class="ttdeci">dictionary start</div><div class="ttdef"><b>Definition:</b> <a href="drifttubeMonitoring_8py_source.html#l00254">drifttubeMonitoring.py:254</a></div></div>
<div class="ttc" id="anamespacegenfit_1_1RKTools_html_a5ad8693b4b34e9d016b4bedc7a574800"><div class="ttname"><a href="namespacegenfit_1_1RKTools.html#a5ad8693b4b34e9d016b4bedc7a574800">genfit::RKTools::Np_N_NpT</a></div><div class="ttdeci">void Np_N_NpT(const M7x7 &amp;Np, M7x7 &amp;N)</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8cc_source.html#l00618">RKTools.cc:618</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a13cb802e03b7ad640485ba2bf9fe12f7"><div class="ttname"><a href="namespacegenfit.html#a13cb802e03b7ad640485ba2bf9fe12f7">genfit::M5x7</a></div><div class="ttdeci">double M5x7[5 *7]</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8h_source.html#l00044">RKTools.h:44</a></div></div>
<div class="ttc" id="aclassgenfit_1_1FieldManager_html_aaf0b56fea4f0deb428de8749febf792d"><div class="ttname"><a href="classgenfit_1_1FieldManager.html#aaf0b56fea4f0deb428de8749febf792d">genfit::FieldManager::getInstance</a></div><div class="ttdeci">static FieldManager * getInstance()</div><div class="ttdoc">Get singleton instance.</div><div class="ttdef"><b>Definition:</b> <a href="core_2include_2FieldManager_8h_source.html#l00112">FieldManager.h:112</a></div></div>
<div class="ttc" id="aclassgenfit_1_1AbsTrackRep_html_a29cc69d36b01cab1d0c6fc8a9529fac4"><div class="ttname"><a href="classgenfit_1_1AbsTrackRep.html#a29cc69d36b01cab1d0c6fc8a9529fac4">genfit::AbsTrackRep::pdgCode_</a></div><div class="ttdeci">int pdgCode_</div><div class="ttdoc">Particle code.</div><div class="ttdef"><b>Definition:</b> <a href="AbsTrackRep_8h_source.html#l00345">AbsTrackRep.h:345</a></div></div>
<div class="ttc" id="anamespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring_html_aede22303843a29a0e309f77331129bf9"><div class="ttname"><a href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#aede22303843a29a0e309f77331129bf9">conditionsDatabase.demo.drifttubeMonitoring.r</a></div><div class="ttdeci">r</div><div class="ttdef"><b>Definition:</b> <a href="drifttubeMonitoring_8py_source.html#l00678">drifttubeMonitoring.py:678</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a324ba092d634f324285f445b4bba12b6"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a324ba092d634f324285f445b4bba12b6">genfit::RKTrackRep::setSpu</a></div><div class="ttdeci">void setSpu(StateOnPlane &amp;state, double spu) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l01136">RKTrackRep.cc:1136</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a6154edc550af3e20a8b596b9c22e9a6e"><div class="ttname"><a href="namespacegenfit.html#a6154edc550af3e20a8b596b9c22e9a6e">genfit::M5x6</a></div><div class="ttdeci">double M5x6[5 *6]</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8h_source.html#l00043">RKTools.h:43</a></div></div>
<div class="ttc" id="aclassgenfit_1_1AbsTrackRep_html_a7f0073f2446a780e27886ab512e7787f"><div class="ttname"><a href="classgenfit_1_1AbsTrackRep.html#a7f0073f2446a780e27886ab512e7787f">genfit::AbsTrackRep::getMass</a></div><div class="ttdeci">double getMass(const StateOnPlane &amp;state) const</div><div class="ttdoc">Get tha particle mass in GeV/c^2.</div><div class="ttdef"><b>Definition:</b> <a href="AbsTrackRep_8cc_source.html#l00100">AbsTrackRep.cc:100</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_ae5b17345256ef11df15d571f9237f431"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#ae5b17345256ef11df15d571f9237f431">genfit::RKTrackRep::transformM6P</a></div><div class="ttdeci">void transformM6P(const M6x6 &amp;in6x6, const M1x7 &amp;state7, MeasuredStateOnPlane &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l01627">RKTrackRep.cc:1627</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a93996a7134dfba3449c78bf882de8720"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a93996a7134dfba3449c78bf882de8720">genfit::RKTrackRep::checkCache</a></div><div class="ttdeci">void checkCache(const StateOnPlane &amp;state, const SharedPlanePtr *plane) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l02412">RKTrackRep.cc:2412</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a0825cd5635ffb49e5879ada5b9f86149"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a0825cd5635ffb49e5879ada5b9f86149">genfit::RKTrackRep::RKSteps_</a></div><div class="ttdeci">std::vector&lt; RKStep &gt; RKSteps_</div><div class="ttdoc">state where the last extrapolation has ended</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00279">RKTrackRep.h:279</a></div></div>
<div class="ttc" id="anamespacemakeDecay_html_ad0cca2a83c59bb283ee59cc30dc2ea4b"><div class="ttname"><a href="namespacemakeDecay.html#ad0cca2a83c59bb283ee59cc30dc2ea4b">makeDecay.par</a></div><div class="ttdeci">par</div><div class="ttdef"><b>Definition:</b> <a href="makeDecay_8py_source.html#l00135">makeDecay.py:135</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a8f08fa06a70fdb7d6c5fe8b63bbe7c81"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a8f08fa06a70fdb7d6c5fe8b63bbe7c81">genfit::RKTrackRep::transformPM6</a></div><div class="ttdeci">void transformPM6(const MeasuredStateOnPlane &amp;state, M6x6 &amp;out6x6) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l01497">RKTrackRep.cc:1497</a></div></div>
<div class="ttc" id="aclassgenfit_1_1AbsTrackRep_html_af8b046499b9651e30c0d4e06243c58b4"><div class="ttname"><a href="classgenfit_1_1AbsTrackRep.html#af8b046499b9651e30c0d4e06243c58b4">genfit::AbsTrackRep::propDir_</a></div><div class="ttdeci">char propDir_</div><div class="ttdoc">propagation direction (-1, 0, 1) -&gt; (backward, auto, forward)</div><div class="ttdef"><b>Definition:</b> <a href="AbsTrackRep_8h_source.html#l00347">AbsTrackRep.h:347</a></div></div>
<div class="ttc" id="anamespacegenfit_1_1RKTools_html_a399786be57d47fbbeb5539095b0138f8"><div class="ttname"><a href="namespacegenfit_1_1RKTools.html#a399786be57d47fbbeb5539095b0138f8">genfit::RKTools::J_MpTxcov6xJ_Mp</a></div><div class="ttdeci">void J_MpTxcov6xJ_Mp(const M6x5 &amp;J_Mp, const M6x6 &amp;cov6, M5x5 &amp;out5)</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8cc_source.html#l00277">RKTools.cc:277</a></div></div>
<div class="ttc" id="anamespacerunPythia8_html_a92b74818d4845c92d20cf34c4802c79d"><div class="ttname"><a href="namespacerunPythia8.html#a92b74818d4845c92d20cf34c4802c79d">runPythia8.G</a></div><div class="ttdeci">dictionary G</div><div class="ttdef"><b>Definition:</b> <a href="runPythia8_8py_source.html#l00133">runPythia8.py:133</a></div></div>
<div class="ttc" id="aclassgenfit_1_1StateOnPlane_html_a07e3deab7abff59e61fd91786fa335b6"><div class="ttname"><a href="classgenfit_1_1StateOnPlane.html#a07e3deab7abff59e61fd91786fa335b6">genfit::StateOnPlane::getPlane</a></div><div class="ttdeci">const SharedPlanePtr &amp; getPlane() const</div><div class="ttdef"><b>Definition:</b> <a href="StateOnPlane_8h_source.html#l00063">StateOnPlane.h:63</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a14b3e8a65ae607330fcd65315ace0cba"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a14b3e8a65ae607330fcd65315ace0cba">genfit::RKTrackRep::calcJ_Mp_7x5</a></div><div class="ttdeci">void calcJ_Mp_7x5(M7x5 &amp;J_Mp, const TVector3 &amp;U, const TVector3 &amp;V, const TVector3 &amp;W, const M1x3 &amp;A) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l01582">RKTrackRep.cc:1582</a></div></div>
<div class="ttc" id="anamespacerun__simScript_html_a7438ba4e0f241567d8e58065969d5ab5"><div class="ttname"><a href="namespacerun__simScript.html#a7438ba4e0f241567d8e58065969d5ab5">run_simScript.t</a></div><div class="ttdeci">bool t</div><div class="ttdef"><b>Definition:</b> <a href="run__simScript_8py_source.html#l00710">run_simScript.py:710</a></div></div>
<div class="ttc" id="anamespacescifiSimAna_html_a3d2b280b16570f1b32f4c8e56f666015"><div class="ttname"><a href="namespacescifiSimAna.html#a3d2b280b16570f1b32f4c8e56f666015">scifiSimAna.nPoints</a></div><div class="ttdeci">int nPoints</div><div class="ttdef"><b>Definition:</b> <a href="scifiSimAna_8py_source.html#l00156">scifiSimAna.py:156</a></div></div>
<div class="ttc" id="aclassgenfit_1_1StateOnPlane_html_a3c89a0efae9b00bd44ee240aa9e6c843"><div class="ttname"><a href="classgenfit_1_1StateOnPlane.html#a3c89a0efae9b00bd44ee240aa9e6c843">genfit::StateOnPlane::getState</a></div><div class="ttdeci">const TVectorD &amp; getState() const</div><div class="ttdef"><b>Definition:</b> <a href="StateOnPlane_8h_source.html#l00059">StateOnPlane.h:59</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a31706efb8d31465e314243eca3594f6da9a3e90c9756979f3bdd4de5e3cd9da15"><div class="ttname"><a href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da9a3e90c9756979f3bdd4de5e3cd9da15">genfit::stp_sMaxArg</a></div><div class="ttdeci">@ stp_sMaxArg</div><div class="ttdef"><b>Definition:</b> <a href="StepLimits_8h_source.html#l00043">StepLimits.h:43</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a31706efb8d31465e314243eca3594f6daa23157bc4bd9610af3b3416324b47bff"><div class="ttname"><a href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6daa23157bc4bd9610af3b3416324b47bff">genfit::stp_momLoss</a></div><div class="ttdeci">@ stp_momLoss</div><div class="ttdef"><b>Definition:</b> <a href="StepLimits_8h_source.html#l00039">StepLimits.h:39</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a3e8167b2b78ea4a8f7d5f6485640a6cd"><div class="ttname"><a href="namespacegenfit.html#a3e8167b2b78ea4a8f7d5f6485640a6cd">genfit::M1x3</a></div><div class="ttdeci">double M1x3[1 *3]</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8h_source.html#l00033">RKTools.h:33</a></div></div>
<div class="ttc" id="anamespacegenfit_1_1RKTools_html_a65fa58888e266d50b8857b6d098377a7"><div class="ttname"><a href="namespacegenfit_1_1RKTools.html#a65fa58888e266d50b8857b6d098377a7">genfit::RKTools::J_pMTTxJ_MMTTxJ_MpTT</a></div><div class="ttdeci">void J_pMTTxJ_MMTTxJ_MpTT(const M7x5 &amp;J_pMT, const M7x7 &amp;J_MMT, const M5x7 &amp;J_MpT, M5x5 &amp;J_pp)</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8cc_source.html#l00508">RKTools.cc:508</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a29c9e8adb3357e302bebf4b3f6959f77"><div class="ttname"><a href="namespacegenfit.html#a29c9e8adb3357e302bebf4b3f6959f77">genfit::M1x7</a></div><div class="ttdeci">double M1x7[1 *7]</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8h_source.html#l00036">RKTools.h:36</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a889ad368e5c5c6ac870402c9420b2bb8"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a889ad368e5c5c6ac870402c9420b2bb8">genfit::RKTrackRep::noiseArray_</a></div><div class="ttdeci">M7x7 noiseArray_</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00293">RKTrackRep.h:293</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a9fe94bdc4b216fd56da5e7e447403d75"><div class="ttname"><a href="namespacegenfit.html#a9fe94bdc4b216fd56da5e7e447403d75">genfit::M6x5</a></div><div class="ttdeci">double M6x5[6 *5]</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8h_source.html#l00041">RKTools.h:41</a></div></div>
<div class="ttc" id="aclassgenfit_1_1MaterialEffects_html_a2b4a0a0718f2c097d73b7b8c9514557f"><div class="ttname"><a href="classgenfit_1_1MaterialEffects.html#a2b4a0a0718f2c097d73b7b8c9514557f">genfit::MaterialEffects::effects</a></div><div class="ttdeci">double effects(const std::vector&lt; genfit::RKStep &gt; &amp;steps, int materialsFXStart, int materialsFXStop, const double &amp;mom, const int &amp;pdg, M7x7 *noise=nullptr)</div><div class="ttdoc">Calculates energy loss in the traveled path, optional calculation of noise matrix.</div></div>
<div class="ttc" id="anamespacerun__simEcal_html_a43b5db65045aec3156fc3ae4167610f3"><div class="ttname"><a href="namespacerun__simEcal.html#a43b5db65045aec3156fc3ae4167610f3">run_simEcal.momentum</a></div><div class="ttdeci">int momentum</div><div class="ttdef"><b>Definition:</b> <a href="run__simEcal_8py_source.html#l00003">run_simEcal.py:3</a></div></div>
<div class="ttc" id="aclassgenfit_1_1StepLimits_html_ada8640542f6d6fc3f9467bf08d8ad777"><div class="ttname"><a href="classgenfit_1_1StepLimits.html#ada8640542f6d6fc3f9467bf08d8ad777">genfit::StepLimits::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdef"><b>Definition:</b> <a href="StepLimits_8cc_source.html#l00108">StepLimits.cc:108</a></div></div>
<div class="ttc" id="anamespacerun__simPgun_html_a6e3b169e244bda1369fd9edbcd52ea01"><div class="ttname"><a href="namespacerun__simPgun.html#a6e3b169e244bda1369fd9edbcd52ea01">run_simPgun.mom</a></div><div class="ttdeci">mom</div><div class="ttdef"><b>Definition:</b> <a href="run__simPgun_8py_source.html#l00084">run_simPgun.py:84</a></div></div>
<div class="ttc" id="anamespacegenfit_html_aa59cd0f20b9c72817c90fe0df1472ece"><div class="ttname"><a href="namespacegenfit.html#aa59cd0f20b9c72817c90fe0df1472ece">genfit::M5x5</a></div><div class="ttdeci">double M5x5[5 *5]</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8h_source.html#l00037">RKTools.h:37</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf"><div class="ttname"><a href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6dade88faa0984312182863fb378aecc4bf">genfit::stp_plane</a></div><div class="ttdeci">@ stp_plane</div><div class="ttdef"><b>Definition:</b> <a href="StepLimits_8h_source.html#l00045">StepLimits.h:45</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a31706efb8d31465e314243eca3594f6da605e0085946c284dd888271e7f7c5252"><div class="ttname"><a href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da605e0085946c284dd888271e7f7c5252">genfit::stp_boundary</a></div><div class="ttdeci">@ stp_boundary</div><div class="ttdef"><b>Definition:</b> <a href="StepLimits_8h_source.html#l00044">StepLimits.h:44</a></div></div>
<div class="ttc" id="aRKTrackRep_8cc_html_ad11facf168162312152fe0d946fefbee"><div class="ttname"><a href="RKTrackRep_8cc.html#ad11facf168162312152fe0d946fefbee">MINSTEP</a></div><div class="ttdeci">#define MINSTEP</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l00034">RKTrackRep.cc:34</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a64a99eb10c8052a950ad68376257e7dd"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a64a99eb10c8052a950ad68376257e7dd">genfit::RKTrackRep::getState7</a></div><div class="ttdeci">void getState7(const StateOnPlane &amp;state, M1x7 &amp;state7) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l01351">RKTrackRep.cc:1351</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_ab145870eeeffa63af990fea3b93cf791"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#ab145870eeeffa63af990fea3b93cf791">genfit::RKTrackRep::cachePos_</a></div><div class="ttdeci">unsigned int cachePos_</div><div class="ttdoc">use cached RKSteps_ for extrapolation</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00288">RKTrackRep.h:288</a></div></div>
<div class="ttc" id="anamespacerunPythia8_html_a3f77e7ead348cea83692a18f52d78a62"><div class="ttname"><a href="namespacerunPythia8.html#a3f77e7ead348cea83692a18f52d78a62">runPythia8.A</a></div><div class="ttdeci">dictionary A</div><div class="ttdef"><b>Definition:</b> <a href="runPythia8_8py_source.html#l00122">runPythia8.py:122</a></div></div>
<div class="ttc" id="anamespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring_html_a03923acd0da372eec842c9a6e48161e4"><div class="ttname"><a href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a03923acd0da372eec842c9a6e48161e4">conditionsDatabase.demo.drifttubeMonitoring.p</a></div><div class="ttdeci">string p</div><div class="ttdef"><b>Definition:</b> <a href="drifttubeMonitoring_8py_source.html#l00289">drifttubeMonitoring.py:289</a></div></div>
<div class="ttc" id="aclassgenfit_1_1StateOnPlane_html_ae524fe7b14b36572372ee7553557d37c"><div class="ttname"><a href="classgenfit_1_1StateOnPlane.html#ae524fe7b14b36572372ee7553557d37c">genfit::StateOnPlane::getMomMag</a></div><div class="ttdeci">double getMomMag() const</div><div class="ttdef"><b>Definition:</b> <a href="StateOnPlane_8h_source.html#l00110">StateOnPlane.h:110</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a27fe628afd6be77f1f9de8a5a10d3b0a"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a27fe628afd6be77f1f9de8a5a10d3b0a">genfit::RKTrackRep::RKStepsFXStart_</a></div><div class="ttdeci">int RKStepsFXStart_</div><div class="ttdoc">RungeKutta steps made in the last extrapolation.</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00280">RKTrackRep.h:280</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_ab58d20f1b58e78d1952245a23e695553"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#ab58d20f1b58e78d1952245a23e695553">genfit::RKTrackRep::calcJ_pM_5x7</a></div><div class="ttdeci">void calcJ_pM_5x7(M5x7 &amp;J_pM, const TVector3 &amp;U, const TVector3 &amp;V, const M1x3 &amp;pTilde, double spu) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l01452">RKTrackRep.cc:1452</a></div></div>
<div class="ttc" id="anamespaceShipAna_html_aa4bf87f4d17f9d38b1d8f4d009bb54b3"><div class="ttname"><a href="namespaceShipAna.html#aa4bf87f4d17f9d38b1d8f4d009bb54b3">ShipAna.i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="ShipAna_8py_source.html#l00086">ShipAna.py:86</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a0d80e3ef5d443b05e14b33b63a0d3ea9"><div class="ttname"><a href="namespacegenfit.html#a0d80e3ef5d443b05e14b33b63a0d3ea9">genfit::M6x6</a></div><div class="ttdeci">double M6x6[6 *6]</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8h_source.html#l00038">RKTools.h:38</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_aafac71f71cc93a82aa42281d600b4776"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#aafac71f71cc93a82aa42281d600b4776">genfit::RKTrackRep::fJacobian_</a></div><div class="ttdeci">TMatrixD fJacobian_</div><div class="ttdoc">steps made in Extrap during last extrapolation</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00284">RKTrackRep.h:284</a></div></div>
<div class="ttc" id="anamespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring_html_a4761262924c3ec5c89e319afab5084a9"><div class="ttname"><a href="namespaceconditionsDatabase_1_1demo_1_1drifttubeMonitoring.html#a4761262924c3ec5c89e319afab5084a9">conditionsDatabase.demo.drifttubeMonitoring.dest</a></div><div class="ttdeci">dest</div><div class="ttdef"><b>Definition:</b> <a href="drifttubeMonitoring_8py_source.html#l00073">drifttubeMonitoring.py:73</a></div></div>
<div class="ttc" id="anamespacepi0Reco_html_a1aa5dc9c03ee8cd23d0c329c69e198d2"><div class="ttname"><a href="namespacepi0Reco.html#a1aa5dc9c03ee8cd23d0c329c69e198d2">pi0Reco.V</a></div><div class="ttdeci">V</div><div class="ttdef"><b>Definition:</b> <a href="pi0Reco_8py_source.html#l00008">pi0Reco.py:8</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a5235db4672bcedc6c78d69470b1cb289"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a5235db4672bcedc6c78d69470b1cb289">genfit::RKTrackRep::RKutta</a></div><div class="ttdeci">bool RKutta(const M1x4 &amp;SU, const DetPlane &amp;plane, double charge, M1x7 &amp;state7, M7x7 *jacobianT, double &amp;coveredDistance, bool &amp;checkJacProj, M7x7 &amp;noiseProjection, StepLimits &amp;limits, bool onlyOneStep=false, bool calcOnlyLastRowOfJ=false) const</div><div class="ttdoc">Propagates the particle through the magnetic field.</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l01705">RKTrackRep.cc:1705</a></div></div>
<div class="ttc" id="anamespaceScifiCTR_html_a87a9336a17ef0557a1090c56e6990797"><div class="ttname"><a href="namespaceScifiCTR.html#a87a9336a17ef0557a1090c56e6990797">ScifiCTR.b</a></div><div class="ttdeci">b</div><div class="ttdef"><b>Definition:</b> <a href="ScifiCTR_8py_source.html#l00450">ScifiCTR.py:450</a></div></div>
<div class="ttc" id="aclassgenfit_1_1StateOnPlane_html_ae99cc4cd2f81ae8c848b4cb76f63389e"><div class="ttname"><a href="classgenfit_1_1StateOnPlane.html#ae99cc4cd2f81ae8c848b4cb76f63389e">genfit::StateOnPlane::setStatePlane</a></div><div class="ttdeci">void setStatePlane(const TVectorD &amp;state, const SharedPlanePtr &amp;plane)</div><div class="ttdef"><b>Definition:</b> <a href="StateOnPlane_8h_source.html#l00068">StateOnPlane.h:68</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a0d72d0cf8fed127c8599c11283374288"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a0d72d0cf8fed127c8599c11283374288">genfit::RKTrackRep::limits_</a></div><div class="ttdeci">StepLimits limits_</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00292">RKTrackRep.h:292</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a31706efb8d31465e314243eca3594f6da61f5269fcba7511a27c72e1583641040"><div class="ttname"><a href="namespacegenfit.html#a31706efb8d31465e314243eca3594f6da61f5269fcba7511a27c72e1583641040">genfit::stp_sMax</a></div><div class="ttdeci">@ stp_sMax</div><div class="ttdef"><b>Definition:</b> <a href="StepLimits_8h_source.html#l00040">StepLimits.h:40</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_ae498a8cb248b5aa8dffb2555b6ca1925"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#ae498a8cb248b5aa8dffb2555b6ca1925">genfit::RKTrackRep::fNoise_</a></div><div class="ttdeci">TMatrixDSym fNoise_</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00285">RKTrackRep.h:285</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_ade2e4cf73880a2df757e9dd372bf7b00"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#ade2e4cf73880a2df757e9dd372bf7b00">genfit::RKTrackRep::extrapolateToPlane</a></div><div class="ttdeci">virtual double extrapolateToPlane(StateOnPlane &amp;state, const SharedPlanePtr &amp;plane, bool stopAtBoundary=false, bool calcJacobianNoise=false) const</div><div class="ttdoc">Extrapolates the state to plane, and returns the extrapolation length and, via reference,...</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l00097">RKTrackRep.cc:97</a></div></div>
<div class="ttc" id="anamespacehnl_html_adb7ba50b8941bf3badea16f97cb665d5"><div class="ttname"><a href="namespacehnl.html#adb7ba50b8941bf3badea16f97cb665d5">hnl.c</a></div><div class="ttdeci">c</div><div class="ttdef"><b>Definition:</b> <a href="hnl_8py_source.html#l00100">hnl.py:100</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_adf4865558fe7b54ffe94c3e145344505"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#adf4865558fe7b54ffe94c3e145344505">genfit::RKTrackRep::getPos</a></div><div class="ttdeci">virtual TVector3 getPos(const StateOnPlane &amp;state) const</div><div class="ttdoc">Get the cartesian position of a state.</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l00669">RKTrackRep.cc:669</a></div></div>
<div class="ttc" id="anamespaceconvertRawData__muTestbeam_html_acc0e8c0a4e13c384547a75bbba32164c"><div class="ttname"><a href="namespaceconvertRawData__muTestbeam.html#acc0e8c0a4e13c384547a75bbba32164c">convertRawData_muTestbeam.status</a></div><div class="ttdeci">status</div><div class="ttdef"><b>Definition:</b> <a href="convertRawData__muTestbeam_8py_source.html#l00053">convertRawData_muTestbeam.py:53</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_aca0b07380cd50f63eef644ebda8252ce"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#aca0b07380cd50f63eef644ebda8252ce">genfit::RKTrackRep::RKTrackRep</a></div><div class="ttdeci">RKTrackRep()</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l00045">RKTrackRep.cc:45</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a3a66aa71e3109808ef8783809552139d"><div class="ttname"><a href="namespacegenfit.html#a3a66aa71e3109808ef8783809552139d">genfit::M7x5</a></div><div class="ttdeci">double M7x5[7 *5]</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8h_source.html#l00042">RKTools.h:42</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a210279ccff463e20ea47b345a288f1d0"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a210279ccff463e20ea47b345a288f1d0">genfit::RKTrackRep::noiseProjection_</a></div><div class="ttdeci">M7x7 noiseProjection_</div><div class="ttdoc">noise matrix of the last extrapolation</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00294">RKTrackRep.h:294</a></div></div>
<div class="ttc" id="anamespacemakeMuonDIS_html_ad916c51f2653b60d746cf521ef14f685"><div class="ttname"><a href="namespacemakeMuonDIS.html#ad916c51f2653b60d746cf521ef14f685">makeMuonDIS.E</a></div><div class="ttdeci">E</div><div class="ttdef"><b>Definition:</b> <a href="makeMuonDIS_8py_source.html#l00077">makeMuonDIS.py:77</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a03a4f035cc4162ea33556eb6da224150"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a03a4f035cc4162ea33556eb6da224150">genfit::RKTrackRep::initArrays</a></div><div class="ttdeci">void initArrays() const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l01332">RKTrackRep.cc:1332</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a35723de16e1bae56aeb8a7ca098b2b9e"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a35723de16e1bae56aeb8a7ca098b2b9e">genfit::RKTrackRep::getPosMom</a></div><div class="ttdeci">virtual void getPosMom(const StateOnPlane &amp;state, TVector3 &amp;pos, TVector3 &amp;mom) const</div><div class="ttdoc">Get cartesian position and momentum vector of a state.</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l00687">RKTrackRep.cc:687</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a33b8c25c6a34f361839aa7ac65769193"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a33b8c25c6a34f361839aa7ac65769193">genfit::RKTrackRep::getCharge</a></div><div class="ttdeci">virtual double getCharge(const StateOnPlane &amp;state) const</div><div class="ttdoc">Get the (fitted) charge of a state. This is not always equal the pdg charge (e.g. if the charge sign ...</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l00712">RKTrackRep.cc:712</a></div></div>
<div class="ttc" id="aclassgenfit_1_1AbsTrackRep_html_af96ccfed2ddd3cc344503e1b1bd4d17f"><div class="ttname"><a href="classgenfit_1_1AbsTrackRep.html#af96ccfed2ddd3cc344503e1b1bd4d17f">genfit::AbsTrackRep::AbsTrackRep</a></div><div class="ttdeci">AbsTrackRep()</div><div class="ttdef"><b>Definition:</b> <a href="AbsTrackRep_8cc_source.html#l00031">AbsTrackRep.cc:31</a></div></div>
<div class="ttc" id="anamespacegenfit_1_1RKTools_html_a7842d42c75a8456ef78ccc4ddf08373f"><div class="ttname"><a href="namespacegenfit_1_1RKTools.html#a7842d42c75a8456ef78ccc4ddf08373f">genfit::RKTools::printDim</a></div><div class="ttdeci">void printDim(const double *mat, unsigned int dimX, unsigned int dimY)</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8cc_source.html#l00691">RKTools.cc:691</a></div></div>
<div class="ttc" id="anamespacegenfit_1_1RKTools_html_ad2530899a8df922d173c17f55ac590b9"><div class="ttname"><a href="namespacegenfit_1_1RKTools.html#ad2530899a8df922d173c17f55ac590b9">genfit::RKTools::J_MpTxcov7xJ_Mp</a></div><div class="ttdeci">void J_MpTxcov7xJ_Mp(const M7x5 &amp;J_Mp, const M7x7 &amp;cov7, M5x5 &amp;out5)</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8cc_source.html#l00196">RKTools.cc:196</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a155aa1470ea4d57da938fe4cb484b9ce"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a155aa1470ea4d57da938fe4cb484b9ce">genfit::RKTrackRep::ExtrapSteps_</a></div><div class="ttdeci">std::vector&lt; ExtrapStep &gt; ExtrapSteps_</div><div class="ttdef"><b>Definition:</b> <a href="include_2genfit_2RKTrackRep_8h_source.html#l00282">RKTrackRep.h:282</a></div></div>
<div class="ttc" id="anamespacegenfit_html_aef963dd271482931d5ce8e86b3f5a008"><div class="ttname"><a href="namespacegenfit.html#aef963dd271482931d5ce8e86b3f5a008">genfit::M7x7</a></div><div class="ttdeci">double M7x7[7 *7]</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8h_source.html#l00039">RKTools.h:39</a></div></div>
<div class="ttc" id="aclassgenfit_1_1RKTrackRep_html_a177f273f4dc3d7d1eaa646fe5a70aaf3"><div class="ttname"><a href="classgenfit_1_1RKTrackRep.html#a177f273f4dc3d7d1eaa646fe5a70aaf3">genfit::RKTrackRep::getSpu</a></div><div class="ttdeci">double getSpu(const StateOnPlane &amp;state) const</div><div class="ttdef"><b>Definition:</b> <a href="RKTrackRep_8cc_source.html#l00758">RKTrackRep.cc:758</a></div></div>
<div class="ttc" id="anamespacegenfit_html_a2f0d1d795f44c877a78277c7107a4eea"><div class="ttname"><a href="namespacegenfit.html#a2f0d1d795f44c877a78277c7107a4eea">genfit::M1x4</a></div><div class="ttdeci">double M1x4[1 *4]</div><div class="ttdef"><b>Definition:</b> <a href="RKTools_8h_source.html#l00034">RKTools.h:34</a></div></div>
<div class="ttc" id="aclassgenfit_1_1MaterialEffects_html_a15a93d367165ade368e6caec713d0934"><div class="ttname"><a href="classgenfit_1_1MaterialEffects.html#a15a93d367165ade368e6caec713d0934">genfit::MaterialEffects::getInstance</a></div><div class="ttdeci">static MaterialEffects * getInstance()</div><div class="ttdef"><b>Definition:</b> <a href="MaterialEffects_8cc_source.html#l00072">MaterialEffects.cc:72</a></div></div>
<div class="ttc" id="aclassgenfit_1_1StateOnPlane_html_ad574c9e4ef45aed61bab1f7b99e221db"><div class="ttname"><a href="classgenfit_1_1StateOnPlane.html#ad574c9e4ef45aed61bab1f7b99e221db">genfit::StateOnPlane::getAuxInfo</a></div><div class="ttdeci">const TVectorD &amp; getAuxInfo() const</div><div class="ttdef"><b>Definition:</b> <a href="StateOnPlane_8h_source.html#l00061">StateOnPlane.h:61</a></div></div>
<div class="ttc" id="anamespacemakeCascade_html_a0ea591e7333fcfd50fb131ada5ef2ead"><div class="ttname"><a href="namespacemakeCascade.html#a0ea591e7333fcfd50fb131ada5ef2ead">makeCascade.beta</a></div><div class="ttdeci">int beta</div><div class="ttdef"><b>Definition:</b> <a href="makeCascade_8py_source.html#l00339">makeCascade.py:339</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacegenfit.html">genfit</a></li><li class="navelem"><a class="el" href="classgenfit_1_1RKTrackRep.html">RKTrackRep</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
