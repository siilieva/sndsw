<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SND Software: millepede/mptext.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SND Software
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('mptext_8f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mptext.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="mptext_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacemptext"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemptext.html">mptext</a></td></tr>
<tr class="memdesc:namespacemptext"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keyword position. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ac707e6fabcc93cc4eb04b7acc1abbafa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptext_8f90.html#ac707e6fabcc93cc4eb04b7acc1abbafa">ratext</a> (text, nums, dnum)</td></tr>
<tr class="memdesc:ac707e6fabcc93cc4eb04b7acc1abbafa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translate text.  <a href="mptext_8f90.html#ac707e6fabcc93cc4eb04b7acc1abbafa">More...</a><br /></td></tr>
<tr class="separator:ac707e6fabcc93cc4eb04b7acc1abbafa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6e4dfef4c87d0f39a54dab2f6b210d3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptext_8f90.html#af6e4dfef4c87d0f39a54dab2f6b210d3">rltext</a> (text, ia, ib, nab)</td></tr>
<tr class="memdesc:af6e4dfef4c87d0f39a54dab2f6b210d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyse text range.  <a href="mptext_8f90.html#af6e4dfef4c87d0f39a54dab2f6b210d3">More...</a><br /></td></tr>
<tr class="separator:af6e4dfef4c87d0f39a54dab2f6b210d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2caf7b022af31e22cf09e7f587f2237a"><td class="memItemLeft" align="right" valign="top">integer(mpi) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mptext_8f90.html#a2caf7b022af31e22cf09e7f587f2237a">matint</a> (pat, text, npat, ntext)</td></tr>
<tr class="memdesc:a2caf7b022af31e22cf09e7f587f2237a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Approximate string matching.  <a href="mptext_8f90.html#a2caf7b022af31e22cf09e7f587f2237a">More...</a><br /></td></tr>
<tr class="separator:a2caf7b022af31e22cf09e7f587f2237a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5a15cd59193f031a1b4d5a21f4678795"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemptext.html#a5a15cd59193f031a1b4d5a21f4678795">mptext::keya</a></td></tr>
<tr class="memdesc:a5a15cd59193f031a1b4d5a21f4678795"><td class="mdescLeft">&#160;</td><td class="mdescRight">start (position) of keyword  <a href="namespacemptext.html#a5a15cd59193f031a1b4d5a21f4678795">More...</a><br /></td></tr>
<tr class="separator:a5a15cd59193f031a1b4d5a21f4678795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8b9be380072379b1ab5e04d9c8c55e"><td class="memItemLeft" align="right" valign="top">integer(mpi)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemptext.html#a0b8b9be380072379b1ab5e04d9c8c55e">mptext::keyb</a></td></tr>
<tr class="memdesc:a0b8b9be380072379b1ab5e04d9c8c55e"><td class="mdescLeft">&#160;</td><td class="mdescRight">end (position) of keyword  <a href="namespacemptext.html#a0b8b9be380072379b1ab5e04d9c8c55e">More...</a><br /></td></tr>
<tr class="separator:a0b8b9be380072379b1ab5e04d9c8c55e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Analyse text string.</p>
<dl class="section author"><dt>Author</dt><dd>Volker Blobel, University Hamburg, 2005-2009 (initial Fortran77 version) </dd>
<dd>
Claus Kleinwort, DESY (maintenance and developement)</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2009 - 2015 Deutsches Elektronen-Synchroton, Member of the Helmholtz Association, (DESY), HAMBURG, GERMANY <br  />
<br  />
 This library is free software; you can redistribute it and/or modify it under the terms of the GNU Library General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version. <br  />
<br  />
 This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Library General Public License for more details. <br  />
<br  />
 You should have received a copy of the GNU Library General Public License along with this program (see the file COPYING.LIB for more details); if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA. </dd></dl>

<p class="definition">Definition in file <a class="el" href="mptext_8f90_source.html">mptext.f90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a2caf7b022af31e22cf09e7f587f2237a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2caf7b022af31e22cf09e7f587f2237a">&#9670;&nbsp;</a></span>matint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(mpi) function matint </td>
          <td>(</td>
          <td class="paramtype">character (len=*), intent(in)&#160;</td>
          <td class="paramname"><em>pat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character (len=*), intent(in)&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>npat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>ntext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Approximate string matching. </p>
<p>Approximate string matching - case insensitive. Return number of matches of string PAT in string TEXT, and number NPAT, NTEXT of characters of string PAT and string TEXT. Strings are considered from first to last non-blank character.</p>
<p>Example: </p><pre class="fragment"> MATCH = MATINT(' keYs ','keyWO RD',NPAT,NTEXT)
 returns MATCH=3, NPAT=4, NTEXT=8
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pat</td><td>pattern </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">text</td><td>text </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">npat</td><td>number of characters in pattern </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ntext</td><td>number of characters in text </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of matching characters of pattern in text </dd></dl>

<p class="definition">Definition at line <a class="el" href="mptext_8f90_source.html#l00290">290</a> of file <a class="el" href="mptext_8f90_source.html">mptext.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdef.html">mpdef</a></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ic</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ideq</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ip</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ipa</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ipb</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ita</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: itb</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: jc</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: jot</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: jt</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: npatma</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">CHARACTER (LEN=*)</span>, <span class="keywordtype">INTENT(IN)</span> :: pat</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">CHARACTER (LEN=*)</span>, <span class="keywordtype">INTENT(IN)</span> :: text</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span> :: npat</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span> :: ntext</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">!GF</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">!      INTEGER ID(0:100,2)</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="namespacempdef.html#a867f0da7c7d6580a731013b8ec11a36a">parameter</a>(npatma=512)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: id(0:npatma,2)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">! end GF</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordtype">LOGICAL</span> :: start                        <span class="comment">! for case conversion</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordtype">CHARACTER (LEN=26)</span> :: chu</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordtype">CHARACTER (LEN=26)</span> :: chl</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: nj(0:255)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keyword">DATA</span>  chu/<span class="stringliteral">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span>/</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keyword">DATA</span>  chl/<span class="stringliteral">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span>/</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keyword">DATA</span>  start/.true./</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">DATA</span> nj/256*0/</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">!     ...</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">IF</span>(start) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        start=.false.</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">DO</span> j=0,255</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            nj(j)=j</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">DO</span> i=1,26</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            nj(ichar(chl(i:i)))=ichar(chu(i:i))</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">!     ...</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <a class="code" href="mptext_8f90.html#a2caf7b022af31e22cf09e7f587f2237a">matint</a>=0</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    ntext=0</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">DO</span> i=1,len(text)               <span class="comment">! find indices ITA...ITB</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">IF</span>(text(i:i) /= <span class="stringliteral">&#39; &#39;</span>) <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">GO TO</span> 15</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;10  ita=i</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">DO</span> i=ita,len(text)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">IF</span>(text(i:i) /= <span class="stringliteral">&#39; &#39;</span>) itb=i</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    ntext=itb-ita+1               <span class="comment">! number of charcaters in TEXT</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;15  npat=0</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">DO</span> i=1,len(pat)               <span class="comment">! find indices IPA...IPB</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">IF</span>(pat(i:i) /= <span class="stringliteral">&#39; &#39;</span>) <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;20  ipa=i</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">DO</span> i=ipa,len(pat)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">IF</span>(pat(i:i) /= <span class="stringliteral">&#39; &#39;</span>) ipb=i</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    npat=ipb-ipa+1</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">!GF      IF(NPAT.GT.100) STOP &#39;MATINT: string PAT too long!   &#39;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">IF</span>(npat &gt; npatma) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;too long PAT (&#39;</span>, pat,<span class="stringliteral">&#39;):&#39;</span>, npat, <span class="stringliteral">&#39; &gt;&#39;</span>, npatma</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keyword">CALL </span><a class="code" href="pede_8f90.html#a16ef8020d3ee5c0aa46a0cb5b1dceba8">peend</a>(34,<span class="stringliteral">&#39;Aborted, pattern string too long&#39;</span>)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        stop <span class="stringliteral">&#39;MATINT: string PAT too long!   &#39;</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">!GF end</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    id(0,1)=0</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">DO</span> i=0,npat</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        id(i,2)=i</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    jot=2</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">DO</span> j=1,ntext</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        jot=3-jot</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        jt=j+ita-1</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        jc=nj(ichar(text(jt:jt)))</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">DO</span> i=1,npat</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            ip=i+ipa-1</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            ideq=id(i-1,3-jot)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            ic=nj(ichar(pat(ip:ip)))</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keywordflow">IF</span>(ic /= jc) ideq=ideq+1</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            id(i,jot)=min(ideq,id(i,3-jot)+1,id(i-1,jot)+1)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="mptext_8f90.html#a2caf7b022af31e22cf09e7f587f2237a">matint</a>=max(<a class="code" href="mptext_8f90.html#a2caf7b022af31e22cf09e7f587f2237a">matint</a>,npat-id(npat,jot))</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac707e6fabcc93cc4eb04b7acc1abbafa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac707e6fabcc93cc4eb04b7acc1abbafa">&#9670;&nbsp;</a></span>ratext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ratext </td>
          <td>(</td>
          <td class="paramtype">character (len=*), intent(in)&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>nums</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(out)&#160;</td>
          <td class="paramname"><em>dnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Translate text. </p>
<p>Translate TEXT into arrays of double precision numbers DNUMS(NUMS). Text preceeding numbers is TEXT(KEYA:KEYB), if KEYB &gt;= KEYA.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">text</td><td>text </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nums</td><td>number of numbers found </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dnum</td><td>array of numbers found </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mptext_8f90_source.html#l00049">49</a> of file <a class="el" href="mptext_8f90_source.html">mptext.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacemptext.html">mptext</a></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ia</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ib</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ic</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: ich</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: icl</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: icode</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: lent</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: num</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">CHARACTER (LEN=*)</span>, <span class="keywordtype">INTENT(IN)</span>            :: text</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: nums</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: dnum(*)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: last <span class="comment">! last non-blank character</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">PARAMETER</span> :: ndim=1000</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">DIMENSION(2,ndim)</span>:: icd</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">CHARACTER (LEN=16)</span> :: keywrd</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">CHARACTER (LEN=1)</span> :: ch</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: dic(ndim)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keywordtype">    REAL</span>(mpd) :: dumber</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: icdt(ndim)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">!     ...</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    nums=0</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    last=0</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="namespacemptext.html#a5a15cd59193f031a1b4d5a21f4678795">keya</a>=0</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="namespacemptext.html#a0b8b9be380072379b1ab5e04d9c8c55e">keyb</a>=0</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">IF</span>(text(1:1) == <span class="stringliteral">&#39;*&#39;</span>) <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    num=ichar(<span class="stringliteral">&#39;0&#39;</span>)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    lent=0</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    last=0</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">DO</span> i=1,len(text)        <span class="comment">! find comment and end</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">IF</span>(lent == 0.AND.(text(i:i) == <span class="stringliteral">&#39;!&#39;</span>.OR.text(i:i) == <span class="stringliteral">&#39;%&#39;</span>)) lent=i</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">IF</span>(text(i:i) /= <span class="stringliteral">&#39; &#39;</span>) last=i</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">IF</span>(lent == 0) lent=last+1</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    icd(1,1)=lent</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    j=1</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    icdt(1)=0</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    icl=0</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">DO</span> i=1,lent-1</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        ch =text(i:i)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        ich=ichar(ch)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        ic=0</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">IF</span>(ch == <span class="stringliteral">&#39;.&#39;</span>) ic=1</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">IF</span>(ch == <span class="stringliteral">&#39;+&#39;</span>) ic=2</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">IF</span>(ch == <span class="stringliteral">&#39;-&#39;</span>) ic=3</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">IF</span>(ch == <span class="stringliteral">&#39;E&#39;</span>) ic=4</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">IF</span>(ch == <span class="stringliteral">&#39;D&#39;</span>) ic=4</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">IF</span>(ch == <span class="stringliteral">&#39;e&#39;</span>) ic=4</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">IF</span>(ch == <span class="stringliteral">&#39;d&#39;</span>) ic=4</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">IF</span>(ic &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            j=j+1</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            icd(1,j)=i</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            icd(2,j)=i</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            icdt(j)=ic</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            ic=6</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">IF</span>(ich &gt;= num.AND.ich &lt;= num+9) ic=5  <span class="comment">! digit</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordflow">IF</span>(ic /= icl) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                j=j+1</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                icd(1,j)=i</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                icdt(j)=ic</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            icd(2,j)=i</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        icl=ic <span class="comment">! previous IC</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    icdt(j+1)=0</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">DO</span> i=1,j                  <span class="comment">! define number</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">IF</span>(icdt(i) == 5) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            dumber=0.0d0</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">DO</span> k=icd(1,i),icd(2,i)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                dumber=10.0_mpd*dumber+real(ichar(text(k:k))-num,<a class="code" href="namespacempdef.html#a1f913a4d0f3752088f75db7d925b0ac1">mpd</a>)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            dic(i)=dumber</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    icdt(j+1)=0</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">DO</span> i=2,j                  <span class="comment">! get dots</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">IF</span>(icdt(i) == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            icode=0</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">IF</span>(icdt(i-1) == 5.AND.icd(2,i-1)+1 == icd(1,i)) icode=1</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordflow">IF</span>(icdt(i+1) == 5.AND.icd(1,i+1)-1 == icd(2,i)) icode=icode+2</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">IF</span>(icode == 1) <span class="keywordflow">THEN</span>            <span class="comment">! 123.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                icd(2,i-1)=icd(2,i)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                icdt(i)=0</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(icode == 2) <span class="keywordflow">THEN</span>       <span class="comment">! .456</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                dic(i)=10.0d0**(icd(1,i+1)-icd(2,i+1)-1)*dic(i+1)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                icdt(i)=5</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                icd(2,i)=icd(2,i+1)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                icdt(i+1)=0</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(icode == 3) <span class="keywordflow">THEN</span>       <span class="comment">! 123.456</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                dic(i-1)=dic(i-1)+ 10.0d0**(icd(1,i+1)-icd(2,i+1)-1)*dic(i+1)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                icd(2,i-1)=icd(2,i+1)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                icdt(i)=0</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                icdt(i+1)=0</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    k=1                         <span class="comment">! remove blanks, compress</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">DO</span> i=2,j</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">IF</span>(icdt(i) == 6.AND.text(icd(1,i):icd(2,i)) == <span class="stringliteral">&#39; &#39;</span>) icdt(i)=0</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">IF</span>(icdt(i) /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            k=k+1</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            icd(1,k)=icd(1,i)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            icd(2,k)=icd(2,i)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            icdt(k)=icdt(i)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            dic(k)=dic(i)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    j=k</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">DO</span> i=2,j-1</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">IF</span>(icdt(i) == 2.OR.icdt(i) == 3) <span class="keywordflow">THEN</span>   <span class="comment">!  +-</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordflow">IF</span>(icdt(i+1) == 5) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                icd(1,i+1)=icd(1,i)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="keywordflow">IF</span>(icdt(i) == 3) dic(i+1)=-dic(i+1)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                icdt(i)=0</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    k=1                         <span class="comment">! compress</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">DO</span> i=2,j</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">IF</span>(icdt(i) == 6.AND.text(icd(1,i):icd(2,i)) == <span class="stringliteral">&#39; &#39;</span>) icdt(i)=0</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">IF</span>(icdt(i) /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            k=k+1</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            icd(1,k)=icd(1,i)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            icd(2,k)=icd(2,i)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            icdt(k)=icdt(i)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            dic(k)=dic(i)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    j=k</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">DO</span> i=2,j-1</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">IF</span>(icdt(i) == 4) <span class="keywordflow">THEN</span>        <span class="comment">! E or D</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="keywordflow">IF</span>(icdt(i-1) == 5.AND.icdt(i+1) == 5) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                icd(2,i-1)=icd(2,i+1)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                dic(i-1)=dic(i-1)*10.0d0**dic(i+1)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                icdt(i)=0</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                icdt(i+1)=0</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    nums=0                         <span class="comment">! compress</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">DO</span> i=1,j</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">IF</span>(icdt(i) == 5) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            nums=nums+1</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            icd(1,nums)=icd(1,i)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            icd(2,nums)=icd(2,i)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            dnum(nums)=dic(i)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    keywrd=<span class="stringliteral">&#39; &#39;</span>                     <span class="comment">! assemble keyword</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    ia=0</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    ib=-1</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">DO</span> i=1,icd(1,1)-1</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">IF</span>(ia == 0.AND.text(i:i) /= <span class="stringliteral">&#39; &#39;</span>) ia=i</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">IF</span>(text(i:i) /= <span class="stringliteral">&#39; &#39;</span>) ib=i</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">IF</span>(ib &gt;= 0) keywrd=text(ia:ib)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="namespacemptext.html#a5a15cd59193f031a1b4d5a21f4678795">keya</a>=ia</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="namespacemptext.html#a0b8b9be380072379b1ab5e04d9c8c55e">keyb</a>=max(0,ib)</div>
</div><!-- fragment -->
</div>
</div>
<a id="af6e4dfef4c87d0f39a54dab2f6b210d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6e4dfef4c87d0f39a54dab2f6b210d3">&#9670;&nbsp;</a></span>rltext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine rltext </td>
          <td>(</td>
          <td class="paramtype">character (len=*), intent(in)&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>ia</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>nab</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Analyse text range. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">text</td><td>text </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ia</td><td>index of first non-blank character, or =1 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ib</td><td>index of last non-blank character, or =0 - comment excluded </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nab</td><td>index of last non-blank character (=0 for blank text) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mptext_8f90_source.html#l00237">237</a> of file <a class="el" href="mptext_8f90_source.html">mptext.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacempdef.html">mpdef</a></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span> :: lim</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">CHARACTER (LEN=*)</span>, <span class="keywordtype">INTENT(IN)</span>            :: text</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: ia</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: ib</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: nab</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">SAVE</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">!     ...</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    ia=0</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    ib=0</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    nab=0</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    lim=0</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">DO</span> i=1,len(text)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">IF</span>(text(i:i) /= <span class="stringliteral">&#39; &#39;</span>) nab=i</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">IF</span>((i == 1.AND.text(1:1) == <span class="stringliteral">&#39;*&#39;</span>).OR.text(i:i) == <span class="stringliteral">&#39;!&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keywordflow">IF</span>(lim == 0) lim=i</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">IF</span>(lim == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        lim=nab</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        lim=lim-1</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">DO</span> i=1,lim</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">IF</span>(ia == 0.AND.text(i:i) /= <span class="stringliteral">&#39; &#39;</span>) ia=i</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">IF</span>(text(i:i) /= <span class="stringliteral">&#39; &#39;</span>) ib=i</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacemptext_html_a5a15cd59193f031a1b4d5a21f4678795"><div class="ttname"><a href="namespacemptext.html#a5a15cd59193f031a1b4d5a21f4678795">mptext::keya</a></div><div class="ttdeci">integer(mpi) keya</div><div class="ttdoc">start (position) of keyword</div><div class="ttdef"><b>Definition:</b> <a href="mptext_8f90_source.html#l00034">mptext.f90:34</a></div></div>
<div class="ttc" id="apede_8f90_html_a16ef8020d3ee5c0aa46a0cb5b1dceba8"><div class="ttname"><a href="pede_8f90.html#a16ef8020d3ee5c0aa46a0cb5b1dceba8">peend</a></div><div class="ttdeci">subroutine peend(icode, cmessage)</div><div class="ttdoc">Print exit code.</div><div class="ttdef"><b>Definition:</b> <a href="pede_8f90_source.html#l08890">pede.f90:8890</a></div></div>
<div class="ttc" id="anamespacemptext_html_a0b8b9be380072379b1ab5e04d9c8c55e"><div class="ttname"><a href="namespacemptext.html#a0b8b9be380072379b1ab5e04d9c8c55e">mptext::keyb</a></div><div class="ttdeci">integer(mpi) keyb</div><div class="ttdoc">end (position) of keyword</div><div class="ttdef"><b>Definition:</b> <a href="mptext_8f90_source.html#l00035">mptext.f90:35</a></div></div>
<div class="ttc" id="amptext_8f90_html_a2caf7b022af31e22cf09e7f587f2237a"><div class="ttname"><a href="mptext_8f90.html#a2caf7b022af31e22cf09e7f587f2237a">matint</a></div><div class="ttdeci">integer(mpi) function matint(pat, text, npat, ntext)</div><div class="ttdoc">Approximate string matching.</div><div class="ttdef"><b>Definition:</b> <a href="mptext_8f90_source.html#l00290">mptext.f90:290</a></div></div>
<div class="ttc" id="anamespacempdef_html"><div class="ttname"><a href="namespacempdef.html">mpdef</a></div><div class="ttdoc">Definition of constants.</div><div class="ttdef"><b>Definition:</b> <a href="mpdef_8f90_source.html#l00024">mpdef.f90:24</a></div></div>
<div class="ttc" id="anamespacemptext_html"><div class="ttname"><a href="namespacemptext.html">mptext</a></div><div class="ttdoc">Keyword position.</div><div class="ttdef"><b>Definition:</b> <a href="mptext_8f90_source.html#l00029">mptext.f90:29</a></div></div>
<div class="ttc" id="anamespacempdef_html_a1f913a4d0f3752088f75db7d925b0ac1"><div class="ttname"><a href="namespacempdef.html#a1f913a4d0f3752088f75db7d925b0ac1">mpdef::mpd</a></div><div class="ttdeci">integer, parameter mpd</div><div class="ttdef"><b>Definition:</b> <a href="mpdef_8f90_source.html#l00038">mpdef.f90:38</a></div></div>
<div class="ttc" id="anamespacempdef_html_a867f0da7c7d6580a731013b8ec11a36a"><div class="ttname"><a href="namespacempdef.html#a867f0da7c7d6580a731013b8ec11a36a">mpdef::parameter</a></div><div class="ttdeci">integer, parameter parameter</div><div class="ttdef"><b>Definition:</b> <a href="mpdef_8f90_source.html#l00034">mpdef.f90:34</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_23416660aff6402864c13eb5e981e75a.html">millepede</a></li><li class="navelem"><a class="el" href="mptext_8f90.html">mptext.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
