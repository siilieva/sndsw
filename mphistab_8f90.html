<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SND@LHC Software: millepede/mphistab.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SND@LHC Software
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mphistab_8f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">mphistab.f90 File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Histogramming package.  
<a href="#details">More...</a></p>

<p><a href="mphistab_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a3f3455d53e876e4fa06564306a0aeba9" id="r_a3f3455d53e876e4fa06564306a0aeba9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mphistab_8f90.html#a3f3455d53e876e4fa06564306a0aeba9">hmpdef</a> (ih, xa, xb, text)</td></tr>
<tr class="separator:a3f3455d53e876e4fa06564306a0aeba9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a080a392c68fcea196d331b844ead9ffd" id="r_a080a392c68fcea196d331b844ead9ffd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mphistab_8f90.html#a080a392c68fcea196d331b844ead9ffd">hmpmak</a> (inhist, fnhist, jnhist, xl, dl)</td></tr>
<tr class="separator:a080a392c68fcea196d331b844ead9ffd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a313682fccd921114074f837794fb5676" id="r_a313682fccd921114074f837794fb5676"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mphistab_8f90.html#a313682fccd921114074f837794fb5676">bintab</a> (tab, n, xa, xb)</td></tr>
<tr class="separator:a313682fccd921114074f837794fb5676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a719432bd7b5cfb9fd0660200dc04a99e" id="r_a719432bd7b5cfb9fd0660200dc04a99e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mphistab_8f90.html#a719432bd7b5cfb9fd0660200dc04a99e">kprint</a> (lun, list, n)</td></tr>
<tr class="separator:a719432bd7b5cfb9fd0660200dc04a99e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f4d28d6412fcfa886404bed5f4d7d9" id="r_a14f4d28d6412fcfa886404bed5f4d7d9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mphistab_8f90.html#a14f4d28d6412fcfa886404bed5f4d7d9">gmpdef</a> (ig, ityp, text)</td></tr>
<tr class="separator:a14f4d28d6412fcfa886404bed5f4d7d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c10636054e5389ae1edf80dc039c03f" id="r_a0c10636054e5389ae1edf80dc039c03f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mphistab_8f90.html#a0c10636054e5389ae1edf80dc039c03f">stmars</a></td></tr>
<tr class="separator:a0c10636054e5389ae1edf80dc039c03f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43e4b787e0e2c4b2fd1e6554a6734800" id="r_a43e4b787e0e2c4b2fd1e6554a6734800"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mphistab_8f90.html#a43e4b787e0e2c4b2fd1e6554a6734800">rmesig</a> (x, n, xloc, xsca)</td></tr>
<tr class="separator:a43e4b787e0e2c4b2fd1e6554a6734800"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Histogramming package. </p>
<dl class="section author"><dt>Author</dt><dd>Volker Blobel, University Hamburg, 2005-2009 (initial Fortran77 version) </dd>
<dd>
Claus Kleinwort, DESY (maintenance and developement)</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2009 - 2015 Deutsches Elektronen-Synchroton, Member of the Helmholtz Association, (DESY), HAMBURG, GERMANY <br  />
<br  />
 This library is free software; you can redistribute it and/or modify it under the terms of the GNU Library General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version. <br  />
<br  />
 This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Library General Public License for more details. <br  />
<br  />
 You should have received a copy of the GNU Library General Public License along with this program (see the file COPYING.LIB for more details); if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</dd></dl>
<pre class="fragment">                          HMP... and GMP...
                    Histogram and XY data in text files

     Booking:

     CALL HMPDEF(IH,XA,XB,TEXT)               CALL GMPDEF(IG,ITYP,TEXT)
     where                                    where
        IH    = 1 ... 10                         IG    = 1 ... 10
        XA,XB = left, right limit                ITYP  = 1 dots
        TEXT  = explanation                            = 2 line
                                                       = 3 dots and line
                                                       = 4 symbols
                                                       = 5 mean/sigma
                                                 TEXT  = explanation

     CALL HMPLUN(LUNW)                        CALL GMPLUN(LUNW)
     unit for output                          unit for output

     CALL HMPENT(IH,X)                        CALL GMPXY(IG,X,Y)
     entry flt.pt. X                          add (X,Y) pair

                                              CALL GMPXYD(IG,X,Y,DX,DY)
                                              add (X,Y,DX,DY) ITYP=4

        new                                   CALL GMPMS(IG,X,Y)
                                              mean/sigma from x,y

     Booking log integer histogram:

     CALL HMPLDF(IH,TEXT)
     book and reset log integer histogram

     CALL HMPLNT(IH,IX)
     entry integer IX

     Printing and writing:

     CALL HMPRNT(IH)                          CALL GMPRNT(IG)
     print histogram IH or all, if 0          print data Ig or all, if 0

     CALL HMPWRT(IH)                          CALL GMPWRT(IG)
     write histogram IH or all to file        write data IG or all to file


     Storage manager for GMP...

      CALL STMARS                 !! init/reset  storage manager

      CALL STMAPR(JFLC,X,Y)       !! store pair (X,Y)

      CALL STMADP(JFLC,FOUR)      !! store double pair

      CALL STMACP(JFLC,ARRAY,N)   !! copy (cp) all pairs to array

      CALL STMARM(JFLC)           !! remove (rm) stored paiirs</pre><p>The number of histograms is limited to NUMHIS (=15), the number of XY data plots to NUMGXY (=10) and the storage of XY points to NDIM (=5000). As each XY plot can contain up to NLIMIT (=500) points (before averaging) NDIM should be NLIMIT*NUMGXY. </p>

<p class="definition">Definition in file <a class="el" href="mphistab_8f90_source.html">mphistab.f90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a313682fccd921114074f837794fb5676" name="a313682fccd921114074f837794fb5676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a313682fccd921114074f837794fb5676">&#9670;&#160;</a></span>bintab()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bintab </td>
          <td>(</td>
          <td class="paramtype">real(mps), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>tab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mps), intent(out)&#160;</td>
          <td class="paramname"><em>xa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mps), intent(out)&#160;</td>
          <td class="paramname"><em>xb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mphistab_8f90_source.html#l00415">415</a> of file <a class="el" href="mphistab_8f90_source.html">mphistab.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  416</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  419</span><span class="keywordtype">    REAL</span>(mps) :: dd</div>
<div class="line"><span class="lineno">  420</span><span class="keywordtype">    REAL</span>(mps) :: dx</div>
<div class="line"><span class="lineno">  421</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  422</span>    <span class="keywordtype">INTEGER(mpi)</span> :: iexp</div>
<div class="line"><span class="lineno">  423</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ii</div>
<div class="line"><span class="lineno">  424</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordtype">INTEGER(mpi)</span> :: m1</div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordtype">INTEGER(mpi)</span> :: m2</div>
<div class="line"><span class="lineno">  427</span>    <span class="keywordtype">INTEGER(mpi)</span> :: n1</div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordtype">INTEGER(mpi)</span> :: n2</div>
<div class="line"><span class="lineno">  429</span><span class="keywordtype">    REAL</span>(mps) :: rat</div>
<div class="line"><span class="lineno">  430</span><span class="keywordtype">    REAL</span>(mps) :: x1</div>
<div class="line"><span class="lineno">  431</span><span class="keywordtype">    REAL</span>(mps) :: x2</div>
<div class="line"><span class="lineno">  432</span><span class="keywordtype">    REAL</span>(mps) :: xx</div>
<div class="line"><span class="lineno">  433</span>    <span class="comment">!     Bin limits XA and XB from TAB(N)</span></div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span><span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(IN)</span>                         :: tab(n)</div>
<div class="line"><span class="lineno">  436</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno">  437</span><span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(OUT)</span>                        :: xa</div>
<div class="line"><span class="lineno">  438</span><span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(OUT)</span>                        :: xb</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span><span class="keywordtype">    REAL</span>(mps) :: bin(10)</div>
<div class="line"><span class="lineno">  441</span>    <span class="keyword">DATA</span> bin/1.0,1.5,2.0,3.0,4.0,5.0,8.0,10.0,15.0,20.0/</div>
<div class="line"><span class="lineno">  442</span>    <span class="keywordtype">SAVE</span></div>
<div class="line"><span class="lineno">  443</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>    <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#a59c0fd2fe612e6fb7c2b5b40b8e7762f">heapf</a>(tab,n) <span class="comment">! reduced statistic</span></div>
<div class="line"><span class="lineno">  446</span>    <span class="comment">!      WRITE(*,*) &#39; &#39;</span></div>
<div class="line"><span class="lineno">  447</span>    <span class="comment">!      WRITE(*,*) &#39;Sorted &#39;,(TAB(I),I=1,N)</span></div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">IF</span>(n &lt; 100) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  449</span>        x1=tab(1)</div>
<div class="line"><span class="lineno">  450</span>        x2=tab(n)</div>
<div class="line"><span class="lineno">  451</span>    <span class="comment">!         WRITE(*,*) &#39;reduced statistic X1 X2 &#39;,X1,X2</span></div>
<div class="line"><span class="lineno">  452</span>    <span class="keywordflow">ELSE</span>              <span class="comment">! large statistic</span></div>
<div class="line"><span class="lineno">  453</span>        m1=int(1.0+0.05*real(n),<a class="code hl_variable" href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpi</a>)</div>
<div class="line"><span class="lineno">  454</span>        m2=int(1.0+0.16*real(n),<a class="code hl_variable" href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpi</a>)</div>
<div class="line"><span class="lineno">  455</span>        x1=tab(m1)-4.0*(tab(m2)-tab(m1))</div>
<div class="line"><span class="lineno">  456</span>        <span class="keywordflow">IF</span>(x1 &lt; 0.0.AND.tab(1) &gt;= 0.0) x1=tab(1)</div>
<div class="line"><span class="lineno">  457</span>        x2=tab(n+1-m1)+4.0*(tab(n+1-m1)-tab(n+1-m2))</div>
<div class="line"><span class="lineno">  458</span>        <span class="keywordflow">IF</span>(x2 &gt; 0.0.AND.tab(n) &lt;= 0.0) x2=tab(n)</div>
<div class="line"><span class="lineno">  459</span>        <span class="comment">!         WRITE(*,*) &#39;large statistic &#39;,X1,X2</span></div>
<div class="line"><span class="lineno">  460</span>        <span class="comment">!         WRITE(*,*) &#39;min und max &#39;,TAB(1),TAB(N)</span></div>
<div class="line"><span class="lineno">  461</span>        <span class="keywordflow">IF</span>(x1*tab(1) &lt;= 0.0) x1=0.0</div>
<div class="line"><span class="lineno">  462</span>        <span class="keywordflow">IF</span>(x2*tab(n) &lt;= 0.0) x2=0.0</div>
<div class="line"><span class="lineno">  463</span>        <span class="comment">!         WRITE(*,*) &#39;large statistic zero &#39;,X1,X2</span></div>
<div class="line"><span class="lineno">  464</span>        <span class="keywordflow">IF</span>(x1*x2 &lt; 0.0.AND.min(-x1,x2) &gt; 0.6*max(-x1,x2)) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  465</span>            xx=max(-x1,x2) <span class="comment">! symmetry</span></div>
<div class="line"><span class="lineno">  466</span>            x1=-xx</div>
<div class="line"><span class="lineno">  467</span>            x2=+xx</div>
<div class="line"><span class="lineno">  468</span>        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(x1*x2 &gt; 0.0.AND. &amp; <span class="comment">! include zero ?</span></div>
<div class="line"><span class="lineno">  469</span>            abs(min(x1,x2)) &lt; 0.4*abs(max(x1,x2))) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  470</span>            <span class="keywordflow">IF</span>(x1 &lt; 0.0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  471</span>                x2=0.0</div>
<div class="line"><span class="lineno">  472</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  473</span>                x1=0.0</div>
<div class="line"><span class="lineno">  474</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  475</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  476</span>    <span class="comment">!         WRITE(*,*) &#39;large statistic &#39;,X1,X2</span></div>
<div class="line"><span class="lineno">  477</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  478</span>    <span class="keywordflow">IF</span>(x1 == x2) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  479</span>        x1=x1-1.0</div>
<div class="line"><span class="lineno">  480</span>        x2=x2+1.0</div>
<div class="line"><span class="lineno">  481</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  482</span>    dx=x2-x1</div>
<div class="line"><span class="lineno">  483</span>    <span class="comment">!      WRITE(*,*) &#39;X1,X2,DX &#39;,X1,X2,DX</span></div>
<div class="line"><span class="lineno">  484</span>    rat=0.0</div>
<div class="line"><span class="lineno">  485</span>    ii=1</div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordflow">DO</span> j=1,11</div>
<div class="line"><span class="lineno">  487</span>        i=j</div>
<div class="line"><span class="lineno">  488</span>        <span class="keywordflow">IF</span>(j == 11) i=ii</div>
<div class="line"><span class="lineno">  489</span>        iexp=int(101.0+log10(dx)-log10(6.0*bin(i)),<a class="code hl_variable" href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpi</a>)</div>
<div class="line"><span class="lineno">  490</span>        iexp=iexp-100</div>
<div class="line"><span class="lineno">  491</span>        dd=bin(i)*10.0**iexp</div>
<div class="line"><span class="lineno">  492</span>  </div>
<div class="line"><span class="lineno">  493</span>        n1=int(abs(x1)/dd,<a class="code hl_variable" href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpi</a>)</div>
<div class="line"><span class="lineno">  494</span>        <span class="keywordflow">IF</span>(x1 &lt; 0.0) n1=-n1</div>
<div class="line"><span class="lineno">  495</span>        <span class="keywordflow">IF</span>(real(n1,<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)*dd &gt; x1) n1=n1-1</div>
<div class="line"><span class="lineno">  496</span>        <span class="comment">!       WRITE(*,*) &#39;Bin &#39;,I,N1,N1*DD,X1</span></div>
<div class="line"><span class="lineno">  497</span>  </div>
<div class="line"><span class="lineno">  498</span>        n2=int(abs(x2)/dd,<a class="code hl_variable" href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpi</a>)</div>
<div class="line"><span class="lineno">  499</span>        <span class="keywordflow">IF</span>(x2 &lt; 0.0) n2=-n2</div>
<div class="line"><span class="lineno">  500</span>        <span class="keywordflow">IF</span>(real(n2,<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)*dd &lt; x2) n2=n2+1</div>
<div class="line"><span class="lineno">  501</span>        <span class="comment">!       WRITE(*,*) &#39;Bin &#39;,I,N2,N2*DD,X2</span></div>
<div class="line"><span class="lineno">  502</span>10      <span class="keywordflow">IF</span>(n2-n1 &lt; 6) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  503</span>            <span class="keywordflow">IF</span>(n1 /= 0) n1=n1-1</div>
<div class="line"><span class="lineno">  504</span>            <span class="keywordflow">IF</span>(n2-n1 &lt; 6.AND.n2 /= 0) n2=n2+1</div>
<div class="line"><span class="lineno">  505</span>            <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><span class="lineno">  506</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  507</span>        <span class="comment">!       WRITE(*,*) &#39;corrected N1 N2 &#39;,N1,N2</span></div>
<div class="line"><span class="lineno">  508</span>        xa=sign(real(n1,<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)*dd,x1)</div>
<div class="line"><span class="lineno">  509</span>        xb=sign(real(n2,<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)*dd,x2)</div>
<div class="line"><span class="lineno">  510</span>        <span class="comment">!       WRITE(*,*) J,&#39; resulting limits XA XB &#39;,XA,XB</span></div>
<div class="line"><span class="lineno">  511</span>        <span class="keywordflow">IF</span>((x2-x1)/(xb-xa) &gt; rat) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  512</span>            ii=i</div>
<div class="line"><span class="lineno">  513</span>            rat=(x2-x1)/(xb-xa)</div>
<div class="line"><span class="lineno">  514</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  515</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  516</span><span class="comment">!      WRITE(*,*) J,&#39; resulting limits XA XB &#39;,XA,XB</span></div>
<div class="ttc" id="ampnum_8f90_html_a59c0fd2fe612e6fb7c2b5b40b8e7762f"><div class="ttname"><a href="mpnum_8f90.html#a59c0fd2fe612e6fb7c2b5b40b8e7762f">heapf</a></div><div class="ttdeci">subroutine heapf(a, n)</div><div class="ttdoc">Heap sort direct (real).</div><div class="ttdef"><b>Definition</b> <a href="mpnum_8f90_source.html#l01467">mpnum.f90:1468</a></div></div>
<div class="ttc" id="anamespacempdef_html"><div class="ttname"><a href="namespacempdef.html">mpdef</a></div><div class="ttdoc">Definition of constants.</div><div class="ttdef"><b>Definition</b> <a href="mpdef_8f90_source.html#l00024">mpdef.f90:24</a></div></div>
<div class="ttc" id="anamespacempdef_html_a3fc26af88c2fce97882db26de5535606"><div class="ttname"><a href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpdef::mpi</a></div><div class="ttdeci">integer, parameter mpi</div><div class="ttdef"><b>Definition</b> <a href="mpdef_8f90_source.html#l00034">mpdef.f90:34</a></div></div>
<div class="ttc" id="anamespacempdef_html_aeda146bde2da88d0f6940fc9be01e963"><div class="ttname"><a href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mpdef::mps</a></div><div class="ttdeci">integer, parameter mps</div><div class="ttdef"><b>Definition</b> <a href="mpdef_8f90_source.html#l00037">mpdef.f90:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a14f4d28d6412fcfa886404bed5f4d7d9" name="a14f4d28d6412fcfa886404bed5f4d7d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f4d28d6412fcfa886404bed5f4d7d9">&#9670;&#160;</a></span>gmpdef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gmpdef </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>ig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>ityp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character (len=*), intent(in)&#160;</td>
          <td class="paramname"><em>text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mphistab_8f90_source.html#l00581">581</a> of file <a class="el" href="mphistab_8f90_source.html">mphistab.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  582</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  585</span><span class="keywordtype">    REAL</span>(mps) :: dx</div>
<div class="line"><span class="lineno">  586</span><span class="keywordtype">    REAL</span>(mps) :: dy</div>
<div class="line"><span class="lineno">  587</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  588</span>    <span class="keywordtype">INTEGER(mpi)</span> :: iga</div>
<div class="line"><span class="lineno">  589</span>    <span class="keywordtype">INTEGER(mpi)</span> :: igb</div>
<div class="line"><span class="lineno">  590</span>    <span class="keywordtype">INTEGER(mpi)</span> :: igc</div>
<div class="line"><span class="lineno">  591</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  592</span>    <span class="keywordtype">INTEGER(mpi)</span> :: lun</div>
<div class="line"><span class="lineno">  593</span>    <span class="keywordtype">INTEGER(mpi)</span> :: lunw</div>
<div class="line"><span class="lineno">  594</span>    <span class="keywordtype">INTEGER(mpi)</span> :: n</div>
<div class="line"><span class="lineno">  595</span>    <span class="keywordtype">INTEGER(mpi)</span> :: na</div>
<div class="line"><span class="lineno">  596</span><span class="keywordtype">    REAL</span>(mps) :: wght</div>
<div class="line"><span class="lineno">  597</span><span class="keywordtype">    REAL</span>(mps) :: x</div>
<div class="line"><span class="lineno">  598</span><span class="keywordtype">    REAL</span>(mps) :: y</div>
<div class="line"><span class="lineno">  599</span><span class="keywordtype">    REAL</span>(mps) :: y1</div>
<div class="line"><span class="lineno">  600</span>    <span class="comment">!     ITYP = 1  X,Y     as dots</span></div>
<div class="line"><span class="lineno">  601</span>    <span class="comment">!          = 2  X,Y     as line</span></div>
<div class="line"><span class="lineno">  602</span>    <span class="comment">!          = 3  X,Y     as line and dots</span></div>
<div class="line"><span class="lineno">  603</span>    <span class="comment">!          = 4  X,Y, DX,DY symbols</span></div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: ig</div>
<div class="line"><span class="lineno">  606</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: ityp</div>
<div class="line"><span class="lineno">  607</span>    <span class="keywordtype">CHARACTER (LEN=*)</span>, <span class="keywordtype">INTENT(IN)</span>            :: text</div>
<div class="line"><span class="lineno">  608</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">PARAMETER</span> :: narr=1000</div>
<div class="line"><span class="lineno">  609</span><span class="keywordtype">    REAL</span>(mps) :: array(2,narr)</div>
<div class="line"><span class="lineno">  610</span><span class="keywordtype">    REAL</span>(mps) ::array4(4,narr/2)</div>
<div class="line"><span class="lineno">  611</span><span class="keywordtype">    REAL</span>(mps) ::array1(narr+narr)</div>
<div class="line"><span class="lineno">  612</span><span class="keywordtype">    REAL</span>(mps) ::four(4)</div>
<div class="line"><span class="lineno">  613</span>    equivalence(array(1,1),array4(1,1),array1(1))</div>
<div class="line"><span class="lineno">  614</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">PARAMETER</span> :: numgxy=10</div>
<div class="line"><span class="lineno">  615</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">PARAMETER</span> :: nlimit=500</div>
<div class="line"><span class="lineno">  616</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nstr(numgxy)</div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordtype">INTEGER(mpi)</span> ::igtp(numgxy)</div>
<div class="line"><span class="lineno">  618</span>    <span class="keywordtype">INTEGER(mpi)</span> ::lvers(numgxy)</div>
<div class="line"><span class="lineno">  619</span>    <span class="keywordtype">INTEGER(mpi)</span> ::nst(3,numgxy)</div>
<div class="line"><span class="lineno">  620</span><span class="keywordtype">    REAL</span>(mps) :: xyplws(10,numgxy)</div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jflc(5,numgxy)</div>
<div class="line"><span class="lineno">  622</span>    <span class="keywordtype">INTEGER(mpi)</span> ::kflc(5,numgxy)</div>
<div class="line"><span class="lineno">  623</span>    <span class="comment">!     JFLC(1,.) = first used index</span></div>
<div class="line"><span class="lineno">  624</span>    <span class="comment">!     JFLC(2,.) = last used index</span></div>
<div class="line"><span class="lineno">  625</span>    <span class="comment">!     JFLC(3,.) = counter of used places</span></div>
<div class="line"><span class="lineno">  626</span>    <span class="comment">!     JFLC(4,.) = counter of ignored</span></div>
<div class="line"><span class="lineno">  627</span>    <span class="comment">!     JFLC(5,.) = limit for JFLC(3)</span></div>
<div class="line"><span class="lineno">  628</span>    <span class="keywordtype">CHARACTER (LEN=60)</span>:: gtext(numgxy)</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>    <span class="keywordtype">LOGICAL</span>:: start</div>
<div class="line"><span class="lineno">  631</span>    <span class="keywordtype">SAVE</span></div>
<div class="line"><span class="lineno">  632</span>    <span class="keyword">DATA</span> start/.true./,lun/7/</div>
<div class="line"><span class="lineno">  633</span>    <span class="keyword">DATA</span> nstr/numgxy*0/   <span class="comment">! by GF</span></div>
<div class="line"><span class="lineno">  634</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordflow">IF</span>(start) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  636</span>        start=.false.</div>
<div class="line"><span class="lineno">  637</span>        <span class="keyword">CALL </span><a class="code hl_function" href="mphistab_8f90.html#a0c10636054e5389ae1edf80dc039c03f">stmars</a>    <span class="comment">! initialize storage</span></div>
<div class="line"><span class="lineno">  638</span>        <span class="keywordflow">DO</span> i=1,numgxy</div>
<div class="line"><span class="lineno">  639</span>            <span class="keywordflow">DO</span> j=1,5</div>
<div class="line"><span class="lineno">  640</span>                jflc(j,i)=0</div>
<div class="line"><span class="lineno">  641</span>                kflc(j,i)=0</div>
<div class="line"><span class="lineno">  642</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  643</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  644</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>    <span class="keywordflow">IF</span>(ig &lt; 1.OR.ig &gt; numgxy) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  647</span>    <span class="keywordflow">IF</span>(ityp &lt; 1.OR.ityp &gt; 5) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  648</span>    <span class="keywordflow">IF</span>(nstr(ig) == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  649</span>        lvers(ig)=0</div>
<div class="line"><span class="lineno">  650</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  651</span>        lvers(ig)=lvers(ig)+1</div>
<div class="line"><span class="lineno">  652</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  653</span>    nstr(ig)=1 <span class="comment">! by GF</span></div>
<div class="line"><span class="lineno">  654</span>    <span class="comment">!        remove stored elements</span></div>
<div class="line"><span class="lineno">  655</span>    <span class="keywordflow">IF</span>(jflc(1,ig) /= 0) <span class="keyword">CALL </span>stmarm(jflc(1,ig))</div>
<div class="line"><span class="lineno">  656</span>    <span class="keywordflow">IF</span>(kflc(1,ig) /= 0) <span class="keyword">CALL </span>stmarm(kflc(1,ig))</div>
<div class="line"><span class="lineno">  657</span>    igtp(ig)=ityp</div>
<div class="line"><span class="lineno">  658</span>    gtext(ig)=text</div>
<div class="line"><span class="lineno">  659</span>    <span class="keywordflow">DO</span> j=1,5</div>
<div class="line"><span class="lineno">  660</span>        jflc(j,ig)=0</div>
<div class="line"><span class="lineno">  661</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  662</span>    jflc(5,ig)=nlimit</div>
<div class="line"><span class="lineno">  663</span>    <span class="keywordflow">IF</span>(ityp == 5) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  664</span>        <span class="keywordflow">DO</span> j=1,5</div>
<div class="line"><span class="lineno">  665</span>            kflc(j,ig)=0</div>
<div class="line"><span class="lineno">  666</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  667</span>        jflc(5,ig)=128 <span class="comment">! maximum of 128 values</span></div>
<div class="line"><span class="lineno">  668</span>        kflc(5,ig)=narr</div>
<div class="line"><span class="lineno">  669</span>        nst(1,ig)=0</div>
<div class="line"><span class="lineno">  670</span>        nst(2,ig)=0</div>
<div class="line"><span class="lineno">  671</span>        nst(3,ig)=1</div>
<div class="line"><span class="lineno">  672</span>        <span class="keywordflow">DO</span> j=1,10</div>
<div class="line"><span class="lineno">  673</span>            xyplws(j,ig)=0.0</div>
<div class="line"><span class="lineno">  674</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  675</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  676</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>    entry gmpxy(ig,x,y)                     <span class="comment">! add (X,Y) pair</span></div>
<div class="line"><span class="lineno">  679</span>    <span class="keywordflow">IF</span>(ig  &lt; 1.OR.ig &gt; numgxy) <span class="keywordflow">RETURN</span>        <span class="comment">! check argument IG</span></div>
<div class="line"><span class="lineno">  680</span>    <span class="keywordflow">IF</span>(igtp(ig) &lt; 1.OR.igtp(ig) &gt; 3) <span class="keywordflow">RETURN</span>   <span class="comment">! check type</span></div>
<div class="line"><span class="lineno">  681</span>    <span class="keyword">CALL </span>stmapr(jflc(1,ig),x,y)</div>
<div class="line"><span class="lineno">  682</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>    entry gmpxyd(ig,x,y,dx,dy)              <span class="comment">! add (X,Y,DX,DY)</span></div>
<div class="line"><span class="lineno">  685</span>    <span class="keywordflow">IF</span>(ig  &lt; 1.OR.ig &gt; numgxy) <span class="keywordflow">RETURN</span>        <span class="comment">! check argument IG</span></div>
<div class="line"><span class="lineno">  686</span>    <span class="keywordflow">IF</span>(igtp(ig) /= 4) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  687</span>    four(1)=x</div>
<div class="line"><span class="lineno">  688</span>    four(2)=y</div>
<div class="line"><span class="lineno">  689</span>    four(3)=dx</div>
<div class="line"><span class="lineno">  690</span>    four(4)=dy</div>
<div class="line"><span class="lineno">  691</span>    <span class="keyword">CALL </span>stmadp(jflc(1,ig),four)</div>
<div class="line"><span class="lineno">  692</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span>    entry gmpms(ig,x,y)                     <span class="comment">! mean sigma(X) from Y</span></div>
<div class="line"><span class="lineno">  695</span>    <span class="comment">!     mean sigma from Y, as a function of X</span></div>
<div class="line"><span class="lineno">  696</span>    <span class="comment">!      WRITE(*,*) &#39;GMPMS &#39;,IG,X,Y</span></div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span>    <span class="keywordflow">IF</span>(ig  &lt; 1.OR.ig &gt; numgxy) <span class="keywordflow">RETURN</span>        <span class="comment">! check argument IG</span></div>
<div class="line"><span class="lineno">  699</span>    <span class="keywordflow">IF</span>(igtp(ig) /= 5) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>    xyplws(10,ig)=x  <span class="comment">! last X  coordinate</span></div>
<div class="line"><span class="lineno">  702</span>    <span class="keywordflow">IF</span>(nst(1,ig) == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  703</span>        y1=y</div>
<div class="line"><span class="lineno">  704</span>        nst(1,ig)=1</div>
<div class="line"><span class="lineno">  705</span>        <span class="keywordflow">IF</span>(kflc(3,ig) == 0) xyplws(9,ig)=x        <span class="comment">! start coordinate</span></div>
<div class="line"><span class="lineno">  706</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  707</span>        nst(1,ig)=0</div>
<div class="line"><span class="lineno">  708</span>        <span class="keyword">CALL </span>stmapr(kflc(1,ig),y1,y) <span class="comment">! store pair</span></div>
<div class="line"><span class="lineno">  709</span>        <span class="keywordflow">IF</span>(kflc(3,ig) &gt;= kflc(5,ig)) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  710</span>            <span class="keyword">CALL </span>stmacp(kflc(1,ig),array,n) <span class="comment">! get data</span></div>
<div class="line"><span class="lineno">  711</span>            <span class="keyword">CALL </span>stmarm(kflc(1,ig))         <span class="comment">! remove data</span></div>
<div class="line"><span class="lineno">  712</span>            n=n+n</div>
<div class="line"><span class="lineno">  713</span>            <span class="keyword">CALL </span><a class="code hl_function" href="mphistab_8f90.html#a43e4b787e0e2c4b2fd1e6554a6734800">rmesig</a>(array,n,xyplws(2,ig),xyplws(4,ig))</div>
<div class="line"><span class="lineno">  714</span>            nst(2,ig)=nst(2,ig)+1</div>
<div class="line"><span class="lineno">  715</span>            <span class="keywordflow">IF</span>(nst(2,ig) == 1) xyplws(7,ig)=xyplws(9,ig)</div>
<div class="line"><span class="lineno">  716</span>            xyplws(8,ig)=x                   <span class="comment">! end coordinate</span></div>
<div class="line"><span class="lineno">  717</span>            xyplws(5,ig)=xyplws(5,ig)+xyplws(2,ig)</div>
<div class="line"><span class="lineno">  718</span>            xyplws(6,ig)=xyplws(6,ig)+xyplws(4,ig)</div>
<div class="line"><span class="lineno">  719</span>            <span class="keywordflow">IF</span>(nst(2,ig) == nst(3,ig)) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  720</span>                xyplws(1,ig)=0.5*(xyplws(7,ig)+xyplws(8,ig))</div>
<div class="line"><span class="lineno">  721</span>                xyplws(2,ig)=xyplws(5,ig)/real(nst(3,ig),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><span class="lineno">  722</span>                xyplws(3,ig)=0.5*(xyplws(8,ig)-xyplws(7,ig))</div>
<div class="line"><span class="lineno">  723</span>                xyplws(4,ig)=xyplws(6,ig)/real(nst(3,ig),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><span class="lineno">  724</span>                xyplws(5,ig)=0.0</div>
<div class="line"><span class="lineno">  725</span>                xyplws(6,ig)=0.0</div>
<div class="line"><span class="lineno">  726</span>                nst(2,ig)=0</div>
<div class="line"><span class="lineno">  727</span>                <span class="keyword">CALL </span>stmadp(jflc(1,ig),xyplws(1,ig))</div>
<div class="line"><span class="lineno">  728</span>                <span class="keywordflow">IF</span>(jflc(3,ig) &gt;= jflc(5,ig)) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  729</span>                    <span class="keyword">CALL </span>stmacp(jflc(1,ig),array4,n)   <span class="comment">! get data</span></div>
<div class="line"><span class="lineno">  730</span>                    n=n/2</div>
<div class="line"><span class="lineno">  731</span>                    <span class="keyword">CALL </span>stmarm(jflc(1,ig))            <span class="comment">! remove data</span></div>
<div class="line"><span class="lineno">  732</span>                    <span class="keywordflow">DO</span> i=1,n,2                   <span class="comment">! average</span></div>
<div class="line"><span class="lineno">  733</span>                        xyplws(7,ig)=array4(1,i  )-array4(3,  i)</div>
<div class="line"><span class="lineno">  734</span>                        xyplws(8,ig)=array4(1,i+1)+array4(3,i+1)</div>
<div class="line"><span class="lineno">  735</span>                        xyplws(1,ig)=0.5*(xyplws(7,ig)+xyplws(8,ig))</div>
<div class="line"><span class="lineno">  736</span>                        xyplws(2,ig)=0.5*(array4(2,i)+array4(2,i+1))</div>
<div class="line"><span class="lineno">  737</span>                        xyplws(3,ig)=0.5*(xyplws(8,ig)-xyplws(7,ig))</div>
<div class="line"><span class="lineno">  738</span>                        xyplws(4,ig)=0.5*(array4(4,i)+array4(4,i+1))</div>
<div class="line"><span class="lineno">  739</span>                        <span class="keyword">CALL </span>stmadp(jflc(1,ig),xyplws(1,ig))</div>
<div class="line"><span class="lineno">  740</span><span class="keywordflow">                    END DO</span></div>
<div class="line"><span class="lineno">  741</span>                    nst(3,ig)=nst(3,ig)+nst(3,ig)</div>
<div class="line"><span class="lineno">  742</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  743</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  744</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  745</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  746</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>    entry gmprnt(ig)                        <span class="comment">! print XY data</span></div>
<div class="line"><span class="lineno">  749</span>    <span class="keywordflow">IF</span>(ig == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  750</span>        iga=1</div>
<div class="line"><span class="lineno">  751</span>        igb=numgxy</div>
<div class="line"><span class="lineno">  752</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  753</span>        <span class="keywordflow">IF</span>(ig &lt;= 0.OR.ig &gt; numgxy) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  754</span>        iga=ig</div>
<div class="line"><span class="lineno">  755</span>        igb=ig</div>
<div class="line"><span class="lineno">  756</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  757</span>    <span class="keywordflow">DO</span> igc=iga,igb</div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>        <span class="keywordflow">IF</span>(igtp(igc) &gt;= 1.AND.igtp(igc) &lt;= 3) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  760</span>            <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><span class="lineno">  761</span>            <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Store &#39;</span>,igc,<span class="stringliteral">&#39;: &#39;</span>,gtext(igc)</div>
<div class="line"><span class="lineno">  762</span>            <span class="keywordflow">IF</span>(jflc(4,igc) == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  763</span>                <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;      stored n-tuples: &#39;</span>,jflc(3,igc)</div>
<div class="line"><span class="lineno">  764</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  765</span>                <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   stored n-tuples,  not-stored n-tuples: &#39;</span>,  &amp;</div>
<div class="line"><span class="lineno">  766</span>                    jflc(3,igc),<span class="stringliteral">&#39;, &#39;</span>,jflc(4,igc)</div>
<div class="line"><span class="lineno">  767</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  768</span>    </div>
<div class="line"><span class="lineno">  769</span>            <span class="keyword">CALL </span>stmacp(jflc(1,igc),array,na) <span class="comment">! get all data</span></div>
<div class="line"><span class="lineno">  770</span>    </div>
<div class="line"><span class="lineno">  771</span>            <span class="keywordflow">DO</span> n=1,na</div>
<div class="line"><span class="lineno">  772</span>                <span class="keyword">WRITE</span>(*,102) n, array(1,n),array(2,n)</div>
<div class="line"><span class="lineno">  773</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  774</span>    </div>
<div class="line"><span class="lineno">  775</span>        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(igtp(igc) == 4) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  776</span>    </div>
<div class="line"><span class="lineno">  777</span>            <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><span class="lineno">  778</span>            <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Store &#39;</span>,igc,<span class="stringliteral">&#39;: &#39;</span>,gtext(igc)</div>
<div class="line"><span class="lineno">  779</span>            <span class="keywordflow">IF</span>(jflc(4,igc) == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  780</span>                <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;      stored n-tuples: &#39;</span>,jflc(3,igc)</div>
<div class="line"><span class="lineno">  781</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  782</span>                <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   stored n-tuples,  not-stored n-tuples: &#39;</span>,  &amp;</div>
<div class="line"><span class="lineno">  783</span>                    jflc(3,igc),<span class="stringliteral">&#39;, &#39;</span>,jflc(4,igc)</div>
<div class="line"><span class="lineno">  784</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  785</span>    </div>
<div class="line"><span class="lineno">  786</span>            <span class="keyword">CALL </span>stmacp(jflc(1,igc),array,na) <span class="comment">! get all data</span></div>
<div class="line"><span class="lineno">  787</span>            na=na/2</div>
<div class="line"><span class="lineno">  788</span>    </div>
<div class="line"><span class="lineno">  789</span>            <span class="keywordflow">DO</span> n=1,na</div>
<div class="line"><span class="lineno">  790</span>                <span class="keyword">WRITE</span>(*,102) n,(array4(j,n),j=1,4)</div>
<div class="line"><span class="lineno">  791</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  792</span>    </div>
<div class="line"><span class="lineno">  793</span>        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(igtp(igc) == 5) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  794</span>    </div>
<div class="line"><span class="lineno">  795</span>            <span class="keyword">CALL </span>stmacp(kflc(1,igc),array,n) <span class="comment">! get data</span></div>
<div class="line"><span class="lineno">  796</span>            <span class="keyword">CALL </span>stmarm(kflc(1,igc))         <span class="comment">! remove data</span></div>
<div class="line"><span class="lineno">  797</span>            n=n+n</div>
<div class="line"><span class="lineno">  798</span>            <span class="keywordflow">IF</span>(nst(1,igc) == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  799</span>                n=n+1</div>
<div class="line"><span class="lineno">  800</span>                array1(n)=y1</div>
<div class="line"><span class="lineno">  801</span>                nst(1,igc)=0 <span class="comment">! reset</span></div>
<div class="line"><span class="lineno">  802</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  803</span>            <span class="keywordflow">IF</span>(n /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  804</span>                xyplws(7,igc)=xyplws( 9,igc)</div>
<div class="line"><span class="lineno">  805</span>                xyplws(8,igc)=xyplws(10,igc)</div>
<div class="line"><span class="lineno">  806</span>                <span class="keyword">CALL </span><a class="code hl_function" href="mphistab_8f90.html#a43e4b787e0e2c4b2fd1e6554a6734800">rmesig</a>(array1,n,xyplws(2,igc),xyplws(4,igc))</div>
<div class="line"><span class="lineno">  807</span>                wght=real(n,<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)/real(nst(3,igc)*kflc(5,igc),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><span class="lineno">  808</span>                xyplws(5,igc)=xyplws(5,igc)+xyplws(2,igc)*wght</div>
<div class="line"><span class="lineno">  809</span>                xyplws(6,igc)=xyplws(6,igc)+xyplws(4,igc)*wght</div>
<div class="line"><span class="lineno">  810</span>                xyplws(2,igc)=xyplws(5,igc)/(real(nst(2,igc),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)+wght)</div>
<div class="line"><span class="lineno">  811</span>                xyplws(4,igc)=xyplws(6,igc)/(real(nst(2,igc),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)+wght)</div>
<div class="line"><span class="lineno">  812</span>                xyplws(1,igc)=0.5*(xyplws(7,igc)+xyplws(8,igc))</div>
<div class="line"><span class="lineno">  813</span>                xyplws(3,igc)=0.5*(xyplws(8,igc)-xyplws(7,igc))</div>
<div class="line"><span class="lineno">  814</span>                <span class="keyword">CALL </span>stmadp(jflc(1,igc),xyplws(1,igc))</div>
<div class="line"><span class="lineno">  815</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  816</span>    </div>
<div class="line"><span class="lineno">  817</span>            <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><span class="lineno">  818</span>            <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Store &#39;</span>,igc,<span class="stringliteral">&#39;: &#39;</span>,gtext(igc)</div>
<div class="line"><span class="lineno">  819</span>            <span class="keywordflow">IF</span>(jflc(4,igc) == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  820</span>                <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;      stored n-tuples: &#39;</span>,jflc(3,igc)</div>
<div class="line"><span class="lineno">  821</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  822</span>                <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   stored n-tuples,  not-stored n-tuples: &#39;</span>,  &amp;</div>
<div class="line"><span class="lineno">  823</span>                    jflc(3,igc),<span class="stringliteral">&#39;, &#39;</span>,jflc(4,igc)</div>
<div class="line"><span class="lineno">  824</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  825</span>    </div>
<div class="line"><span class="lineno">  826</span>            <span class="keyword">CALL </span>stmacp(jflc(1,igc),array,na) <span class="comment">! get all data</span></div>
<div class="line"><span class="lineno">  827</span>            na=na/2</div>
<div class="line"><span class="lineno">  828</span>            <span class="keywordflow">DO</span> n=1,na</div>
<div class="line"><span class="lineno">  829</span>                <span class="keyword">WRITE</span>(*,102) n,(array4(j,n),j=1,4)</div>
<div class="line"><span class="lineno">  830</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  831</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  832</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  833</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>    entry gmplun(lunw)                      <span class="comment">! unit for output</span></div>
<div class="line"><span class="lineno">  836</span>    lun=lunw</div>
<div class="line"><span class="lineno">  837</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>    entry gmpwrt(ig)                        <span class="comment">! write XY text file</span></div>
<div class="line"><span class="lineno">  840</span>    <span class="keywordflow">IF</span>(lun &lt;= 0) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  841</span>    <span class="keywordflow">IF</span>(ig == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  842</span>        iga=1</div>
<div class="line"><span class="lineno">  843</span>        igb=numgxy</div>
<div class="line"><span class="lineno">  844</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  845</span>        <span class="keywordflow">IF</span>(ig &lt;= 0.OR.ig &gt; numgxy) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  846</span>        iga=ig</div>
<div class="line"><span class="lineno">  847</span>        igb=ig</div>
<div class="line"><span class="lineno">  848</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  849</span>    <span class="keywordflow">DO</span> igc=iga,igb</div>
<div class="line"><span class="lineno">  850</span>        <span class="keywordflow">IF</span>(igtp(igc) == 5) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  851</span>    </div>
<div class="line"><span class="lineno">  852</span>            <span class="keyword">CALL </span>stmacp(kflc(1,igc),array,n) <span class="comment">! get data</span></div>
<div class="line"><span class="lineno">  853</span>            <span class="keyword">CALL </span>stmarm(kflc(1,igc))         <span class="comment">! remove data</span></div>
<div class="line"><span class="lineno">  854</span>            n=n+n</div>
<div class="line"><span class="lineno">  855</span>            <span class="keywordflow">IF</span>(nst(1,igc) == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  856</span>                n=n+1</div>
<div class="line"><span class="lineno">  857</span>                array1(n)=y1</div>
<div class="line"><span class="lineno">  858</span>                nst(1,igc)=0 <span class="comment">! reset</span></div>
<div class="line"><span class="lineno">  859</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  860</span>            <span class="keywordflow">IF</span>(n /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  861</span>                xyplws(7,igc)=xyplws( 9,igc)</div>
<div class="line"><span class="lineno">  862</span>                xyplws(8,igc)=xyplws(10,igc)</div>
<div class="line"><span class="lineno">  863</span>                <span class="keyword">CALL </span><a class="code hl_function" href="mphistab_8f90.html#a43e4b787e0e2c4b2fd1e6554a6734800">rmesig</a>(array1,n,xyplws(2,igc),xyplws(4,igc))</div>
<div class="line"><span class="lineno">  864</span>                wght=real(n,<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)/real(nst(3,igc)*kflc(5,igc),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><span class="lineno">  865</span>                xyplws(5,igc)=xyplws(5,igc)+xyplws(2,igc)*wght</div>
<div class="line"><span class="lineno">  866</span>                xyplws(6,igc)=xyplws(6,igc)+xyplws(4,igc)*wght</div>
<div class="line"><span class="lineno">  867</span>                xyplws(2,igc)=xyplws(5,igc)/(real(nst(2,igc),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)+wght)</div>
<div class="line"><span class="lineno">  868</span>                xyplws(4,igc)=xyplws(6,igc)/(real(nst(2,igc),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)+wght)</div>
<div class="line"><span class="lineno">  869</span>                xyplws(1,igc)=0.5*(xyplws(7,igc)+xyplws(8,igc))</div>
<div class="line"><span class="lineno">  870</span>                xyplws(3,igc)=0.5*(xyplws(8,igc)-xyplws(7,igc))</div>
<div class="line"><span class="lineno">  871</span>                <span class="keyword">CALL </span>stmadp(jflc(1,igc),xyplws(1,igc))</div>
<div class="line"><span class="lineno">  872</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  873</span>    </div>
<div class="line"><span class="lineno">  874</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  875</span>        <span class="keywordflow">IF</span>(jflc(3,igc)+jflc(4,igc) /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  876</span>            <span class="keyword">WRITE</span>(lun,204) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><span class="lineno">  877</span>            <span class="keyword">WRITE</span>(lun,201) igc,lvers(igc),igtp(igc)</div>
<div class="line"><span class="lineno">  878</span>            <span class="keyword">WRITE</span>(lun,204) gtext(igc)</div>
<div class="line"><span class="lineno">  879</span>            <span class="keyword">WRITE</span>(lun,203) jflc(3,igc)+jflc(4,igc)</div>
<div class="line"><span class="lineno">  880</span>            <span class="keyword">CALL </span>stmacp(jflc(1,igc),array,na) <span class="comment">! get all data</span></div>
<div class="line"><span class="lineno">  881</span>            <span class="keywordflow">IF</span>(igtp(igc) &gt;= 1.AND.igtp(igc) &lt;= 3) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  882</span>                <span class="keyword">WRITE</span>(lun,204) <span class="stringliteral">&#39;x-y&#39;</span></div>
<div class="line"><span class="lineno">  883</span>                <span class="keywordflow">DO</span> n=1,na</div>
<div class="line"><span class="lineno">  884</span>                    <span class="keyword">WRITE</span>(lun,205) array(1,n),array(2,n)</div>
<div class="line"><span class="lineno">  885</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno">  886</span>            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(igtp(igc) == 4.OR.igtp(igc) == 5) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  887</span>                <span class="keyword">WRITE</span>(lun,204) <span class="stringliteral">&#39;x-y-dx-dy&#39;</span></div>
<div class="line"><span class="lineno">  888</span>                na=na/2</div>
<div class="line"><span class="lineno">  889</span>                <span class="keywordflow">DO</span> n=1,na</div>
<div class="line"><span class="lineno">  890</span>                    <span class="keyword">WRITE</span>(lun,205) (array4(j,n),j=1,4)</div>
<div class="line"><span class="lineno">  891</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno">  892</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  893</span>            <span class="keyword">WRITE</span>(lun,204) <span class="stringliteral">&#39;end of xy-data&#39;</span></div>
<div class="line"><span class="lineno">  894</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  895</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  896</span>102 <span class="keyword">FORMAT</span>(i12,4g15.7)</div>
<div class="line"><span class="lineno">  897</span>    <span class="comment">! 103  FORMAT(&#39;       Index    ___X___       ___Y___     &#39;/</span></div>
<div class="line"><span class="lineno">  898</span>    <span class="comment">!     +       &#39;       ----- -------------- --------------&#39;)</span></div>
<div class="line"><span class="lineno">  899</span>    <span class="comment">! 104  FORMAT(&#39;       Index    ___X___       ___Y___     &#39;,</span></div>
<div class="line"><span class="lineno">  900</span>    <span class="comment">!     +                   &#39;    ___DX__       ___DY__     &#39;/</span></div>
<div class="line"><span class="lineno">  901</span>    <span class="comment">!     +       &#39;       ----- -------------- --------------&#39;,</span></div>
<div class="line"><span class="lineno">  902</span>    <span class="comment">!     +                   &#39; -------------- --------------&#39;)</span></div>
<div class="line"><span class="lineno">  903</span>201 <span class="keyword">FORMAT</span>(<span class="stringliteral">&#39;XY-Data &#39;</span>,i4,10x,<span class="stringliteral">&#39;version &#39;</span>,i4,10x,<span class="stringliteral">&#39;type&#39;</span>,i2)</div>
<div class="line"><span class="lineno">  904</span>203 <span class="keyword">FORMAT</span>(10x,<span class="stringliteral">&#39;stored  not-stored &#39;</span>,2i10)</div>
<div class="line"><span class="lineno">  905</span>204 <span class="keyword">FORMAT</span>(a)</div>
<div class="line"><span class="lineno">  906</span>205 <span class="keyword">FORMAT</span>(3x,4g15.7)</div>
<div class="ttc" id="amphistab_8f90_html_a0c10636054e5389ae1edf80dc039c03f"><div class="ttname"><a href="mphistab_8f90.html#a0c10636054e5389ae1edf80dc039c03f">stmars</a></div><div class="ttdeci">subroutine stmars</div><div class="ttdef"><b>Definition</b> <a href="mphistab_8f90_source.html#l00910">mphistab.f90:911</a></div></div>
<div class="ttc" id="amphistab_8f90_html_a43e4b787e0e2c4b2fd1e6554a6734800"><div class="ttname"><a href="mphistab_8f90.html#a43e4b787e0e2c4b2fd1e6554a6734800">rmesig</a></div><div class="ttdeci">subroutine rmesig(x, n, xloc, xsca)</div><div class="ttdef"><b>Definition</b> <a href="mphistab_8f90_source.html#l01012">mphistab.f90:1013</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f3455d53e876e4fa06564306a0aeba9" name="a3f3455d53e876e4fa06564306a0aeba9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f3455d53e876e4fa06564306a0aeba9">&#9670;&#160;</a></span>hmpdef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hmpdef </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>ih</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mps), intent(in)&#160;</td>
          <td class="paramname"><em>xa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mps), intent(in)&#160;</td>
          <td class="paramname"><em>xb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character (len=*), intent(in)&#160;</td>
          <td class="paramname"><em>text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mphistab_8f90_source.html#l00092">92</a> of file <a class="el" href="mphistab_8f90_source.html">mphistab.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   93</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordtype">INTEGER(mpi)</span> :: iha</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ihb</div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ihc</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ix</div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordtype">INTEGER(mpi)</span> :: lun</div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordtype">INTEGER(mpi)</span> :: lunw</div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nbin</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nn</div>
<div class="line"><span class="lineno">  106</span><span class="keywordtype">    REAL</span>(mps) :: x</div>
<div class="line"><span class="lineno">  107</span><span class="keywordtype">    REAL</span>(mps) :: xcent</div>
<div class="line"><span class="lineno">  108</span><span class="keywordtype">    REAL</span>(mps) :: xmean</div>
<div class="line"><span class="lineno">  109</span><span class="keywordtype">    REAL</span>(mps) :: xsigm</div>
<div class="line"><span class="lineno">  110</span>    <span class="comment">!     book millepede histogram, 120 bins</span></div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: ih</div>
<div class="line"><span class="lineno">  113</span><span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(IN)</span>                         :: xa</div>
<div class="line"><span class="lineno">  114</span><span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(IN)</span>                         :: xb</div>
<div class="line"><span class="lineno">  115</span>    <span class="keywordtype">CHARACTER (LEN=*)</span>, <span class="keywordtype">INTENT(IN)</span>            :: text</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">PARAMETER</span> :: numhis=15</div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordtype">INTEGER(mpi)</span> :: inhist(120,numhis)</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordtype">INTEGER(mpi)</span> ::jnhist(5,numhis)</div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordtype">INTEGER(mpi)</span> ::khist(numhis)</div>
<div class="line"><span class="lineno">  120</span><span class="keywordtype">    REAL</span>(mps) :: fnhist(120,numhis)</div>
<div class="line"><span class="lineno">  121</span>    equivalence(inhist(1,1),fnhist(1,1))</div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordtype">INTEGER(mpi)</span> :: kvers(numhis)</div>
<div class="line"><span class="lineno">  123</span><span class="keywordtype">    REAL</span>(mps) :: xl(6,numhis)</div>
<div class="line"><span class="lineno">  124</span><span class="keywordtype">    REAL</span>(mpd):: dl(2,numhis)</div>
<div class="line"><span class="lineno">  125</span>    <span class="keywordtype">CHARACTER (LEN=60)</span>:: htext(numhis)</div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordtype">SAVE</span></div>
<div class="line"><span class="lineno">  127</span>    <span class="keyword">DATA</span> khist/numhis*0/,lun/7/</div>
<div class="line"><span class="lineno">  128</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordflow">IF</span>(ih &lt;= 0.OR.ih &gt; numhis) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  130</span>    <span class="comment">!      IF(XA.EQ.XB)                RETURN</span></div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">DO</span> i=1,120</div>
<div class="line"><span class="lineno">  132</span>        inhist(i,ih)=0</div>
<div class="line"><span class="lineno">  133</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  134</span>    <span class="keywordflow">DO</span> j=1,5</div>
<div class="line"><span class="lineno">  135</span>        jnhist(j,ih)=0</div>
<div class="line"><span class="lineno">  136</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  137</span>    xl(1,ih)=xa</div>
<div class="line"><span class="lineno">  138</span>    xl(2,ih)=xb</div>
<div class="line"><span class="lineno">  139</span>    xl(3,ih)=0.0</div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">IF</span>(xa /= xb) xl(3,ih)=120.0/(xb-xa)</div>
<div class="line"><span class="lineno">  141</span>    xl(6,ih)=0.5*(xa+xb) <span class="comment">! center</span></div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">IF</span>(khist(ih) == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  143</span>        kvers(ih)=0</div>
<div class="line"><span class="lineno">  144</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  145</span>        kvers(ih)=kvers(ih)+1</div>
<div class="line"><span class="lineno">  146</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  147</span>    khist(ih)=1    <span class="comment">! flt.pt. (lin)</span></div>
<div class="line"><span class="lineno">  148</span>    htext(ih)=text</div>
<div class="line"><span class="lineno">  149</span>    dl(1,ih)=0.0_mpd</div>
<div class="line"><span class="lineno">  150</span>    dl(2,ih)=0.0_mpd</div>
<div class="line"><span class="lineno">  151</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    entry hmpldf(ih,text)                   <span class="comment">! book, reset log histogram</span></div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordflow">IF</span>(ih &lt;= 0.OR.ih &gt; numhis) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">DO</span> i=1,120</div>
<div class="line"><span class="lineno">  156</span>        inhist(i,ih)=0</div>
<div class="line"><span class="lineno">  157</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  158</span>    <span class="keywordflow">DO</span> j=1,5</div>
<div class="line"><span class="lineno">  159</span>        jnhist(j,ih)=0</div>
<div class="line"><span class="lineno">  160</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordflow">IF</span>(khist(ih) == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  162</span>        kvers(ih)=0</div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  164</span>        kvers(ih)=kvers(ih)+1</div>
<div class="line"><span class="lineno">  165</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  166</span>    khist(ih)=2    <span class="comment">! integer log</span></div>
<div class="line"><span class="lineno">  167</span>    htext(ih)=text</div>
<div class="line"><span class="lineno">  168</span>    xl(1,ih)=0.0</div>
<div class="line"><span class="lineno">  169</span>    xl(2,ih)=6.0</div>
<div class="line"><span class="lineno">  170</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    entry hmpent(ih,x)                      <span class="comment">! entry flt.pt.</span></div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">IF</span>(ih &lt;= 0.OR.ih &gt; numhis) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  174</span>    <span class="keywordflow">IF</span>(khist(ih) /= 1)          <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordflow">IF</span>(jnhist(4,ih) &gt;= 2147483647) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  176</span>    jnhist(4,ih)=jnhist(4,ih)+1      <span class="comment">! count</span></div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">IF</span>(jnhist(4,ih) &lt;= 120) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  178</span>        fnhist(jnhist(4,ih),ih)=x     <span class="comment">! store value</span></div>
<div class="line"><span class="lineno">  179</span>        <span class="keywordflow">IF</span>(jnhist(4,ih) == 120) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  180</span>            <span class="keyword">CALL </span><a class="code hl_function" href="mphistab_8f90.html#a080a392c68fcea196d331b844ead9ffd">hmpmak</a>(inhist(1,ih),fnhist(1,ih),jnhist(1,ih), xl(1,ih),dl(1,ih))</div>
<div class="line"><span class="lineno">  181</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  182</span>        <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  183</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  184</span>    <span class="comment">!      IF(JNHIST(1,IH)+JNHIST(2,IH)+JNHIST(3,IH).EQ.0) THEN</span></div>
<div class="line"><span class="lineno">  185</span>    <span class="comment">!         XL(4,IH)=X</span></div>
<div class="line"><span class="lineno">  186</span>    <span class="comment">!         XL(5,IH)=X</span></div>
<div class="line"><span class="lineno">  187</span>    <span class="comment">!      END IF</span></div>
<div class="line"><span class="lineno">  188</span>    i=int(1.0+xl(3,ih)*(x-xl(1,ih)),<a class="code hl_variable" href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpi</a>)   <span class="comment">! X - Xmin</span></div>
<div class="line"><span class="lineno">  189</span>    j=2</div>
<div class="line"><span class="lineno">  190</span>    <span class="keywordflow">IF</span>(i &lt;  1) j=1</div>
<div class="line"><span class="lineno">  191</span>    <span class="keywordflow">IF</span>(i &gt; 120) j=3</div>
<div class="line"><span class="lineno">  192</span>    jnhist(j,ih)=jnhist(j,ih)+1</div>
<div class="line"><span class="lineno">  193</span>    xl(4,ih)=min(xl(4,ih),x)</div>
<div class="line"><span class="lineno">  194</span>    xl(5,ih)=max(xl(5,ih),x)</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">IF</span>(j /= 2) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  196</span>    inhist(i,ih)=inhist(i,ih)+1</div>
<div class="line"><span class="lineno">  197</span>    dl(1,ih)=dl(1,ih)+ x-xl(6,ih)</div>
<div class="line"><span class="lineno">  198</span>    dl(2,ih)=dl(2,ih)+(x-xl(6,ih))**2</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>    entry hmplnt(ih,ix)                     <span class="comment">! entry integer</span></div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">IF</span>(ih &lt;= 0.OR.ih &gt; numhis) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  203</span>    <span class="keywordflow">IF</span>(khist(ih) /= 2)          <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">IF</span>(jnhist(1,ih) &gt;= 2147483647) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">IF</span>(ix &lt;= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  206</span>        jnhist(1,ih)=jnhist(1,ih)+1</div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  208</span>        <span class="keywordflow">IF</span>(jnhist(4,ih) == 0) jnhist(4,ih)=ix</div>
<div class="line"><span class="lineno">  209</span>        <span class="keywordflow">IF</span>(jnhist(5,ih) == 0) jnhist(5,ih)=ix</div>
<div class="line"><span class="lineno">  210</span>        jnhist(4,ih)=min(jnhist(4,ih),ix)</div>
<div class="line"><span class="lineno">  211</span>        jnhist(5,ih)=max(jnhist(5,ih),ix)</div>
<div class="line"><span class="lineno">  212</span>        i=int(1.0+20.0*log10(real(ix,<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)),<a class="code hl_variable" href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpi</a>)</div>
<div class="line"><span class="lineno">  213</span>        j=2</div>
<div class="line"><span class="lineno">  214</span>        <span class="keywordflow">IF</span>(i &lt;  1) j=1</div>
<div class="line"><span class="lineno">  215</span>        <span class="keywordflow">IF</span>(i &gt; 120) j=3</div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">IF</span>(j == 2)  inhist(i,ih)=inhist(i,ih)+1</div>
<div class="line"><span class="lineno">  217</span>        jnhist(j,ih)=jnhist(j,ih)+1</div>
<div class="line"><span class="lineno">  218</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>    entry hmprnt(ih)                        <span class="comment">! print, content vert</span></div>
<div class="line"><span class="lineno">  222</span>    <span class="keywordflow">IF</span>(ih == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  223</span>        iha=1</div>
<div class="line"><span class="lineno">  224</span>        ihb=numhis</div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  226</span>        <span class="keywordflow">IF</span>(ih &lt;= 0.OR.ih &gt; numhis) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  227</span>        iha=ih</div>
<div class="line"><span class="lineno">  228</span>        ihb=ih</div>
<div class="line"><span class="lineno">  229</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordflow">DO</span> ihc=iha,ihb</div>
<div class="line"><span class="lineno">  231</span>        <span class="keywordflow">IF</span>(khist(ihc) /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  232</span>            <span class="keywordflow">IF</span>(khist(ihc) == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  233</span>                <span class="keyword">CALL </span><a class="code hl_function" href="mphistab_8f90.html#a080a392c68fcea196d331b844ead9ffd">hmpmak</a>(inhist(1,ihc),fnhist(1,ihc),jnhist(1,ihc),  &amp;</div>
<div class="line"><span class="lineno">  234</span>                    xl(1,ihc),dl(1,ihc))</div>
<div class="line"><span class="lineno">  235</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  236</span>            nn=jnhist(1,ihc)+jnhist(2,ihc)+jnhist(3,ihc)</div>
<div class="line"><span class="lineno">  237</span>            <span class="keywordflow">IF</span>(nn /= 0.OR.khist(ihc) == 3) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  238</span>                <span class="keyword">WRITE</span>(*,111)</div>
<div class="line"><span class="lineno">  239</span>111             <span class="keyword">FORMAT</span>(<span class="stringliteral">&#39; ______&#39;</span>,2(<span class="stringliteral">&#39;______________________________&#39;</span>))</div>
<div class="line"><span class="lineno">  240</span>                <span class="keywordflow">IF</span>(kvers(ihc) == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  241</span>                    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Histogram&#39;</span>,ihc,<span class="stringliteral">&#39;: &#39;</span>,htext(ihc)</div>
<div class="line"><span class="lineno">  242</span>                <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  243</span>                    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Histogram&#39;</span>,ihc,<span class="stringliteral">&#39;/&#39;</span>,kvers(ihc),<span class="stringliteral">&#39;: &#39;</span>,htext(ihc)</div>
<div class="line"><span class="lineno">  244</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  245</span>                <span class="keywordflow">IF</span>(khist(ihc) == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  246</span>                    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   Out_low  inside  out_high = &#39;</span>, (jnhist(j,ihc),j=1,3)</div>
<div class="line"><span class="lineno">  247</span>                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(khist(ihc) == 2) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  248</span>                    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   0_or_negative  inside  above_10^6 = &#39;</span>,  &amp;</div>
<div class="line"><span class="lineno">  249</span>                        (jnhist(j,ihc),j=1,3)</div>
<div class="line"><span class="lineno">  250</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  251</span>                <span class="keywordflow">IF</span>(khist(ihc) == 3) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  252</span>                    <span class="keyword">CALL </span><a class="code hl_function" href="vertpr_8f90.html#a3cbbea2b3edd420dc246faf71ccbd4fb">pfvert</a>(120,fnhist(1,ihc))</div>
<div class="line"><span class="lineno">  253</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  254</span>                <span class="keywordflow">IF</span>(jnhist(2,ihc) /= 0) <span class="keywordflow">THEN</span>        <span class="comment">! integer content</span></div>
<div class="line"><span class="lineno">  255</span>                    <span class="keyword">CALL </span><a class="code hl_function" href="vertpr_8f90.html#a73afdc70b3fc1b06990f5370b704814e">pivert</a>(120,inhist(1,ihc))</div>
<div class="line"><span class="lineno">  256</span>                    <span class="keywordflow">IF</span>(khist(ihc) == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  257</span>                        <span class="keyword">CALL </span><a class="code hl_function" href="vertpr_8f90.html#a9d248bbc8158cf832263204b696b53c5">psvert</a>(xl(1,ihc),xl(2,ihc))</div>
<div class="line"><span class="lineno">  258</span>                    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(khist(ihc) == 2) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  259</span>                        <span class="keyword">CALL </span><a class="code hl_function" href="vertpr_8f90.html#a9d248bbc8158cf832263204b696b53c5">psvert</a>(0.0,6.0)</div>
<div class="line"><span class="lineno">  260</span><span class="keywordflow">                    END IF</span></div>
<div class="line"><span class="lineno">  261</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  262</span>                <span class="keywordflow">IF</span>(khist(ihc) == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  263</span>                    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   Min and Max are&#39;</span>,xl(4,ihc),xl(5,ihc)</div>
<div class="line"><span class="lineno">  264</span>                    <span class="keywordflow">IF</span>(jnhist(2,ihc) &gt; 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  265</span>                        xmean=real(xl(6,ihc)+dl(1,ihc)/real(jnhist(2,ihc),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><span class="lineno">  266</span>                        xcent=0.5*(xl(1,ihc)+xl(2,ihc))</div>
<div class="line"><span class="lineno">  267</span>                        xsigm=real((dl(2,ihc)-dl(1,ihc)**2/real(jnhist(2,ihc),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><span class="lineno">  268</span>                        xsigm=sqrt(xsigm/real(jnhist(2,ihc)-1,<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>))</div>
<div class="line"><span class="lineno">  269</span>                        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   Mean and sigma are&#39;</span>, xmean,<span class="stringliteral">&#39; +-&#39;</span>,xsigm</div>
<div class="line"><span class="lineno">  270</span><span class="keywordflow">                    END IF</span></div>
<div class="line"><span class="lineno">  271</span>                <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(khist(ihc) == 2) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  272</span>                    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   Plot of log10 of entries. Min and Max are&#39;</span>,  &amp;</div>
<div class="line"><span class="lineno">  273</span>                        jnhist(4,ihc),jnhist(5,ihc)</div>
<div class="line"><span class="lineno">  274</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  275</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  276</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  277</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  278</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>    entry hmplun(lunw)                      <span class="comment">! unit for output</span></div>
<div class="line"><span class="lineno">  281</span>    lun=lunw</div>
<div class="line"><span class="lineno">  282</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>    entry hmpwrt(ih)                        <span class="comment">! write histogram text file</span></div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">IF</span>(lun &lt;= 0) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordflow">IF</span>(ih == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  287</span>        iha=1</div>
<div class="line"><span class="lineno">  288</span>        ihb=numhis</div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  290</span>        <span class="keywordflow">IF</span>(ih &lt;= 0.OR.ih &gt; numhis) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  291</span>        iha=ih</div>
<div class="line"><span class="lineno">  292</span>        ihb=ih</div>
<div class="line"><span class="lineno">  293</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>    <span class="keywordflow">DO</span> ihc=iha,ihb <span class="comment">! histogram loop</span></div>
<div class="line"><span class="lineno">  296</span>        <span class="keywordflow">IF</span>(khist(ihc) /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  297</span>            <span class="keywordflow">IF</span>(khist(ihc) == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  298</span>                <span class="keyword">CALL </span><a class="code hl_function" href="mphistab_8f90.html#a080a392c68fcea196d331b844ead9ffd">hmpmak</a>(inhist(1,ihc),fnhist(1,ihc),jnhist(1,ihc),  &amp;</div>
<div class="line"><span class="lineno">  299</span>                    xl(1,ihc),dl(1,ihc))</div>
<div class="line"><span class="lineno">  300</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  301</span>            nbin=120</div>
<div class="line"><span class="lineno">  302</span>            <span class="keyword">WRITE</span>(lun,204) <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><span class="lineno">  303</span>            <span class="keyword">WRITE</span>(lun,201) ihc,kvers(ihc),khist(ihc)</div>
<div class="line"><span class="lineno">  304</span>            <span class="keyword">WRITE</span>(lun,204) htext(ihc)</div>
<div class="line"><span class="lineno">  305</span>            <span class="keywordflow">IF</span> (jnhist(1,ihc)+jnhist(2,ihc)+jnhist(3,ihc) == 0  &amp;</div>
<div class="line"><span class="lineno">  306</span>                .AND.xl(1,ihc) == xl(2,ihc)) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  307</span>                <span class="comment">!     hist is empty and hist range makes no sense</span></div>
<div class="line"><span class="lineno">  308</span>                <span class="comment">!     - cause: hist with &#39;variable edges&#39; was never filled</span></div>
<div class="line"><span class="lineno">  309</span>                <span class="comment">!     - workaround: make lower and upper edge of hist differ in output</span></div>
<div class="line"><span class="lineno">  310</span>                <span class="keyword">WRITE</span>(lun,202) nbin,xl(1,ihc)-0.001,xl(2,ihc)+0.001</div>
<div class="line"><span class="lineno">  311</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  312</span>                <span class="keyword">WRITE</span>(lun,202) nbin,xl(1,ihc),xl(2,ihc)</div>
<div class="line"><span class="lineno">  313</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  314</span>            <span class="keyword">WRITE</span>(lun,203) (jnhist(j,ihc),j=1,3)</div>
<div class="line"><span class="lineno">  315</span>            <span class="keyword">WRITE</span>(lun,204) <span class="stringliteral">&#39;bincontent&#39;</span></div>
<div class="line"><span class="lineno">  316</span>            <span class="keywordflow">IF</span>(khist(ihc) == 1.OR.khist(ihc) == 2) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  317</span>                <span class="keyword">CALL </span><a class="code hl_function" href="mphistab_8f90.html#a719432bd7b5cfb9fd0660200dc04a99e">kprint</a>(lun,inhist(1,ihc),nbin)</div>
<div class="line"><span class="lineno">  318</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  319</span>                <span class="keyword">WRITE</span>(lun,219) (fnhist(i,ihc),i=1,nbin)</div>
<div class="line"><span class="lineno">  320</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  321</span>    </div>
<div class="line"><span class="lineno">  322</span>            <span class="keywordflow">IF</span>(khist(ihc) == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  323</span>                <span class="keyword">WRITE</span>(lun,205) xl(4,ihc),xl(5,ihc)</div>
<div class="line"><span class="lineno">  324</span>            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(khist(ihc) == 2) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  325</span>                <span class="keyword">WRITE</span>(lun,205) real(jnhist(4,ihc),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>),real(jnhist(5,ihc),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><span class="lineno">  326</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  327</span>            <span class="keywordflow">IF</span>(khist(ihc) == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  328</span>                <span class="keywordflow">IF</span>(jnhist(2,ihc) &gt; 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  329</span>                    xmean=real(xl(6,ihc)+dl(1,ihc)/real(jnhist(2,ihc),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><span class="lineno">  330</span>                    xcent=0.5*(xl(1,ihc)+xl(2,ihc))</div>
<div class="line"><span class="lineno">  331</span>                    xsigm=real((dl(2,ihc)-dl(1,ihc)**2/real(jnhist(2,ihc),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><span class="lineno">  332</span>                    xsigm=sqrt(xsigm/real(jnhist(2,ihc)-1,<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>))</div>
<div class="line"><span class="lineno">  333</span>                    <span class="keyword">WRITE</span>(lun,206) xmean,xsigm</div>
<div class="line"><span class="lineno">  334</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  335</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  336</span>            <span class="keyword">WRITE</span>(lun,204) <span class="stringliteral">&#39;end of histogram&#39;</span></div>
<div class="line"><span class="lineno">  337</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  338</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>201 <span class="keyword">FORMAT</span>(<span class="stringliteral">&#39;Histogram &#39;</span>,i4,10x,<span class="stringliteral">&#39;version &#39;</span>,i4,10x,<span class="stringliteral">&#39;type&#39;</span>,i2)</div>
<div class="line"><span class="lineno">  341</span>202 <span class="keyword">FORMAT</span>(10x,<span class="stringliteral">&#39; bins, limits &#39;</span>,i4,2g15.5)</div>
<div class="line"><span class="lineno">  342</span>203 <span class="keyword">FORMAT</span>(10x,<span class="stringliteral">&#39;out-low inside out-high &#39;</span>,3i10)</div>
<div class="line"><span class="lineno">  343</span>204 <span class="keyword">FORMAT</span>(a)</div>
<div class="line"><span class="lineno">  344</span>205 <span class="keyword">FORMAT</span>(<span class="stringliteral">&#39;minmax&#39;</span>,2e15.7)</div>
<div class="line"><span class="lineno">  345</span>206 <span class="keyword">FORMAT</span>(<span class="stringliteral">&#39;meansigma&#39;</span>,2e15.7)</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>219 <span class="keyword">FORMAT</span>(4e15.7)</div>
<div class="ttc" id="amphistab_8f90_html_a080a392c68fcea196d331b844ead9ffd"><div class="ttname"><a href="mphistab_8f90.html#a080a392c68fcea196d331b844ead9ffd">hmpmak</a></div><div class="ttdeci">subroutine hmpmak(inhist, fnhist, jnhist, xl, dl)</div><div class="ttdef"><b>Definition</b> <a href="mphistab_8f90_source.html#l00350">mphistab.f90:351</a></div></div>
<div class="ttc" id="amphistab_8f90_html_a719432bd7b5cfb9fd0660200dc04a99e"><div class="ttname"><a href="mphistab_8f90.html#a719432bd7b5cfb9fd0660200dc04a99e">kprint</a></div><div class="ttdeci">subroutine kprint(lun, list, n)</div><div class="ttdef"><b>Definition</b> <a href="mphistab_8f90_source.html#l00519">mphistab.f90:520</a></div></div>
<div class="ttc" id="avertpr_8f90_html_a3cbbea2b3edd420dc246faf71ccbd4fb"><div class="ttname"><a href="vertpr_8f90.html#a3cbbea2b3edd420dc246faf71ccbd4fb">pfvert</a></div><div class="ttdeci">subroutine pfvert(n, x)</div><div class="ttdoc">Vertical print of floating point data.</div><div class="ttdef"><b>Definition</b> <a href="vertpr_8f90_source.html#l00224">vertpr.f90:225</a></div></div>
<div class="ttc" id="avertpr_8f90_html_a73afdc70b3fc1b06990f5370b704814e"><div class="ttname"><a href="vertpr_8f90.html#a73afdc70b3fc1b06990f5370b704814e">pivert</a></div><div class="ttdeci">subroutine pivert(n, list)</div><div class="ttdoc">Vertical print of integer data.</div><div class="ttdef"><b>Definition</b> <a href="vertpr_8f90_source.html#l00184">vertpr.f90:185</a></div></div>
<div class="ttc" id="avertpr_8f90_html_a9d248bbc8158cf832263204b696b53c5"><div class="ttname"><a href="vertpr_8f90.html#a9d248bbc8158cf832263204b696b53c5">psvert</a></div><div class="ttdeci">subroutine psvert(xa, xb)</div><div class="ttdoc">Print scale.</div><div class="ttdef"><b>Definition</b> <a href="vertpr_8f90_source.html#l00258">vertpr.f90:259</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a080a392c68fcea196d331b844ead9ffd" name="a080a392c68fcea196d331b844ead9ffd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a080a392c68fcea196d331b844ead9ffd">&#9670;&#160;</a></span>hmpmak()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine hmpmak </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), dimension(120), intent(out)&#160;</td>
          <td class="paramname"><em>inhist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mps), dimension(120), intent(in)&#160;</td>
          <td class="paramname"><em>fnhist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(5), intent(inout)&#160;</td>
          <td class="paramname"><em>jnhist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mps), dimension(6), intent(inout)&#160;</td>
          <td class="paramname"><em>xl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(2), intent(out)&#160;</td>
          <td class="paramname"><em>dl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mphistab_8f90_source.html#l00350">350</a> of file <a class="el" href="mphistab_8f90_source.html">mphistab.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  351</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  355</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno">  357</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nn</div>
<div class="line"><span class="lineno">  358</span><span class="keywordtype">    REAL</span>(mps) :: x</div>
<div class="line"><span class="lineno">  359</span><span class="keywordtype">    REAL</span>(mps) :: xa</div>
<div class="line"><span class="lineno">  360</span><span class="keywordtype">    REAL</span>(mps) :: xb</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: inhist(120)</div>
<div class="line"><span class="lineno">  363</span><span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(IN)</span>                         :: fnhist(120)</div>
<div class="line"><span class="lineno">  364</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN OUT)</span>                  :: jnhist(5)</div>
<div class="line"><span class="lineno">  365</span><span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(IN OUT)</span>                     :: xl(6)</div>
<div class="line"><span class="lineno">  366</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: dl(2)</div>
<div class="line"><span class="lineno">  367</span><span class="keywordtype">    REAL</span>(mps) :: cphist(120)</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>    <span class="keywordtype">SAVE</span></div>
<div class="line"><span class="lineno">  372</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  373</span>    nn=jnhist(4)</div>
<div class="line"><span class="lineno">  374</span>    <span class="comment">!      WRITE(*,*) &#39;HMPMAK: NN,JNHIST(5)&#39;,NN,JNHIST(5)</span></div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordflow">IF</span>(nn == 0.OR.jnhist(5) /= 0) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  376</span>    jnhist(5)=1</div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordflow">DO</span> i=1,nn</div>
<div class="line"><span class="lineno">  378</span>        <span class="comment">!       WRITE(*,*) &#39;copy &#39;,I,FNHIST(I)</span></div>
<div class="line"><span class="lineno">  379</span>        cphist(i)=fnhist(i)</div>
<div class="line"><span class="lineno">  380</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  381</span>    <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#a59c0fd2fe612e6fb7c2b5b40b8e7762f">heapf</a>(cphist,nn)</div>
<div class="line"><span class="lineno">  382</span>    <span class="keywordflow">IF</span>(xl(3) == 0.0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  383</span>        <span class="keyword">CALL </span><a class="code hl_function" href="mphistab_8f90.html#a313682fccd921114074f837794fb5676">bintab</a>(cphist,nn,xa,xb)</div>
<div class="line"><span class="lineno">  384</span>        xl(1)=xa</div>
<div class="line"><span class="lineno">  385</span>        xl(2)=xb</div>
<div class="line"><span class="lineno">  386</span>        xl(3)=0.0</div>
<div class="line"><span class="lineno">  387</span>        <span class="keywordflow">IF</span>(xa /= xb) xl(3)=120.0/(xb-xa)</div>
<div class="line"><span class="lineno">  388</span>        xl(6)=0.5*(xa+xb) <span class="comment">! center</span></div>
<div class="line"><span class="lineno">  389</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  390</span>    xl(4)=cphist( 1)</div>
<div class="line"><span class="lineno">  391</span>    xl(5)=cphist(nn)</div>
<div class="line"><span class="lineno">  392</span>    <span class="comment">!      WRITE(*,*) &#39;XL &#39;,XL</span></div>
<div class="line"><span class="lineno">  393</span>    <span class="keywordflow">DO</span> i=1,nn</div>
<div class="line"><span class="lineno">  394</span>        inhist(i)=0</div>
<div class="line"><span class="lineno">  395</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  396</span>    <span class="keywordflow">DO</span> k=1,nn</div>
<div class="line"><span class="lineno">  397</span>        x=cphist(k)</div>
<div class="line"><span class="lineno">  398</span>        i=int(1.0+xl(3)*(x-xl(1)),<a class="code hl_variable" href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpi</a>)   <span class="comment">! X - Xmin</span></div>
<div class="line"><span class="lineno">  399</span>        <span class="comment">!       WRITE(*,*) &#39;K,I,X &#39;,K,I,X</span></div>
<div class="line"><span class="lineno">  400</span>        j=2</div>
<div class="line"><span class="lineno">  401</span>        <span class="keywordflow">IF</span>(i &lt;  1) j=1</div>
<div class="line"><span class="lineno">  402</span>        <span class="keywordflow">IF</span>(i &gt; 120) j=3</div>
<div class="line"><span class="lineno">  403</span>        jnhist(j)=jnhist(j)+1</div>
<div class="line"><span class="lineno">  404</span>        <span class="keywordflow">IF</span>(j == 2) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  405</span>            inhist(i)=inhist(i)+1</div>
<div class="line"><span class="lineno">  406</span>            dl(1)=dl(1)+ x-xl(6)</div>
<div class="line"><span class="lineno">  407</span>            dl(2)=dl(2)+(x-xl(6))**2</div>
<div class="line"><span class="lineno">  408</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  409</span><span class="keywordflow">    END DO</span></div>
<div class="ttc" id="amphistab_8f90_html_a313682fccd921114074f837794fb5676"><div class="ttname"><a href="mphistab_8f90.html#a313682fccd921114074f837794fb5676">bintab</a></div><div class="ttdeci">subroutine bintab(tab, n, xa, xb)</div><div class="ttdef"><b>Definition</b> <a href="mphistab_8f90_source.html#l00415">mphistab.f90:416</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a719432bd7b5cfb9fd0660200dc04a99e" name="a719432bd7b5cfb9fd0660200dc04a99e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a719432bd7b5cfb9fd0660200dc04a99e">&#9670;&#160;</a></span>kprint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine kprint </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(inout)&#160;</td>
          <td class="paramname"><em>lun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mphistab_8f90_source.html#l00519">519</a> of file <a class="el" href="mphistab_8f90_source.html">mphistab.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  520</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  523</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  524</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ia</div>
<div class="line"><span class="lineno">  525</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ib</div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno">  527</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ln</div>
<div class="line"><span class="lineno">  528</span>    <span class="keywordtype">INTEGER(mpi)</span> :: lp</div>
<div class="line"><span class="lineno">  529</span>    <span class="keywordtype">INTEGER(mpi)</span> :: np</div>
<div class="line"><span class="lineno">  530</span>    <span class="comment">!     print integer array LIST(N)</span></div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN OUT)</span>                  :: lun</div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: list(n)</div>
<div class="line"><span class="lineno">  534</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno">  535</span>    <span class="keywordtype">INTEGER(mpi)</span> :: li(7)</div>
<div class="line"><span class="lineno">  536</span>    <span class="keyword">DATA</span> li/2,3,4,6,8,9,12/ <span class="comment">! number of characters</span></div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordtype">SAVE</span></div>
<div class="line"><span class="lineno">  538</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  539</span>    ib=0</div>
<div class="line"><span class="lineno">  540</span>10  ia=ib+1</div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">IF</span>(ia &gt; n) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  542</span>    <span class="keywordflow">DO</span> k=1,7</div>
<div class="line"><span class="lineno">  543</span>        np=72/li(k)</div>
<div class="line"><span class="lineno">  544</span>        ib=min(ia-1+np,n)</div>
<div class="line"><span class="lineno">  545</span>        <span class="keywordflow">IF</span>(k &lt;= 6) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  546</span>            lp=10**(li(k)-1)-1 <span class="comment">! maximum positive</span></div>
<div class="line"><span class="lineno">  547</span>            ln=-lp/10       <span class="comment">! minimum negative</span></div>
<div class="line"><span class="lineno">  548</span>            <span class="keywordflow">DO</span> i=ia,ib</div>
<div class="line"><span class="lineno">  549</span>                <span class="keywordflow">IF</span>(list(i) &gt; lp.OR.list(i) &lt; ln) <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><span class="lineno">  550</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  551</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  552</span>        <span class="keywordflow">IF</span>(k == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  553</span>            <span class="keyword">WRITE</span>(lun,101) (list(i),i=ia,ib)</div>
<div class="line"><span class="lineno">  554</span>        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(k == 2) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  555</span>            <span class="keyword">WRITE</span>(lun,102) (list(i),i=ia,ib)</div>
<div class="line"><span class="lineno">  556</span>        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(k == 3) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  557</span>            <span class="keyword">WRITE</span>(lun,103) (list(i),i=ia,ib)</div>
<div class="line"><span class="lineno">  558</span>        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(k == 4) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  559</span>            <span class="keyword">WRITE</span>(lun,104) (list(i),i=ia,ib)</div>
<div class="line"><span class="lineno">  560</span>        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(k == 5) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  561</span>            <span class="keyword">WRITE</span>(lun,105) (list(i),i=ia,ib)</div>
<div class="line"><span class="lineno">  562</span>        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(k == 6) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  563</span>            <span class="keyword">WRITE</span>(lun,106) (list(i),i=ia,ib)</div>
<div class="line"><span class="lineno">  564</span>        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(k == 7) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  565</span>            <span class="keyword">WRITE</span>(lun,107) (list(i),i=ia,ib)</div>
<div class="line"><span class="lineno">  566</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  567</span>        <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><span class="lineno">  568</span>20  <span class="keywordflow">CONTINUE</span></div>
<div class="line"><span class="lineno">  569</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  570</span>101 <span class="keyword">FORMAT</span>(36i2)</div>
<div class="line"><span class="lineno">  571</span>102 <span class="keyword">FORMAT</span>(24i3)</div>
<div class="line"><span class="lineno">  572</span>103 <span class="keyword">FORMAT</span>(18i4)</div>
<div class="line"><span class="lineno">  573</span>104 <span class="keyword">FORMAT</span>(12i6)</div>
<div class="line"><span class="lineno">  574</span>105 <span class="keyword">FORMAT</span>( 9i8)</div>
<div class="line"><span class="lineno">  575</span>106 <span class="keyword">FORMAT</span>( 8i9)</div>
<div class="line"><span class="lineno">  576</span>107 <span class="keyword">FORMAT</span>( 6i12)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a43e4b787e0e2c4b2fd1e6554a6734800" name="a43e4b787e0e2c4b2fd1e6554a6734800"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43e4b787e0e2c4b2fd1e6554a6734800">&#9670;&#160;</a></span>rmesig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine rmesig </td>
          <td>(</td>
          <td class="paramtype">real(mps), dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mps), intent(out)&#160;</td>
          <td class="paramname"><em>xloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mps), intent(out)&#160;</td>
          <td class="paramname"><em>xsca</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mphistab_8f90_source.html#l01012">1012</a> of file <a class="el" href="mphistab_8f90_source.html">mphistab.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1013</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1016</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1017</span>    <span class="comment">!     robust determination of location and scale parameter,</span></div>
<div class="line"><span class="lineno"> 1018</span>    <span class="comment">!        for Gaussian data: location=mean and scale=standard deviation</span></div>
<div class="line"><span class="lineno"> 1019</span>    <span class="comment">!     XLOC = median of X_i            (N values in array X(N))</span></div>
<div class="line"><span class="lineno"> 1020</span>    <span class="comment">!     XCSA = median of | X_i - XLOC |, times 1.4826</span></div>
<div class="line"><span class="lineno"> 1021</span> </div>
<div class="line"><span class="lineno"> 1022</span><span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(IN OUT)</span>                     :: x(n) <span class="comment">! input array, modified</span></div>
<div class="line"><span class="lineno"> 1023</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno"> 1024</span><span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(OUT)</span>                        :: xloc</div>
<div class="line"><span class="lineno"> 1025</span><span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(OUT)</span>                        :: xsca</div>
<div class="line"><span class="lineno"> 1026</span>    <span class="keywordtype">SAVE</span></div>
<div class="line"><span class="lineno"> 1027</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 1028</span>    xloc=0.0</div>
<div class="line"><span class="lineno"> 1029</span>    xsca=0.0</div>
<div class="line"><span class="lineno"> 1030</span>    <span class="keywordflow">IF</span>(n &lt;= 0) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno"> 1031</span>    <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#a59c0fd2fe612e6fb7c2b5b40b8e7762f">heapf</a>(x,n)  <span class="comment">! sort</span></div>
<div class="line"><span class="lineno"> 1032</span>    xloc=0.5*(x((n+1)/2)+x((n+2)/2))         <span class="comment">! location</span></div>
<div class="line"><span class="lineno"> 1033</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno"> 1034</span>        x(i)=abs(x(i)-xloc)</div>
<div class="line"><span class="lineno"> 1035</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 1036</span>    <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#a59c0fd2fe612e6fb7c2b5b40b8e7762f">heapf</a>(x,n) <span class="comment">! sort</span></div>
<div class="line"><span class="lineno"> 1037</span>    xsca=1.4826*0.5*(x((n+1)/2)+x((n+2)/2))  <span class="comment">! dispersion</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c10636054e5389ae1edf80dc039c03f" name="a0c10636054e5389ae1edf80dc039c03f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c10636054e5389ae1edf80dc039c03f">&#9670;&#160;</a></span>stmars()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine stmars</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mphistab_8f90_source.html#l00910">910</a> of file <a class="el" href="mphistab_8f90_source.html">mphistab.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  911</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  912</span> </div>
<div class="line"><span class="lineno">  913</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  914</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  915</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ifre</div>
<div class="line"><span class="lineno">  916</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ifrea</div>
<div class="line"><span class="lineno">  917</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ifreb</div>
<div class="line"><span class="lineno">  918</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ind</div>
<div class="line"><span class="lineno">  919</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  920</span>    <span class="keywordtype">INTEGER(mpi)</span> :: n</div>
<div class="line"><span class="lineno">  921</span><span class="keywordtype">    REAL</span>(mps) :: x</div>
<div class="line"><span class="lineno">  922</span><span class="keywordtype">    REAL</span>(mps) :: y</div>
<div class="line"><span class="lineno">  923</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">PARAMETER</span> :: ndim=5000   <span class="comment">! storage dimension, should be NUMGXY*NLIMIT</span></div>
<div class="line"><span class="lineno">  924</span><span class="keywordtype">    REAL</span>(mps) :: tk(2,ndim)    <span class="comment">! pair storage for data pairs</span></div>
<div class="line"><span class="lineno">  925</span>    <span class="keywordtype">INTEGER(mpi)</span> :: next(ndim)    <span class="comment">! pointer</span></div>
<div class="line"><span class="lineno">  926</span>    <span class="keywordtype">INTEGER(mpi)</span> :: iflc1     <span class="comment">! first and last index of free pairs</span></div>
<div class="line"><span class="lineno">  927</span>    <span class="keywordtype">INTEGER(mpi)</span> ::iflc2     <span class="comment">! first and last index of free pairs</span></div>
<div class="line"><span class="lineno">  928</span>    <span class="keywordtype">SAVE</span></div>
<div class="line"><span class="lineno">  929</span> </div>
<div class="line"><span class="lineno">  930</span><span class="keywordtype">    REAL</span>(mps) :: four(4) <span class="comment">! double_pair, copy array</span></div>
<div class="line"><span class="lineno">  931</span><span class="keywordtype">    REAL</span>(mps) ::array(2,*) <span class="comment">! double_pair, copy array</span></div>
<div class="line"><span class="lineno">  932</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jflc(5)         <span class="comment">! user array</span></div>
<div class="line"><span class="lineno">  933</span>    <span class="comment">!     JFLC(1) = first used index</span></div>
<div class="line"><span class="lineno">  934</span>    <span class="comment">!     JFLC(2) = last used index</span></div>
<div class="line"><span class="lineno">  935</span>    <span class="comment">!     JFLC(3) = counter of used places</span></div>
<div class="line"><span class="lineno">  936</span>    <span class="comment">!     JFLC(4) = counter of ignored</span></div>
<div class="line"><span class="lineno">  937</span>    <span class="comment">!     JFLC(5) = limit for JFLC(3)</span></div>
<div class="line"><span class="lineno">  938</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  939</span>    <span class="keywordflow">DO</span> i=1,ndim</div>
<div class="line"><span class="lineno">  940</span>        next(i)=i+1   <span class="comment">! pointer to next free location</span></div>
<div class="line"><span class="lineno">  941</span>        tk(1,i)=0.0   <span class="comment">! reset</span></div>
<div class="line"><span class="lineno">  942</span>        tk(2,i)=0.0</div>
<div class="line"><span class="lineno">  943</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  944</span>    next(ndim)=0   <span class="comment">! ... and end pointer</span></div>
<div class="line"><span class="lineno">  945</span>    iflc1=1        <span class="comment">! index first free pair</span></div>
<div class="line"><span class="lineno">  946</span>    iflc2=ndim     <span class="comment">! index last free pair</span></div>
<div class="line"><span class="lineno">  947</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  948</span> </div>
<div class="line"><span class="lineno">  949</span>    entry stmapr(jflc,x,y)                  <span class="comment">! store pair (X,Y)</span></div>
<div class="line"><span class="lineno">  950</span>    ifre=iflc1                   <span class="comment">! index of free place</span></div>
<div class="line"><span class="lineno">  951</span>    <span class="keywordflow">IF</span>(ifre == 0.OR.jflc(3) &gt;= jflc(5)) <span class="keywordflow">THEN</span> <span class="comment">! overflow</span></div>
<div class="line"><span class="lineno">  952</span>        jflc(4)=jflc(4)+1</div>
<div class="line"><span class="lineno">  953</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  954</span>        iflc1=next(ifre)          <span class="comment">! pointer to new free location</span></div>
<div class="line"><span class="lineno">  955</span>        <span class="keywordflow">IF</span>(jflc(1) == 0) <span class="keywordflow">THEN</span>     <span class="comment">! first item</span></div>
<div class="line"><span class="lineno">  956</span>            jflc(1)=ifre</div>
<div class="line"><span class="lineno">  957</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  958</span>            next(jflc(2))=ifre</div>
<div class="line"><span class="lineno">  959</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  960</span>        next(ifre)=0</div>
<div class="line"><span class="lineno">  961</span>        jflc(2)=ifre              <span class="comment">! last index</span></div>
<div class="line"><span class="lineno">  962</span>        jflc(3)=jflc(3)+1         <span class="comment">! counter</span></div>
<div class="line"><span class="lineno">  963</span>        tk(1,ifre)=x</div>
<div class="line"><span class="lineno">  964</span>        tk(2,ifre)=y</div>
<div class="line"><span class="lineno">  965</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  966</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span>    entry stmadp(jflc,four)                 <span class="comment">! store double pair</span></div>
<div class="line"><span class="lineno">  969</span>    ifrea=iflc1                  <span class="comment">! index of 1. free place</span></div>
<div class="line"><span class="lineno">  970</span>    <span class="keywordflow">IF</span>(ifrea == 0) <span class="keywordflow">THEN</span> <span class="comment">! overflow</span></div>
<div class="line"><span class="lineno">  971</span>        jflc(4)=jflc(4)+1</div>
<div class="line"><span class="lineno">  972</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  973</span>        ifreb=next(iflc1)         <span class="comment">! index of 2. free place</span></div>
<div class="line"><span class="lineno">  974</span>        <span class="keywordflow">IF</span>(ifreb == 0.OR.jflc(3) &gt;= 2*jflc(5)) <span class="keywordflow">THEN</span> <span class="comment">! overflow</span></div>
<div class="line"><span class="lineno">  975</span>            jflc(4)=jflc(4)+1</div>
<div class="line"><span class="lineno">  976</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  977</span>            iflc1=next(ifreb)      <span class="comment">! pointer to new free location</span></div>
<div class="line"><span class="lineno">  978</span>            <span class="keywordflow">IF</span>(jflc(1) == 0) <span class="keywordflow">THEN</span>  <span class="comment">! first item</span></div>
<div class="line"><span class="lineno">  979</span>                jflc(1)=ifrea</div>
<div class="line"><span class="lineno">  980</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  981</span>                next(jflc(2))=ifrea</div>
<div class="line"><span class="lineno">  982</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  983</span>            next(ifreb)=0</div>
<div class="line"><span class="lineno">  984</span>            jflc(2)=ifreb          <span class="comment">! last index</span></div>
<div class="line"><span class="lineno">  985</span>            jflc(3)=jflc(3)+1      <span class="comment">! counter</span></div>
<div class="line"><span class="lineno">  986</span>            tk(1,ifrea)=four(1)</div>
<div class="line"><span class="lineno">  987</span>            tk(2,ifrea)=four(2)</div>
<div class="line"><span class="lineno">  988</span>            tk(1,ifreb)=four(3)</div>
<div class="line"><span class="lineno">  989</span>            tk(2,ifreb)=four(4)</div>
<div class="line"><span class="lineno">  990</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  991</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno">  992</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>    entry stmacp(jflc,array,n)              <span class="comment">! copy (cp) all pairs to array</span></div>
<div class="line"><span class="lineno">  995</span>    n=0</div>
<div class="line"><span class="lineno">  996</span>    ind=jflc(1)</div>
<div class="line"><span class="lineno">  997</span>10  <span class="keywordflow">IF</span>(ind == 0) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno">  998</span>    n=n+1</div>
<div class="line"><span class="lineno">  999</span>    array(1,n)=tk(1,ind)</div>
<div class="line"><span class="lineno"> 1000</span>    array(2,n)=tk(2,ind)</div>
<div class="line"><span class="lineno"> 1001</span>    ind=next(ind)</div>
<div class="line"><span class="lineno"> 1002</span>    <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><span class="lineno"> 1003</span> </div>
<div class="line"><span class="lineno"> 1004</span>    entry stmarm(jflc)                      <span class="comment">! remove (rm) stored paiirs</span></div>
<div class="line"><span class="lineno"> 1005</span>    next(iflc2)=jflc(1)          <span class="comment">! connect to free space</span></div>
<div class="line"><span class="lineno"> 1006</span>    iflc2=jflc(2)                <span class="comment">! new last free index</span></div>
<div class="line"><span class="lineno"> 1007</span>    <span class="keywordflow">DO</span> j=1,4</div>
<div class="line"><span class="lineno"> 1008</span>        jflc(j)=0</div>
<div class="line"><span class="lineno"> 1009</span><span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_23416660aff6402864c13eb5e981e75a.html">millepede</a></li><li class="navelem"><a class="el" href="mphistab_8f90.html">mphistab.f90</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
