<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SND@LHC Software: millepede/mpnum.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SND@LHC Software
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mpnum_8f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">mpnum.f90 File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>General linear algebra routines.  
<a href="#details">More...</a></p>

<p><a href="mpnum_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a92f02ed4dc87864fa0b65cec04e4c9e3" id="r_a92f02ed4dc87864fa0b65cec04e4c9e3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a92f02ed4dc87864fa0b65cec04e4c9e3">sqminv</a> (v, b, n, nrank, diag, next)</td></tr>
<tr class="memdesc:a92f02ed4dc87864fa0b65cec04e4c9e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix inversion and solution.  <br /></td></tr>
<tr class="separator:a92f02ed4dc87864fa0b65cec04e4c9e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24d99a263ffebf0cbb2a8839f259c816" id="r_a24d99a263ffebf0cbb2a8839f259c816"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a24d99a263ffebf0cbb2a8839f259c816">sqminl</a> (v, b, n, nrank, diag, next)</td></tr>
<tr class="memdesc:a24d99a263ffebf0cbb2a8839f259c816"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix inversion for LARGE matrices.  <br /></td></tr>
<tr class="separator:a24d99a263ffebf0cbb2a8839f259c816"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36ccd26f5ba6d72c55e9f90b2e22b1e1" id="r_a36ccd26f5ba6d72c55e9f90b2e22b1e1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a36ccd26f5ba6d72c55e9f90b2e22b1e1">devrot</a> (n, diag, u, v, work, iwork)</td></tr>
<tr class="memdesc:a36ccd26f5ba6d72c55e9f90b2e22b1e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diagonalization.  <br /></td></tr>
<tr class="separator:a36ccd26f5ba6d72c55e9f90b2e22b1e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc1b41f704b9ad302fbbbb7685c3bf03" id="r_acc1b41f704b9ad302fbbbb7685c3bf03"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#acc1b41f704b9ad302fbbbb7685c3bf03">devsig</a> (n, diag, u, b, coef)</td></tr>
<tr class="memdesc:acc1b41f704b9ad302fbbbb7685c3bf03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate significances.  <br /></td></tr>
<tr class="separator:acc1b41f704b9ad302fbbbb7685c3bf03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20cdb7dca1007e7cc6ea973e584f94ee" id="r_a20cdb7dca1007e7cc6ea973e584f94ee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a20cdb7dca1007e7cc6ea973e584f94ee">devsol</a> (n, diag, u, b, x, work)</td></tr>
<tr class="memdesc:a20cdb7dca1007e7cc6ea973e584f94ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solution by diagonalization.  <br /></td></tr>
<tr class="separator:a20cdb7dca1007e7cc6ea973e584f94ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1c8f4ab95e058209d96c6271f5ec95b" id="r_ab1c8f4ab95e058209d96c6271f5ec95b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#ab1c8f4ab95e058209d96c6271f5ec95b">devinv</a> (n, diag, u, v)</td></tr>
<tr class="memdesc:ab1c8f4ab95e058209d96c6271f5ec95b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inversion by diagonalization. Get inverse matrix V from DIAG and U.  <br /></td></tr>
<tr class="separator:ab1c8f4ab95e058209d96c6271f5ec95b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e0bf788ba860f0b05f091d5029da682" id="r_a7e0bf788ba860f0b05f091d5029da682"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a7e0bf788ba860f0b05f091d5029da682">choldc</a> (g, n)</td></tr>
<tr class="memdesc:a7e0bf788ba860f0b05f091d5029da682"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cholesky decomposition.  <br /></td></tr>
<tr class="separator:a7e0bf788ba860f0b05f091d5029da682"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3796955c8ea4b95e77872ab50725f22" id="r_ac3796955c8ea4b95e77872ab50725f22"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#ac3796955c8ea4b95e77872ab50725f22">cholsl</a> (g, x, n)</td></tr>
<tr class="memdesc:ac3796955c8ea4b95e77872ab50725f22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solution after decomposition.  <br /></td></tr>
<tr class="separator:ac3796955c8ea4b95e77872ab50725f22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0066a6d748ec7e6b5228c15ece16430d" id="r_a0066a6d748ec7e6b5228c15ece16430d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a0066a6d748ec7e6b5228c15ece16430d">cholin</a> (g, v, n)</td></tr>
<tr class="memdesc:a0066a6d748ec7e6b5228c15ece16430d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inversion after decomposition.  <br /></td></tr>
<tr class="separator:a0066a6d748ec7e6b5228c15ece16430d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a692128ba96a608353675ecc7ae89b77a" id="r_a692128ba96a608353675ecc7ae89b77a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a692128ba96a608353675ecc7ae89b77a">vabdec</a> (n, val, ilptr)</td></tr>
<tr class="memdesc:a692128ba96a608353675ecc7ae89b77a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable band matrix decomposition.  <br /></td></tr>
<tr class="separator:a692128ba96a608353675ecc7ae89b77a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c3b930ef489fec3d8b422e23a2ea0d5" id="r_a0c3b930ef489fec3d8b422e23a2ea0d5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a0c3b930ef489fec3d8b422e23a2ea0d5">vabmmm</a> (n, val, ilptr)</td></tr>
<tr class="memdesc:a0c3b930ef489fec3d8b422e23a2ea0d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable band matrix print minimum and maximum.  <br /></td></tr>
<tr class="separator:a0c3b930ef489fec3d8b422e23a2ea0d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b71525e0a1923dfe5b87571f8ea10d1" id="r_a7b71525e0a1923dfe5b87571f8ea10d1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a7b71525e0a1923dfe5b87571f8ea10d1">vabslv</a> (n, val, ilptr, x)</td></tr>
<tr class="memdesc:a7b71525e0a1923dfe5b87571f8ea10d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable band matrix solution.  <br /></td></tr>
<tr class="separator:a7b71525e0a1923dfe5b87571f8ea10d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a639d876a6e8ba1c3dc98794a1ef5827f" id="r_a639d876a6e8ba1c3dc98794a1ef5827f"><td class="memItemLeft" align="right" valign="top">real(mpd) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a639d876a6e8ba1c3dc98794a1ef5827f">dbdot</a> (n, dx, dy)</td></tr>
<tr class="memdesc:a639d876a6e8ba1c3dc98794a1ef5827f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dot product.  <br /></td></tr>
<tr class="separator:a639d876a6e8ba1c3dc98794a1ef5827f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a442c6c8a5f2dc87ae42e262a046879f0" id="r_a442c6c8a5f2dc87ae42e262a046879f0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a442c6c8a5f2dc87ae42e262a046879f0">dbaxpy</a> (n, da, dx, dy)</td></tr>
<tr class="memdesc:a442c6c8a5f2dc87ae42e262a046879f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiply, addition.  <br /></td></tr>
<tr class="separator:a442c6c8a5f2dc87ae42e262a046879f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae51d83946746b8fd144656d5c4ef8771" id="r_ae51d83946746b8fd144656d5c4ef8771"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#ae51d83946746b8fd144656d5c4ef8771">dbsvx</a> (v, a, b, n)</td></tr>
<tr class="memdesc:ae51d83946746b8fd144656d5c4ef8771"><td class="mdescLeft">&#160;</td><td class="mdescRight">Product symmetric matrix, vector.  <br /></td></tr>
<tr class="separator:ae51d83946746b8fd144656d5c4ef8771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f58743f91524d7e25eeec8d39699a3b" id="r_a2f58743f91524d7e25eeec8d39699a3b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a2f58743f91524d7e25eeec8d39699a3b">dbsvxl</a> (v, a, b, n)</td></tr>
<tr class="memdesc:a2f58743f91524d7e25eeec8d39699a3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Product LARGE symmetric matrix, vector.  <br /></td></tr>
<tr class="separator:a2f58743f91524d7e25eeec8d39699a3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9667c9fc8d4b6fbcdb46078f26f906b1" id="r_a9667c9fc8d4b6fbcdb46078f26f906b1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a9667c9fc8d4b6fbcdb46078f26f906b1">dbgax</a> (a, x, y, m, n)</td></tr>
<tr class="memdesc:a9667c9fc8d4b6fbcdb46078f26f906b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiply general M-by-N matrix A and N-vector X.  <br /></td></tr>
<tr class="separator:a9667c9fc8d4b6fbcdb46078f26f906b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd27e1fb8331bdff9e37afe376e54643" id="r_afd27e1fb8331bdff9e37afe376e54643"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#afd27e1fb8331bdff9e37afe376e54643">dbavat</a> (v, a, w, n, ms)</td></tr>
<tr class="memdesc:afd27e1fb8331bdff9e37afe376e54643"><td class="mdescLeft">&#160;</td><td class="mdescRight">A V AT product (similarity).  <br /></td></tr>
<tr class="separator:afd27e1fb8331bdff9e37afe376e54643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4215de1ac22cc248323f1e966df30ed3" id="r_a4215de1ac22cc248323f1e966df30ed3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a4215de1ac22cc248323f1e966df30ed3">dbmprv</a> (lun, x, v, n)</td></tr>
<tr class="memdesc:a4215de1ac22cc248323f1e966df30ed3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print symmetric matrix, vector.  <br /></td></tr>
<tr class="separator:a4215de1ac22cc248323f1e966df30ed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae8511bf4f0a922fdd51b1852e41ba7b" id="r_aae8511bf4f0a922fdd51b1852e41ba7b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#aae8511bf4f0a922fdd51b1852e41ba7b">dbprv</a> (lun, v, n)</td></tr>
<tr class="memdesc:aae8511bf4f0a922fdd51b1852e41ba7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print symmetric matrix.  <br /></td></tr>
<tr class="separator:aae8511bf4f0a922fdd51b1852e41ba7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59c0fd2fe612e6fb7c2b5b40b8e7762f" id="r_a59c0fd2fe612e6fb7c2b5b40b8e7762f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a59c0fd2fe612e6fb7c2b5b40b8e7762f">heapf</a> (a, n)</td></tr>
<tr class="memdesc:a59c0fd2fe612e6fb7c2b5b40b8e7762f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Heap sort direct (real).  <br /></td></tr>
<tr class="separator:a59c0fd2fe612e6fb7c2b5b40b8e7762f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8750c46a189254239c8be1f5f9f25554" id="r_a8750c46a189254239c8be1f5f9f25554"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a8750c46a189254239c8be1f5f9f25554">sort1k</a> (a, n)</td></tr>
<tr class="memdesc:a8750c46a189254239c8be1f5f9f25554"><td class="mdescLeft">&#160;</td><td class="mdescRight">Quick sort 1.  <br /></td></tr>
<tr class="separator:a8750c46a189254239c8be1f5f9f25554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac95580af88f23895acfc53d125c8928a" id="r_ac95580af88f23895acfc53d125c8928a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#ac95580af88f23895acfc53d125c8928a">sort2k</a> (a, n)</td></tr>
<tr class="memdesc:ac95580af88f23895acfc53d125c8928a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Quick sort 2.  <br /></td></tr>
<tr class="separator:ac95580af88f23895acfc53d125c8928a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe21c37313ca7c9b8c16eec2d23c2f1a" id="r_afe21c37313ca7c9b8c16eec2d23c2f1a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#afe21c37313ca7c9b8c16eec2d23c2f1a">sort2i</a> (a, n)</td></tr>
<tr class="memdesc:afe21c37313ca7c9b8c16eec2d23c2f1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Quick sort 2 with index.  <br /></td></tr>
<tr class="separator:afe21c37313ca7c9b8c16eec2d23c2f1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada9fefb711817245f72e5296fbbb28ff" id="r_ada9fefb711817245f72e5296fbbb28ff"><td class="memItemLeft" align="right" valign="top">real(mps) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#ada9fefb711817245f72e5296fbbb28ff">chindl</a> (n, nd)</td></tr>
<tr class="memdesc:ada9fefb711817245f72e5296fbbb28ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Chi2/ndf cuts.  <br /></td></tr>
<tr class="separator:ada9fefb711817245f72e5296fbbb28ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab49da2d76d818a3eb74c29ca64f3309d" id="r_ab49da2d76d818a3eb74c29ca64f3309d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#ab49da2d76d818a3eb74c29ca64f3309d">lltdec</a> (n, c, india, nrkd, iopt)</td></tr>
<tr class="memdesc:ab49da2d76d818a3eb74c29ca64f3309d"><td class="mdescLeft">&#160;</td><td class="mdescRight">LLT decomposition.  <br /></td></tr>
<tr class="separator:ab49da2d76d818a3eb74c29ca64f3309d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae18e26bc0cb31b5a04fd171ca44b3b85" id="r_ae18e26bc0cb31b5a04fd171ca44b3b85"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#ae18e26bc0cb31b5a04fd171ca44b3b85">lltfwd</a> (n, c, india, x)</td></tr>
<tr class="memdesc:ae18e26bc0cb31b5a04fd171ca44b3b85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forward solution.  <br /></td></tr>
<tr class="separator:ae18e26bc0cb31b5a04fd171ca44b3b85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a938b3c14edfd0ebb1649e8758b253ede" id="r_a938b3c14edfd0ebb1649e8758b253ede"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a938b3c14edfd0ebb1649e8758b253ede">lltbwd</a> (n, c, india, x)</td></tr>
<tr class="memdesc:a938b3c14edfd0ebb1649e8758b253ede"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backward solution.  <br /></td></tr>
<tr class="separator:a938b3c14edfd0ebb1649e8758b253ede"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67c9c5eec2673298f1eb58a1310ab0a3" id="r_a67c9c5eec2673298f1eb58a1310ab0a3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a67c9c5eec2673298f1eb58a1310ab0a3">equdec</a> (n, m, ls, c, india, nrkd, nrkd2)</td></tr>
<tr class="memdesc:a67c9c5eec2673298f1eb58a1310ab0a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decomposition of equilibrium systems.  <br /></td></tr>
<tr class="separator:a67c9c5eec2673298f1eb58a1310ab0a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52d41b509025b261281343ff5b243d3e" id="r_a52d41b509025b261281343ff5b243d3e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a52d41b509025b261281343ff5b243d3e">equslv</a> (n, m, c, india, x)</td></tr>
<tr class="memdesc:a52d41b509025b261281343ff5b243d3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solution of equilibrium systems (after decomposition).  <br /></td></tr>
<tr class="separator:a52d41b509025b261281343ff5b243d3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1be727b806123cdbd7ae0695df918243" id="r_a1be727b806123cdbd7ae0695df918243"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a1be727b806123cdbd7ae0695df918243">precon</a> (p, n, c, cu, a, s, nrkd)</td></tr>
<tr class="memdesc:a1be727b806123cdbd7ae0695df918243"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrained preconditioner, decomposition.  <br /></td></tr>
<tr class="separator:a1be727b806123cdbd7ae0695df918243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6d1e48380366698fa934cf368cb0b4b" id="r_aa6d1e48380366698fa934cf368cb0b4b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#aa6d1e48380366698fa934cf368cb0b4b">presol</a> (p, n, cu, a, s, x, y)</td></tr>
<tr class="memdesc:aa6d1e48380366698fa934cf368cb0b4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrained preconditioner, solution.  <br /></td></tr>
<tr class="separator:aa6d1e48380366698fa934cf368cb0b4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9723a1127567d1d778894b985a921286" id="r_a9723a1127567d1d778894b985a921286"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a9723a1127567d1d778894b985a921286">sqmibb</a> (v, b, n, nbdr, nbnd, inv, nrank, vbnd, vbdr, aux, vbk, vzru, scdiag, scflag)</td></tr>
<tr class="memdesc:a9723a1127567d1d778894b985a921286"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bordered band matrix.  <br /></td></tr>
<tr class="separator:a9723a1127567d1d778894b985a921286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a019b639fffc7f6888d08ba3508f3451c" id="r_a019b639fffc7f6888d08ba3508f3451c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpnum_8f90.html#a019b639fffc7f6888d08ba3508f3451c">sqmibb2</a> (v, b, n, nbdr, nbnd, inv, nrank, vbnd, vbdr, aux, vbk, vzru, scdiag, scflag)</td></tr>
<tr class="memdesc:a019b639fffc7f6888d08ba3508f3451c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Band bordered matrix.  <br /></td></tr>
<tr class="separator:a019b639fffc7f6888d08ba3508f3451c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>General linear algebra routines. </p>
<dl class="section author"><dt>Author</dt><dd>Volker Blobel, University Hamburg, 2005-2009 (initial Fortran77 version) </dd>
<dd>
Claus Kleinwort, DESY (maintenance and developement)</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2009 - 2015 Deutsches Elektronen-Synchroton, Member of the Helmholtz Association, (DESY), HAMBURG, GERMANY <br  />
<br  />
 This library is free software; you can redistribute it and/or modify it under the terms of the GNU Library General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version. <br  />
<br  />
 This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Library General Public License for more details. <br  />
<br  />
 You should have received a copy of the GNU Library General Public License along with this program (see the file COPYING.LIB for more details); if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</dd></dl>
<p>***** Collection of utility routines from V. Blobel ***** </p><pre class="fragment">V. Blobel, Univ. Hamburg
Numerical subprograms used in MP-II: matrix equations,
   and matrix products, double precision

Solution by inversion
   SQMINV
   SQMINL  for LARGE matrix, use OpenMP (CHK)

Solution by diagonalization
   DEVROT, DEVPRT, DEFSOL,DEVINV

Solution by Cholesky decomposition of symmetric matrix
   CHOLDC

Solution by Cholesky decomposition of variable-band matrix
   VABDEC

Solution by Cholesky decomposition of bordered band matrix
   SQMIBB    upper/left  border (CHK)
   SQMIBB2   lower/right border (CHK)

Matrix/vector products
   DBDOT     dot vector product
   DBAXPY    multiplication and addition
   DBSVX     symmetric matrix vector
   DBSVX     LARGE symmetric matrix vector (CHK)
   DBGAX     general matrix vector
   DBAVAT    AVAT product
   DBMPRV    print parameter and matrix
   DBPRV     print matrix  (CHK)

Chi^2 cut values
   CHINDL

Accurate summation (moved to pede.f90)
   ADDSUM

Sorting
   HEAPF    heap sort reals direct
   SORT1K   sort 1-dim key-array (CHK)
   SORT2K   sort 2-dim key-array
   SORT2I   sort 2-dim key-array with index (CHK)
</pre> 
<p class="definition">Definition in file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ada9fefb711817245f72e5296fbbb28ff" name="ada9fefb711817245f72e5296fbbb28ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada9fefb711817245f72e5296fbbb28ff">&#9670;&#160;</a></span>chindl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(mps) function chindl </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>nd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Chi2/ndf cuts. </p>
<p>Return limit in Chi^2/ndf for N sigmas (N=1, 2 or 3).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>number of sigmas </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nd</td><td>ndf </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Chi2/ndf cut value </dd></dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01800">1800</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1801</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1802</span> </div>
<div class="line"><span class="lineno"> 1803</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1804</span>    <span class="keywordtype">INTEGER(mpi)</span> :: m</div>
<div class="line"><span class="lineno"> 1805</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: n</div>
<div class="line"><span class="lineno"> 1806</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span> :: nd</div>
<div class="line"><span class="lineno"> 1807</span>    <span class="comment">!</span></div>
<div class="line"><span class="lineno"> 1808</span><span class="keywordtype">    REAL</span>(mps) :: sn(3)</div>
<div class="line"><span class="lineno"> 1809</span><span class="keywordtype">    REAL</span>(mps) ::table(30,3)</div>
<div class="line"><span class="lineno"> 1810</span>    <span class="comment">!     REAL PN(3)</span></div>
<div class="line"><span class="lineno"> 1811</span>    <span class="comment">!     DATA PN/0.31731,0.0455002785,2.69985E-3/         ! probabilities</span></div>
<div class="line"><span class="lineno"> 1812</span>    <span class="keyword">DATA</span> sn/0.47523,1.690140,2.782170/</div>
<div class="line"><span class="lineno"> 1813</span>    <span class="keyword">DATA</span> table/ 1.0000, 1.1479, 1.1753, 1.1798, 1.1775, 1.1730, 1.1680, 1.1630,  &amp;</div>
<div class="line"><span class="lineno"> 1814</span>        1.1581, 1.1536, 1.1493, 1.1454, 1.1417, 1.1383, 1.1351, 1.1321,  &amp;</div>
<div class="line"><span class="lineno"> 1815</span>        1.1293, 1.1266, 1.1242, 1.1218, 1.1196, 1.1175, 1.1155, 1.1136,  &amp;</div>
<div class="line"><span class="lineno"> 1816</span>        1.1119, 1.1101, 1.1085, 1.1070, 1.1055, 1.1040,  &amp;</div>
<div class="line"><span class="lineno"> 1817</span>        4.0000, 3.0900, 2.6750, 2.4290, 2.2628, 2.1415, 2.0481, 1.9736,  &amp;</div>
<div class="line"><span class="lineno"> 1818</span>        1.9124, 1.8610, 1.8171, 1.7791, 1.7457, 1.7161, 1.6897, 1.6658,  &amp;</div>
<div class="line"><span class="lineno"> 1819</span>        1.6442, 1.6246, 1.6065, 1.5899, 1.5745, 1.5603, 1.5470, 1.5346,  &amp;</div>
<div class="line"><span class="lineno"> 1820</span>        1.5230, 1.5120, 1.5017, 1.4920, 1.4829, 1.4742,  &amp;</div>
<div class="line"><span class="lineno"> 1821</span>        9.0000, 5.9146, 4.7184, 4.0628, 3.6410, 3.3436, 3.1209, 2.9468,  &amp;</div>
<div class="line"><span class="lineno"> 1822</span>        2.8063, 2.6902, 2.5922, 2.5082, 2.4352, 2.3711, 2.3143, 2.2635,  &amp;</div>
<div class="line"><span class="lineno"> 1823</span>        2.2178, 2.1764, 2.1386, 2.1040, 2.0722, 2.0428, 2.0155, 1.9901,  &amp;</div>
<div class="line"><span class="lineno"> 1824</span>        1.9665, 1.9443, 1.9235, 1.9040, 1.8855, 1.8681/</div>
<div class="line"><span class="lineno"> 1825</span>    <span class="keywordtype">SAVE</span> sn,table</div>
<div class="line"><span class="lineno"> 1826</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 1827</span>    <span class="keywordflow">IF</span>(nd &lt; 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1828</span>        <a class="code hl_function" href="mpnum_8f90.html#ada9fefb711817245f72e5296fbbb28ff">chindl</a>=0.0</div>
<div class="line"><span class="lineno"> 1829</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1830</span>        m=max(1,min(n,3))         <span class="comment">! 1, 2 or 3 sigmas</span></div>
<div class="line"><span class="lineno"> 1831</span>        <span class="keywordflow">IF</span>(nd &lt;= 30) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1832</span>            <a class="code hl_function" href="mpnum_8f90.html#ada9fefb711817245f72e5296fbbb28ff">chindl</a>=table(nd,m)     <span class="comment">! from table</span></div>
<div class="line"><span class="lineno"> 1833</span>        <span class="keywordflow">ELSE</span>                      <span class="comment">! approximation for ND &gt; 30</span></div>
<div class="line"><span class="lineno"> 1834</span>            <a class="code hl_function" href="mpnum_8f90.html#ada9fefb711817245f72e5296fbbb28ff">chindl</a>=(sn(m)+sqrt(real(nd+nd-1,<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)))**2/real(nd+nd,<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><span class="lineno"> 1835</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1836</span><span class="keywordflow">    END IF</span></div>
<div class="ttc" id="ampnum_8f90_html_ada9fefb711817245f72e5296fbbb28ff"><div class="ttname"><a href="mpnum_8f90.html#ada9fefb711817245f72e5296fbbb28ff">chindl</a></div><div class="ttdeci">real(mps) function chindl(n, nd)</div><div class="ttdoc">Chi2/ndf cuts.</div><div class="ttdef"><b>Definition</b> <a href="mpnum_8f90_source.html#l01800">mpnum.f90:1801</a></div></div>
<div class="ttc" id="anamespacempdef_html"><div class="ttname"><a href="namespacempdef.html">mpdef</a></div><div class="ttdoc">Definition of constants.</div><div class="ttdef"><b>Definition</b> <a href="mpdef_8f90_source.html#l00024">mpdef.f90:24</a></div></div>
<div class="ttc" id="anamespacempdef_html_aeda146bde2da88d0f6940fc9be01e963"><div class="ttname"><a href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mpdef::mps</a></div><div class="ttdeci">integer, parameter mps</div><div class="ttdef"><b>Definition</b> <a href="mpdef_8f90_source.html#l00037">mpdef.f90:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e0bf788ba860f0b05f091d5029da682" name="a7e0bf788ba860f0b05f091d5029da682"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e0bf788ba860f0b05f091d5029da682">&#9670;&#160;</a></span>choldc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine choldc </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cholesky decomposition. </p>
<p>Cholesky decomposition of the matrix G: G = L D L^T</p>
<ul>
<li>G = symmetric matrix, in symmetric storage mode</li>
<li>L = unit triangular matrix (1's on diagonal)</li>
<li>D = diagonal matrix (elements store on diagonal of L)</li>
</ul>
<p>The sqrts of the usual Cholesky decomposition are avoided by D. Matrices L and D are stored in the place of matrix G; after the decomposition, the solution of matrix equations and the computation of the inverse of the (original) matrix G are done by CHOLSL and CHOLIN.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>symmetric matrix, replaced by D,L </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l00753">753</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  754</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  757</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  758</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ii</div>
<div class="line"><span class="lineno">  759</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  760</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jj</div>
<div class="line"><span class="lineno">  761</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno">  762</span>    <span class="keywordtype">INTEGER(mpi)</span> :: kk</div>
<div class="line"><span class="lineno">  763</span>    </div>
<div class="line"><span class="lineno">  764</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: g(*)</div>
<div class="line"><span class="lineno">  765</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span><span class="keywordtype">    REAL</span>(mpd) :: ratio</div>
<div class="line"><span class="lineno">  768</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  769</span>    ii=0</div>
<div class="line"><span class="lineno">  770</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno">  771</span>        ii=ii+i</div>
<div class="line"><span class="lineno">  772</span>        <span class="keywordflow">IF</span>(g(ii) /= 0.0) g(ii)=1.0/g(ii)  <span class="comment">! (I,I) div !</span></div>
<div class="line"><span class="lineno">  773</span>        jj=ii</div>
<div class="line"><span class="lineno">  774</span>        <span class="keywordflow">DO</span> j=i+1,n</div>
<div class="line"><span class="lineno">  775</span>            ratio=g(i+jj)*g(ii)              <span class="comment">! (I,J) (I,I)</span></div>
<div class="line"><span class="lineno">  776</span>            kk=jj</div>
<div class="line"><span class="lineno">  777</span>            <span class="keywordflow">DO</span> k=j,n</div>
<div class="line"><span class="lineno">  778</span>                g(kk+j)=g(kk+j)-g(kk+i)*ratio   <span class="comment">! (K,J) (K,I)</span></div>
<div class="line"><span class="lineno">  779</span>                kk=kk+k</div>
<div class="line"><span class="lineno">  780</span><span class="keywordflow">            END DO</span> <span class="comment">! K</span></div>
<div class="line"><span class="lineno">  781</span>            g(i+jj)=ratio                    <span class="comment">! (I,J)</span></div>
<div class="line"><span class="lineno">  782</span>            jj=jj+j</div>
<div class="line"><span class="lineno">  783</span><span class="keywordflow">        END DO</span> <span class="comment">! J</span></div>
<div class="line"><span class="lineno">  784</span><span class="keywordflow">    END DO</span> <span class="comment">! I</span></div>
<div class="line"><span class="lineno">  785</span>    <span class="keywordflow">RETURN</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0066a6d748ec7e6b5228c15ece16430d" name="a0066a6d748ec7e6b5228c15ece16430d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0066a6d748ec7e6b5228c15ece16430d">&#9670;&#160;</a></span>cholin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cholin </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(out)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inversion after decomposition. </p>
<p>The inverse of the (original) matrix G is computed and stored in symmetric storage mode in matrix V. Arrays G and V must be different arrays.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>decomposed symmetric matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">v</td><td>inverse matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l00845">845</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  846</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  849</span><span class="keywordtype">    REAL</span>(mpd) :: dsum</div>
<div class="line"><span class="lineno">  850</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  851</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ii</div>
<div class="line"><span class="lineno">  852</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  853</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno">  854</span>    <span class="keywordtype">INTEGER(mpi)</span> :: l</div>
<div class="line"><span class="lineno">  855</span>    <span class="keywordtype">INTEGER(mpi)</span> :: m</div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>            :: g(*)</div>
<div class="line"><span class="lineno">  858</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT( OUT)</span>          :: v(*)</div>
<div class="line"><span class="lineno">  859</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                     :: n</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>    ii=(n*n-n)/2</div>
<div class="line"><span class="lineno">  862</span>    <span class="keywordflow">DO</span> i=n,1,-1</div>
<div class="line"><span class="lineno">  863</span>        dsum=g(ii+i)                       <span class="comment">! (I,I)</span></div>
<div class="line"><span class="lineno">  864</span>        <span class="keywordflow">DO</span> j=i,1,-1</div>
<div class="line"><span class="lineno">  865</span>            <span class="keywordflow">DO</span> k=j+1,n</div>
<div class="line"><span class="lineno">  866</span>                l=min(i,k)</div>
<div class="line"><span class="lineno">  867</span>                m=max(i,k)</div>
<div class="line"><span class="lineno">  868</span>                dsum=dsum-g(j+(k*k-k)/2)*v(l+(m*m-m)/2) <span class="comment">! (J,K) (I,K)</span></div>
<div class="line"><span class="lineno">  869</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  870</span>            v(ii+j)=dsum                      <span class="comment">! (I,J)</span></div>
<div class="line"><span class="lineno">  871</span>            dsum=0.0_mpd</div>
<div class="line"><span class="lineno">  872</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  873</span>        ii=ii-i+1</div>
<div class="line"><span class="lineno">  874</span><span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3796955c8ea4b95e77872ab50725f22" name="ac3796955c8ea4b95e77872ab50725f22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3796955c8ea4b95e77872ab50725f22">&#9670;&#160;</a></span>cholsl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cholsl </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solution after decomposition. </p>
<p>The matrix equation G X = B is solved for X, where the matrix G in the argument is already decomposed by CHOLDC. The vector B is called X in the argument and the content is replaced by the resulting vector X.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>decomposed symmetric matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>r.h.s vector B, replaced by solution vector X </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l00799">799</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  800</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  803</span><span class="keywordtype">    REAL</span>(mpd) :: dsum</div>
<div class="line"><span class="lineno">  804</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  805</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ii</div>
<div class="line"><span class="lineno">  806</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordtype">INTEGER(mpi)</span> :: kk</div>
<div class="line"><span class="lineno">  808</span>    </div>
<div class="line"><span class="lineno">  809</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>            :: g(*)</div>
<div class="line"><span class="lineno">  810</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>        :: x(n)</div>
<div class="line"><span class="lineno">  811</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                     :: n</div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span>    ii=0</div>
<div class="line"><span class="lineno">  814</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno">  815</span>        dsum=x(i)</div>
<div class="line"><span class="lineno">  816</span>        <span class="keywordflow">DO</span> k=1,i-1</div>
<div class="line"><span class="lineno">  817</span>            dsum=dsum-g(k+ii)*x(k)             <span class="comment">! (K,I)</span></div>
<div class="line"><span class="lineno">  818</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  819</span>        x(i)=dsum</div>
<div class="line"><span class="lineno">  820</span>        ii=ii+i</div>
<div class="line"><span class="lineno">  821</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  822</span>    <span class="keywordflow">DO</span> i=n,1,-1</div>
<div class="line"><span class="lineno">  823</span>        dsum=x(i)*g(ii)                    <span class="comment">! (I,I)</span></div>
<div class="line"><span class="lineno">  824</span>        kk=ii</div>
<div class="line"><span class="lineno">  825</span>        <span class="keywordflow">DO</span> k=i+1,n</div>
<div class="line"><span class="lineno">  826</span>            dsum=dsum-g(kk+i)*x(k)             <span class="comment">! (K,I)</span></div>
<div class="line"><span class="lineno">  827</span>            kk=kk+k</div>
<div class="line"><span class="lineno">  828</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  829</span>        x(i)=dsum</div>
<div class="line"><span class="lineno">  830</span>        ii=ii-i</div>
<div class="line"><span class="lineno">  831</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  832</span>    <span class="keywordflow">RETURN</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd27e1fb8331bdff9e37afe376e54643" name="afd27e1fb8331bdff9e37afe376e54643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd27e1fb8331bdff9e37afe376e54643">&#9670;&#160;</a></span>dbavat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dbavat </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A V AT product (similarity). </p>
<p>Multiply symmetric N-by-N matrix from the left with general M-by-N matrix and from the right with the transposed of the same general matrix to form symmetric M-by-M matrix (used for error propagation).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">V</td><td>symmetric N-by-N matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">A</td><td>general M-by-N matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">W</td><td>symmetric M-by-M matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MS</td><td>rows of A (-rows: don't reset W) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>columns of A </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01276">1276</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1277</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1280</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1281</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ij</div>
<div class="line"><span class="lineno"> 1282</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ijs</div>
<div class="line"><span class="lineno"> 1283</span>    <span class="keywordtype">INTEGER(mpi)</span> :: il</div>
<div class="line"><span class="lineno"> 1284</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 1285</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jk</div>
<div class="line"><span class="lineno"> 1286</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno"> 1287</span>    <span class="keywordtype">INTEGER(mpi)</span> :: l</div>
<div class="line"><span class="lineno"> 1288</span>    <span class="keywordtype">INTEGER(mpi)</span> :: lk</div>
<div class="line"><span class="lineno"> 1289</span>    <span class="keywordtype">INTEGER(mpi)</span> :: lkl</div>
<div class="line"><span class="lineno"> 1290</span>    <span class="keywordtype">INTEGER(mpi)</span> :: m</div>
<div class="line"><span class="lineno"> 1291</span> </div>
<div class="line"><span class="lineno"> 1292</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: v(*)</div>
<div class="line"><span class="lineno"> 1293</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: a(*)</div>
<div class="line"><span class="lineno"> 1294</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(INOUT)</span>          :: w(*)</div>
<div class="line"><span class="lineno"> 1295</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno"> 1296</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: ms</div>
<div class="line"><span class="lineno"> 1297</span> </div>
<div class="line"><span class="lineno"> 1298</span><span class="keywordtype">    REAL</span>(mpd) :: cik</div>
<div class="line"><span class="lineno"> 1299</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 1300</span>    m=ms</div>
<div class="line"><span class="lineno"> 1301</span>    <span class="keywordflow">IF</span> (m &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1302</span>        <span class="keywordflow">DO</span> i=1,(m*m+m)/2</div>
<div class="line"><span class="lineno"> 1303</span>            w(i)=0.0_mpd             <span class="comment">! reset output matrix</span></div>
<div class="line"><span class="lineno"> 1304</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 1305</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1306</span>        m=-m</div>
<div class="line"><span class="lineno"> 1307</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span>    il=-n</div>
<div class="line"><span class="lineno"> 1310</span>    ijs=0</div>
<div class="line"><span class="lineno"> 1311</span>    <span class="keywordflow">DO</span> i=1,m                 <span class="comment">! do I</span></div>
<div class="line"><span class="lineno"> 1312</span>        ijs=ijs+i-1             <span class="comment">!</span></div>
<div class="line"><span class="lineno"> 1313</span>        il=il+n                 <span class="comment">!</span></div>
<div class="line"><span class="lineno"> 1314</span>        lkl=0                   <span class="comment">!</span></div>
<div class="line"><span class="lineno"> 1315</span>        <span class="keywordflow">DO</span> k=1,n                <span class="comment">!   do K</span></div>
<div class="line"><span class="lineno"> 1316</span>            cik=0.0_mpd              <span class="comment">!</span></div>
<div class="line"><span class="lineno"> 1317</span>            lkl=lkl+k-1            <span class="comment">!</span></div>
<div class="line"><span class="lineno"> 1318</span>            lk=lkl                 <span class="comment">!</span></div>
<div class="line"><span class="lineno"> 1319</span>            <span class="keywordflow">DO</span> l=1,k               <span class="comment">!     do L</span></div>
<div class="line"><span class="lineno"> 1320</span>                lk=lk+1               <span class="comment">!     .</span></div>
<div class="line"><span class="lineno"> 1321</span>                cik=cik+a(il+l)*v(lk) <span class="comment">!     .</span></div>
<div class="line"><span class="lineno"> 1322</span><span class="keywordflow">            END DO</span>                 <span class="comment">!     end do L</span></div>
<div class="line"><span class="lineno"> 1323</span>            <span class="keywordflow">DO</span> l=k+1,n             <span class="comment">!     do L</span></div>
<div class="line"><span class="lineno"> 1324</span>                lk=lk+l-1             <span class="comment">!     .</span></div>
<div class="line"><span class="lineno"> 1325</span>                cik=cik+a(il+l)*v(lk) <span class="comment">!     .</span></div>
<div class="line"><span class="lineno"> 1326</span><span class="keywordflow">            END DO</span>                 <span class="comment">!     end do L</span></div>
<div class="line"><span class="lineno"> 1327</span>            jk=k                   <span class="comment">!</span></div>
<div class="line"><span class="lineno"> 1328</span>            ij=ijs                 <span class="comment">!</span></div>
<div class="line"><span class="lineno"> 1329</span>            <span class="keywordflow">DO</span> j=1,i               <span class="comment">!     do J</span></div>
<div class="line"><span class="lineno"> 1330</span>                ij=ij+1               <span class="comment">!     .</span></div>
<div class="line"><span class="lineno"> 1331</span>                w(ij)=w(ij)+cik*a(jk) <span class="comment">!     .</span></div>
<div class="line"><span class="lineno"> 1332</span>                jk=jk+n               <span class="comment">!     .</span></div>
<div class="line"><span class="lineno"> 1333</span><span class="keywordflow">            END DO</span>                 <span class="comment">!     end do J</span></div>
<div class="line"><span class="lineno"> 1334</span><span class="keywordflow">        END DO</span>                  <span class="comment">!   end do K</span></div>
<div class="line"><span class="lineno"> 1335</span><span class="keywordflow">    END DO</span>                   <span class="comment">! end do I</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a442c6c8a5f2dc87ae42e262a046879f0" name="a442c6c8a5f2dc87ae42e262a046879f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a442c6c8a5f2dc87ae42e262a046879f0">&#9670;&#160;</a></span>dbaxpy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dbaxpy </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), intent(in)&#160;</td>
          <td class="paramname"><em>da</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>dy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Multiply, addition. </p>
<p>Constant times vector added to a vector: DY:=DY+DA*DX</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>vector size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dx</td><td>vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dy</td><td>vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">da</td><td>scalar </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01121">1121</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1122</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1123</span> </div>
<div class="line"><span class="lineno"> 1124</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1125</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: n</div>
<div class="line"><span class="lineno"> 1128</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>     :: dx(*)</div>
<div class="line"><span class="lineno"> 1129</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span> :: dy(*)</div>
<div class="line"><span class="lineno"> 1130</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>     :: da</div>
<div class="line"><span class="lineno"> 1131</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 1132</span>    <span class="keywordflow">DO</span> i=1,mod(n,4)</div>
<div class="line"><span class="lineno"> 1133</span>        dy(i)=dy(i)+da*dx(i)</div>
<div class="line"><span class="lineno"> 1134</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 1135</span>    <span class="keywordflow">DO</span> i=mod(n,4)+1,n,4</div>
<div class="line"><span class="lineno"> 1136</span>        dy(i  )=dy(i  )+da*dx(i  )</div>
<div class="line"><span class="lineno"> 1137</span>        dy(i+1)=dy(i+1)+da*dx(i+1)</div>
<div class="line"><span class="lineno"> 1138</span>        dy(i+2)=dy(i+2)+da*dx(i+2)</div>
<div class="line"><span class="lineno"> 1139</span>        dy(i+3)=dy(i+3)+da*dx(i+3)</div>
<div class="line"><span class="lineno"> 1140</span><span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a639d876a6e8ba1c3dc98794a1ef5827f" name="a639d876a6e8ba1c3dc98794a1ef5827f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a639d876a6e8ba1c3dc98794a1ef5827f">&#9670;&#160;</a></span>dbdot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(mpd) function dbdot </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>dy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dot product. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>vector size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dx</td><td>vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dy</td><td>vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>dot product dx*dy </dd></dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01090">1090</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1091</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1094</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1095</span><span class="keywordtype">    REAL</span>(mpd) :: dtemp</div>
<div class="line"><span class="lineno"> 1096</span> </div>
<div class="line"><span class="lineno"> 1097</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>          :: n</div>
<div class="line"><span class="lineno"> 1098</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span> :: dx(*)</div>
<div class="line"><span class="lineno"> 1099</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span> :: dy(*)</div>
<div class="line"><span class="lineno"> 1100</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 1101</span>    dtemp=0.0_mpd</div>
<div class="line"><span class="lineno"> 1102</span>    <span class="keywordflow">DO</span> i = 1,mod(n,5)</div>
<div class="line"><span class="lineno"> 1103</span>        dtemp=dtemp+dx(i)*dy(i)</div>
<div class="line"><span class="lineno"> 1104</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 1105</span>    <span class="keywordflow">DO</span> i =mod(n,5)+1,n,5</div>
<div class="line"><span class="lineno"> 1106</span>        dtemp=dtemp+dx(i)*dy(i)+dx(i+1)*dy(i+1)+dx(i+2)*dy(i+2)  &amp;</div>
<div class="line"><span class="lineno"> 1107</span>            +dx(i+3)*dy(i+3)+dx(i+4)*dy(i+4)</div>
<div class="line"><span class="lineno"> 1108</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 1109</span>    <a class="code hl_function" href="mpnum_8f90.html#a639d876a6e8ba1c3dc98794a1ef5827f">dbdot</a>=dtemp</div>
<div class="ttc" id="ampnum_8f90_html_a639d876a6e8ba1c3dc98794a1ef5827f"><div class="ttname"><a href="mpnum_8f90.html#a639d876a6e8ba1c3dc98794a1ef5827f">dbdot</a></div><div class="ttdeci">real(mpd) function dbdot(n, dx, dy)</div><div class="ttdoc">Dot product.</div><div class="ttdef"><b>Definition</b> <a href="mpnum_8f90_source.html#l01090">mpnum.f90:1091</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9667c9fc8d4b6fbcdb46078f26f906b1" name="a9667c9fc8d4b6fbcdb46078f26f906b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9667c9fc8d4b6fbcdb46078f26f906b1">&#9670;&#160;</a></span>dbgax()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dbgax </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(out)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Multiply general M-by-N matrix A and N-vector X. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">A</td><td>general M-by-N matrix (A11 A12 ... A1N A21 A22 ...) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">X</td><td>N vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Y</td><td>= M vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">M</td><td>rows of A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>columns of A </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01239">1239</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1240</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1241</span> </div>
<div class="line"><span class="lineno"> 1242</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1243</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1244</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ij</div>
<div class="line"><span class="lineno"> 1245</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 1246</span> </div>
<div class="line"><span class="lineno"> 1247</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: a(*)</div>
<div class="line"><span class="lineno"> 1248</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: x(*)</div>
<div class="line"><span class="lineno"> 1249</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: y(*)</div>
<div class="line"><span class="lineno"> 1250</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: m</div>
<div class="line"><span class="lineno"> 1251</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno"> 1252</span> </div>
<div class="line"><span class="lineno"> 1253</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 1254</span>    ij=0</div>
<div class="line"><span class="lineno"> 1255</span>    <span class="keywordflow">DO</span> i=1,m</div>
<div class="line"><span class="lineno"> 1256</span>        y(i)=0.0_mpd</div>
<div class="line"><span class="lineno"> 1257</span>        <span class="keywordflow">DO</span> j=1,n</div>
<div class="line"><span class="lineno"> 1258</span>            ij=ij+1</div>
<div class="line"><span class="lineno"> 1259</span>            y(i)=y(i)+a(ij)*x(j)</div>
<div class="line"><span class="lineno"> 1260</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 1261</span><span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4215de1ac22cc248323f1e966df30ed3" name="a4215de1ac22cc248323f1e966df30ed3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4215de1ac22cc248323f1e966df30ed3">&#9670;&#160;</a></span>dbmprv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dbmprv </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>lun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print symmetric matrix, vector. </p>
<p>Prints the n-vector X and the symmetric N-by-N covariance matrix V, the latter as a correlation matrix.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lun</td><td>unit number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>symmetric matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix, vector </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01348">1348</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1349</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1350</span> </div>
<div class="line"><span class="lineno"> 1351</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1352</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1353</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ii</div>
<div class="line"><span class="lineno"> 1354</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ij</div>
<div class="line"><span class="lineno"> 1355</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 1356</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jj</div>
<div class="line"><span class="lineno"> 1357</span>    <span class="keywordtype">INTEGER(mpi)</span> :: l</div>
<div class="line"><span class="lineno"> 1358</span>    <span class="keywordtype">INTEGER(mpi)</span> :: m</div>
<div class="line"><span class="lineno"> 1359</span>    <span class="keywordtype">INTEGER(mpi)</span> :: mc(15)</div>
<div class="line"><span class="lineno"> 1360</span><span class="keywordtype">    REAL</span>(mps) :: pd</div>
<div class="line"><span class="lineno"> 1361</span><span class="keywordtype">    REAL</span>(mps) :: rho</div>
<div class="line"><span class="lineno"> 1362</span><span class="keywordtype">    REAL</span>(mps) :: err</div>
<div class="line"><span class="lineno"> 1363</span> </div>
<div class="line"><span class="lineno"> 1364</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>          :: lun</div>
<div class="line"><span class="lineno"> 1365</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span> :: x(*)</div>
<div class="line"><span class="lineno"> 1366</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span> :: v(*)</div>
<div class="line"><span class="lineno"> 1367</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>          :: n</div>
<div class="line"><span class="lineno"> 1368</span> </div>
<div class="line"><span class="lineno"> 1369</span>    <span class="keyword">WRITE</span>(lun,103)</div>
<div class="line"><span class="lineno"> 1370</span>    <span class="keyword">WRITE</span>(lun,101)</div>
<div class="line"><span class="lineno"> 1371</span>    ii=0</div>
<div class="line"><span class="lineno"> 1372</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno"> 1373</span>        ij=ii</div>
<div class="line"><span class="lineno"> 1374</span>        ii=ii+i</div>
<div class="line"><span class="lineno"> 1375</span>        err=0.0</div>
<div class="line"><span class="lineno"> 1376</span>        <span class="keywordflow">IF</span>(v(ii) &gt; 0.0) err=sqrt(real(v(ii),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>))</div>
<div class="line"><span class="lineno"> 1377</span>        l=0</div>
<div class="line"><span class="lineno"> 1378</span>        jj=0</div>
<div class="line"><span class="lineno"> 1379</span>        <span class="keywordflow">DO</span> j=1,i</div>
<div class="line"><span class="lineno"> 1380</span>            jj=jj+j</div>
<div class="line"><span class="lineno"> 1381</span>            ij=ij+1</div>
<div class="line"><span class="lineno"> 1382</span>            rho=0.0</div>
<div class="line"><span class="lineno"> 1383</span>            pd=real(v(ii)*v(jj),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)</div>
<div class="line"><span class="lineno"> 1384</span>            <span class="keywordflow">IF</span>(pd &gt; 0.0) rho=real(v(ij),<a class="code hl_variable" href="namespacempdef.html#aeda146bde2da88d0f6940fc9be01e963">mps</a>)/sqrt(pd)</div>
<div class="line"><span class="lineno"> 1385</span>            l=l+1</div>
<div class="line"><span class="lineno"> 1386</span>            mc(l)=nint(100.0*abs(rho),<a class="code hl_variable" href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpi</a>)</div>
<div class="line"><span class="lineno"> 1387</span>            <span class="keywordflow">IF</span>(rho &lt; 0.0) mc(l)=-mc(l)</div>
<div class="line"><span class="lineno"> 1388</span>            <span class="keywordflow">IF</span>(j == i.OR.l == 15) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1389</span>                <span class="keywordflow">IF</span>(j &lt;= 15) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1390</span>                    <span class="keywordflow">IF</span>(j == i) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1391</span>                        <span class="keyword">WRITE</span>(lun,102) i,x(i),err,(mc(m),m=1,l-1)</div>
<div class="line"><span class="lineno"> 1392</span>                    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1393</span>                        <span class="keyword">WRITE</span>(lun,102) i,x(i),err,(mc(m),m=1,l)</div>
<div class="line"><span class="lineno"> 1394</span><span class="keywordflow">                    END IF</span></div>
<div class="line"><span class="lineno"> 1395</span>                <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1396</span>                    <span class="keywordflow">IF</span>(j == i) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1397</span>                        <span class="keyword">WRITE</span>(lun,103) (mc(m),m=1,l-1)</div>
<div class="line"><span class="lineno"> 1398</span>                    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1399</span>                        <span class="keyword">WRITE</span>(lun,103) (mc(m),m=1,l)</div>
<div class="line"><span class="lineno"> 1400</span><span class="keywordflow">                    END IF</span></div>
<div class="line"><span class="lineno"> 1401</span>                    l=0</div>
<div class="line"><span class="lineno"> 1402</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno"> 1403</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno"> 1404</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 1405</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 1406</span>    <span class="keyword">WRITE</span>(lun,104)</div>
<div class="line"><span class="lineno"> 1407</span>    <span class="comment">!  100 RETURN</span></div>
<div class="line"><span class="lineno"> 1408</span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno"> 1409</span>101 <span class="keyword">FORMAT</span>(9x,<span class="stringliteral">&#39;Param&#39;</span>,7x,<span class="stringliteral">&#39;error&#39;</span>,7x,<span class="stringliteral">&#39;correlation coefficients&#39;</span>/)</div>
<div class="line"><span class="lineno"> 1410</span>102 <span class="keyword">FORMAT</span>(1x,i5,2g12.4,1x,15i5)</div>
<div class="line"><span class="lineno"> 1411</span>103 <span class="keyword">FORMAT</span>(31x,15i5)</div>
<div class="line"><span class="lineno"> 1412</span>104 <span class="keyword">FORMAT</span>(33x,<span class="stringliteral">&#39;(correlation coefficients in percent)&#39;</span>)</div>
<div class="ttc" id="anamespacempdef_html_a3fc26af88c2fce97882db26de5535606"><div class="ttname"><a href="namespacempdef.html#a3fc26af88c2fce97882db26de5535606">mpdef::mpi</a></div><div class="ttdeci">integer, parameter mpi</div><div class="ttdef"><b>Definition</b> <a href="mpdef_8f90_source.html#l00034">mpdef.f90:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae8511bf4f0a922fdd51b1852e41ba7b" name="aae8511bf4f0a922fdd51b1852e41ba7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae8511bf4f0a922fdd51b1852e41ba7b">&#9670;&#160;</a></span>dbprv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dbprv </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>lun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print symmetric matrix. </p>
<p>Prints the symmetric N-by-N matrix V.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lun</td><td>unit number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>symmetric matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix, </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01423">1423</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1424</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1425</span> </div>
<div class="line"><span class="lineno"> 1426</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1427</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">PARAMETER</span> :: istp=6</div>
<div class="line"><span class="lineno"> 1428</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1429</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ip</div>
<div class="line"><span class="lineno"> 1430</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ipe</div>
<div class="line"><span class="lineno"> 1431</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ipn</div>
<div class="line"><span class="lineno"> 1432</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ips</div>
<div class="line"><span class="lineno"> 1433</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno"> 1434</span> </div>
<div class="line"><span class="lineno"> 1435</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>          :: lun</div>
<div class="line"><span class="lineno"> 1436</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span> :: v(*)</div>
<div class="line"><span class="lineno"> 1437</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>          :: n</div>
<div class="line"><span class="lineno"> 1438</span> </div>
<div class="line"><span class="lineno"> 1439</span>    <span class="keyword">WRITE</span>(lun,101)</div>
<div class="line"><span class="lineno"> 1440</span> </div>
<div class="line"><span class="lineno"> 1441</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno"> 1442</span>        ips=(i*i-i)/2</div>
<div class="line"><span class="lineno"> 1443</span>        ipe=ips+i</div>
<div class="line"><span class="lineno"> 1444</span>        ip =ips</div>
<div class="line"><span class="lineno"> 1445</span>100 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><span class="lineno"> 1446</span>    ipn=ip+istp</div>
<div class="line"><span class="lineno"> 1447</span>    <span class="keyword">WRITE</span>(lun,102) i, ip+1-ips, (v(k),k=ip+1,min(ipn,ipe))</div>
<div class="line"><span class="lineno"> 1448</span>    <span class="keywordflow">IF</span> (ipn &lt; ipe) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1449</span>        ip=ipn</div>
<div class="line"><span class="lineno"> 1450</span>        <span class="keywordflow">GO TO</span> 100</div>
<div class="line"><span class="lineno"> 1451</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 1452</span><span class="keywordflow">END DO</span></div>
<div class="line"><span class="lineno"> 1453</span><span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno"> 1454</span>101 <span class="keyword">FORMAT</span>(1x,<span class="stringliteral">&#39;--- DBPRV -----------------------------------&#39;</span>)</div>
<div class="line"><span class="lineno"> 1455</span>102 <span class="keyword">FORMAT</span>(1x,2i3,6g12.4)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae51d83946746b8fd144656d5c4ef8771" name="ae51d83946746b8fd144656d5c4ef8771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae51d83946746b8fd144656d5c4ef8771">&#9670;&#160;</a></span>dbsvx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dbsvx </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(out)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Product symmetric matrix, vector. </p>
<p>Multiply symmetric N-by-N matrix and N-vector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>symmetric matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">b</td><td>vector B = V * A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01152">1152</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1153</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1154</span> </div>
<div class="line"><span class="lineno"> 1155</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1156</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1157</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ij</div>
<div class="line"><span class="lineno"> 1158</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ijs</div>
<div class="line"><span class="lineno"> 1159</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 1160</span> </div>
<div class="line"><span class="lineno"> 1161</span>    <span class="comment">!         B   :=    V   *    A</span></div>
<div class="line"><span class="lineno"> 1162</span>    <span class="comment">!         N        N*N       N</span></div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>           :: n</div>
<div class="line"><span class="lineno"> 1165</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>  :: v(*)</div>
<div class="line"><span class="lineno"> 1166</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>  :: a(*)</div>
<div class="line"><span class="lineno"> 1167</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: b(*)</div>
<div class="line"><span class="lineno"> 1168</span> </div>
<div class="line"><span class="lineno"> 1169</span><span class="keywordtype">    REAL</span>(mpd) :: dsum</div>
<div class="line"><span class="lineno"> 1170</span>    ijs=1</div>
<div class="line"><span class="lineno"> 1171</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno"> 1172</span>        dsum=0.0</div>
<div class="line"><span class="lineno"> 1173</span>        ij=ijs</div>
<div class="line"><span class="lineno"> 1174</span>        <span class="keywordflow">DO</span> j=1,n</div>
<div class="line"><span class="lineno"> 1175</span>            dsum=dsum+v(ij)*a(j)</div>
<div class="line"><span class="lineno"> 1176</span>            <span class="keywordflow">IF</span>(j &lt; i) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1177</span>                ij=ij+1</div>
<div class="line"><span class="lineno"> 1178</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1179</span>                ij=ij+j</div>
<div class="line"><span class="lineno"> 1180</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno"> 1181</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 1182</span>        b(i)=dsum</div>
<div class="line"><span class="lineno"> 1183</span>        ijs=ijs+i</div>
<div class="line"><span class="lineno"> 1184</span><span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f58743f91524d7e25eeec8d39699a3b" name="a2f58743f91524d7e25eeec8d39699a3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f58743f91524d7e25eeec8d39699a3b">&#9670;&#160;</a></span>dbsvxl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine dbsvxl </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(out)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Product LARGE symmetric matrix, vector. </p>
<p>Multiply LARGE symmetric N-by-N matrix and N-vector:</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>symmetric matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">b</td><td>product vector B = V * A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01196">1196</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1197</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1198</span> </div>
<div class="line"><span class="lineno"> 1199</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1200</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1201</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 1202</span> </div>
<div class="line"><span class="lineno"> 1203</span>    <span class="comment">!         B   :=    V   *    A</span></div>
<div class="line"><span class="lineno"> 1204</span>    <span class="comment">!         N        N*N       N</span></div>
<div class="line"><span class="lineno"> 1205</span> </div>
<div class="line"><span class="lineno"> 1206</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>           :: n</div>
<div class="line"><span class="lineno"> 1207</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>  :: v(*)</div>
<div class="line"><span class="lineno"> 1208</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>  :: a(*)</div>
<div class="line"><span class="lineno"> 1209</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: b(*)</div>
<div class="line"><span class="lineno"> 1210</span> </div>
<div class="line"><span class="lineno"> 1211</span><span class="keywordtype">    REAL</span>(mpd) :: dsum</div>
<div class="line"><span class="lineno"> 1212</span>    <span class="keywordtype">INTEGER(mpl)</span> :: ij</div>
<div class="line"><span class="lineno"> 1213</span>    <span class="keywordtype">INTEGER(mpl)</span> :: ijs</div>
<div class="line"><span class="lineno"> 1214</span>    ijs=1</div>
<div class="line"><span class="lineno"> 1215</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno"> 1216</span>        dsum=0.0</div>
<div class="line"><span class="lineno"> 1217</span>        ij=ijs</div>
<div class="line"><span class="lineno"> 1218</span>        <span class="keywordflow">DO</span> j=1,n</div>
<div class="line"><span class="lineno"> 1219</span>            dsum=dsum+v(ij)*a(j)</div>
<div class="line"><span class="lineno"> 1220</span>            <span class="keywordflow">IF</span>(j &lt; i) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1221</span>                ij=ij+1</div>
<div class="line"><span class="lineno"> 1222</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1223</span>                ij=ij+int8(j)</div>
<div class="line"><span class="lineno"> 1224</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno"> 1225</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 1226</span>        b(i)=dsum</div>
<div class="line"><span class="lineno"> 1227</span>        ijs=ijs+int8(i)</div>
<div class="line"><span class="lineno"> 1228</span><span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab1c8f4ab95e058209d96c6271f5ec95b" name="ab1c8f4ab95e058209d96c6271f5ec95b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1c8f4ab95e058209d96c6271f5ec95b">&#9670;&#160;</a></span>devinv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine devinv </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n,n), intent(in)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(out)&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inversion by diagonalization. Get inverse matrix V from DIAG and U. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size of matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DIAG</td><td>diagonal elements </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">U</td><td>transformation matrix </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">V</td><td>smmmetric matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l00704">704</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  705</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  708</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  709</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ij</div>
<div class="line"><span class="lineno">  710</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  711</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno">  714</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: diag(n)</div>
<div class="line"><span class="lineno">  715</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: u(n,n)</div>
<div class="line"><span class="lineno">  716</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: v(*)</div>
<div class="line"><span class="lineno">  717</span><span class="keywordtype">    REAL</span>(mpd) :: dsum</div>
<div class="line"><span class="lineno">  718</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  719</span>    ij=0</div>
<div class="line"><span class="lineno">  720</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno">  721</span>        <span class="keywordflow">DO</span> j=1,i</div>
<div class="line"><span class="lineno">  722</span>            ij=ij+1</div>
<div class="line"><span class="lineno">  723</span>            dsum=0.0_mpd</div>
<div class="line"><span class="lineno">  724</span>            <span class="keywordflow">DO</span> k=1,n</div>
<div class="line"><span class="lineno">  725</span>                <span class="keywordflow">IF</span>(diag(k) /= 0.0_mpd) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  726</span>                    dsum=dsum+u(i,k)*u(j,k)/diag(k)</div>
<div class="line"><span class="lineno">  727</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  728</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  729</span>            v(ij)=dsum</div>
<div class="line"><span class="lineno">  730</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  731</span><span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a36ccd26f5ba6d72c55e9f90b2e22b1e1" name="a36ccd26f5ba6d72c55e9f90b2e22b1e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36ccd26f5ba6d72c55e9f90b2e22b1e1">&#9670;&#160;</a></span>devrot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine devrot </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n,n), intent(out)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>work</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>iwork</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Diagonalization. </p>
<p>Determination of eigenvalues and eigenvectors of symmetric matrix V by Householder method</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">diag</td><td>diagonal elements </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">u</td><td>transformation matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>symmetric matrix, unchanged </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">work</td><td>work array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">iwork</td><td>work array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l00377">377</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  378</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno">  383</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: diag(n)</div>
<div class="line"><span class="lineno">  384</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: u(n,n)</div>
<div class="line"><span class="lineno">  385</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: v(*)</div>
<div class="line"><span class="lineno">  386</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: work(n)</div>
<div class="line"><span class="lineno">  387</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: iwork(n)</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">PARAMETER</span> :: itmax=30</div>
<div class="line"><span class="lineno">  391</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">PARAMETER</span> :: tol=epsilon(tol)</div>
<div class="line"><span class="lineno">  392</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">PARAMETER</span> :: eps=epsilon(eps)</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span><span class="keywordtype">    REAL</span>(mpd) :: f</div>
<div class="line"><span class="lineno">  395</span><span class="keywordtype">    REAL</span>(mpd) :: g</div>
<div class="line"><span class="lineno">  396</span><span class="keywordtype">    REAL</span>(mpd) :: h</div>
<div class="line"><span class="lineno">  397</span><span class="keywordtype">    REAL</span>(mpd) :: sh</div>
<div class="line"><span class="lineno">  398</span><span class="keywordtype">    REAL</span>(mpd) :: hh</div>
<div class="line"><span class="lineno">  399</span><span class="keywordtype">    REAL</span>(mpd) :: b</div>
<div class="line"><span class="lineno">  400</span><span class="keywordtype">    REAL</span>(mpd) :: p</div>
<div class="line"><span class="lineno">  401</span><span class="keywordtype">    REAL</span>(mpd) :: r</div>
<div class="line"><span class="lineno">  402</span><span class="keywordtype">    REAL</span>(mpd) :: s</div>
<div class="line"><span class="lineno">  403</span><span class="keywordtype">    REAL</span>(mpd) :: c</div>
<div class="line"><span class="lineno">  404</span><span class="keywordtype">    REAL</span>(mpd) :: workd</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ij</div>
<div class="line"><span class="lineno">  407</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  408</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  409</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordtype">INTEGER(mpi)</span> :: l</div>
<div class="line"><span class="lineno">  411</span>    <span class="keywordtype">INTEGER(mpi)</span> :: m</div>
<div class="line"><span class="lineno">  412</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ll</div>
<div class="line"><span class="lineno">  413</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  414</span>    <span class="comment">!     1. part: symmetric matrix V reduced to tridiagonal from</span></div>
<div class="line"><span class="lineno">  415</span>    ij=0</div>
<div class="line"><span class="lineno">  416</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno">  417</span>        <span class="keywordflow">DO</span> j=1,i</div>
<div class="line"><span class="lineno">  418</span>            ij=ij+1</div>
<div class="line"><span class="lineno">  419</span>            u(i,j)=v(ij)  <span class="comment">! copy half of symmetric matirx</span></div>
<div class="line"><span class="lineno">  420</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  421</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>    <span class="keywordflow">DO</span> i=n,2,-1</div>
<div class="line"><span class="lineno">  424</span>        l=i-2</div>
<div class="line"><span class="lineno">  425</span>        f=u(i,i-1)</div>
<div class="line"><span class="lineno">  426</span>        g=0.0_mpd</div>
<div class="line"><span class="lineno">  427</span>        <span class="keywordflow">IF</span>(l /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  428</span>            <span class="keywordflow">DO</span> k=1,l</div>
<div class="line"><span class="lineno">  429</span>                <span class="keywordflow">IF</span>(abs(u(i,k)) &gt; tol) g=g+u(i,k)*u(i,k)</div>
<div class="line"><span class="lineno">  430</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  431</span>            h=g+f*f</div>
<div class="line"><span class="lineno">  432</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  433</span>        <span class="keywordflow">IF</span>(g &lt; tol) <span class="keywordflow">THEN</span>   <span class="comment">! G too small</span></div>
<div class="line"><span class="lineno">  434</span>            work(i)=f           <span class="comment">! skip transformation</span></div>
<div class="line"><span class="lineno">  435</span>            h   =0.0_mpd</div>
<div class="line"><span class="lineno">  436</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  437</span>            l=l+1</div>
<div class="line"><span class="lineno">  438</span>            sh=sqrt(h)</div>
<div class="line"><span class="lineno">  439</span>            <span class="keywordflow">IF</span>(f &gt;= 0.0_mpd) sh=-sh</div>
<div class="line"><span class="lineno">  440</span>            g=sh</div>
<div class="line"><span class="lineno">  441</span>            work(i)=sh</div>
<div class="line"><span class="lineno">  442</span>            h=h-f*g</div>
<div class="line"><span class="lineno">  443</span>            u(i,i-1)=f-g</div>
<div class="line"><span class="lineno">  444</span>            f=0.0_mpd</div>
<div class="line"><span class="lineno">  445</span>            <span class="keywordflow">DO</span> j=1,l</div>
<div class="line"><span class="lineno">  446</span>                u(j,i)=u(i,j)/h</div>
<div class="line"><span class="lineno">  447</span>                g=0.0_mpd</div>
<div class="line"><span class="lineno">  448</span>                <span class="comment">!          form element of a u</span></div>
<div class="line"><span class="lineno">  449</span>                <span class="keywordflow">DO</span> k=1,j</div>
<div class="line"><span class="lineno">  450</span>                    <span class="keywordflow">IF</span>(abs(u(j,k)) &gt; tol.AND.abs(u(i,k)) &gt; tol) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  451</span>                        g=g+u(j,k)*u(i,k)</div>
<div class="line"><span class="lineno">  452</span><span class="keywordflow">                    END IF</span></div>
<div class="line"><span class="lineno">  453</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno">  454</span>                <span class="keywordflow">DO</span> k=j+1,l</div>
<div class="line"><span class="lineno">  455</span>                    <span class="keywordflow">IF</span>(abs(u(k,j)) &gt; tol.AND.abs(u(i,k)) &gt; tol) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  456</span>                        g=g+u(k,j)*u(i,k)</div>
<div class="line"><span class="lineno">  457</span><span class="keywordflow">                    END IF</span></div>
<div class="line"><span class="lineno">  458</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno">  459</span>                work(j)=g/h</div>
<div class="line"><span class="lineno">  460</span>                f=f+g*u(j,i)</div>
<div class="line"><span class="lineno">  461</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  462</span>            <span class="comment">!         form k</span></div>
<div class="line"><span class="lineno">  463</span>            hh=f/(h+h)</div>
<div class="line"><span class="lineno">  464</span>            <span class="comment">!         form reduced a</span></div>
<div class="line"><span class="lineno">  465</span>            <span class="keywordflow">DO</span> j=1,l</div>
<div class="line"><span class="lineno">  466</span>                f=u(i,j)</div>
<div class="line"><span class="lineno">  467</span>                work(j)=work(j)-hh*f</div>
<div class="line"><span class="lineno">  468</span>                g=work(j)</div>
<div class="line"><span class="lineno">  469</span>                <span class="keywordflow">DO</span> k=1,j</div>
<div class="line"><span class="lineno">  470</span>                    u(j,k)=u(j,k)-f*work(k)-g*u(i,k)</div>
<div class="line"><span class="lineno">  471</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno">  472</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  473</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  474</span>        diag(i)=h</div>
<div class="line"><span class="lineno">  475</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    diag(1)=0.0_mpd</div>
<div class="line"><span class="lineno">  478</span>    work(1)=0.0_mpd</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="comment">!     accumulation of transformation matrices</span></div>
<div class="line"><span class="lineno">  481</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno">  482</span>        <span class="keywordflow">IF</span>(diag(i) /= 0.0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  483</span>            <span class="keywordflow">DO</span> j=1,i-1</div>
<div class="line"><span class="lineno">  484</span>                g=0.0_mpd</div>
<div class="line"><span class="lineno">  485</span>                <span class="keywordflow">DO</span> k=1,i-1</div>
<div class="line"><span class="lineno">  486</span>                    g=g+u(i,k)*u(k,j)</div>
<div class="line"><span class="lineno">  487</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno">  488</span>                <span class="keywordflow">DO</span> k=1,i-1</div>
<div class="line"><span class="lineno">  489</span>                    u(k,j)=u(k,j)-g*u(k,i)</div>
<div class="line"><span class="lineno">  490</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno">  491</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  492</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  493</span>        diag(i)=u(i,i)</div>
<div class="line"><span class="lineno">  494</span>        u(i,i)=1.0_mpd</div>
<div class="line"><span class="lineno">  495</span>        <span class="keywordflow">DO</span> j=1,i-1</div>
<div class="line"><span class="lineno">  496</span>            u(i,j)=0.0_mpd</div>
<div class="line"><span class="lineno">  497</span>            u(j,i)=0.0_mpd</div>
<div class="line"><span class="lineno">  498</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  499</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>    <span class="comment">!     2. part: diagonalization of tridiagonal matrix</span></div>
<div class="line"><span class="lineno">  502</span>    <span class="keywordflow">DO</span> i=2,n</div>
<div class="line"><span class="lineno">  503</span>        work(i-1)=work(i)</div>
<div class="line"><span class="lineno">  504</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  505</span>    work(n)=0.0_mpd</div>
<div class="line"><span class="lineno">  506</span>    b=0.0_mpd</div>
<div class="line"><span class="lineno">  507</span>    f=0.0_mpd</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordflow">DO</span> l=1,n</div>
<div class="line"><span class="lineno">  510</span>        j=0</div>
<div class="line"><span class="lineno">  511</span>        h=eps*(abs(diag(l))+abs(work(l)))</div>
<div class="line"><span class="lineno">  512</span>        <span class="keywordflow">IF</span>(b &lt; h) b=h</div>
<div class="line"><span class="lineno">  513</span>        <span class="keywordflow">DO</span> m=l,n</div>
<div class="line"><span class="lineno">  514</span>            <span class="keywordflow">IF</span>(abs(work(m)) &lt;= b) <span class="keywordflow">GO TO</span> 10 <span class="comment">! look for small sub-diagonal element</span></div>
<div class="line"><span class="lineno">  515</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  516</span>        m=l</div>
<div class="line"><span class="lineno">  517</span>10      <span class="keywordflow">IF</span>(m == l) <span class="keywordflow">GO TO</span> 30</div>
<div class="line"><span class="lineno">  518</span>        <span class="comment">!      next iteration</span></div>
<div class="line"><span class="lineno">  519</span>20      <span class="keywordflow">IF</span>(j == itmax) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  520</span>            <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;DEVROT: Iteration limit reached&#39;</span></div>
<div class="line"><span class="lineno">  521</span>            <span class="keyword">CALL </span><a class="code hl_function" href="pede_8f90.html#a16ef8020d3ee5c0aa46a0cb5b1dceba8">peend</a>(32,<span class="stringliteral">&#39;Aborted, iteration limit reached in diagonalization&#39;</span>)</div>
<div class="line"><span class="lineno">  522</span>            stop</div>
<div class="line"><span class="lineno">  523</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  524</span>        j=j+1</div>
<div class="line"><span class="lineno">  525</span>        g=diag(l)</div>
<div class="line"><span class="lineno">  526</span>        p=(diag(l+1)-g)/(2.0_mpd*work(l))</div>
<div class="line"><span class="lineno">  527</span>        r=sqrt(1.0_mpd+p*p)</div>
<div class="line"><span class="lineno">  528</span>        diag(l)=work(l)</div>
<div class="line"><span class="lineno">  529</span>        <span class="keywordflow">IF</span>(p &lt; 0.0_mpd) diag(l)=diag(l)/(p-r)</div>
<div class="line"><span class="lineno">  530</span>        <span class="keywordflow">IF</span>(p &gt;= 0.0_mpd) diag(l)=diag(l)/(p+r)</div>
<div class="line"><span class="lineno">  531</span>        h=g-diag(l)</div>
<div class="line"><span class="lineno">  532</span>        <span class="keywordflow">DO</span> i=l+1,n</div>
<div class="line"><span class="lineno">  533</span>            diag(i)=diag(i)-h</div>
<div class="line"><span class="lineno">  534</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  535</span>        f=f+h</div>
<div class="line"><span class="lineno">  536</span>        <span class="comment">!      QL transformation</span></div>
<div class="line"><span class="lineno">  537</span>        p=diag(m)</div>
<div class="line"><span class="lineno">  538</span>        c=1.0_mpd</div>
<div class="line"><span class="lineno">  539</span>        s=0.0_mpd</div>
<div class="line"><span class="lineno">  540</span>        <span class="keywordflow">DO</span> i=m-1,l,-1          <span class="comment">! reverse loop</span></div>
<div class="line"><span class="lineno">  541</span>            g=c*work(i)</div>
<div class="line"><span class="lineno">  542</span>            h=c*p</div>
<div class="line"><span class="lineno">  543</span>            <span class="keywordflow">IF</span>(abs(p) &gt;= abs(work(i))) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  544</span>                c=work(i)/p</div>
<div class="line"><span class="lineno">  545</span>                r=sqrt(1.0_mpd+c*c)</div>
<div class="line"><span class="lineno">  546</span>                work(i+1)=s*p*r</div>
<div class="line"><span class="lineno">  547</span>                s=c/r</div>
<div class="line"><span class="lineno">  548</span>                c=1.0_mpd/r</div>
<div class="line"><span class="lineno">  549</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  550</span>                c=p/work(i)</div>
<div class="line"><span class="lineno">  551</span>                r=sqrt(1.0_mpd+c*c)</div>
<div class="line"><span class="lineno">  552</span>                work(i+1)=s*work(i)*r</div>
<div class="line"><span class="lineno">  553</span>                s=1.0_mpd/r</div>
<div class="line"><span class="lineno">  554</span>                c=c/r</div>
<div class="line"><span class="lineno">  555</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  556</span>            p=c*diag(i)-s*g</div>
<div class="line"><span class="lineno">  557</span>            diag(i+1)=h+s*(c*g+s*diag(i))</div>
<div class="line"><span class="lineno">  558</span>            <span class="comment">!       form vector</span></div>
<div class="line"><span class="lineno">  559</span>            <span class="keywordflow">DO</span> k=1,n</div>
<div class="line"><span class="lineno">  560</span>                h=u(k,i+1)</div>
<div class="line"><span class="lineno">  561</span>                u(k,i+1)=s*u(k,i)+c*h</div>
<div class="line"><span class="lineno">  562</span>                u(k,i)=c*u(k,i)-s*h</div>
<div class="line"><span class="lineno">  563</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  564</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  565</span>        work(l)=s*p</div>
<div class="line"><span class="lineno">  566</span>        diag(l)=c*p</div>
<div class="line"><span class="lineno">  567</span>        <span class="keywordflow">IF</span>(abs(work(l)) &gt; b) <span class="keywordflow">GO TO</span> 20 <span class="comment">! next iteration</span></div>
<div class="line"><span class="lineno">  568</span>30      diag(l)=diag(l)+f</div>
<div class="line"><span class="lineno">  569</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  570</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno">  571</span>        iwork(i)=i</div>
<div class="line"><span class="lineno">  572</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>    m=1</div>
<div class="line"><span class="lineno">  575</span>40  m=1+3*m    <span class="comment">! determine initial increment</span></div>
<div class="line"><span class="lineno">  576</span>    <span class="keywordflow">IF</span>(m &lt;= n) <span class="keywordflow">GO TO</span> 40</div>
<div class="line"><span class="lineno">  577</span>50  m=m/3</div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">DO</span> j=1,n-m <span class="comment">! sort with increment M</span></div>
<div class="line"><span class="lineno">  579</span>        l=j</div>
<div class="line"><span class="lineno">  580</span>60      <span class="keywordflow">IF</span>(diag(iwork(l+m)) &gt; diag(iwork(l))) <span class="keywordflow">THEN</span> <span class="comment">! compare</span></div>
<div class="line"><span class="lineno">  581</span>            ll=iwork(l+m)      <span class="comment">! exchange the two index values</span></div>
<div class="line"><span class="lineno">  582</span>            iwork(l+m)=iwork(l)</div>
<div class="line"><span class="lineno">  583</span>            iwork(l)=ll</div>
<div class="line"><span class="lineno">  584</span>            l=l-m</div>
<div class="line"><span class="lineno">  585</span>            <span class="keywordflow">IF</span>(l &gt; 0) <span class="keywordflow">GO TO</span> 60</div>
<div class="line"><span class="lineno">  586</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  587</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  588</span>    <span class="keywordflow">IF</span>(m &gt; 1) <span class="keywordflow">GO TO</span> 50</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno">  591</span>        <span class="keywordflow">IF</span>(iwork(i) /= i) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  592</span>            <span class="comment">!         move vector from position I to the work area</span></div>
<div class="line"><span class="lineno">  593</span>            workd=diag(i)</div>
<div class="line"><span class="lineno">  594</span>            <span class="keywordflow">DO</span> l=1,n</div>
<div class="line"><span class="lineno">  595</span>                work(l)=u(l,i)</div>
<div class="line"><span class="lineno">  596</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  597</span>            k=i</div>
<div class="line"><span class="lineno">  598</span>70          j=k</div>
<div class="line"><span class="lineno">  599</span>            k=iwork(j)</div>
<div class="line"><span class="lineno">  600</span>            iwork(j)=j</div>
<div class="line"><span class="lineno">  601</span>            <span class="keywordflow">IF</span>(k /= i) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  602</span>                <span class="comment">!            move vector from position K to the (free) position J</span></div>
<div class="line"><span class="lineno">  603</span>                diag(j)=diag(k)</div>
<div class="line"><span class="lineno">  604</span>                <span class="keywordflow">DO</span> l=1,n</div>
<div class="line"><span class="lineno">  605</span>                    u(l,j)=u(l,k)</div>
<div class="line"><span class="lineno">  606</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno">  607</span>                <span class="keywordflow">GO TO</span> 70</div>
<div class="line"><span class="lineno">  608</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  609</span>            <span class="comment">!         move vector from the work area to position J</span></div>
<div class="line"><span class="lineno">  610</span>            diag(j)=workd</div>
<div class="line"><span class="lineno">  611</span>            <span class="keywordflow">DO</span> l=1,n</div>
<div class="line"><span class="lineno">  612</span>                u(l,j)=work(l)</div>
<div class="line"><span class="lineno">  613</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  614</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  615</span><span class="keywordflow">    END DO</span></div>
<div class="ttc" id="apede_8f90_html_a16ef8020d3ee5c0aa46a0cb5b1dceba8"><div class="ttname"><a href="pede_8f90.html#a16ef8020d3ee5c0aa46a0cb5b1dceba8">peend</a></div><div class="ttdeci">subroutine peend(icode, cmessage)</div><div class="ttdoc">Print exit code.</div><div class="ttdef"><b>Definition</b> <a href="pede_8f90_source.html#l08889">pede.f90:8890</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acc1b41f704b9ad302fbbbb7685c3bf03" name="acc1b41f704b9ad302fbbbb7685c3bf03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc1b41f704b9ad302fbbbb7685c3bf03">&#9670;&#160;</a></span>devsig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine devsig </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n,n), intent(in)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>coef</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate significances. </p>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l00619">619</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  620</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno">  625</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: diag(n)</div>
<div class="line"><span class="lineno">  626</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: u(n,n)</div>
<div class="line"><span class="lineno">  627</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: b(n)</div>
<div class="line"><span class="lineno">  628</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: coef(n)</div>
<div class="line"><span class="lineno">  629</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  630</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  631</span><span class="keywordtype">    REAL</span>(mpd) :: dsum</div>
<div class="line"><span class="lineno">  632</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  633</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno">  634</span>        coef(i)=0.0_mpd</div>
<div class="line"><span class="lineno">  635</span>        <span class="keywordflow">IF</span>(diag(i) &gt; 0.0_mpd) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  636</span>            dsum=0.0_mpd</div>
<div class="line"><span class="lineno">  637</span>            <span class="keywordflow">DO</span> j=1,n</div>
<div class="line"><span class="lineno">  638</span>                dsum=dsum+u(j,i)*b(j)</div>
<div class="line"><span class="lineno">  639</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  640</span>            coef(i)=abs(dsum)/sqrt(diag(i))</div>
<div class="line"><span class="lineno">  641</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  642</span><span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a20cdb7dca1007e7cc6ea973e584f94ee" name="a20cdb7dca1007e7cc6ea973e584f94ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20cdb7dca1007e7cc6ea973e584f94ee">&#9670;&#160;</a></span>devsol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine devsol </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n,n), intent(in)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>work</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solution by diagonalization. </p>
<p>Solution of matrix equation V * X = B after diagonalization of V.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size of matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DIAG</td><td>diagonal elements </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">U</td><td>transformation matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">B</td><td>r.h.s. of matrix equation (unchanged) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>solution vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">WORK</td><td>work array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l00657">657</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  658</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno">  663</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: diag(n)</div>
<div class="line"><span class="lineno">  664</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: u(n,n)</div>
<div class="line"><span class="lineno">  665</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>             :: b(n)</div>
<div class="line"><span class="lineno">  666</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: x(n)</div>
<div class="line"><span class="lineno">  667</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: work(n)</div>
<div class="line"><span class="lineno">  668</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  669</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  670</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jj</div>
<div class="line"><span class="lineno">  671</span><span class="keywordtype">    REAL</span>(mpd) :: s</div>
<div class="line"><span class="lineno">  672</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  673</span>    <span class="keywordflow">DO</span> j=1,n</div>
<div class="line"><span class="lineno">  674</span>        s=0.0_mpd</div>
<div class="line"><span class="lineno">  675</span>        work(j)=0.0_mpd</div>
<div class="line"><span class="lineno">  676</span>        <span class="keywordflow">IF</span>(diag(j) /= 0.0_mpd) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  677</span>            <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno">  678</span>                <span class="comment">!           j-th eigenvector is U(.,J)</span></div>
<div class="line"><span class="lineno">  679</span>                s=s+u(i,j)*b(i)</div>
<div class="line"><span class="lineno">  680</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  681</span>            work(j)=s/diag(j)</div>
<div class="line"><span class="lineno">  682</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  683</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span>    <span class="keywordflow">DO</span> j=1,n</div>
<div class="line"><span class="lineno">  686</span>        s=0.0_mpd</div>
<div class="line"><span class="lineno">  687</span>        <span class="keywordflow">DO</span> jj=1,n</div>
<div class="line"><span class="lineno">  688</span>            s=s+u(j,jj)*work(jj)</div>
<div class="line"><span class="lineno">  689</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno">  690</span>        x(j)=s</div>
<div class="line"><span class="lineno">  691</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  692</span><span class="comment">!      WRITE(*,*) &#39;DEVSOL&#39;</span></div>
<div class="line"><span class="lineno">  693</span><span class="comment">!      WRITE(*,*) &#39;X &#39;,X</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a67c9c5eec2673298f1eb58a1310ab0a3" name="a67c9c5eec2673298f1eb58a1310ab0a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67c9c5eec2673298f1eb58a1310ab0a3">&#9670;&#160;</a></span>equdec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine equdec </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>ls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(n+<a class="el" href="ShipBellField_8cxx.html#a42d42dd2c682d42f11de58e34c89f895">m</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>india</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>nrkd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>nrkd2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decomposition of equilibrium systems. </p>
<pre class="fragment">N x N matrix C:     starting with sym.pos.def. matrix (N)
length  of array C: INDIA(N) + N*M + (M*M+M)/2
Content of array C: band matrix, as described by INDIA(1)...INDIA(N)
       followed by: NxM elements of constraint matrix A
       followed by: (M*M+M)/2 unused elements
                    INDIA(N+1)...INDIA(N+M) defined internally
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of symmetric matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>number of constrains </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ls</td><td>flag for skyline decomposition </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>combined variable-band + constraints matrix, replaced by decomposition </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">india</td><td>pointer array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nrkd</td><td>removed components </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nrkd2</td><td>removed components </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l02034">2034</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2035</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 2036</span> </div>
<div class="line"><span class="lineno"> 2037</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 2038</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 2039</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 2040</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jk</div>
<div class="line"><span class="lineno"> 2041</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno"> 2042</span> </div>
<div class="line"><span class="lineno"> 2043</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: n</div>
<div class="line"><span class="lineno"> 2044</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: m</div>
<div class="line"><span class="lineno"> 2045</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: ls    </div>
<div class="line"><span class="lineno"> 2046</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span> :: c(*)</div>
<div class="line"><span class="lineno"> 2047</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN OUT)</span>          :: india(n+m)</div>
<div class="line"><span class="lineno"> 2048</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>             :: nrkd</div>
<div class="line"><span class="lineno"> 2049</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>             :: nrkd2</div>
<div class="line"><span class="lineno"> 2050</span> </div>
<div class="line"><span class="lineno"> 2051</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 2052</span> </div>
<div class="line"><span class="lineno"> 2053</span>    nrkd=0</div>
<div class="line"><span class="lineno"> 2054</span>    nrkd2=0</div>
<div class="line"><span class="lineno"> 2055</span>    </div>
<div class="line"><span class="lineno"> 2056</span>    <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#ab49da2d76d818a3eb74c29ca64f3309d">lltdec</a>(n,c,india,nrkd,ls)             <span class="comment">! decomposition G G^T</span></div>
<div class="line"><span class="lineno"> 2057</span>    </div>
<div class="line"><span class="lineno"> 2058</span>    <span class="keywordflow">IF</span> (m&gt;0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2059</span>        <span class="keywordflow">DO</span> i=1,m</div>
<div class="line"><span class="lineno"> 2060</span>            <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#ae18e26bc0cb31b5a04fd171ca44b3b85">lltfwd</a>(n,c,india,c(india(n)+(i-1)*n+1)) <span class="comment">! forward solution K</span></div>
<div class="line"><span class="lineno"> 2061</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2062</span> </div>
<div class="line"><span class="lineno"> 2063</span>        jk=india(n)+n*m</div>
<div class="line"><span class="lineno"> 2064</span>        <span class="keywordflow">DO</span> j=1,m</div>
<div class="line"><span class="lineno"> 2065</span>            <span class="keywordflow">DO</span> k=1,j</div>
<div class="line"><span class="lineno"> 2066</span>                jk=jk+1</div>
<div class="line"><span class="lineno"> 2067</span>                c(jk)=0.0_mpd                                 <span class="comment">! product K K^T</span></div>
<div class="line"><span class="lineno"> 2068</span>                <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno"> 2069</span>                    c(jk)=c(jk)+c(india(n)+(j-1)*n+i)*c(india(n)+(k-1)*n+i)</div>
<div class="line"><span class="lineno"> 2070</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno"> 2071</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2072</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2073</span> </div>
<div class="line"><span class="lineno"> 2074</span>        india(n+1)=1</div>
<div class="line"><span class="lineno"> 2075</span>        <span class="keywordflow">DO</span> i=2,m</div>
<div class="line"><span class="lineno"> 2076</span>            india(n+i)=india(n+i-1)+min(i,m)              <span class="comment">! pointer for K K^T</span></div>
<div class="line"><span class="lineno"> 2077</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2078</span> </div>
<div class="line"><span class="lineno"> 2079</span>        <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#ab49da2d76d818a3eb74c29ca64f3309d">lltdec</a>(m,c(india(n)+n*m+1),india(n+1),nrkd2,0)  <span class="comment">! decomp. H H^T</span></div>
<div class="line"><span class="lineno"> 2080</span><span class="keywordflow">    ENDIF</span></div>
<div class="line"><span class="lineno"> 2081</span> </div>
<div class="line"><span class="lineno"> 2082</span>    <span class="keywordflow">RETURN</span></div>
<div class="ttc" id="ampnum_8f90_html_ab49da2d76d818a3eb74c29ca64f3309d"><div class="ttname"><a href="mpnum_8f90.html#ab49da2d76d818a3eb74c29ca64f3309d">lltdec</a></div><div class="ttdeci">subroutine lltdec(n, c, india, nrkd, iopt)</div><div class="ttdoc">LLT decomposition.</div><div class="ttdef"><b>Definition</b> <a href="mpnum_8f90_source.html#l01877">mpnum.f90:1878</a></div></div>
<div class="ttc" id="ampnum_8f90_html_ae18e26bc0cb31b5a04fd171ca44b3b85"><div class="ttname"><a href="mpnum_8f90.html#ae18e26bc0cb31b5a04fd171ca44b3b85">lltfwd</a></div><div class="ttdeci">subroutine lltfwd(n, c, india, x)</div><div class="ttdoc">Forward solution.</div><div class="ttdef"><b>Definition</b> <a href="mpnum_8f90_source.html#l01959">mpnum.f90:1960</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a52d41b509025b261281343ff5b243d3e" name="a52d41b509025b261281343ff5b243d3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52d41b509025b261281343ff5b243d3e">&#9670;&#160;</a></span>equslv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine equslv </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(n+<a class="el" href="ShipBellField_8cxx.html#a42d42dd2c682d42f11de58e34c89f895">m</a>), intent(in)&#160;</td>
          <td class="paramname"><em>india</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n+<a class="el" href="ShipBellField_8cxx.html#a42d42dd2c682d42f11de58e34c89f895">m</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solution of equilibrium systems (after decomposition). </p>
<pre class="fragment">N x N matrix C:     starting with sym.pos.def. matrix (N)
length  of array C: INDIA(N) + N*M + (M*M+M)/2
Content of array C: band matrix, as described by INDIA(1)...INDIA(N)
       followed by: NxM elements of constraint matrix A
       followed by: (M*M+M)/2 unused elements
                    INDIA(N+1)...INDIA(N+M) defined internally
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of symmetric matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>number of constrains </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>decomposed combined variable-band + constraints matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">india</td><td>pointer array </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>r.h.s vector B, replaced by solution vector X </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l02100">2100</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2101</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 2102</span> </div>
<div class="line"><span class="lineno"> 2103</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 2104</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 2105</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 2106</span> </div>
<div class="line"><span class="lineno"> 2107</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: n</div>
<div class="line"><span class="lineno"> 2108</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: m</div>
<div class="line"><span class="lineno"> 2109</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>     :: c(*)</div>
<div class="line"><span class="lineno"> 2110</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: india(n+m)</div>
<div class="line"><span class="lineno"> 2111</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span> :: x(n+m)</div>
<div class="line"><span class="lineno"> 2112</span>    </div>
<div class="line"><span class="lineno"> 2113</span>    <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#ae18e26bc0cb31b5a04fd171ca44b3b85">lltfwd</a>(n,c,india,x)                           <span class="comment">! result is u</span></div>
<div class="line"><span class="lineno"> 2114</span>        </div>
<div class="line"><span class="lineno"> 2115</span>    <span class="keywordflow">IF</span> (m&gt;0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2116</span>        <span class="keywordflow">DO</span> i=1,m</div>
<div class="line"><span class="lineno"> 2117</span>            <span class="keywordflow">DO</span> j=1,n</div>
<div class="line"><span class="lineno"> 2118</span>                x(n+i)=x(n+i)-x(j)*c(india(n)+(i-1)*n+j)         <span class="comment">! g - K u</span></div>
<div class="line"><span class="lineno"> 2119</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2120</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2121</span>        <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#ae18e26bc0cb31b5a04fd171ca44b3b85">lltfwd</a>(m,c(india(n)+n*m+1),india(n+1),x(n+1)) <span class="comment">! result is v</span></div>
<div class="line"><span class="lineno"> 2122</span> </div>
<div class="line"><span class="lineno"> 2123</span> </div>
<div class="line"><span class="lineno"> 2124</span>        <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#a938b3c14edfd0ebb1649e8758b253ede">lltbwd</a>(m,c(india(n)+n*m+1),india(n+1),x(n+1)) <span class="comment">! result is -y</span></div>
<div class="line"><span class="lineno"> 2125</span>        <span class="keywordflow">DO</span> i=1,m</div>
<div class="line"><span class="lineno"> 2126</span>            x(n+i)=-x(n+i)                                    <span class="comment">! result is +y</span></div>
<div class="line"><span class="lineno"> 2127</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2128</span> </div>
<div class="line"><span class="lineno"> 2129</span>        <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno"> 2130</span>            <span class="keywordflow">DO</span> j=1,m</div>
<div class="line"><span class="lineno"> 2131</span>                x(i)=x(i)-x(n+j)*c(india(n)+(j-1)*n+i)           <span class="comment">! u - K^T y</span></div>
<div class="line"><span class="lineno"> 2132</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2133</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2134</span><span class="keywordflow">    ENDIF</span></div>
<div class="line"><span class="lineno"> 2135</span>    </div>
<div class="line"><span class="lineno"> 2136</span>    <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#a938b3c14edfd0ebb1649e8758b253ede">lltbwd</a>(n,c,india,x)                           <span class="comment">! result is x</span></div>
<div class="line"><span class="lineno"> 2137</span>    </div>
<div class="line"><span class="lineno"> 2138</span>    <span class="keywordflow">RETURN</span></div>
<div class="ttc" id="ampnum_8f90_html_a938b3c14edfd0ebb1649e8758b253ede"><div class="ttname"><a href="mpnum_8f90.html#a938b3c14edfd0ebb1649e8758b253ede">lltbwd</a></div><div class="ttdeci">subroutine lltbwd(n, c, india, x)</div><div class="ttdoc">Backward solution.</div><div class="ttdef"><b>Definition</b> <a href="mpnum_8f90_source.html#l01994">mpnum.f90:1995</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59c0fd2fe612e6fb7c2b5b40b8e7762f" name="a59c0fd2fe612e6fb7c2b5b40b8e7762f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59c0fd2fe612e6fb7c2b5b40b8e7762f">&#9670;&#160;</a></span>heapf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine heapf </td>
          <td>(</td>
          <td class="paramtype">real(mps), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Heap sort direct (real). </p>
<p>Real keys A(*), sorted at return.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>array of keys </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>number of keys </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01467">1467</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1468</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1469</span> </div>
<div class="line"><span class="lineno"> 1470</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1471</span>    <span class="comment">!</span></div>
<div class="line"><span class="lineno"> 1472</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1473</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 1474</span>    <span class="keywordtype">INTEGER(mpi)</span> :: l</div>
<div class="line"><span class="lineno"> 1475</span>    <span class="keywordtype">INTEGER(mpi)</span> :: r</div>
<div class="line"><span class="lineno"> 1476</span><span class="keywordtype">    REAL</span>(mps) :: at    <span class="comment">! pivot key value</span></div>
<div class="line"><span class="lineno"> 1477</span> </div>
<div class="line"><span class="lineno"> 1478</span><span class="keywordtype">    REAL</span>(mps), <span class="keywordtype">INTENT(IN OUT)</span> :: a(*)</div>
<div class="line"><span class="lineno"> 1479</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>  :: n</div>
<div class="line"><span class="lineno"> 1480</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 1481</span>    <span class="keywordflow">IF</span>(n &lt;= 1) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno"> 1482</span>    l=n/2+1</div>
<div class="line"><span class="lineno"> 1483</span>    r=n</div>
<div class="line"><span class="lineno"> 1484</span>10  <span class="keywordflow">IF</span>(l &gt; 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1485</span>        l=l-1</div>
<div class="line"><span class="lineno"> 1486</span>        at  =a(l)</div>
<div class="line"><span class="lineno"> 1487</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1488</span>        at  =a(r)</div>
<div class="line"><span class="lineno"> 1489</span>        a(r)=a(1)</div>
<div class="line"><span class="lineno"> 1490</span>        r=r-1</div>
<div class="line"><span class="lineno"> 1491</span>        <span class="keywordflow">IF</span>(r == 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1492</span>            a(1)=at</div>
<div class="line"><span class="lineno"> 1493</span>            <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno"> 1494</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1495</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 1496</span>    i=l</div>
<div class="line"><span class="lineno"> 1497</span>    j=l+l</div>
<div class="line"><span class="lineno"> 1498</span>20  <span class="keywordflow">IF</span>(j &lt;= r) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1499</span>        <span class="keywordflow">IF</span>(j &lt; r) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1500</span>            <span class="keywordflow">IF</span>(a(j) &lt; a(j+1)) j=j+1</div>
<div class="line"><span class="lineno"> 1501</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1502</span>        <span class="keywordflow">IF</span>(at &lt; a(j)) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1503</span>            a(i)=a(j)</div>
<div class="line"><span class="lineno"> 1504</span>            i=j</div>
<div class="line"><span class="lineno"> 1505</span>            j=j+j</div>
<div class="line"><span class="lineno"> 1506</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1507</span>            j=r+1</div>
<div class="line"><span class="lineno"> 1508</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1509</span>        <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><span class="lineno"> 1510</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 1511</span>    a(i)=at</div>
<div class="line"><span class="lineno"> 1512</span>    <span class="keywordflow">GO TO</span> 10</div>
</div><!-- fragment -->
</div>
</div>
<a id="a938b3c14edfd0ebb1649e8758b253ede" name="a938b3c14edfd0ebb1649e8758b253ede"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a938b3c14edfd0ebb1649e8758b253ede">&#9670;&#160;</a></span>lltbwd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lltbwd </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>india</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Backward solution. </p>
<p>The matrix equation A X = B is solved by forward + backward solution. The matrix is assumed to decomposed before using LLTDEC. The array X(N) contains on entry the right-hand-side B(N); at return it contains the solution.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>decomposed variable-band matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">india</td><td>pointer array </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>r.h.s vector B, replaced by solution vector X </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01994">1994</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1995</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1996</span> </div>
<div class="line"><span class="lineno"> 1997</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1998</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 1999</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k   </div>
<div class="line"><span class="lineno"> 2000</span> </div>
<div class="line"><span class="lineno"> 2001</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: n</div>
<div class="line"><span class="lineno"> 2002</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>     :: c(*)</div>
<div class="line"><span class="lineno"> 2003</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: india(n)</div>
<div class="line"><span class="lineno"> 2004</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span> :: x(n)</div>
<div class="line"><span class="lineno"> 2005</span>    </div>
<div class="line"><span class="lineno"> 2006</span>    <span class="keywordflow">DO</span> k=n,2,-1                    <span class="comment">! backward loop</span></div>
<div class="line"><span class="lineno"> 2007</span>        x(k)=x(k)*c(india(k))</div>
<div class="line"><span class="lineno"> 2008</span>        <span class="keywordflow">DO</span> j=k-india(k)+india(k-1)+1,k-1</div>
<div class="line"><span class="lineno"> 2009</span>            x(j)=x(j)-c(india(k)-k+j)*x(k)  <span class="comment">! X_j := X_j - L_kj * X_k</span></div>
<div class="line"><span class="lineno"> 2010</span><span class="keywordflow">        END DO</span> <span class="comment">! J</span></div>
<div class="line"><span class="lineno"> 2011</span><span class="keywordflow">    END DO</span> <span class="comment">! K</span></div>
<div class="line"><span class="lineno"> 2012</span>    x(1)=x(1)*c(india(1))</div>
<div class="line"><span class="lineno"> 2013</span>    </div>
<div class="line"><span class="lineno"> 2014</span>    <span class="keywordflow">RETURN</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab49da2d76d818a3eb74c29ca64f3309d" name="ab49da2d76d818a3eb74c29ca64f3309d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab49da2d76d818a3eb74c29ca64f3309d">&#9670;&#160;</a></span>lltdec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lltdec </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>india</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>nrkd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>iopt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LLT decomposition. </p>
<p>Decomposition: C = L L^T.</p>
<p>Variable-band matrix row-Doolittle decomposition of pos. def. matrix. A variable-band NxN symmetric matrix, is stored row by row in the array C(.). For each row all coefficients from the first non-zero element in the row to the diagonal is stored. The pointer array INDIA(N) contains the indices in C(.) of the diagonal elements. INDIA(1) is always 1, and INDIA(N) is equal to the total number of coefficients stored, called the profile. The form of a variable-band matrix is preserved in the L D L^T decomposition. No fill-in is created ahead in any row or ahead of the first entry in any column, but existing zero-values will become non-zero. The decomposition is done "in-place". (The diagonal will contain the inverse of the diaginal of L).</p>
<ul>
<li>NRKD = 0 no component removed</li>
<li>NRKD &lt; 0 1 component removed, negative index</li>
<li>NRKD &gt; 1 number of</li>
</ul>
<p>The matrix C is assumed to be positive definite, e.g. from the normal equations of least squares. The (positive) diagonal elements are reduced during decomposition. If a diagonal element is reduced by about a word length (see line "test for linear dependence"), then the pivot is assumed as zero and the entire row/column is reset to zero, removing the corresponding element from the solution. Optionally use only diagonal element in this case to preserve rank (changing band to skyline matrix).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>variable-band matrix, replaced by L </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">india</td><td>pointer array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nrkd</td><td>removed components </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>&gt;0: use diagonal to preserve rank ('skyline') </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01877">1877</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1878</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1879</span> </div>
<div class="line"><span class="lineno"> 1880</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1881</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1882</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 1883</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno"> 1884</span>    <span class="keywordtype">INTEGER(mpi)</span> :: kj</div>
<div class="line"><span class="lineno"> 1885</span>    <span class="keywordtype">INTEGER(mpi)</span> :: mj</div>
<div class="line"><span class="lineno"> 1886</span>    <span class="keywordtype">INTEGER(mpi)</span> :: mk</div>
<div class="line"><span class="lineno"> 1887</span><span class="keywordtype">    REAL</span>(mpd) ::diag</div>
<div class="line"><span class="lineno"> 1888</span> </div>
<div class="line"><span class="lineno"> 1889</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: n</div>
<div class="line"><span class="lineno"> 1890</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span> :: c(*)</div>
<div class="line"><span class="lineno"> 1891</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: india(n)</div>
<div class="line"><span class="lineno"> 1892</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>             :: nrkd</div>
<div class="line"><span class="lineno"> 1893</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: iopt</div>
<div class="line"><span class="lineno"> 1894</span><span class="keywordtype">    REAL</span>(mpd) eps</div>
<div class="line"><span class="lineno"> 1895</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 1896</span>    eps = 16.0_mpd * epsilon(eps) <span class="comment">! 16 * precision(mpd) </span></div>
<div class="line"><span class="lineno"> 1897</span>      </div>
<div class="line"><span class="lineno"> 1898</span>    <span class="comment">!     ..</span></div>
<div class="line"><span class="lineno"> 1899</span>    nrkd=0</div>
<div class="line"><span class="lineno"> 1900</span>    diag=0.0_mpd</div>
<div class="line"><span class="lineno"> 1901</span>    <span class="keywordflow">IF</span>(c(india(1)) &gt; 0.0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1902</span>        c(india(1))=1.0_mpd/sqrt(c(india(1))) <span class="comment">! square root</span></div>
<div class="line"><span class="lineno"> 1903</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1904</span>        c(india(1))=0.0_mpd</div>
<div class="line"><span class="lineno"> 1905</span>        nrkd=-1</div>
<div class="line"><span class="lineno"> 1906</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 1907</span> </div>
<div class="line"><span class="lineno"> 1908</span>    <span class="keywordflow">DO</span> k=2,n</div>
<div class="line"><span class="lineno"> 1909</span>        mk=k-india(k)+india(k-1)+1    <span class="comment">! first index in row K</span></div>
<div class="line"><span class="lineno"> 1910</span>        <span class="keywordflow">DO</span> j=mk,k                     <span class="comment">! loop over row K with index J</span></div>
<div class="line"><span class="lineno"> 1911</span>            mj=1</div>
<div class="line"><span class="lineno"> 1912</span>            <span class="keywordflow">IF</span>(j &gt; 1) mj=j-india(j)+india(j-1)+1   <span class="comment">! first index in row J</span></div>
<div class="line"><span class="lineno"> 1913</span>            kj=india(k)-k+j              <span class="comment">! index kj</span></div>
<div class="line"><span class="lineno"> 1914</span>            diag=c(india(j))             <span class="comment">! j-th diagonal element</span></div>
<div class="line"><span class="lineno"> 1915</span>    </div>
<div class="line"><span class="lineno"> 1916</span>            <span class="keywordflow">DO</span> i=max(mj,mk),j-1</div>
<div class="line"><span class="lineno"> 1917</span>                <span class="comment">!        L_kj = L_kj - L_ki           *D_ii       *L_ji</span></div>
<div class="line"><span class="lineno"> 1918</span>                c(kj)=c(kj) - c(india(k)-k+i)*c(india(j)-j+i)</div>
<div class="line"><span class="lineno"> 1919</span><span class="keywordflow">            END DO</span> <span class="comment">! I</span></div>
<div class="line"><span class="lineno"> 1920</span>    </div>
<div class="line"><span class="lineno"> 1921</span>            <span class="keywordflow">IF</span>(j /= k) c(kj)=c(kj)*diag</div>
<div class="line"><span class="lineno"> 1922</span><span class="keywordflow">        END DO</span> <span class="comment">! J</span></div>
<div class="line"><span class="lineno"> 1923</span>  </div>
<div class="line"><span class="lineno"> 1924</span>        <span class="keywordflow">IF</span>(c(india(k)) &gt; eps*diag) <span class="keywordflow">THEN</span>      <span class="comment">! test for linear dependence</span></div>
<div class="line"><span class="lineno"> 1925</span>            c(india(k))=1.0_mpd/sqrt(c(india(k))) <span class="comment">! square root</span></div>
<div class="line"><span class="lineno"> 1926</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1927</span>            <span class="keywordflow">DO</span> j=mk,k                  <span class="comment">! reset row K</span></div>
<div class="line"><span class="lineno"> 1928</span>                c(india(k)-k+j)=0.0_mpd</div>
<div class="line"><span class="lineno"> 1929</span><span class="keywordflow">            END DO</span> <span class="comment">! J</span></div>
<div class="line"><span class="lineno"> 1930</span>            <span class="keywordflow">IF</span> (iopt &gt; 0 .and. diag &gt; 0.0) <span class="keywordflow">THEN</span> <span class="comment">! skyline</span></div>
<div class="line"><span class="lineno"> 1931</span>                c(india(k))=1.0_mpd/sqrt(diag) <span class="comment">! square root</span></div>
<div class="line"><span class="lineno"> 1932</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1933</span>                <span class="keywordflow">IF</span>(nrkd == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1934</span>                    nrkd=-k</div>
<div class="line"><span class="lineno"> 1935</span>                <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1936</span>                    <span class="keywordflow">IF</span>(nrkd &lt; 0) nrkd=1</div>
<div class="line"><span class="lineno"> 1937</span>                    nrkd=nrkd+1</div>
<div class="line"><span class="lineno"> 1938</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno"> 1939</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno"> 1940</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1941</span>  </div>
<div class="line"><span class="lineno"> 1942</span><span class="keywordflow">    END DO</span> <span class="comment">! K</span></div>
<div class="line"><span class="lineno"> 1943</span>    <span class="keywordflow">RETURN</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae18e26bc0cb31b5a04fd171ca44b3b85" name="ae18e26bc0cb31b5a04fd171ca44b3b85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae18e26bc0cb31b5a04fd171ca44b3b85">&#9670;&#160;</a></span>lltfwd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine lltfwd </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>india</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forward solution. </p>
<p>The matrix equation A X = B is solved by forward + backward solution. The matrix is assumed to decomposed before using LLTDEC. The array X(N) contains on entry the right-hand-side B(N); at return it contains the solution.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>decomposed variable-band matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">india</td><td>pointer array </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>r.h.s vector B, replaced by solution vector X </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01959">1959</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1960</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1961</span> </div>
<div class="line"><span class="lineno"> 1962</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1963</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 1964</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno"> 1965</span> </div>
<div class="line"><span class="lineno"> 1966</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: n</div>
<div class="line"><span class="lineno"> 1967</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>     :: c(*)</div>
<div class="line"><span class="lineno"> 1968</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: india(n)</div>
<div class="line"><span class="lineno"> 1969</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span> :: x(n)</div>
<div class="line"><span class="lineno"> 1970</span> </div>
<div class="line"><span class="lineno"> 1971</span>    x(1)=x(1)*c(india(1))</div>
<div class="line"><span class="lineno"> 1972</span>    <span class="keywordflow">DO</span> k=2,n                       <span class="comment">! forward loop</span></div>
<div class="line"><span class="lineno"> 1973</span>        <span class="keywordflow">DO</span> j=k-india(k)+india(k-1)+1,k-1</div>
<div class="line"><span class="lineno"> 1974</span>            x(k)=x(k)-c(india(k)-k+j)*x(j)  <span class="comment">! X_k := X_k - L_kj * B_j</span></div>
<div class="line"><span class="lineno"> 1975</span><span class="keywordflow">        END DO</span> <span class="comment">! J</span></div>
<div class="line"><span class="lineno"> 1976</span>        x(k)=x(k)*c(india(k))</div>
<div class="line"><span class="lineno"> 1977</span><span class="keywordflow">    END DO</span> <span class="comment">! K</span></div>
<div class="line"><span class="lineno"> 1978</span>    </div>
<div class="line"><span class="lineno"> 1979</span>    <span class="keywordflow">RETURN</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1be727b806123cdbd7ae0695df918243" name="a1be727b806123cdbd7ae0695df918243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1be727b806123cdbd7ae0695df918243">&#9670;&#160;</a></span>precon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine precon </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>cu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n,p), intent(inout)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension((p*p+p)/2), intent(out)&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>nrkd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constrained preconditioner, decomposition. </p>
<pre class="fragment">Constrained preconditioner, e.g for GMRES solution:

                                           intermediate
   (            )  (   )      (   )           (   )
   (   C    A^T )  ( x )   =  ( y )           ( u )
   (            )  (   )      (   )           (   )
   (   A     0  )  ( l )      ( d )           ( v )

input:
   C(N) is diagonal matrix and remains unchanged
        may be identical to CU(N), then it is changed
   A(N,P) is modified
   Y(N+P) is rhs vector, unchanged
        may be identical to X(N), then it is changed

result:
   CU(N) is 1/sqrt of diagonal matrix C(N)
   X(N+P) is result vector
   S((P*P+P)/2) is Cholesky decomposed symmetric (P,P) matrix
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>number of constraints </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of diagonal matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>diagonal matrix (changed if c=cu as actual parameters) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cu</td><td>1/sqrt(c) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>constraint matrix (size n*p), modified </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">s</td><td>Cholesky decomposed symmetric (P,P) matrix </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nrkd</td><td>removed components </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l02171">2171</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2172</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 2173</span> </div>
<div class="line"><span class="lineno"> 2174</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 2175</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 2176</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ii</div>
<div class="line"><span class="lineno"> 2177</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 2178</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jj</div>
<div class="line"><span class="lineno"> 2179</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jk</div>
<div class="line"><span class="lineno"> 2180</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno"> 2181</span>    <span class="keywordtype">INTEGER(mpi)</span> :: kk</div>
<div class="line"><span class="lineno"> 2182</span> </div>
<div class="line"><span class="lineno"> 2183</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: p</div>
<div class="line"><span class="lineno"> 2184</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: n</div>
<div class="line"><span class="lineno"> 2185</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>     :: c(n)</div>
<div class="line"><span class="lineno"> 2186</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>    :: cu(n)</div>
<div class="line"><span class="lineno"> 2187</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span> :: a(n,p)</div>
<div class="line"><span class="lineno"> 2188</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>    :: s((p*p+p)/2)</div>
<div class="line"><span class="lineno"> 2189</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span> :: nrkd</div>
<div class="line"><span class="lineno"> 2190</span> </div>
<div class="line"><span class="lineno"> 2191</span><span class="keywordtype">    REAL</span>(mpd) :: div</div>
<div class="line"><span class="lineno"> 2192</span><span class="keywordtype">    REAL</span>(mpd) :: ratio</div>
<div class="line"><span class="lineno"> 2193</span>    </div>
<div class="line"><span class="lineno"> 2194</span>    nrkd=0</div>
<div class="line"><span class="lineno"> 2195</span>    <span class="keywordflow">DO</span> i=1,(p*p+p)/2</div>
<div class="line"><span class="lineno"> 2196</span>        s(i)=0.0_mpd</div>
<div class="line"><span class="lineno"> 2197</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 2198</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno"> 2199</span>        jk=0</div>
<div class="line"><span class="lineno"> 2200</span>        div=c(i)                          <span class="comment">! copy</span></div>
<div class="line"><span class="lineno"> 2201</span>        <span class="keywordflow">IF</span> (div &gt; 0.0_mpd) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2202</span>            cu(i)=1.0_mpd/sqrt(div)</div>
<div class="line"><span class="lineno"> 2203</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 2204</span>            cu(i)=0.0_mpd</div>
<div class="line"><span class="lineno"> 2205</span>            nrkd=nrkd+1</div>
<div class="line"><span class="lineno"> 2206</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 2207</span>        <span class="keywordflow">DO</span> j=1,p</div>
<div class="line"><span class="lineno"> 2208</span>            a(i,j)=a(i,j)*cu(i)              <span class="comment">! K = A C^{-1/2}</span></div>
<div class="line"><span class="lineno"> 2209</span>            <span class="keywordflow">DO</span> k=1,j</div>
<div class="line"><span class="lineno"> 2210</span>                jk=jk+1</div>
<div class="line"><span class="lineno"> 2211</span>                s(jk)=s(jk)+a(i,j)*a(i,k)       <span class="comment">! S = symmetric matrix K K^T</span></div>
<div class="line"><span class="lineno"> 2212</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2213</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2214</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 2215</span> </div>
<div class="line"><span class="lineno"> 2216</span>    ii=0</div>
<div class="line"><span class="lineno"> 2217</span>    <span class="keywordflow">DO</span> i=1,p                           <span class="comment">! S -&gt; H D H^T (Cholesky)</span></div>
<div class="line"><span class="lineno"> 2218</span>        ii=ii+i</div>
<div class="line"><span class="lineno"> 2219</span>        <span class="keywordflow">IF</span>(s(ii) /= 0.0_mpd) s(ii)=1.0_mpd/s(ii)</div>
<div class="line"><span class="lineno"> 2220</span>        jj=ii</div>
<div class="line"><span class="lineno"> 2221</span>        <span class="keywordflow">DO</span> j=i+1,p</div>
<div class="line"><span class="lineno"> 2222</span>            ratio=s(i+jj)*s(ii)</div>
<div class="line"><span class="lineno"> 2223</span>            kk=jj</div>
<div class="line"><span class="lineno"> 2224</span>            <span class="keywordflow">DO</span> k=j,p</div>
<div class="line"><span class="lineno"> 2225</span>                s(kk+j)=s(kk+j)-s(kk+i)*ratio</div>
<div class="line"><span class="lineno"> 2226</span>                kk=kk+k</div>
<div class="line"><span class="lineno"> 2227</span><span class="keywordflow">            END DO</span> <span class="comment">! K</span></div>
<div class="line"><span class="lineno"> 2228</span>            s(i+jj)=ratio</div>
<div class="line"><span class="lineno"> 2229</span>            jj=jj+j</div>
<div class="line"><span class="lineno"> 2230</span><span class="keywordflow">        END DO</span> <span class="comment">! J</span></div>
<div class="line"><span class="lineno"> 2231</span><span class="keywordflow">    END DO</span> <span class="comment">! I</span></div>
<div class="line"><span class="lineno"> 2232</span>    <span class="keywordflow">RETURN</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6d1e48380366698fa934cf368cb0b4b" name="aa6d1e48380366698fa934cf368cb0b4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6d1e48380366698fa934cf368cb0b4b">&#9670;&#160;</a></span>presol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine presol </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>cu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n,p), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension((p*p+p)/2), intent(in)&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n+p), intent(out)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n+p), intent(in)&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constrained preconditioner, solution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>number of constraints </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of diagonal matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cu</td><td>1/sqrt(c) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>modified constraint matrix (size n*p) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Cholesky decomposed symmetric (P,P) matrix </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>result vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>rhs vector (changed if x=y as actual parameters) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l02245">2245</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2246</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 2247</span> </div>
<div class="line"><span class="lineno"> 2248</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 2249</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 2250</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 2251</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jj</div>
<div class="line"><span class="lineno"> 2252</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno"> 2253</span>    <span class="keywordtype">INTEGER(mpi)</span> :: kk</div>
<div class="line"><span class="lineno"> 2254</span> </div>
<div class="line"><span class="lineno"> 2255</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: p</div>
<div class="line"><span class="lineno"> 2256</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>              :: n</div>
<div class="line"><span class="lineno"> 2257</span>    </div>
<div class="line"><span class="lineno"> 2258</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>     :: cu(n)</div>
<div class="line"><span class="lineno"> 2259</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>     :: a(n,p)</div>
<div class="line"><span class="lineno"> 2260</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>     :: s((p*p+p)/2)</div>
<div class="line"><span class="lineno"> 2261</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>    :: x(n+p)</div>
<div class="line"><span class="lineno"> 2262</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN)</span>     :: y(n+p)</div>
<div class="line"><span class="lineno"> 2263</span> </div>
<div class="line"><span class="lineno"> 2264</span><span class="keywordtype">    REAL</span>(mpd) :: dsum</div>
<div class="line"><span class="lineno"> 2265</span> </div>
<div class="line"><span class="lineno"> 2266</span>    <span class="keywordflow">DO</span> i=1,n+p</div>
<div class="line"><span class="lineno"> 2267</span>        x(i)=y(i)</div>
<div class="line"><span class="lineno"> 2268</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 2269</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno"> 2270</span>        x(i)=x(i)*cu(i)                   <span class="comment">! u =C^{-1/2} y</span></div>
<div class="line"><span class="lineno"> 2271</span>        <span class="keywordflow">DO</span> j=1,p</div>
<div class="line"><span class="lineno"> 2272</span>            x(n+j)=x(n+j)-a(i,j)*x(i)        <span class="comment">! d - K u</span></div>
<div class="line"><span class="lineno"> 2273</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2274</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 2275</span> </div>
<div class="line"><span class="lineno"> 2276</span>    jj=0</div>
<div class="line"><span class="lineno"> 2277</span>    <span class="keywordflow">DO</span> j=1,p                           <span class="comment">! Cholesky solution for v</span></div>
<div class="line"><span class="lineno"> 2278</span>        dsum=x(n+j)</div>
<div class="line"><span class="lineno"> 2279</span>        <span class="keywordflow">DO</span> k=1,j-1</div>
<div class="line"><span class="lineno"> 2280</span>            dsum=dsum-s(k+jj)*x(n+k)           <span class="comment">! H v = d - K u</span></div>
<div class="line"><span class="lineno"> 2281</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2282</span>        x(n+j)=dsum                        <span class="comment">! -&gt; v</span></div>
<div class="line"><span class="lineno"> 2283</span>        jj=jj+j</div>
<div class="line"><span class="lineno"> 2284</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 2285</span> </div>
<div class="line"><span class="lineno"> 2286</span>    <span class="keywordflow">DO</span> j=p,1,-1                        <span class="comment">! solution for lambda</span></div>
<div class="line"><span class="lineno"> 2287</span>        dsum=x(n+j)*s(jj)</div>
<div class="line"><span class="lineno"> 2288</span>        kk=jj</div>
<div class="line"><span class="lineno"> 2289</span>        <span class="keywordflow">DO</span> k=j+1,p</div>
<div class="line"><span class="lineno"> 2290</span>            dsum=dsum+s(kk+j)*x(n+k)           <span class="comment">! D H^T lambda = -v</span></div>
<div class="line"><span class="lineno"> 2291</span>            kk=kk+k</div>
<div class="line"><span class="lineno"> 2292</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2293</span>        x(n+j)=-dsum                       <span class="comment">! -&gt; lambda</span></div>
<div class="line"><span class="lineno"> 2294</span>        jj=jj-j</div>
<div class="line"><span class="lineno"> 2295</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 2296</span> </div>
<div class="line"><span class="lineno"> 2297</span>    <span class="keywordflow">DO</span> i=1,n                           <span class="comment">! u - K^T lambda</span></div>
<div class="line"><span class="lineno"> 2298</span>        <span class="keywordflow">DO</span> j=1,p</div>
<div class="line"><span class="lineno"> 2299</span>            x(i)=x(i)-a(i,j)*x(n+j)</div>
<div class="line"><span class="lineno"> 2300</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2301</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 2302</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno"> 2303</span>        x(i)=x(i)*cu(i)                   <span class="comment">! x = C^{-1/2} u</span></div>
<div class="line"><span class="lineno"> 2304</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 2305</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8750c46a189254239c8be1f5f9f25554" name="a8750c46a189254239c8be1f5f9f25554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8750c46a189254239c8be1f5f9f25554">&#9670;&#160;</a></span>sort1k()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sort1k </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Quick sort 1. </p>
<p>Quick sort of A(1,N) integer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>vector of integers, sorted at return </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of vector </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01522">1522</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1523</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1524</span> </div>
<div class="line"><span class="lineno"> 1525</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1526</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nlev          <span class="comment">! stack size</span></div>
<div class="line"><span class="lineno"> 1527</span>    <a class="code hl_variable" href="namespacempdef.html#a867f0da7c7d6580a731013b8ec11a36a">parameter</a>(nlev=2*32) <span class="comment">! ... for N = 2**32 = 4.3 10**9</span></div>
<div class="line"><span class="lineno"> 1528</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1529</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 1530</span>    <span class="keywordtype">INTEGER(mpi)</span> :: l</div>
<div class="line"><span class="lineno"> 1531</span>    <span class="keywordtype">INTEGER(mpi)</span> :: r</div>
<div class="line"><span class="lineno"> 1532</span>    <span class="keywordtype">INTEGER(mpi)</span> :: lev</div>
<div class="line"><span class="lineno"> 1533</span>    <span class="keywordtype">INTEGER(mpi)</span> :: lr(nlev)</div>
<div class="line"><span class="lineno"> 1534</span>    <span class="keywordtype">INTEGER(mpi)</span> :: lrh</div>
<div class="line"><span class="lineno"> 1535</span>    <span class="keywordtype">INTEGER(mpi)</span> :: maxlev</div>
<div class="line"><span class="lineno"> 1536</span>    <span class="keywordtype">INTEGER(mpi)</span> :: a1    <span class="comment">! pivot key</span></div>
<div class="line"><span class="lineno"> 1537</span>    <span class="keywordtype">INTEGER(mpi)</span> :: at    <span class="comment">! pivot key</span></div>
<div class="line"><span class="lineno"> 1538</span> </div>
<div class="line"><span class="lineno"> 1539</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN OUT)</span> :: a(*)</div>
<div class="line"><span class="lineno"> 1540</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>     :: n</div>
<div class="line"><span class="lineno"> 1541</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 1542</span>    <span class="keywordflow">IF</span> (n &lt;= 0) <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno"> 1543</span>    maxlev=0</div>
<div class="line"><span class="lineno"> 1544</span>    lev=0</div>
<div class="line"><span class="lineno"> 1545</span>    l=1</div>
<div class="line"><span class="lineno"> 1546</span>    r=n</div>
<div class="line"><span class="lineno"> 1547</span>10  <span class="keywordflow">IF</span>(r-l == 1) <span class="keywordflow">THEN</span>     <span class="comment">! sort two elements L and R</span></div>
<div class="line"><span class="lineno"> 1548</span>        <span class="keywordflow">IF</span>(a(l) &gt; a(r)) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1549</span>            at=a(l)       <span class="comment">! exchange L &lt;-&gt; R</span></div>
<div class="line"><span class="lineno"> 1550</span>            a(l)=a(r)</div>
<div class="line"><span class="lineno"> 1551</span>            a(r)=at</div>
<div class="line"><span class="lineno"> 1552</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1553</span>        r=l</div>
<div class="line"><span class="lineno"> 1554</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 1555</span>    <span class="keywordflow">IF</span>(r == l) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1556</span>        <span class="keywordflow">IF</span>(lev &lt;= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1557</span>            <span class="comment">!            WRITE(*,*) &#39;SORT1K (quicksort): maxlevel used/available =&#39;,</span></div>
<div class="line"><span class="lineno"> 1558</span>            <span class="comment">!     +                 MAXLEV,&#39;/64&#39;</span></div>
<div class="line"><span class="lineno"> 1559</span>            <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno"> 1560</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1561</span>        lev=lev-2</div>
<div class="line"><span class="lineno"> 1562</span>        l=lr(lev+1)</div>
<div class="line"><span class="lineno"> 1563</span>        r=lr(lev+2)</div>
<div class="line"><span class="lineno"> 1564</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1565</span>        <span class="comment">!        LRH=(L+R)/2</span></div>
<div class="line"><span class="lineno"> 1566</span>        lrh=(l/2)+(r/2)          <span class="comment">! avoid bit overflow</span></div>
<div class="line"><span class="lineno"> 1567</span>        <span class="keywordflow">IF</span>(mod(l,2) == 1.AND.mod(r,2) == 1) lrh=lrh+1</div>
<div class="line"><span class="lineno"> 1568</span>        a1=a(lrh)      <span class="comment">! middle</span></div>
<div class="line"><span class="lineno"> 1569</span>        i=l-1            <span class="comment">! find limits [J,I] with [L,R]</span></div>
<div class="line"><span class="lineno"> 1570</span>        j=r+1</div>
<div class="line"><span class="lineno"> 1571</span>20      i=i+1</div>
<div class="line"><span class="lineno"> 1572</span>        <span class="keywordflow">IF</span>(a(i) &lt; a1) <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><span class="lineno"> 1573</span>30      j=j-1</div>
<div class="line"><span class="lineno"> 1574</span>        <span class="keywordflow">IF</span>(a(j) &gt; a1) <span class="keywordflow">GO TO</span> 30</div>
<div class="line"><span class="lineno"> 1575</span>        <span class="keywordflow">IF</span>(i &lt;= j) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1576</span>            at=a(i)     <span class="comment">! exchange I &lt;-&gt; J</span></div>
<div class="line"><span class="lineno"> 1577</span>            a(i)=a(j)</div>
<div class="line"><span class="lineno"> 1578</span>            a(j)=at</div>
<div class="line"><span class="lineno"> 1579</span>            <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><span class="lineno"> 1580</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1581</span>        <span class="keywordflow">IF</span>(lev+2 &gt; nlev) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1582</span>            <span class="keyword">CALL </span><a class="code hl_function" href="pede_8f90.html#a16ef8020d3ee5c0aa46a0cb5b1dceba8">peend</a>(33,<span class="stringliteral">&#39;Aborted, stack overflow in quicksort&#39;</span>)</div>
<div class="line"><span class="lineno"> 1583</span>            stop <span class="stringliteral">&#39;SORT1K (quicksort): stack overflow&#39;</span></div>
<div class="line"><span class="lineno"> 1584</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1585</span>        <span class="keywordflow">IF</span>(r-i &lt; j-l) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1586</span>            lr(lev+1)=l</div>
<div class="line"><span class="lineno"> 1587</span>            lr(lev+2)=j</div>
<div class="line"><span class="lineno"> 1588</span>            l=i</div>
<div class="line"><span class="lineno"> 1589</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1590</span>            lr(lev+1)=i</div>
<div class="line"><span class="lineno"> 1591</span>            lr(lev+2)=r</div>
<div class="line"><span class="lineno"> 1592</span>            r=j</div>
<div class="line"><span class="lineno"> 1593</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1594</span>        lev=lev+2</div>
<div class="line"><span class="lineno"> 1595</span>        maxlev=max(maxlev,lev)</div>
<div class="line"><span class="lineno"> 1596</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 1597</span>    <span class="keywordflow">GO TO</span> 10</div>
<div class="ttc" id="anamespacempdef_html_a867f0da7c7d6580a731013b8ec11a36a"><div class="ttname"><a href="namespacempdef.html#a867f0da7c7d6580a731013b8ec11a36a">mpdef::parameter</a></div><div class="ttdeci">integer, parameter parameter</div><div class="ttdef"><b>Definition</b> <a href="mpdef_8f90_source.html#l00034">mpdef.f90:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe21c37313ca7c9b8c16eec2d23c2f1a" name="afe21c37313ca7c9b8c16eec2d23c2f1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe21c37313ca7c9b8c16eec2d23c2f1a">&#9670;&#160;</a></span>sort2i()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sort2i </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), dimension(3,*), intent(inout)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Quick sort 2 with index. </p>
<p>Quick sort of A(3,N) integer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>vector (pair) of integers, sorted at return and an index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of vector </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01700">1700</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1701</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1702</span> </div>
<div class="line"><span class="lineno"> 1703</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1704</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nlev          <span class="comment">! stack size</span></div>
<div class="line"><span class="lineno"> 1705</span>    <a class="code hl_variable" href="namespacempdef.html#a867f0da7c7d6580a731013b8ec11a36a">parameter</a>(nlev=2*32) <span class="comment">! ... for N = 2**32 = 4.3 10**9</span></div>
<div class="line"><span class="lineno"> 1706</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1707</span>    <span class="keywordtype">INTEGER(mpi)</span> ::j</div>
<div class="line"><span class="lineno"> 1708</span>    <span class="keywordtype">INTEGER(mpi)</span> ::l</div>
<div class="line"><span class="lineno"> 1709</span>    <span class="keywordtype">INTEGER(mpi)</span> ::r</div>
<div class="line"><span class="lineno"> 1710</span>    <span class="keywordtype">INTEGER(mpi)</span> ::lev</div>
<div class="line"><span class="lineno"> 1711</span>    <span class="keywordtype">INTEGER(mpi)</span> ::lr(nlev)</div>
<div class="line"><span class="lineno"> 1712</span>    <span class="keywordtype">INTEGER(mpi)</span> ::lrh</div>
<div class="line"><span class="lineno"> 1713</span>    <span class="keywordtype">INTEGER(mpi)</span> ::maxlev</div>
<div class="line"><span class="lineno"> 1714</span>    <span class="keywordtype">INTEGER(mpi)</span> ::a1       <span class="comment">! pivot key</span></div>
<div class="line"><span class="lineno"> 1715</span>    <span class="keywordtype">INTEGER(mpi)</span> ::a2       <span class="comment">! pivot key</span></div>
<div class="line"><span class="lineno"> 1716</span>    <span class="keywordtype">INTEGER(mpi)</span> ::at       <span class="comment">! pivot key</span></div>
<div class="line"><span class="lineno"> 1717</span> </div>
<div class="line"><span class="lineno"> 1718</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN OUT)</span> :: a(3,*)</div>
<div class="line"><span class="lineno"> 1719</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>     :: n</div>
<div class="line"><span class="lineno"> 1720</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 1721</span>    maxlev=0</div>
<div class="line"><span class="lineno"> 1722</span>    lev=0</div>
<div class="line"><span class="lineno"> 1723</span>    l=1</div>
<div class="line"><span class="lineno"> 1724</span>    r=n</div>
<div class="line"><span class="lineno"> 1725</span>10  <span class="keywordflow">IF</span>(r-l == 1) <span class="keywordflow">THEN</span>     <span class="comment">! sort two elements L and R</span></div>
<div class="line"><span class="lineno"> 1726</span>        <span class="keywordflow">IF</span>(a(1,l) &gt; a(1,r).OR.( a(1,l) == a(1,r).AND.a(2,l) &gt; a(2,r))) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1727</span>            at=a(1,l)       <span class="comment">! exchange L &lt;-&gt; R</span></div>
<div class="line"><span class="lineno"> 1728</span>            a(1,l)=a(1,r)</div>
<div class="line"><span class="lineno"> 1729</span>            a(1,r)=at</div>
<div class="line"><span class="lineno"> 1730</span>            at=a(2,l)</div>
<div class="line"><span class="lineno"> 1731</span>            a(2,l)=a(2,r)</div>
<div class="line"><span class="lineno"> 1732</span>            a(2,r)=at</div>
<div class="line"><span class="lineno"> 1733</span>            at=a(3,l)</div>
<div class="line"><span class="lineno"> 1734</span>            a(3,l)=a(3,r)</div>
<div class="line"><span class="lineno"> 1735</span>            a(3,r)=at</div>
<div class="line"><span class="lineno"> 1736</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1737</span>        r=l</div>
<div class="line"><span class="lineno"> 1738</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 1739</span>    <span class="keywordflow">IF</span>(r == l) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1740</span>        <span class="keywordflow">IF</span>(lev &lt;= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1741</span>            <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;SORT2I (quicksort): maxlevel used/available =&#39;</span>, maxlev,<span class="stringliteral">&#39;/64&#39;</span></div>
<div class="line"><span class="lineno"> 1742</span>            <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno"> 1743</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1744</span>        lev=lev-2</div>
<div class="line"><span class="lineno"> 1745</span>        l=lr(lev+1)</div>
<div class="line"><span class="lineno"> 1746</span>        r=lr(lev+2)</div>
<div class="line"><span class="lineno"> 1747</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1748</span>        <span class="comment">!        LRH=(L+R)/2</span></div>
<div class="line"><span class="lineno"> 1749</span>        lrh=(l/2)+(r/2)          <span class="comment">! avoid bit overflow</span></div>
<div class="line"><span class="lineno"> 1750</span>        <span class="keywordflow">IF</span>(mod(l,2) == 1.AND.mod(r,2) == 1) lrh=lrh+1</div>
<div class="line"><span class="lineno"> 1751</span>        a1=a(1,lrh)      <span class="comment">! middle</span></div>
<div class="line"><span class="lineno"> 1752</span>        a2=a(2,lrh)</div>
<div class="line"><span class="lineno"> 1753</span>        i=l-1            <span class="comment">! find limits [J,I] with [L,R]</span></div>
<div class="line"><span class="lineno"> 1754</span>        j=r+1</div>
<div class="line"><span class="lineno"> 1755</span>20      i=i+1</div>
<div class="line"><span class="lineno"> 1756</span>        <span class="keywordflow">IF</span>(a(1,i) &lt; a1) <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><span class="lineno"> 1757</span>        <span class="keywordflow">IF</span>(a(1,i) == a1.AND.a(2,i) &lt; a2) <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><span class="lineno"> 1758</span>30      j=j-1</div>
<div class="line"><span class="lineno"> 1759</span>        <span class="keywordflow">IF</span>(a(1,j) &gt; a1) <span class="keywordflow">GO TO</span> 30</div>
<div class="line"><span class="lineno"> 1760</span>        <span class="keywordflow">IF</span>(a(1,j) == a1.AND.a(2,j) &gt; a2) <span class="keywordflow">GO TO</span> 30</div>
<div class="line"><span class="lineno"> 1761</span>        <span class="keywordflow">IF</span>(i &lt;= j) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1762</span>            at=a(1,i)     <span class="comment">! exchange I &lt;-&gt; J</span></div>
<div class="line"><span class="lineno"> 1763</span>            a(1,i)=a(1,j)</div>
<div class="line"><span class="lineno"> 1764</span>            a(1,j)=at</div>
<div class="line"><span class="lineno"> 1765</span>            at=a(2,i)</div>
<div class="line"><span class="lineno"> 1766</span>            a(2,i)=a(2,j)</div>
<div class="line"><span class="lineno"> 1767</span>            a(2,j)=at</div>
<div class="line"><span class="lineno"> 1768</span>            at=a(3,i)</div>
<div class="line"><span class="lineno"> 1769</span>            a(3,i)=a(3,j)</div>
<div class="line"><span class="lineno"> 1770</span>            a(3,j)=at</div>
<div class="line"><span class="lineno"> 1771</span>            <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><span class="lineno"> 1772</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1773</span>        <span class="keywordflow">IF</span>(lev+2 &gt; nlev) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1774</span>            <span class="keyword">CALL </span><a class="code hl_function" href="pede_8f90.html#a16ef8020d3ee5c0aa46a0cb5b1dceba8">peend</a>(33,<span class="stringliteral">&#39;Aborted, stack overflow in quicksort&#39;</span>)</div>
<div class="line"><span class="lineno"> 1775</span>            stop <span class="stringliteral">&#39;SORT2I (quicksort): stack overflow&#39;</span></div>
<div class="line"><span class="lineno"> 1776</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1777</span>        <span class="keywordflow">IF</span>(r-i &lt; j-l) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1778</span>            lr(lev+1)=l</div>
<div class="line"><span class="lineno"> 1779</span>            lr(lev+2)=j</div>
<div class="line"><span class="lineno"> 1780</span>            l=i</div>
<div class="line"><span class="lineno"> 1781</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1782</span>            lr(lev+1)=i</div>
<div class="line"><span class="lineno"> 1783</span>            lr(lev+2)=r</div>
<div class="line"><span class="lineno"> 1784</span>            r=j</div>
<div class="line"><span class="lineno"> 1785</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1786</span>        lev=lev+2</div>
<div class="line"><span class="lineno"> 1787</span>        maxlev=max(maxlev,lev)</div>
<div class="line"><span class="lineno"> 1788</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 1789</span>    <span class="keywordflow">GO TO</span> 10</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac95580af88f23895acfc53d125c8928a" name="ac95580af88f23895acfc53d125c8928a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac95580af88f23895acfc53d125c8928a">&#9670;&#160;</a></span>sort2k()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sort2k </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), dimension(2,*), intent(inout)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Quick sort 2. </p>
<p>Quick sort of A(2,N) integer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>vector (pair) of integers, sorted at return </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of vector </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01607">1607</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1608</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1609</span> </div>
<div class="line"><span class="lineno"> 1610</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1611</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nlev          <span class="comment">! stack size</span></div>
<div class="line"><span class="lineno"> 1612</span>    <a class="code hl_variable" href="namespacempdef.html#a867f0da7c7d6580a731013b8ec11a36a">parameter</a>(nlev=2*32) <span class="comment">! ... for N = 2**32 = 4.3 10**9</span></div>
<div class="line"><span class="lineno"> 1613</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 1614</span>    <span class="keywordtype">INTEGER(mpi)</span> ::j</div>
<div class="line"><span class="lineno"> 1615</span>    <span class="keywordtype">INTEGER(mpi)</span> ::l</div>
<div class="line"><span class="lineno"> 1616</span>    <span class="keywordtype">INTEGER(mpi)</span> ::r</div>
<div class="line"><span class="lineno"> 1617</span>    <span class="keywordtype">INTEGER(mpi)</span> ::lev</div>
<div class="line"><span class="lineno"> 1618</span>    <span class="keywordtype">INTEGER(mpi)</span> ::lr(nlev)</div>
<div class="line"><span class="lineno"> 1619</span>    <span class="keywordtype">INTEGER(mpi)</span> ::lrh</div>
<div class="line"><span class="lineno"> 1620</span>    <span class="keywordtype">INTEGER(mpi)</span> ::maxlev</div>
<div class="line"><span class="lineno"> 1621</span>    <span class="keywordtype">INTEGER(mpi)</span> ::a1       <span class="comment">! pivot key</span></div>
<div class="line"><span class="lineno"> 1622</span>    <span class="keywordtype">INTEGER(mpi)</span> ::a2       <span class="comment">! pivot key</span></div>
<div class="line"><span class="lineno"> 1623</span>    <span class="keywordtype">INTEGER(mpi)</span> ::at       <span class="comment">! pivot key</span></div>
<div class="line"><span class="lineno"> 1624</span> </div>
<div class="line"><span class="lineno"> 1625</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN OUT)</span> :: a(2,*)</div>
<div class="line"><span class="lineno"> 1626</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>     :: n</div>
<div class="line"><span class="lineno"> 1627</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 1628</span>    maxlev=0</div>
<div class="line"><span class="lineno"> 1629</span>    lev=0</div>
<div class="line"><span class="lineno"> 1630</span>    l=1</div>
<div class="line"><span class="lineno"> 1631</span>    r=n</div>
<div class="line"><span class="lineno"> 1632</span>10  <span class="keywordflow">IF</span>(r-l == 1) <span class="keywordflow">THEN</span>     <span class="comment">! sort two elements L and R</span></div>
<div class="line"><span class="lineno"> 1633</span>        <span class="keywordflow">IF</span>(a(1,l) &gt; a(1,r).OR.( a(1,l) == a(1,r).AND.a(2,l) &gt; a(2,r))) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1634</span>            at=a(1,l)       <span class="comment">! exchange L &lt;-&gt; R</span></div>
<div class="line"><span class="lineno"> 1635</span>            a(1,l)=a(1,r)</div>
<div class="line"><span class="lineno"> 1636</span>            a(1,r)=at</div>
<div class="line"><span class="lineno"> 1637</span>            at=a(2,l)</div>
<div class="line"><span class="lineno"> 1638</span>            a(2,l)=a(2,r)</div>
<div class="line"><span class="lineno"> 1639</span>            a(2,r)=at</div>
<div class="line"><span class="lineno"> 1640</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1641</span>        r=l</div>
<div class="line"><span class="lineno"> 1642</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 1643</span>    <span class="keywordflow">IF</span>(r == l) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1644</span>        <span class="keywordflow">IF</span>(lev &lt;= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1645</span>            <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;SORT2K (quicksort): maxlevel used/available =&#39;</span>, maxlev,<span class="stringliteral">&#39;/64&#39;</span></div>
<div class="line"><span class="lineno"> 1646</span>            <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno"> 1647</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1648</span>        lev=lev-2</div>
<div class="line"><span class="lineno"> 1649</span>        l=lr(lev+1)</div>
<div class="line"><span class="lineno"> 1650</span>        r=lr(lev+2)</div>
<div class="line"><span class="lineno"> 1651</span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1652</span>        <span class="comment">!        LRH=(L+R)/2</span></div>
<div class="line"><span class="lineno"> 1653</span>        lrh=(l/2)+(r/2)          <span class="comment">! avoid bit overflow</span></div>
<div class="line"><span class="lineno"> 1654</span>        <span class="keywordflow">IF</span>(mod(l,2) == 1.AND.mod(r,2) == 1) lrh=lrh+1</div>
<div class="line"><span class="lineno"> 1655</span>        a1=a(1,lrh)      <span class="comment">! middle</span></div>
<div class="line"><span class="lineno"> 1656</span>        a2=a(2,lrh)</div>
<div class="line"><span class="lineno"> 1657</span>        i=l-1            <span class="comment">! find limits [J,I] with [L,R]</span></div>
<div class="line"><span class="lineno"> 1658</span>        j=r+1</div>
<div class="line"><span class="lineno"> 1659</span>20      i=i+1</div>
<div class="line"><span class="lineno"> 1660</span>        <span class="keywordflow">IF</span>(a(1,i) &lt; a1) <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><span class="lineno"> 1661</span>        <span class="keywordflow">IF</span>(a(1,i) == a1.AND.a(2,i) &lt; a2) <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><span class="lineno"> 1662</span>30      j=j-1</div>
<div class="line"><span class="lineno"> 1663</span>        <span class="keywordflow">IF</span>(a(1,j) &gt; a1) <span class="keywordflow">GO TO</span> 30</div>
<div class="line"><span class="lineno"> 1664</span>        <span class="keywordflow">IF</span>(a(1,j) == a1.AND.a(2,j) &gt; a2) <span class="keywordflow">GO TO</span> 30</div>
<div class="line"><span class="lineno"> 1665</span>        <span class="keywordflow">IF</span>(i &lt;= j) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1666</span>            at=a(1,i)     <span class="comment">! exchange I &lt;-&gt; J</span></div>
<div class="line"><span class="lineno"> 1667</span>            a(1,i)=a(1,j)</div>
<div class="line"><span class="lineno"> 1668</span>            a(1,j)=at</div>
<div class="line"><span class="lineno"> 1669</span>            at=a(2,i)</div>
<div class="line"><span class="lineno"> 1670</span>            a(2,i)=a(2,j)</div>
<div class="line"><span class="lineno"> 1671</span>            a(2,j)=at</div>
<div class="line"><span class="lineno"> 1672</span>            <span class="keywordflow">GO TO</span> 20</div>
<div class="line"><span class="lineno"> 1673</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1674</span>        <span class="keywordflow">IF</span>(lev+2 &gt; nlev) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1675</span>            <span class="keyword">CALL </span><a class="code hl_function" href="pede_8f90.html#a16ef8020d3ee5c0aa46a0cb5b1dceba8">peend</a>(33,<span class="stringliteral">&#39;Aborted, stack overflow in quicksort&#39;</span>)</div>
<div class="line"><span class="lineno"> 1676</span>            stop <span class="stringliteral">&#39;SORT2K (quicksort): stack overflow&#39;</span></div>
<div class="line"><span class="lineno"> 1677</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1678</span>        <span class="keywordflow">IF</span>(r-i &lt; j-l) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 1679</span>            lr(lev+1)=l</div>
<div class="line"><span class="lineno"> 1680</span>            lr(lev+2)=j</div>
<div class="line"><span class="lineno"> 1681</span>            l=i</div>
<div class="line"><span class="lineno"> 1682</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 1683</span>            lr(lev+1)=i</div>
<div class="line"><span class="lineno"> 1684</span>            lr(lev+2)=r</div>
<div class="line"><span class="lineno"> 1685</span>            r=j</div>
<div class="line"><span class="lineno"> 1686</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 1687</span>        lev=lev+2</div>
<div class="line"><span class="lineno"> 1688</span>        maxlev=max(maxlev,lev)</div>
<div class="line"><span class="lineno"> 1689</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 1690</span>    <span class="keywordflow">GO TO</span> 10</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9723a1127567d1d778894b985a921286" name="a9723a1127567d1d778894b985a921286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9723a1127567d1d778894b985a921286">&#9670;&#160;</a></span>sqmibb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sqmibb </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>nbdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>nbnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>nrank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n*(nbnd+1)), intent(out)&#160;</td>
          <td class="paramname"><em>vbnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n*nbdr), intent(out)&#160;</td>
          <td class="paramname"><em>vbdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n*nbdr), intent(out)&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension((nbdr*nbdr+nbdr)/2), intent(out)&#160;</td>
          <td class="paramname"><em>vbk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(nbdr), intent(out)&#160;</td>
          <td class="paramname"><em>vzru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(nbdr), intent(out)&#160;</td>
          <td class="paramname"><em>scdiag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(nbdr), intent(out)&#160;</td>
          <td class="paramname"><em>scflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Bordered band matrix. </p>
<p>Obtain solution of a system of linear equations with symmetric bordered band matrix (V * X = B), on request inverse is calculated. For band part root-free Cholesky decomposition and forward/backward substitution is used.</p>
<p>Use decomposition in border and band part for block matrix algebra: </p><pre class="fragment">| A  Ct |   | x1 |   | b1 |        , A  is the border part
|       | * |    | = |    |        , Ct is the mixed part
| C  D  |   | x2 |   | b2 |        , D  is the band part
</pre><p> Explicit inversion of D is avoided by using solution X of D*X=C (X=D^-1*C, obtained from Cholesky decomposition and forward/backward substitution) </p><pre class="fragment">| x1 |   | E*b1 - E*Xt*b2 |        , E^-1 = A-Ct*D^-1*C = A-Ct*X
|    | = |                |
| x2 |   |  x   - X*x1    |        , x is solution of D*x=b2 (x=D^-1*b2)
</pre><p> Inverse matrix is: </p><pre class="fragment">|  E   -E*Xt          |
|                     |            , only band part of (D^-1 + X*E*Xt)
| -X*E  D^-1 + X*E*Xt |              is calculated for inv=1
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">v</td><td>symmetric N-by-N matrix in symmetric storage mode (V(1) = V11, V(2) = V12, V(3) = V22, V(4) = V13, ...), replaced by inverse matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">b</td><td>N-vector, replaced by solution vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of V, B </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbdr</td><td>border size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbnd</td><td>band width </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inv</td><td>=1 calculate band part of inverse (for pulls), &gt;1 calculate complete inverse </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nrank</td><td>rank of matrix V </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vbnd</td><td>band part of V </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vbdr</td><td>border part of V </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">aux</td><td>solutions for border rows </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vbk</td><td>matrix for border solution </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vzru</td><td>border solution </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scdiag</td><td>workspace (D) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scflag</td><td>workspace (I) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l02354">2354</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2355</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 2356</span> </div>
<div class="line"><span class="lineno"> 2357</span>    <span class="comment">! REAL(mpd) scratch arrays:</span></div>
<div class="line"><span class="lineno"> 2358</span>    <span class="comment">!     VBND(N*(NBND+1)) = storage of band   part</span></div>
<div class="line"><span class="lineno"> 2359</span>    <span class="comment">!     VBDR(N* NBDR)    = storage of border part</span></div>
<div class="line"><span class="lineno"> 2360</span>    <span class="comment">!     AUX (N* NBDR)    = intermediate results</span></div>
<div class="line"><span class="lineno"> 2361</span> </div>
<div class="line"><span class="lineno"> 2362</span>    <span class="comment">! cost[dot ops] ~= (N-NBDR)*(NBDR+NBND+1)**2 + NBDR**3/3 (leading term, solution only)</span></div>
<div class="line"><span class="lineno"> 2363</span> </div>
<div class="line"><span class="lineno"> 2364</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 2365</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 2366</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ib</div>
<div class="line"><span class="lineno"> 2367</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ij</div>
<div class="line"><span class="lineno"> 2368</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ioff</div>
<div class="line"><span class="lineno"> 2369</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ip</div>
<div class="line"><span class="lineno"> 2370</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ip1</div>
<div class="line"><span class="lineno"> 2371</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ip2</div>
<div class="line"><span class="lineno"> 2372</span>    <span class="keywordtype">INTEGER(mpi)</span> :: is</div>
<div class="line"><span class="lineno"> 2373</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 2374</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j0</div>
<div class="line"><span class="lineno"> 2375</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jb</div>
<div class="line"><span class="lineno"> 2376</span>    <span class="keywordtype">INTEGER(mpi)</span> :: joff</div>
<div class="line"><span class="lineno"> 2377</span>    <span class="keywordtype">INTEGER(mpi)</span> :: mp1</div>
<div class="line"><span class="lineno"> 2378</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nb1</div>
<div class="line"><span class="lineno"> 2379</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nmb</div>
<div class="line"><span class="lineno"> 2380</span>    <span class="keywordtype">INTEGER(mpi)</span> :: npri</div>
<div class="line"><span class="lineno"> 2381</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nrankb</div>
<div class="line"><span class="lineno"> 2382</span> </div>
<div class="line"><span class="lineno"> 2383</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: v(*)</div>
<div class="line"><span class="lineno"> 2384</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: b(n)</div>
<div class="line"><span class="lineno"> 2385</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno"> 2386</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: nbdr</div>
<div class="line"><span class="lineno"> 2387</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: nbnd</div>
<div class="line"><span class="lineno"> 2388</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: inv</div>
<div class="line"><span class="lineno"> 2389</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: nrank</div>
<div class="line"><span class="lineno"> 2390</span> </div>
<div class="line"><span class="lineno"> 2391</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: vbnd(n*(nbnd+1))</div>
<div class="line"><span class="lineno"> 2392</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: vbdr(n*nbdr)</div>
<div class="line"><span class="lineno"> 2393</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: aux(n*nbdr)</div>
<div class="line"><span class="lineno"> 2394</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: vbk((nbdr*nbdr+nbdr)/2)</div>
<div class="line"><span class="lineno"> 2395</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: vzru(nbdr)</div>
<div class="line"><span class="lineno"> 2396</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: scdiag(nbdr)</div>
<div class="line"><span class="lineno"> 2397</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>          :: scflag(nbdr)</div>
<div class="line"><span class="lineno"> 2398</span> </div>
<div class="line"><span class="lineno"> 2399</span>    <span class="keywordtype">SAVE</span> npri</div>
<div class="line"><span class="lineno"> 2400</span>    <span class="keyword">DATA</span> npri / 100 /</div>
<div class="line"><span class="lineno"> 2401</span>    <span class="comment">!           ...</span></div>
<div class="line"><span class="lineno"> 2402</span>    nrank=0</div>
<div class="line"><span class="lineno"> 2403</span>    nb1=nbdr+1</div>
<div class="line"><span class="lineno"> 2404</span>    mp1=nbnd+1</div>
<div class="line"><span class="lineno"> 2405</span>    nmb=n-nbdr</div>
<div class="line"><span class="lineno"> 2406</span>    <span class="comment">!     copy band part</span></div>
<div class="line"><span class="lineno"> 2407</span>    <span class="keywordflow">DO</span> i=nb1,n</div>
<div class="line"><span class="lineno"> 2408</span>        ip=(i*(i+1))/2</div>
<div class="line"><span class="lineno"> 2409</span>        is=0</div>
<div class="line"><span class="lineno"> 2410</span>        <span class="keywordflow">DO</span> j=i,min(n,i+nbnd)</div>
<div class="line"><span class="lineno"> 2411</span>            ip=ip+is</div>
<div class="line"><span class="lineno"> 2412</span>            is=j</div>
<div class="line"><span class="lineno"> 2413</span>            ib=j-i+1</div>
<div class="line"><span class="lineno"> 2414</span>            vbnd(ib+(i-nb1)*mp1)=v(ip)</div>
<div class="line"><span class="lineno"> 2415</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2416</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 2417</span>    <span class="comment">!     copy border part</span></div>
<div class="line"><span class="lineno"> 2418</span>    <span class="keywordflow">IF</span> (nbdr &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2419</span>        ioff=0</div>
<div class="line"><span class="lineno"> 2420</span>        <span class="keywordflow">DO</span> i=1,nbdr</div>
<div class="line"><span class="lineno"> 2421</span>            ip=(i*(i+1))/2</div>
<div class="line"><span class="lineno"> 2422</span>            is=0</div>
<div class="line"><span class="lineno"> 2423</span>            <span class="keywordflow">DO</span> j=i,n</div>
<div class="line"><span class="lineno"> 2424</span>                ip=ip+is</div>
<div class="line"><span class="lineno"> 2425</span>                is=j</div>
<div class="line"><span class="lineno"> 2426</span>                vbdr(ioff+j)=v(ip)</div>
<div class="line"><span class="lineno"> 2427</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2428</span>            ioff=ioff+n</div>
<div class="line"><span class="lineno"> 2429</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2430</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 2431</span> </div>
<div class="line"><span class="lineno"> 2432</span>    <span class="keyword">CALL </span><a class="code hl_function" href="Dbandmatrix_8f90.html#a7082e5556fcc5d9aa30386f057f1b668">dbcdec</a>(vbnd,mp1,nmb,aux)</div>
<div class="line"><span class="lineno"> 2433</span>    <span class="comment">! use? CALL DBFDEC(VBND,MP1,NMB) ! modified decomp., numerically more stable</span></div>
<div class="line"><span class="lineno"> 2434</span>    <span class="comment">!      CALL DBCPRB(VBND,MP1,NMB)</span></div>
<div class="line"><span class="lineno"> 2435</span>    ip=1</div>
<div class="line"><span class="lineno"> 2436</span>    <span class="keywordflow">DO</span> i=1, nmb</div>
<div class="line"><span class="lineno"> 2437</span>        <span class="keywordflow">IF</span> (vbnd(ip) &lt;= 0.0_mpd) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2438</span>            npri=npri-1</div>
<div class="line"><span class="lineno"> 2439</span>            <span class="keywordflow">IF</span> (npri &gt;= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2440</span>                <span class="keywordflow">IF</span> (vbnd(ip) == 0.0_mpd) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2441</span>                    print *, <span class="stringliteral">&#39; SQMIBB matrix singular&#39;</span>, n, nbdr, nbnd</div>
<div class="line"><span class="lineno"> 2442</span>                <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 2443</span>                    print *, <span class="stringliteral">&#39; SQMIBB matrix not positive definite&#39;</span>, n, nbdr, nbnd</div>
<div class="line"><span class="lineno"> 2444</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno"> 2445</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno"> 2446</span>            <span class="comment">!           return zeros</span></div>
<div class="line"><span class="lineno"> 2447</span>            <span class="keywordflow">DO</span> ip=1,n</div>
<div class="line"><span class="lineno"> 2448</span>                b(ip)=0.0_mpd</div>
<div class="line"><span class="lineno"> 2449</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2450</span>            <span class="keywordflow">DO</span> ip=1,(n*n+n)/2</div>
<div class="line"><span class="lineno"> 2451</span>                v(ip)=0.0_mpd</div>
<div class="line"><span class="lineno"> 2452</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2453</span>            <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno"> 2454</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 2455</span>        ip=ip+mp1</div>
<div class="line"><span class="lineno"> 2456</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 2457</span>    nrank=nmb</div>
<div class="line"><span class="lineno"> 2458</span> </div>
<div class="line"><span class="lineno"> 2459</span>    <span class="keywordflow">IF</span> (nbdr == 0) <span class="keywordflow">THEN</span> <span class="comment">! special case NBDR=0</span></div>
<div class="line"><span class="lineno"> 2460</span>  </div>
<div class="line"><span class="lineno"> 2461</span>        <span class="keyword">CALL </span>dbcslv(vbnd,mp1,nmb,b,b)</div>
<div class="line"><span class="lineno"> 2462</span>        <span class="keywordflow">IF</span> (inv &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2463</span>            <span class="keywordflow">IF</span> (inv &gt; 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2464</span>                <span class="keyword">CALL </span>dbcinv(vbnd,mp1,nmb,v)</div>
<div class="line"><span class="lineno"> 2465</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 2466</span>                <span class="keyword">CALL </span>dbcinb(vbnd,mp1,nmb,v)</div>
<div class="line"><span class="lineno"> 2467</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno"> 2468</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 2469</span>  </div>
<div class="line"><span class="lineno"> 2470</span>    <span class="keywordflow">ELSE</span> <span class="comment">! general case NBDR&gt;0</span></div>
<div class="line"><span class="lineno"> 2471</span>  </div>
<div class="line"><span class="lineno"> 2472</span>        ioff=nb1</div>
<div class="line"><span class="lineno"> 2473</span>        <span class="keywordflow">DO</span> ib=1,nbdr</div>
<div class="line"><span class="lineno"> 2474</span>            <span class="comment">!           solve for aux. vectors</span></div>
<div class="line"><span class="lineno"> 2475</span>            <span class="keyword">CALL </span>dbcslv(vbnd,mp1,nmb,vbdr(ioff),aux(ioff))</div>
<div class="line"><span class="lineno"> 2476</span>            <span class="comment">!           zT ru</span></div>
<div class="line"><span class="lineno"> 2477</span>            vzru(ib)=b(ib)</div>
<div class="line"><span class="lineno"> 2478</span>            <span class="keywordflow">DO</span> i=0,nmb-1</div>
<div class="line"><span class="lineno"> 2479</span>                vzru(ib)=vzru(ib)-b(nb1+i)*aux(ioff+i)</div>
<div class="line"><span class="lineno"> 2480</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2481</span>            ioff=ioff+n</div>
<div class="line"><span class="lineno"> 2482</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2483</span>        <span class="comment">!        solve for band part only</span></div>
<div class="line"><span class="lineno"> 2484</span>        <span class="keyword">CALL </span>dbcslv(vbnd,mp1,nmb,b(nb1),b(nb1))</div>
<div class="line"><span class="lineno"> 2485</span>        <span class="comment">!        Ck - cT z</span></div>
<div class="line"><span class="lineno"> 2486</span>        ip=0</div>
<div class="line"><span class="lineno"> 2487</span>        ioff=nb1</div>
<div class="line"><span class="lineno"> 2488</span>        <span class="keywordflow">DO</span> ib=1,nbdr</div>
<div class="line"><span class="lineno"> 2489</span>            joff=nb1</div>
<div class="line"><span class="lineno"> 2490</span>            <span class="keywordflow">DO</span> jb=1,ib</div>
<div class="line"><span class="lineno"> 2491</span>                ip=ip+1</div>
<div class="line"><span class="lineno"> 2492</span>                vbk(ip)=v(ip)</div>
<div class="line"><span class="lineno"> 2493</span>                <span class="keywordflow">DO</span> i=0,nmb-1</div>
<div class="line"><span class="lineno"> 2494</span>                    vbk(ip)=vbk(ip)-vbdr(ioff+i)*aux(joff+i)</div>
<div class="line"><span class="lineno"> 2495</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno"> 2496</span>                joff=joff+n</div>
<div class="line"><span class="lineno"> 2497</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2498</span>            ioff=ioff+n</div>
<div class="line"><span class="lineno"> 2499</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2500</span>        <span class="comment">!        solve border part</span></div>
<div class="line"><span class="lineno"> 2501</span>        <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#a92f02ed4dc87864fa0b65cec04e4c9e3">sqminv</a>(vbk,vzru,nbdr,nrankb,scdiag,scflag)</div>
<div class="line"><span class="lineno"> 2502</span>        <span class="keywordflow">IF</span> (nrankb == nbdr) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2503</span>            nrank=nrank+nbdr</div>
<div class="line"><span class="lineno"> 2504</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 2505</span>            npri=npri-1</div>
<div class="line"><span class="lineno"> 2506</span>            <span class="keywordflow">IF</span> (npri &gt;= 0) print *, <span class="stringliteral">&#39; SQMIBB undef border &#39;</span>, n, nbdr, nbnd, nrankb</div>
<div class="line"><span class="lineno"> 2507</span>            <span class="keywordflow">DO</span> ib=1,nbdr</div>
<div class="line"><span class="lineno"> 2508</span>                vzru(ib)=0.0_mpd</div>
<div class="line"><span class="lineno"> 2509</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2510</span>            <span class="keywordflow">DO</span> ip=(nbdr*nbdr+nbdr)/2,1,-1</div>
<div class="line"><span class="lineno"> 2511</span>                vbk(ip)=0.0_mpd</div>
<div class="line"><span class="lineno"> 2512</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2513</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 2514</span>        <span class="comment">!        smoothed data points</span></div>
<div class="line"><span class="lineno"> 2515</span>        ioff=nb1</div>
<div class="line"><span class="lineno"> 2516</span>        <span class="keywordflow">DO</span> ib=1, nbdr</div>
<div class="line"><span class="lineno"> 2517</span>            b(ib) = vzru(ib)</div>
<div class="line"><span class="lineno"> 2518</span>            <span class="keywordflow">DO</span> i=0,nmb-1</div>
<div class="line"><span class="lineno"> 2519</span>                b(nb1+i)=b(nb1+i)-b(ib)*aux(ioff+i)</div>
<div class="line"><span class="lineno"> 2520</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2521</span>            ioff=ioff+n</div>
<div class="line"><span class="lineno"> 2522</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2523</span>        <span class="comment">!        inverse requested ?</span></div>
<div class="line"><span class="lineno"> 2524</span>        <span class="keywordflow">IF</span> (inv &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2525</span>            <span class="keywordflow">IF</span> (inv &gt; 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2526</span>                <span class="keyword">CALL </span>dbcinv(vbnd,mp1,nmb,v)</div>
<div class="line"><span class="lineno"> 2527</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 2528</span>                <span class="keyword">CALL </span>dbcinb(vbnd,mp1,nmb,v)</div>
<div class="line"><span class="lineno"> 2529</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno"> 2530</span>            <span class="comment">!           expand/correct from NMB to N</span></div>
<div class="line"><span class="lineno"> 2531</span>            ip1=(nmb*nmb+nmb)/2</div>
<div class="line"><span class="lineno"> 2532</span>            ip2=(n*n+n)/2</div>
<div class="line"><span class="lineno"> 2533</span>            <span class="keywordflow">DO</span> i=nmb-1,0,-1</div>
<div class="line"><span class="lineno"> 2534</span>                j0=0</div>
<div class="line"><span class="lineno"> 2535</span>                <span class="keywordflow">IF</span> (inv == 1) j0=max(0,i-nbnd)</div>
<div class="line"><span class="lineno"> 2536</span>                <span class="keywordflow">DO</span> j=i,j0,-1</div>
<div class="line"><span class="lineno"> 2537</span>                    v(ip2)=v(ip1)</div>
<div class="line"><span class="lineno"> 2538</span>                    ioff=nb1</div>
<div class="line"><span class="lineno"> 2539</span>                    <span class="keywordflow">DO</span> ib=1,nbdr</div>
<div class="line"><span class="lineno"> 2540</span>                        joff=nb1</div>
<div class="line"><span class="lineno"> 2541</span>                        <span class="keywordflow">DO</span> jb=1,nbdr</div>
<div class="line"><span class="lineno"> 2542</span>                            ij=max(ib,jb)</div>
<div class="line"><span class="lineno"> 2543</span>                            ij=(ij*ij-ij)/2+min(ib,jb)</div>
<div class="line"><span class="lineno"> 2544</span>                            v(ip2)=v(ip2)+vbk(ij)*aux(ioff+i)*aux(joff+j)</div>
<div class="line"><span class="lineno"> 2545</span>                            joff=joff+n</div>
<div class="line"><span class="lineno"> 2546</span><span class="keywordflow">                        END DO</span></div>
<div class="line"><span class="lineno"> 2547</span>                        ioff=ioff+n</div>
<div class="line"><span class="lineno"> 2548</span><span class="keywordflow">                    END DO</span></div>
<div class="line"><span class="lineno"> 2549</span>                    ip1=ip1-1</div>
<div class="line"><span class="lineno"> 2550</span>                    ip2=ip2-1</div>
<div class="line"><span class="lineno"> 2551</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno"> 2552</span>                ip1=ip1-j0</div>
<div class="line"><span class="lineno"> 2553</span>                ip2=ip2-j0</div>
<div class="line"><span class="lineno"> 2554</span>      </div>
<div class="line"><span class="lineno"> 2555</span>                <span class="keywordflow">DO</span> ib=nbdr,1,-1</div>
<div class="line"><span class="lineno"> 2556</span>                    v(ip2)=0.0_mpd</div>
<div class="line"><span class="lineno"> 2557</span>                    joff=nb1</div>
<div class="line"><span class="lineno"> 2558</span>                    <span class="keywordflow">DO</span> jb=1,nbdr</div>
<div class="line"><span class="lineno"> 2559</span>                        ij=max(ib,jb)</div>
<div class="line"><span class="lineno"> 2560</span>                        ij=(ij*ij-ij)/2+min(ib,jb)</div>
<div class="line"><span class="lineno"> 2561</span>                        v(ip2)=v(ip2)-vbk(ij)*aux(i+joff)</div>
<div class="line"><span class="lineno"> 2562</span>                        joff=joff+n</div>
<div class="line"><span class="lineno"> 2563</span><span class="keywordflow">                    END DO</span></div>
<div class="line"><span class="lineno"> 2564</span>                    ip2=ip2-1</div>
<div class="line"><span class="lineno"> 2565</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno"> 2566</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2567</span>    </div>
<div class="line"><span class="lineno"> 2568</span>            <span class="keywordflow">DO</span> ip=(nbdr*nbdr+nbdr)/2,1,-1</div>
<div class="line"><span class="lineno"> 2569</span>                v(ip2)=vbk(ip)</div>
<div class="line"><span class="lineno"> 2570</span>                ip2=ip2-1</div>
<div class="line"><span class="lineno"> 2571</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2572</span>    </div>
<div class="line"><span class="lineno"> 2573</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 2574</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 2575</span> </div>
<div class="ttc" id="aDbandmatrix_8f90_html_a7082e5556fcc5d9aa30386f057f1b668"><div class="ttname"><a href="Dbandmatrix_8f90.html#a7082e5556fcc5d9aa30386f057f1b668">dbcdec</a></div><div class="ttdeci">subroutine dbcdec(w, mp1, n, aux)</div><div class="ttdoc">Decomposition of symmetric band matrix.</div><div class="ttdef"><b>Definition</b> <a href="Dbandmatrix_8f90_source.html#l00419">Dbandmatrix.f90:420</a></div></div>
<div class="ttc" id="ampnum_8f90_html_a92f02ed4dc87864fa0b65cec04e4c9e3"><div class="ttname"><a href="mpnum_8f90.html#a92f02ed4dc87864fa0b65cec04e4c9e3">sqminv</a></div><div class="ttdeci">subroutine sqminv(v, b, n, nrank, diag, next)</div><div class="ttdoc">Matrix inversion and solution.</div><div class="ttdef"><b>Definition</b> <a href="mpnum_8f90_source.html#l00093">mpnum.f90:94</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a019b639fffc7f6888d08ba3508f3451c" name="a019b639fffc7f6888d08ba3508f3451c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a019b639fffc7f6888d08ba3508f3451c">&#9670;&#160;</a></span>sqmibb2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sqmibb2 </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>nbdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>nbnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>nrank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n*(nbnd+1)), intent(out)&#160;</td>
          <td class="paramname"><em>vbnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n*nbdr), intent(out)&#160;</td>
          <td class="paramname"><em>vbdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n*nbdr), intent(out)&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension((nbdr*nbdr+nbdr)/2), intent(out)&#160;</td>
          <td class="paramname"><em>vbk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(nbdr), intent(out)&#160;</td>
          <td class="paramname"><em>vzru</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(nbdr), intent(out)&#160;</td>
          <td class="paramname"><em>scdiag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(nbdr), intent(out)&#160;</td>
          <td class="paramname"><em>scflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Band bordered matrix. </p>
<p>Obtain solution of a system of linear equations with symmetric band bordered matrix (V * X = B), on request inverse is calculated. For band part root-free Cholesky decomposition and forward/backward substitution is used.</p>
<p>Use decomposition in band and border part for block matrix algebra: </p><pre class="fragment">| A  Ct |   | x1 |   | b1 |        , A  is the band part
|       | * |    | = |    |        , Ct is the mixed part
| C  D  |   | x2 |   | b2 |        , D  is the border part
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">v</td><td>symmetric N-by-N matrix in symmetric storage mode (V(1) = V11, V(2) = V12, V(3) = V22, V(4) = V13, ...), replaced by inverse matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">b</td><td>N-vector, replaced by solution vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of V, B </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbdr</td><td>border size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbnd</td><td>band width </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inv</td><td>=1 calculate band part of inverse (for pulls), &gt;1 calculate complete inverse </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nrank</td><td>rank of matrix V </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vbnd</td><td>band part of V </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vbdr</td><td>border part of V </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">aux</td><td>solutions for border rows </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vbk</td><td>matrix for border solution </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vzru</td><td>border solution </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scdiag</td><td>workspace (D) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scflag</td><td>workspace (I) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l02610">2610</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2611</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 2612</span> </div>
<div class="line"><span class="lineno"> 2613</span>    <span class="comment">! REAL(mpd) scratch arrays:</span></div>
<div class="line"><span class="lineno"> 2614</span>    <span class="comment">!     VBND(N*(NBND+1)) = storage of band   part</span></div>
<div class="line"><span class="lineno"> 2615</span>    <span class="comment">!     VBDR(N* NBDR)    = storage of border part</span></div>
<div class="line"><span class="lineno"> 2616</span>    <span class="comment">!     AUX (N* NBDR)    = intermediate results</span></div>
<div class="line"><span class="lineno"> 2617</span> </div>
<div class="line"><span class="lineno"> 2618</span>    <span class="comment">! cost[dot ops] ~= (N-NBDR)*(NBDR+NBND+1)**2 + NBDR**3/3 (leading term, solution only)</span></div>
<div class="line"><span class="lineno"> 2619</span> </div>
<div class="line"><span class="lineno"> 2620</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 2621</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno"> 2622</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ib</div>
<div class="line"><span class="lineno"> 2623</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ij</div>
<div class="line"><span class="lineno"> 2624</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ioff</div>
<div class="line"><span class="lineno"> 2625</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ip</div>
<div class="line"><span class="lineno"> 2626</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ip1</div>
<div class="line"><span class="lineno"> 2627</span>    <span class="keywordtype">INTEGER(mpi)</span> :: is</div>
<div class="line"><span class="lineno"> 2628</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 2629</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j0</div>
<div class="line"><span class="lineno"> 2630</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jb</div>
<div class="line"><span class="lineno"> 2631</span>    <span class="keywordtype">INTEGER(mpi)</span> :: joff</div>
<div class="line"><span class="lineno"> 2632</span>    <span class="keywordtype">INTEGER(mpi)</span> :: koff</div>
<div class="line"><span class="lineno"> 2633</span>    <span class="keywordtype">INTEGER(mpi)</span> :: mp1</div>
<div class="line"><span class="lineno"> 2634</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nb1</div>
<div class="line"><span class="lineno"> 2635</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nmb</div>
<div class="line"><span class="lineno"> 2636</span>    <span class="keywordtype">INTEGER(mpi)</span> :: npri</div>
<div class="line"><span class="lineno"> 2637</span>    <span class="keywordtype">INTEGER(mpi)</span> :: nrankb</div>
<div class="line"><span class="lineno"> 2638</span> </div>
<div class="line"><span class="lineno"> 2639</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: v(*)</div>
<div class="line"><span class="lineno"> 2640</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: b(n)</div>
<div class="line"><span class="lineno"> 2641</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno"> 2642</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: nbdr</div>
<div class="line"><span class="lineno"> 2643</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: nbnd</div>
<div class="line"><span class="lineno"> 2644</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: inv</div>
<div class="line"><span class="lineno"> 2645</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: nrank</div>
<div class="line"><span class="lineno"> 2646</span> </div>
<div class="line"><span class="lineno"> 2647</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: vbnd(n*(nbnd+1))</div>
<div class="line"><span class="lineno"> 2648</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: vbdr(n*nbdr)</div>
<div class="line"><span class="lineno"> 2649</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: aux(n*nbdr)</div>
<div class="line"><span class="lineno"> 2650</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: vbk((nbdr*nbdr+nbdr)/2)</div>
<div class="line"><span class="lineno"> 2651</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: vzru(nbdr)</div>
<div class="line"><span class="lineno"> 2652</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span> :: scdiag(nbdr)</div>
<div class="line"><span class="lineno"> 2653</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>          :: scflag(nbdr)</div>
<div class="line"><span class="lineno"> 2654</span> </div>
<div class="line"><span class="lineno"> 2655</span>    <span class="keywordtype">SAVE</span> npri</div>
<div class="line"><span class="lineno"> 2656</span>    <span class="keyword">DATA</span> npri / 100 /</div>
<div class="line"><span class="lineno"> 2657</span>    <span class="comment">!           ...</span></div>
<div class="line"><span class="lineno"> 2658</span>    nrank=0</div>
<div class="line"><span class="lineno"> 2659</span>    mp1=nbnd+1</div>
<div class="line"><span class="lineno"> 2660</span>    nmb=n-nbdr</div>
<div class="line"><span class="lineno"> 2661</span>    nb1=nmb+1</div>
<div class="line"><span class="lineno"> 2662</span>    <span class="comment">!     copy band part</span></div>
<div class="line"><span class="lineno"> 2663</span>    <span class="keywordflow">DO</span> i=1,nmb</div>
<div class="line"><span class="lineno"> 2664</span>        ip=(i*(i+1))/2</div>
<div class="line"><span class="lineno"> 2665</span>        is=0</div>
<div class="line"><span class="lineno"> 2666</span>        <span class="keywordflow">DO</span> j=i,min(nmb,i+nbnd)</div>
<div class="line"><span class="lineno"> 2667</span>            ip=ip+is</div>
<div class="line"><span class="lineno"> 2668</span>            is=j</div>
<div class="line"><span class="lineno"> 2669</span>            ib=j-i+1</div>
<div class="line"><span class="lineno"> 2670</span>            vbnd(ib+(i-1)*mp1)=v(ip)</div>
<div class="line"><span class="lineno"> 2671</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2672</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 2673</span>    <span class="comment">!     copy border part</span></div>
<div class="line"><span class="lineno"> 2674</span>    <span class="keywordflow">IF</span> (nbdr &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2675</span>        ioff=0</div>
<div class="line"><span class="lineno"> 2676</span>        <span class="keywordflow">DO</span> i=nb1,n</div>
<div class="line"><span class="lineno"> 2677</span>            ip=(i*(i-1))/2</div>
<div class="line"><span class="lineno"> 2678</span>            <span class="keywordflow">DO</span> j=1,i</div>
<div class="line"><span class="lineno"> 2679</span>                vbdr(ioff+j)=v(ip+j)</div>
<div class="line"><span class="lineno"> 2680</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2681</span>            ioff=ioff+n</div>
<div class="line"><span class="lineno"> 2682</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2683</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 2684</span> </div>
<div class="line"><span class="lineno"> 2685</span>    <span class="keyword">CALL </span><a class="code hl_function" href="Dbandmatrix_8f90.html#a7082e5556fcc5d9aa30386f057f1b668">dbcdec</a>(vbnd,mp1,nmb,aux)</div>
<div class="line"><span class="lineno"> 2686</span>    <span class="comment">! use? CALL DBFDEC(VBND,MP1,NMB) ! modified decomp., numerically more stable</span></div>
<div class="line"><span class="lineno"> 2687</span>    <span class="comment">!      CALL DBCPRB(VBND,MP1,NMB)</span></div>
<div class="line"><span class="lineno"> 2688</span>    ip=1</div>
<div class="line"><span class="lineno"> 2689</span>    <span class="keywordflow">DO</span> i=1, nmb</div>
<div class="line"><span class="lineno"> 2690</span>        <span class="keywordflow">IF</span> (vbnd(ip) &lt;= 0.0_mpd) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2691</span>            npri=npri-1</div>
<div class="line"><span class="lineno"> 2692</span>            <span class="keywordflow">IF</span> (npri &gt;= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2693</span>                <span class="keywordflow">IF</span> (vbnd(ip) == 0.0_mpd) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2694</span>                    print *, <span class="stringliteral">&#39; SQMIBB2 matrix singular&#39;</span>, n, nbdr, nbnd</div>
<div class="line"><span class="lineno"> 2695</span>                <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 2696</span>                    print *, <span class="stringliteral">&#39; SQMIBB2 matrix not positive definite&#39;</span>, n, nbdr, nbnd</div>
<div class="line"><span class="lineno"> 2697</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno"> 2698</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno"> 2699</span>            <span class="comment">!           return zeros</span></div>
<div class="line"><span class="lineno"> 2700</span>            <span class="keywordflow">DO</span> ip=1,n</div>
<div class="line"><span class="lineno"> 2701</span>                b(ip)=0.0_mpd</div>
<div class="line"><span class="lineno"> 2702</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2703</span>            <span class="keywordflow">DO</span> ip=1,(n*n+n)/2</div>
<div class="line"><span class="lineno"> 2704</span>                v(ip)=0.0_mpd</div>
<div class="line"><span class="lineno"> 2705</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2706</span>            <span class="keywordflow">RETURN</span></div>
<div class="line"><span class="lineno"> 2707</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 2708</span>        ip=ip+mp1</div>
<div class="line"><span class="lineno"> 2709</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 2710</span>    nrank=nmb</div>
<div class="line"><span class="lineno"> 2711</span> </div>
<div class="line"><span class="lineno"> 2712</span>    <span class="keywordflow">IF</span> (nbdr == 0) <span class="keywordflow">THEN</span> <span class="comment">! special case NBDR=0</span></div>
<div class="line"><span class="lineno"> 2713</span>  </div>
<div class="line"><span class="lineno"> 2714</span>        <span class="keyword">CALL </span>dbcslv(vbnd,mp1,nmb,b,b)</div>
<div class="line"><span class="lineno"> 2715</span>        <span class="keywordflow">IF</span> (inv &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2716</span>            <span class="keywordflow">IF</span> (inv &gt; 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2717</span>                <span class="keyword">CALL </span>dbcinv(vbnd,mp1,nmb,v)</div>
<div class="line"><span class="lineno"> 2718</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 2719</span>                <span class="keyword">CALL </span>dbcinb(vbnd,mp1,nmb,v)</div>
<div class="line"><span class="lineno"> 2720</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno"> 2721</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 2722</span>  </div>
<div class="line"><span class="lineno"> 2723</span>    <span class="keywordflow">ELSE</span> <span class="comment">! general case NBDR&gt;0</span></div>
<div class="line"><span class="lineno"> 2724</span>  </div>
<div class="line"><span class="lineno"> 2725</span>        ioff=0</div>
<div class="line"><span class="lineno"> 2726</span>        <span class="keywordflow">DO</span> ib=1,nbdr</div>
<div class="line"><span class="lineno"> 2727</span>            <span class="comment">!           solve for aux. vectors</span></div>
<div class="line"><span class="lineno"> 2728</span>            <span class="keyword">CALL </span>dbcslv(vbnd,mp1,nmb,vbdr(ioff+1),aux(ioff+1))</div>
<div class="line"><span class="lineno"> 2729</span>            <span class="comment">!           zT ru</span></div>
<div class="line"><span class="lineno"> 2730</span>            vzru(ib)=b(nmb+ib)</div>
<div class="line"><span class="lineno"> 2731</span>            <span class="keywordflow">DO</span> i=1,nmb</div>
<div class="line"><span class="lineno"> 2732</span>                vzru(ib)=vzru(ib)-b(i)*aux(ioff+i)</div>
<div class="line"><span class="lineno"> 2733</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2734</span>            ioff=ioff+n</div>
<div class="line"><span class="lineno"> 2735</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2736</span>        <span class="comment">!        solve for band part only</span></div>
<div class="line"><span class="lineno"> 2737</span>        <span class="keyword">CALL </span>dbcslv(vbnd,mp1,nmb,b,b)</div>
<div class="line"><span class="lineno"> 2738</span>        <span class="comment">!        Ck - cT z</span></div>
<div class="line"><span class="lineno"> 2739</span>        ip=0</div>
<div class="line"><span class="lineno"> 2740</span>        ioff=0</div>
<div class="line"><span class="lineno"> 2741</span>        koff=nmb</div>
<div class="line"><span class="lineno"> 2742</span>        <span class="keywordflow">DO</span> ib=1,nbdr</div>
<div class="line"><span class="lineno"> 2743</span>            joff=0</div>
<div class="line"><span class="lineno"> 2744</span>            <span class="keywordflow">DO</span> jb=1,ib</div>
<div class="line"><span class="lineno"> 2745</span>                ip=ip+1</div>
<div class="line"><span class="lineno"> 2746</span>                vbk(ip)=vbdr(koff+jb)</div>
<div class="line"><span class="lineno"> 2747</span>                <span class="keywordflow">DO</span> i=1,nmb   </div>
<div class="line"><span class="lineno"> 2748</span>                    vbk(ip)=vbk(ip)-vbdr(ioff+i)*aux(joff+i)</div>
<div class="line"><span class="lineno"> 2749</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno"> 2750</span>                joff=joff+n</div>
<div class="line"><span class="lineno"> 2751</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2752</span>            ioff=ioff+n</div>
<div class="line"><span class="lineno"> 2753</span>            koff=koff+n</div>
<div class="line"><span class="lineno"> 2754</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2755</span>        </div>
<div class="line"><span class="lineno"> 2756</span>        <span class="comment">!        solve border part</span></div>
<div class="line"><span class="lineno"> 2757</span>        <span class="keyword">CALL </span><a class="code hl_function" href="mpnum_8f90.html#a92f02ed4dc87864fa0b65cec04e4c9e3">sqminv</a>(vbk,vzru,nbdr,nrankb,scdiag,scflag)</div>
<div class="line"><span class="lineno"> 2758</span>        <span class="keywordflow">IF</span> (nrankb == nbdr) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2759</span>            nrank=nrank+nbdr</div>
<div class="line"><span class="lineno"> 2760</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 2761</span>            npri=npri-1</div>
<div class="line"><span class="lineno"> 2762</span>            <span class="keywordflow">IF</span> (npri &gt;= 0) print *, <span class="stringliteral">&#39; SQMIBB2 undef border &#39;</span>, n, nbdr, nbnd, nrankb</div>
<div class="line"><span class="lineno"> 2763</span>            <span class="keywordflow">DO</span> ib=1,nbdr</div>
<div class="line"><span class="lineno"> 2764</span>                vzru(ib)=0.0_mpd</div>
<div class="line"><span class="lineno"> 2765</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2766</span>            <span class="keywordflow">DO</span> ip=(nbdr*nbdr+nbdr)/2,1,-1</div>
<div class="line"><span class="lineno"> 2767</span>                vbk(ip)=0.0_mpd</div>
<div class="line"><span class="lineno"> 2768</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2769</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 2770</span>        <span class="comment">!        smoothed data points</span></div>
<div class="line"><span class="lineno"> 2771</span>        ioff=0</div>
<div class="line"><span class="lineno"> 2772</span>        <span class="keywordflow">DO</span> ib=1, nbdr</div>
<div class="line"><span class="lineno"> 2773</span>            <span class="keywordflow">DO</span> i=1,nmb</div>
<div class="line"><span class="lineno"> 2774</span>                b(i)=b(i)-vzru(ib)*aux(ioff+i)</div>
<div class="line"><span class="lineno"> 2775</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno"> 2776</span>            ioff=ioff+n</div>
<div class="line"><span class="lineno"> 2777</span>            b(nmb+ib)=vzru(ib)</div>
<div class="line"><span class="lineno"> 2778</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 2779</span>        <span class="comment">!        inverse requested ?</span></div>
<div class="line"><span class="lineno"> 2780</span>        <span class="keywordflow">IF</span> (inv &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2781</span>            <span class="keywordflow">IF</span> (inv &gt; 1) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2782</span>                <span class="keyword">CALL </span>dbcinv(vbnd,mp1,nmb,v)</div>
<div class="line"><span class="lineno"> 2783</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno"> 2784</span>                <span class="keyword">CALL </span>dbcinb(vbnd,mp1,nmb,v)</div>
<div class="line"><span class="lineno"> 2785</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno"> 2786</span>            <span class="comment">!           assemble band and border</span></div>
<div class="line"><span class="lineno"> 2787</span>            <span class="keywordflow">IF</span> (nbdr &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno"> 2788</span>                <span class="comment">! band part</span></div>
<div class="line"><span class="lineno"> 2789</span>                ip1=(nmb*nmb+nmb)/2</div>
<div class="line"><span class="lineno"> 2790</span>                <span class="keywordflow">DO</span> i=nmb-1,0,-1</div>
<div class="line"><span class="lineno"> 2791</span>                    j0=0</div>
<div class="line"><span class="lineno"> 2792</span>                    <span class="keywordflow">IF</span> (inv == 1) j0=max(0,i-nbnd)</div>
<div class="line"><span class="lineno"> 2793</span>                    <span class="keywordflow">DO</span> j=i,j0,-1</div>
<div class="line"><span class="lineno"> 2794</span>                        ioff=1</div>
<div class="line"><span class="lineno"> 2795</span>                        <span class="keywordflow">DO</span> ib=1,nbdr</div>
<div class="line"><span class="lineno"> 2796</span>                            joff=1</div>
<div class="line"><span class="lineno"> 2797</span>                            <span class="keywordflow">DO</span> jb=1,nbdr</div>
<div class="line"><span class="lineno"> 2798</span>                                ij=max(ib,jb)</div>
<div class="line"><span class="lineno"> 2799</span>                                ij=(ij*ij-ij)/2+min(ib,jb)</div>
<div class="line"><span class="lineno"> 2800</span>                                v(ip1)=v(ip1)+vbk(ij)*aux(ioff+i)*aux(joff+j)</div>
<div class="line"><span class="lineno"> 2801</span>                                joff=joff+n</div>
<div class="line"><span class="lineno"> 2802</span><span class="keywordflow">                            END DO</span></div>
<div class="line"><span class="lineno"> 2803</span>                            ioff=ioff+n</div>
<div class="line"><span class="lineno"> 2804</span><span class="keywordflow">                        END DO</span></div>
<div class="line"><span class="lineno"> 2805</span>                        ip1=ip1-1</div>
<div class="line"><span class="lineno"> 2806</span><span class="keywordflow">                    END DO</span></div>
<div class="line"><span class="lineno"> 2807</span>                    ip1=ip1-j0</div>
<div class="line"><span class="lineno"> 2808</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno"> 2809</span>                <span class="comment">! border part</span></div>
<div class="line"><span class="lineno"> 2810</span>                ip1=(nmb*nmb+nmb)/2</div>
<div class="line"><span class="lineno"> 2811</span>                ip=0</div>
<div class="line"><span class="lineno"> 2812</span>                <span class="keywordflow">DO</span> ib=1,nbdr</div>
<div class="line"><span class="lineno"> 2813</span>                    <span class="keywordflow">DO</span> i=1,nmb</div>
<div class="line"><span class="lineno"> 2814</span>                        ip1=ip1+1</div>
<div class="line"><span class="lineno"> 2815</span>                        v(ip1)=0.0_mpd</div>
<div class="line"><span class="lineno"> 2816</span>                        joff=0</div>
<div class="line"><span class="lineno"> 2817</span>                        <span class="keywordflow">DO</span> jb=1,nbdr</div>
<div class="line"><span class="lineno"> 2818</span>                            ij=max(ib,jb)</div>
<div class="line"><span class="lineno"> 2819</span>                            ij=(ij*ij-ij)/2+min(ib,jb)</div>
<div class="line"><span class="lineno"> 2820</span>                            v(ip1)=v(ip1)-vbk(ij)*aux(i+joff)</div>
<div class="line"><span class="lineno"> 2821</span>                            joff=joff+n</div>
<div class="line"><span class="lineno"> 2822</span><span class="keywordflow">                        END DO</span></div>
<div class="line"><span class="lineno"> 2823</span><span class="keywordflow">                    END DO</span></div>
<div class="line"><span class="lineno"> 2824</span>                    <span class="keywordflow">DO</span> jb=1,ib</div>
<div class="line"><span class="lineno"> 2825</span>                        ip1=ip1+1</div>
<div class="line"><span class="lineno"> 2826</span>                        ip=ip+1</div>
<div class="line"><span class="lineno"> 2827</span>                        v(ip1)=vbk(ip)</div>
<div class="line"><span class="lineno"> 2828</span><span class="keywordflow">                    END DO</span></div>
<div class="line"><span class="lineno"> 2829</span><span class="keywordflow">                END DO</span></div>
<div class="line"><span class="lineno"> 2830</span> </div>
<div class="line"><span class="lineno"> 2831</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno"> 2832</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno"> 2833</span><span class="keywordflow">    END IF</span></div>
<div class="line"><span class="lineno"> 2834</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a24d99a263ffebf0cbb2a8839f259c816" name="a24d99a263ffebf0cbb2a8839f259c816"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24d99a263ffebf0cbb2a8839f259c816">&#9670;&#160;</a></span>sqminl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sqminl </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>nrank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>next</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Matrix inversion for LARGE matrices. </p>
<p>Like SQMINV, additional parallelization with OpenMP.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">V</td><td>symmetric N-by-N matrix in symmetric storage mode (V(1) = V11, V(2) = V12, V(3) = V22, V(4) = V13, ...), replaced by inverse matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">B</td><td>N-vector, replaced by solution vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size of V, B </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NRANK</td><td>rank of matrix V </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DIAG</td><td>double precision scratch array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NEXT</td><td>integer aux array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l00224">224</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  225</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  228</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  229</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordtype">INTEGER(mpi)</span> :: l</div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordtype">INTEGER(mpi)</span> :: last</div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordtype">INTEGER(mpi)</span> :: next0</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: v(*)</div>
<div class="line"><span class="lineno">  236</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: b(n)</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno">  238</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: nrank</div>
<div class="line"><span class="lineno">  239</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: diag(n)</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: next(n)</div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordtype">INTEGER(mpl)</span> :: i8</div>
<div class="line"><span class="lineno">  242</span>    <span class="keywordtype">INTEGER(mpl)</span> :: j8</div>
<div class="line"><span class="lineno">  243</span>    <span class="keywordtype">INTEGER(mpl)</span> :: jj</div>
<div class="line"><span class="lineno">  244</span>    <span class="keywordtype">INTEGER(mpl)</span> :: k8</div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordtype">INTEGER(mpl)</span> :: kk</div>
<div class="line"><span class="lineno">  246</span>    <span class="keywordtype">INTEGER(mpl)</span> :: kkmk</div>
<div class="line"><span class="lineno">  247</span>    <span class="keywordtype">INTEGER(mpl)</span> :: jk</div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordtype">INTEGER(mpl)</span> :: jl</div>
<div class="line"><span class="lineno">  249</span>    <span class="keywordtype">INTEGER(mpl)</span> :: llk</div>
<div class="line"><span class="lineno">  250</span>    <span class="keywordtype">INTEGER(mpl)</span> :: ljl</div>
<div class="line"><span class="lineno">  251</span>    </div>
<div class="line"><span class="lineno">  252</span><span class="keywordtype">    REAL</span>(mpd) :: vkk</div>
<div class="line"><span class="lineno">  253</span><span class="keywordtype">    REAL</span>(mpd) :: vjk</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">PARAMETER</span> :: eps=1.0e-10_mpd</div>
<div class="line"><span class="lineno">  256</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  257</span>    next0=1</div>
<div class="line"><span class="lineno">  258</span>    l=1</div>
<div class="line"><span class="lineno">  259</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno">  260</span>        i8=int8(i)</div>
<div class="line"><span class="lineno">  261</span>        next(i)=i+1                <span class="comment">! set &quot;next&quot; pointer</span></div>
<div class="line"><span class="lineno">  262</span>        diag(i)=abs(v((i8*i8+i8)/2))  <span class="comment">! save abs of diagonal elements</span></div>
<div class="line"><span class="lineno">  263</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  264</span>    next(n)=-1                  <span class="comment">! end flag</span></div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>    nrank=0</div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordflow">DO</span> i=1,n                    <span class="comment">! start of loop</span></div>
<div class="line"><span class="lineno">  268</span>        k  =0</div>
<div class="line"><span class="lineno">  269</span>        vkk=0.0_mpd</div>
<div class="line"><span class="lineno">  270</span>        j=next0</div>
<div class="line"><span class="lineno">  271</span>        last=0</div>
<div class="line"><span class="lineno">  272</span>05      <span class="keywordflow">IF</span>(j &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  273</span>            j8=int8(j)</div>
<div class="line"><span class="lineno">  274</span>            jj=(j8*j8+j8)/2</div>
<div class="line"><span class="lineno">  275</span>            <span class="keywordflow">IF</span>(abs(v(jj)) &gt; max(abs(vkk),eps*diag(j))) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  276</span>                vkk=v(jj)</div>
<div class="line"><span class="lineno">  277</span>                k=j</div>
<div class="line"><span class="lineno">  278</span>                l=last</div>
<div class="line"><span class="lineno">  279</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  280</span>            last=j</div>
<div class="line"><span class="lineno">  281</span>            j=next(last)</div>
<div class="line"><span class="lineno">  282</span>            <span class="keywordflow">GO TO</span> 05</div>
<div class="line"><span class="lineno">  283</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  284</span>  </div>
<div class="line"><span class="lineno">  285</span>        <span class="keywordflow">IF</span>(k /= 0) <span class="keywordflow">THEN</span>            <span class="comment">! pivot found</span></div>
<div class="line"><span class="lineno">  286</span>            k8=int8(k)</div>
<div class="line"><span class="lineno">  287</span>            kk=(k8*k8+k8)/2</div>
<div class="line"><span class="lineno">  288</span>            kkmk=kk-k8</div>
<div class="line"><span class="lineno">  289</span>            <span class="keywordflow">IF</span>(l == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  290</span>                next0=next(k)</div>
<div class="line"><span class="lineno">  291</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  292</span>                next(l)=next(k)</div>
<div class="line"><span class="lineno">  293</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  294</span>            next(k)=0               <span class="comment">! index is used, reset</span></div>
<div class="line"><span class="lineno">  295</span>            nrank=nrank+1           <span class="comment">! increase rank and ...</span></div>
<div class="line"><span class="lineno">  296</span>            vkk    =1.0/vkk</div>
<div class="line"><span class="lineno">  297</span>            v(kk)  =-vkk</div>
<div class="line"><span class="lineno">  298</span>            b(k)   =b(k)*vkk</div>
<div class="line"><span class="lineno">  299</span>            <span class="comment">! elimination</span></div>
<div class="line"><span class="lineno">  300</span>            jk     =kkmk</div>
<div class="line"><span class="lineno">  301</span>            <span class="keywordflow">DO</span> j=1,n</div>
<div class="line"><span class="lineno">  302</span>                <span class="keywordflow">IF</span>(j == k) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  303</span>                    jk=kk</div>
<div class="line"><span class="lineno">  304</span>                <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  305</span>                    <span class="keywordflow">IF</span>(j &lt; k) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  306</span>                        jk=jk+1</div>
<div class="line"><span class="lineno">  307</span>                    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  308</span>                        jk=jk+int8(j)-1</div>
<div class="line"><span class="lineno">  309</span><span class="keywordflow">                    END IF</span></div>
<div class="line"><span class="lineno">  310</span>                    v(jk)=v(jk)*vkk</div>
<div class="line"><span class="lineno">  311</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  312</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  313</span>            <span class="comment">! parallelize row loop</span></div>
<div class="line"><span class="lineno">  314</span>            <span class="comment">! slot of 128 &#39;J&#39; for next idle thread</span></div>
<div class="line"><span class="lineno">  315</span>            <span class="comment">!$OMP PARALLEL DO &amp;</span></div>
<div class="line"><span class="lineno">  316</span>            <span class="comment">!$OMP PRIVATE(JL,JK,L,LJL,LLK,VJK,J8) &amp;</span></div>
<div class="line"><span class="lineno">  317</span>            <span class="comment">!$OMP SCHEDULE(DYNAMIC,128)</span></div>
<div class="line"><span class="lineno">  318</span>            <span class="keywordflow">DO</span> j=n,1,-1</div>
<div class="line"><span class="lineno">  319</span>                j8=int8(j)</div>
<div class="line"><span class="lineno">  320</span>                jl=j8*(j8-1)/2</div>
<div class="line"><span class="lineno">  321</span>                <span class="keywordflow">IF</span>(j /= k) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  322</span>                    <span class="keywordflow">IF</span>(j &lt; k) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  323</span>                        jk=kkmk+j8</div>
<div class="line"><span class="lineno">  324</span>                    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  325</span>                        jk=k8+jl</div>
<div class="line"><span class="lineno">  326</span><span class="keywordflow">                    END IF</span></div>
<div class="line"><span class="lineno">  327</span>                    vjk  =v(jk)/vkk</div>
<div class="line"><span class="lineno">  328</span>                    b(j) =b(j)-b(k)*vjk</div>
<div class="line"><span class="lineno">  329</span>                    ljl=jl</div>
<div class="line"><span class="lineno">  330</span>                    llk=kkmk</div>
<div class="line"><span class="lineno">  331</span>                    <span class="keywordflow">DO</span> l=1,min(j,k-1)</div>
<div class="line"><span class="lineno">  332</span>                        ljl=ljl+1</div>
<div class="line"><span class="lineno">  333</span>                        llk=llk+1</div>
<div class="line"><span class="lineno">  334</span>                        v(ljl)=v(ljl)-v(llk)*vjk</div>
<div class="line"><span class="lineno">  335</span><span class="keywordflow">                    END DO</span></div>
<div class="line"><span class="lineno">  336</span>                    ljl=ljl+1</div>
<div class="line"><span class="lineno">  337</span>                    llk=kk</div>
<div class="line"><span class="lineno">  338</span>                    <span class="keywordflow">DO</span> l=k+1,j</div>
<div class="line"><span class="lineno">  339</span>                        ljl=ljl+1</div>
<div class="line"><span class="lineno">  340</span>                        llk=llk+l-1</div>
<div class="line"><span class="lineno">  341</span>                        v(ljl)=v(ljl)-v(llk)*vjk</div>
<div class="line"><span class="lineno">  342</span><span class="keywordflow">                    END DO</span></div>
<div class="line"><span class="lineno">  343</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  344</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  345</span>        <span class="comment">!$OMP END PARALLEL DO</span></div>
<div class="line"><span class="lineno">  346</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  347</span>            <span class="keywordflow">DO</span> k=1,n</div>
<div class="line"><span class="lineno">  348</span>                k8=int8(k)</div>
<div class="line"><span class="lineno">  349</span>                kk=(k8*k8-k8)/2</div>
<div class="line"><span class="lineno">  350</span>                <span class="keywordflow">IF</span>(next(k) /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  351</span>                    b(k)=0.0_mpd       <span class="comment">! clear vector element</span></div>
<div class="line"><span class="lineno">  352</span>                    <span class="keywordflow">DO</span> j=1,k</div>
<div class="line"><span class="lineno">  353</span>                        <span class="keywordflow">IF</span>(next(j) /= 0) v(kk+int8(j))=0.0_mpd  <span class="comment">! clear matrix row/col</span></div>
<div class="line"><span class="lineno">  354</span><span class="keywordflow">                    END DO</span></div>
<div class="line"><span class="lineno">  355</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  356</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  357</span>            <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><span class="lineno">  358</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  359</span><span class="keywordflow">    END DO</span>             <span class="comment">! end of loop</span></div>
<div class="line"><span class="lineno">  360</span>    10   <span class="keywordflow">DO</span> jj=1,(int8(n)*int8(n)+int8(n))/2</div>
<div class="line"><span class="lineno">  361</span>        v(jj)=-v(jj)      <span class="comment">! finally reverse sign of all matrix elements</span></div>
<div class="line"><span class="lineno">  362</span><span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a92f02ed4dc87864fa0b65cec04e4c9e3" name="a92f02ed4dc87864fa0b65cec04e4c9e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92f02ed4dc87864fa0b65cec04e4c9e3">&#9670;&#160;</a></span>sqminv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sqminv </td>
          <td>(</td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), intent(out)&#160;</td>
          <td class="paramname"><em>nrank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(n), intent(out)&#160;</td>
          <td class="paramname"><em>next</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Matrix inversion and solution. </p>
<p>Obtain solution of a system of linear equations with symmetric matrix (V * X = B) and the inverse.</p>
<p>Method of solution is by elimination selecting the pivot on the diagonal each stage. The rank of the matrix is returned in NRANK. For NRANK ne N, all remaining rows and cols of the resulting matrix V and the corresponding elements of B are set to zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">V</td><td>symmetric N-by-N matrix in symmetric storage mode (V(1) = V11, V(2) = V12, V(3) = V22, V(4) = V13, ...), replaced by inverse matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">B</td><td>N-vector, replaced by solution vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>size of V, B </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NRANK</td><td>rank of matrix V </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DIAG</td><td>double precision scratch array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NEXT</td><td>INTEGER(mpi) aux array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l00093">93</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ij</div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jj</div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jk</div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordtype">INTEGER(mpi)</span> :: jl</div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordtype">INTEGER(mpi)</span> :: kk</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordtype">INTEGER(mpi)</span> :: l</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordtype">INTEGER(mpi)</span> :: last</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordtype">INTEGER(mpi)</span> :: lk</div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordtype">INTEGER(mpi)</span> :: next0</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: v(*)</div>
<div class="line"><span class="lineno">  111</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: b(n)</div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: nrank</div>
<div class="line"><span class="lineno">  114</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(OUT)</span>            :: diag(n)</div>
<div class="line"><span class="lineno">  115</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(OUT)</span>                     :: next(n)</div>
<div class="line"><span class="lineno">  116</span><span class="keywordtype">    REAL</span>(mpd) :: vkk</div>
<div class="line"><span class="lineno">  117</span><span class="keywordtype">    REAL</span>(mpd) :: vjk</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>    <span class="comment">!REAL(mpd), PARAMETER :: eps=1.0E-10_mpd</span></div>
<div class="line"><span class="lineno">  120</span><span class="keywordtype">    REAL</span>(mpd) eps</div>
<div class="line"><span class="lineno">  121</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno">  122</span>    eps = 16.0_mpd * epsilon(eps) <span class="comment">! 16 * precision(mpd)</span></div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>    next0=1</div>
<div class="line"><span class="lineno">  125</span>    l=1</div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordflow">DO</span> i=1,n</div>
<div class="line"><span class="lineno">  127</span>        next(i)=i+1                <span class="comment">! set &quot;next&quot; pointer</span></div>
<div class="line"><span class="lineno">  128</span>        diag(i)=abs(v((i*i+i)/2))  <span class="comment">! save abs of diagonal elements</span></div>
<div class="line"><span class="lineno">  129</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  130</span>    next(n)=-1                  <span class="comment">! end flag</span></div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    nrank=0</div>
<div class="line"><span class="lineno">  133</span>    <span class="keywordflow">DO</span> i=1,n                    <span class="comment">! start of loop</span></div>
<div class="line"><span class="lineno">  134</span>        k  =0</div>
<div class="line"><span class="lineno">  135</span>        vkk=0.0_mpd</div>
<div class="line"><span class="lineno">  136</span>  </div>
<div class="line"><span class="lineno">  137</span>        j=next0</div>
<div class="line"><span class="lineno">  138</span>        last=0</div>
<div class="line"><span class="lineno">  139</span>05      <span class="keywordflow">IF</span>(j &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  140</span>            jj=(j*j+j)/2</div>
<div class="line"><span class="lineno">  141</span>            <span class="keywordflow">IF</span>(abs(v(jj)) &gt; max(abs(vkk),eps*diag(j))) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  142</span>                vkk=v(jj)</div>
<div class="line"><span class="lineno">  143</span>                k=j</div>
<div class="line"><span class="lineno">  144</span>                l=last</div>
<div class="line"><span class="lineno">  145</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  146</span>            last=j</div>
<div class="line"><span class="lineno">  147</span>            j=next(last)</div>
<div class="line"><span class="lineno">  148</span>            <span class="keywordflow">GO TO</span> 05</div>
<div class="line"><span class="lineno">  149</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  150</span>  </div>
<div class="line"><span class="lineno">  151</span>        <span class="keywordflow">IF</span>(k /= 0) <span class="keywordflow">THEN</span>            <span class="comment">! pivot found</span></div>
<div class="line"><span class="lineno">  152</span>            kk=(k*k+k)/2</div>
<div class="line"><span class="lineno">  153</span>            <span class="keywordflow">IF</span>(l == 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  154</span>                next0=next(k)</div>
<div class="line"><span class="lineno">  155</span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  156</span>                next(l)=next(k)</div>
<div class="line"><span class="lineno">  157</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  158</span>            next(k)=0               <span class="comment">! index is used, reset</span></div>
<div class="line"><span class="lineno">  159</span>            nrank=nrank+1           <span class="comment">! increase rank and ...</span></div>
<div class="line"><span class="lineno">  160</span>            vkk    =1.0/vkk</div>
<div class="line"><span class="lineno">  161</span>            v(kk)  =-vkk</div>
<div class="line"><span class="lineno">  162</span>            b(k)   =b(k)*vkk</div>
<div class="line"><span class="lineno">  163</span>            jk     =kk-k</div>
<div class="line"><span class="lineno">  164</span>            jl     =0</div>
<div class="line"><span class="lineno">  165</span>            <span class="keywordflow">DO</span> j=1,n                <span class="comment">! elimination</span></div>
<div class="line"><span class="lineno">  166</span>                <span class="keywordflow">IF</span>(j == k) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  167</span>                    jk=kk</div>
<div class="line"><span class="lineno">  168</span>                    jl=jl+j</div>
<div class="line"><span class="lineno">  169</span>                <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  170</span>                    <span class="keywordflow">IF</span>(j &lt; k) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  171</span>                        jk=jk+1</div>
<div class="line"><span class="lineno">  172</span>                    <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  173</span>                        jk=jk+j-1</div>
<div class="line"><span class="lineno">  174</span><span class="keywordflow">                    END IF</span></div>
<div class="line"><span class="lineno">  175</span>                    vjk  =v(jk)</div>
<div class="line"><span class="lineno">  176</span>                    v(jk)=vkk*vjk</div>
<div class="line"><span class="lineno">  177</span>                    b(j) =b(j)-b(k)*vjk</div>
<div class="line"><span class="lineno">  178</span>                    lk   =kk-k</div>
<div class="line"><span class="lineno">  179</span>                    <span class="keywordflow">DO</span> l=1,j</div>
<div class="line"><span class="lineno">  180</span>                        jl=jl+1</div>
<div class="line"><span class="lineno">  181</span>                        <span class="keywordflow">IF</span>(l == k) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  182</span>                            lk=kk</div>
<div class="line"><span class="lineno">  183</span>                        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  184</span>                            <span class="keywordflow">IF</span>(l &lt; k) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  185</span>                                lk=lk+1</div>
<div class="line"><span class="lineno">  186</span>                            <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  187</span>                                lk=lk+l-1</div>
<div class="line"><span class="lineno">  188</span><span class="keywordflow">                            END IF</span></div>
<div class="line"><span class="lineno">  189</span>                            v(jl)=v(jl)-v(lk)*vjk</div>
<div class="line"><span class="lineno">  190</span><span class="keywordflow">                        END IF</span></div>
<div class="line"><span class="lineno">  191</span><span class="keywordflow">                    END DO</span></div>
<div class="line"><span class="lineno">  192</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  193</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  194</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  195</span>            <span class="keywordflow">DO</span> k=1,n</div>
<div class="line"><span class="lineno">  196</span>                <span class="keywordflow">IF</span>(next(k) /= 0) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  197</span>                    b(k)=0.0_mpd       <span class="comment">! clear vector element</span></div>
<div class="line"><span class="lineno">  198</span>                    <span class="keywordflow">DO</span> j=1,k</div>
<div class="line"><span class="lineno">  199</span>                        <span class="keywordflow">IF</span>(next(j) /= 0) v((k*k-k)/2+j)=0.0_mpd  <span class="comment">! clear matrix row/col</span></div>
<div class="line"><span class="lineno">  200</span><span class="keywordflow">                    END DO</span></div>
<div class="line"><span class="lineno">  201</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  202</span><span class="keywordflow">            END DO</span></div>
<div class="line"><span class="lineno">  203</span>            <span class="keywordflow">GO TO</span> 10</div>
<div class="line"><span class="lineno">  204</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  205</span><span class="keywordflow">    END DO</span>             <span class="comment">! end of loop</span></div>
<div class="line"><span class="lineno">  206</span>    10   <span class="keywordflow">DO</span> ij=1,(n*n+n)/2</div>
<div class="line"><span class="lineno">  207</span>        v(ij)=-v(ij)      <span class="comment">! finally reverse sign of all matrix elements</span></div>
<div class="line"><span class="lineno">  208</span><span class="keywordflow">    END DO</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a692128ba96a608353675ecc7ae89b77a" name="a692128ba96a608353675ecc7ae89b77a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a692128ba96a608353675ecc7ae89b77a">&#9670;&#160;</a></span>vabdec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vabdec </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>ilptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Variable band matrix decomposition. </p>
<p>Decomposition: A = L D L^T</p>
<p>Variable-band matrix row Doolittle decomposition. A variable-band NxN symmetric matrix, also called skyline, is stored row by row in the array VAL(.). For each row every coefficient between the first non-zero element in the row and the diagonal is stored. The pointer array ILPTR(N) contains the indices in VAL(.) of the diagonal elements. ILPTR(1) is always 1, and ILPTR(N) is equal to the total number of coefficients stored, called the profile. The form of a variable-band matrix is preserved in the L D L^T decomposition no fill-in is created ahead in any row or ahead of the first entry in any column, but existing zero-values will become non-zero. The decomposition is done "in-place".</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">val</td><td>variable-band matrix, replaced by D,L </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilptr</td><td>pointer array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l00900">900</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  901</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span>    <span class="keywordtype">INTEGER(mpi)</span> :: i</div>
<div class="line"><span class="lineno">  906</span>    <span class="keywordtype">INTEGER(mpi)</span> :: in</div>
<div class="line"><span class="lineno">  907</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno">  908</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno">  909</span>    <span class="keywordtype">INTEGER(mpi)</span> :: kj</div>
<div class="line"><span class="lineno">  910</span>    <span class="keywordtype">INTEGER(mpi)</span> :: mj</div>
<div class="line"><span class="lineno">  911</span>    <span class="keywordtype">INTEGER(mpi)</span> :: mk</div>
<div class="line"><span class="lineno">  912</span><span class="keywordtype">    REAL</span>(mpd) :: sn</div>
<div class="line"><span class="lineno">  913</span><span class="keywordtype">    REAL</span>(mpd) :: beta</div>
<div class="line"><span class="lineno">  914</span><span class="keywordtype">    REAL</span>(mpd) :: delta</div>
<div class="line"><span class="lineno">  915</span><span class="keywordtype">    REAL</span>(mpd) :: theta</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno">  918</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: val(*)</div>
<div class="line"><span class="lineno">  919</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: ilptr(n)</div>
<div class="line"><span class="lineno">  920</span>    </div>
<div class="line"><span class="lineno">  921</span><span class="keywordtype">    REAL</span>(mpd) :: dgamma</div>
<div class="line"><span class="lineno">  922</span><span class="keywordtype">    REAL</span>(mpd) :: xi</div>
<div class="line"><span class="lineno">  923</span><span class="keywordtype">    REAL</span>(mpd) :: valkj</div>
<div class="line"><span class="lineno">  924</span> </div>
<div class="line"><span class="lineno">  925</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">PARAMETER</span> :: one=1.0_mpd</div>
<div class="line"><span class="lineno">  926</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">PARAMETER</span> :: two=2.0_mpd</div>
<div class="line"><span class="lineno">  927</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">PARAMETER</span> :: eps = epsilon(eps)</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Variable band matrix Cholesky decomposition&#39;</span></div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span>    dgamma=0.0_mpd</div>
<div class="line"><span class="lineno">  932</span>    i=1</div>
<div class="line"><span class="lineno">  933</span>    <span class="keywordflow">DO</span> j=1,ilptr(n) <span class="comment">! loop thrugh all matrix elements</span></div>
<div class="line"><span class="lineno">  934</span>        <span class="keywordflow">IF</span>(ilptr(i) == j) <span class="keywordflow">THEN</span> <span class="comment">! diagonal element</span></div>
<div class="line"><span class="lineno">  935</span>            <span class="keywordflow">IF</span>(val(j) &lt;= 0.0_mpd) <span class="keywordflow">GO TO</span> 01   <span class="comment">! exit loop for negative diag</span></div>
<div class="line"><span class="lineno">  936</span>            dgamma=max(dgamma,abs(val(j)))  <span class="comment">! max diagonal element</span></div>
<div class="line"><span class="lineno">  937</span>            i=i+1</div>
<div class="line"><span class="lineno">  938</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  939</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  940</span>    i=n+1</div>
<div class="line"><span class="lineno">  941</span>01  in=i-1      <span class="comment">! IN positive diagonal elements</span></div>
<div class="line"><span class="lineno">  942</span>    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;  &#39;</span>,in,<span class="stringliteral">&#39; positive diagonal elements&#39;</span></div>
<div class="line"><span class="lineno">  943</span>    xi=0.0_mpd</div>
<div class="line"><span class="lineno">  944</span>    i=1</div>
<div class="line"><span class="lineno">  945</span>    <span class="keywordflow">DO</span> j=1,ilptr(in)          <span class="comment">! loop for positive diagonal elements</span></div>
<div class="line"><span class="lineno">  946</span>        <span class="comment">! through all matrix elements</span></div>
<div class="line"><span class="lineno">  947</span>        <span class="keywordflow">IF</span>(ilptr(i) == j) <span class="keywordflow">THEN</span>   <span class="comment">! diagonal element</span></div>
<div class="line"><span class="lineno">  948</span>            i=i+1</div>
<div class="line"><span class="lineno">  949</span>        <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  950</span>            xi=max(xi,abs(val(j))) <span class="comment">! Xi = abs(max) off-diagonal element</span></div>
<div class="line"><span class="lineno">  951</span><span class="keywordflow">        END IF</span></div>
<div class="line"><span class="lineno">  952</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno">  953</span> </div>
<div class="line"><span class="lineno">  954</span>    delta=eps*max(1.0_mpd,dgamma+xi)</div>
<div class="line"><span class="lineno">  955</span>    sn=1.0_mpd</div>
<div class="line"><span class="lineno">  956</span>    <span class="keywordflow">IF</span>(n &gt; 1) sn=1.0_mpd/sqrt(real(n*n-1,<a class="code hl_variable" href="namespacempdef.html#a1f913a4d0f3752088f75db7d925b0ac1">mpd</a>))</div>
<div class="line"><span class="lineno">  957</span>    beta=sqrt(max(eps,dgamma,xi*sn))           <span class="comment">! beta</span></div>
<div class="line"><span class="lineno">  958</span>    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   DELTA and BETA &#39;</span>,delta,beta</div>
<div class="line"><span class="lineno">  959</span> </div>
<div class="line"><span class="lineno">  960</span>    <span class="keywordflow">DO</span> k=2,n</div>
<div class="line"><span class="lineno">  961</span>        mk=k-ilptr(k)+ilptr(k-1)+1</div>
<div class="line"><span class="lineno">  962</span>  </div>
<div class="line"><span class="lineno">  963</span>        theta=0.0_mpd</div>
<div class="line"><span class="lineno">  964</span>  </div>
<div class="line"><span class="lineno">  965</span>        <span class="keywordflow">DO</span> j=mk,k</div>
<div class="line"><span class="lineno">  966</span>            mj=j-ilptr(j)+ilptr(j-1)+1</div>
<div class="line"><span class="lineno">  967</span>            kj=ilptr(k)-k+j        <span class="comment">! index kj</span></div>
<div class="line"><span class="lineno">  968</span>    </div>
<div class="line"><span class="lineno">  969</span>            <span class="keywordflow">DO</span> i=max(mj,mk),j-1</div>
<div class="line"><span class="lineno">  970</span>                val(kj)=val(kj) &amp;     <span class="comment">! L_kj := L_kj - L_ki D_ii L_ji</span></div>
<div class="line"><span class="lineno">  971</span>                    -val(ilptr(k)-k+i)*val(ilptr(i))*val(ilptr(j)-j+i)</div>
<div class="line"><span class="lineno">  972</span>      </div>
<div class="line"><span class="lineno">  973</span><span class="keywordflow">            END DO</span> <span class="comment">!</span></div>
<div class="line"><span class="lineno">  974</span>    </div>
<div class="line"><span class="lineno">  975</span>            theta=max(theta,abs(val(kj)))  <span class="comment">! maximum value of row</span></div>
<div class="line"><span class="lineno">  976</span>    </div>
<div class="line"><span class="lineno">  977</span>            <span class="keywordflow">IF</span>(j /= k) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  978</span>                <span class="keywordflow">IF</span>(val(ilptr(j)) /= 0.0_mpd) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  979</span>                    val(kj)=val(kj)/val(ilptr(j))</div>
<div class="line"><span class="lineno">  980</span>                <span class="keywordflow">ELSE</span></div>
<div class="line"><span class="lineno">  981</span>                    val(kj)=0.0_mpd</div>
<div class="line"><span class="lineno">  982</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  983</span><span class="keywordflow">            END IF</span>                                <span class="comment">! L_kj := L_kj/D_jj ! D_kk</span></div>
<div class="line"><span class="lineno">  984</span>    </div>
<div class="line"><span class="lineno">  985</span>            <span class="keywordflow">IF</span>(j == k) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  986</span>                valkj=val(kj)</div>
<div class="line"><span class="lineno">  987</span>                <span class="keywordflow">IF</span>(k &lt;= in) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  988</span>                    val(kj)=max(abs(val(kj)),(theta/beta)**2,delta)</div>
<div class="line"><span class="lineno">  989</span>                    <span class="keywordflow">IF</span>(valkj /= val(kj)) <span class="keywordflow">THEN</span></div>
<div class="line"><span class="lineno">  990</span>                        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   Index K=&#39;</span>,k</div>
<div class="line"><span class="lineno">  991</span>                        <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   &#39;</span>,valkj,val(kj), (theta/beta)**2,delta,theta</div>
<div class="line"><span class="lineno">  992</span><span class="keywordflow">                    END IF</span></div>
<div class="line"><span class="lineno">  993</span><span class="keywordflow">                END IF</span></div>
<div class="line"><span class="lineno">  994</span><span class="keywordflow">            END IF</span></div>
<div class="line"><span class="lineno">  995</span><span class="keywordflow">        END DO</span> <span class="comment">! J</span></div>
<div class="line"><span class="lineno">  996</span>  </div>
<div class="line"><span class="lineno">  997</span><span class="keywordflow">    END DO</span> <span class="comment">! K</span></div>
<div class="line"><span class="lineno">  998</span> </div>
<div class="line"><span class="lineno">  999</span>    <span class="keywordflow">DO</span> k=1,n</div>
<div class="line"><span class="lineno"> 1000</span>        <span class="keywordflow">IF</span>(val(ilptr(k)) /= 0.0_mpd) val(ilptr(k))=1.0_mpd/val(ilptr(k))</div>
<div class="line"><span class="lineno"> 1001</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 1002</span> </div>
<div class="line"><span class="lineno"> 1003</span>    <span class="keywordflow">RETURN</span></div>
<div class="ttc" id="anamespacempdef_html_a1f913a4d0f3752088f75db7d925b0ac1"><div class="ttname"><a href="namespacempdef.html#a1f913a4d0f3752088f75db7d925b0ac1">mpdef::mpd</a></div><div class="ttdeci">integer, parameter mpd</div><div class="ttdef"><b>Definition</b> <a href="mpdef_8f90_source.html#l00038">mpdef.f90:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c3b930ef489fec3d8b422e23a2ea0d5" name="a0c3b930ef489fec3d8b422e23a2ea0d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c3b930ef489fec3d8b422e23a2ea0d5">&#9670;&#160;</a></span>vabmmm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vabmmm </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>ilptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Variable band matrix print minimum and maximum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">val</td><td>variable-band matrix, replaced by D,L </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilptr</td><td>pointer array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01012">1012</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1013</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1016</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno"> 1017</span>    <span class="keywordtype">INTEGER(mpi)</span> :: kp</div>
<div class="line"><span class="lineno"> 1018</span>    <span class="keywordtype">INTEGER(mpi)</span> :: kr</div>
<div class="line"><span class="lineno"> 1019</span>    <span class="keywordtype">INTEGER(mpi)</span> :: ks</div>
<div class="line"><span class="lineno"> 1020</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno"> 1021</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: val(*)</div>
<div class="line"><span class="lineno"> 1022</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: ilptr(n)</div>
<div class="line"><span class="lineno"> 1023</span>    kr=1</div>
<div class="line"><span class="lineno"> 1024</span>    ks=1</div>
<div class="line"><span class="lineno"> 1025</span>    kp=1</div>
<div class="line"><span class="lineno"> 1026</span>    <span class="keywordflow">DO</span> k=1,n</div>
<div class="line"><span class="lineno"> 1027</span>        <span class="keywordflow">IF</span>(val(ilptr(k)) &gt; val(ilptr(ks))) ks=k</div>
<div class="line"><span class="lineno"> 1028</span>        <span class="keywordflow">IF</span>(val(ilptr(k)) &lt; val(ilptr(kr))) kr=k</div>
<div class="line"><span class="lineno"> 1029</span>        <span class="keywordflow">IF</span>(val(ilptr(k)) &gt; 0.0.AND.val(ilptr(k)) &lt; val(ilptr(kp))) kp=k</div>
<div class="line"><span class="lineno"> 1030</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 1031</span>    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   Index value &#39;</span>,ks,val(ilptr(ks))</div>
<div class="line"><span class="lineno"> 1032</span>    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   Index value &#39;</span>,kp,val(ilptr(kp))</div>
<div class="line"><span class="lineno"> 1033</span>    <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;   Index value &#39;</span>,kr,val(ilptr(kr))</div>
<div class="line"><span class="lineno"> 1034</span> </div>
<div class="line"><span class="lineno"> 1035</span>    <span class="keywordflow">RETURN</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7b71525e0a1923dfe5b87571f8ea10d1" name="a7b71525e0a1923dfe5b87571f8ea10d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b71525e0a1923dfe5b87571f8ea10d1">&#9670;&#160;</a></span>vabslv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vabslv </td>
          <td>(</td>
          <td class="paramtype">integer(mpi), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(mpi), dimension(n), intent(in)&#160;</td>
          <td class="paramname"><em>ilptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(mpd), dimension(n), intent(inout)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Variable band matrix solution. </p>
<p>The matrix equation A X = B is solved. The matrix is assumed to decomposed before using VABDEC. The array X(N) contains on entry the right-hand-side B(N); at return it contains the solution.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">val</td><td>decomposed variable-band matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilptr</td><td>pointer array </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>r.h.s vector B, replaced by solution vector X </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mpnum_8f90_source.html#l01049">1049</a> of file <a class="el" href="mpnum_8f90_source.html">mpnum.f90</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1050</span>    <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespacempdef.html">mpdef</a></div>
<div class="line"><span class="lineno"> 1051</span> </div>
<div class="line"><span class="lineno"> 1052</span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><span class="lineno"> 1053</span>    <span class="keywordtype">INTEGER(mpi)</span> :: j</div>
<div class="line"><span class="lineno"> 1054</span>    <span class="keywordtype">INTEGER(mpi)</span> :: k</div>
<div class="line"><span class="lineno"> 1055</span>    <span class="keywordtype">INTEGER(mpi)</span> :: mk</div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: n</div>
<div class="line"><span class="lineno"> 1058</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: val(*)</div>
<div class="line"><span class="lineno"> 1059</span>    <span class="keywordtype">INTEGER(mpi)</span>, <span class="keywordtype">INTENT(IN)</span>                      :: ilptr(n)</div>
<div class="line"><span class="lineno"> 1060</span><span class="keywordtype">    REAL</span>(mpd), <span class="keywordtype">INTENT(IN OUT)</span>         :: x(n)</div>
<div class="line"><span class="lineno"> 1061</span>    <span class="comment">!     ...</span></div>
<div class="line"><span class="lineno"> 1062</span>    <span class="keywordflow">DO</span> k=1,n                  <span class="comment">! forward loop</span></div>
<div class="line"><span class="lineno"> 1063</span>        mk=k-ilptr(k)+ilptr(k-1)+1</div>
<div class="line"><span class="lineno"> 1064</span>        <span class="keywordflow">DO</span> j=mk,k-1</div>
<div class="line"><span class="lineno"> 1065</span>            x(k)=x(k)-val(ilptr(k)-k+j)*x(j)  <span class="comment">! X_k := X_k - L_kj B_j</span></div>
<div class="line"><span class="lineno"> 1066</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 1067</span><span class="keywordflow">    END DO</span> <span class="comment">! K</span></div>
<div class="line"><span class="lineno"> 1068</span> </div>
<div class="line"><span class="lineno"> 1069</span>    <span class="keywordflow">DO</span> k=1,n                  <span class="comment">! divide by diagonal elements</span></div>
<div class="line"><span class="lineno"> 1070</span>        x(k)=x(k)*val(ilptr(k))            <span class="comment">! X_k := X_k*D_kk</span></div>
<div class="line"><span class="lineno"> 1071</span><span class="keywordflow">    END DO</span></div>
<div class="line"><span class="lineno"> 1072</span> </div>
<div class="line"><span class="lineno"> 1073</span>    <span class="keywordflow">DO</span> k=n,1,-1               <span class="comment">! backward loop</span></div>
<div class="line"><span class="lineno"> 1074</span>        mk=k-ilptr(k)+ilptr(k-1)+1</div>
<div class="line"><span class="lineno"> 1075</span>        <span class="keywordflow">DO</span> j=mk,k-1</div>
<div class="line"><span class="lineno"> 1076</span>            x(j)=x(j)-val(ilptr(k)-k+j)*x(k)  <span class="comment">! X_j := X_j - L_kj X_k</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="keywordflow">        END DO</span></div>
<div class="line"><span class="lineno"> 1078</span><span class="keywordflow">    END DO</span> <span class="comment">! K</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_23416660aff6402864c13eb5e981e75a.html">millepede</a></li><li class="navelem"><a class="el" href="mpnum_8f90.html">mpnum.f90</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
